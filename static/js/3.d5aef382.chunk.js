(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{4771:function(e,t,n){"use strict";var a=n(1),o=n.n(a),i=n(6),s=n(7),r=n(8),l=n(14),c=n(11),u=n(15),p=n(288),h=n(361),d=n.n(h),m=n(0),f=n.n(m),g=n(3),b=n(39),k=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={totalAUM:null,totalAUMEndOfYear:null},n.functionsUtil=null,n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new b.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),this.loadTotalAUM();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),a=t.contractsInitialized!==this.props.contractsInitialized,(!t.availableStrategies&&JSON.stringify(t.availableStrategies)!==JSON.stringify(this.props.availableStrategies)||a)&&this.loadTotalAUM();case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadTotalAUM",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.availableStrategies&&this.props.contractsInitialized){e.next=2;break}return e.abrupt("return",!0);case 2:return e.next=4,this.functionsUtil.getAggregatedStats();case 4:t=e.sent,n=t.avgAPY,a=t.totalAUM,i=a.plus(a.times(n.div(100))),this.setState({totalAUM:a,totalAUMEndOfYear:i});case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.totalAUM?f.a.createElement(g.b,{width:1},f.a.createElement(d.a,{delay:0,decimals:4,decimal:".",separator:"",useEasing:!1,duration:31536e3,start:parseFloat(this.state.totalAUM),end:parseFloat(this.state.totalAUMEndOfYear),formattingFn:function(t){return"$ "+e.functionsUtil.formatMoney(t,4)}},function(t){var n=t.countUpRef;t.start;return f.a.createElement("span",{style:e.props.counterStyle?e.props.counterStyle:{display:"block",color:"dark-gray",whiteSpace:"nowrap",fontFamily:e.props.theme.fonts.counter,fontWeight:e.props.theme.fontWeights[5],textAlign:e.props.isMobile?"center":"right",fontSize:e.props.isMobile?"1.6em":e.props.theme.fontSizes[6]},ref:n})}),("undefined"===typeof this.props.subtitle||this.props.subtitle)&&f.a.createElement(p.a,Object.assign({fontWeight:3,fontSize:[2,2],color:"cellTitle",textAlign:["center","right"]},this.props.subtitleProps),this.props.subtitle?this.props.subtitle:f.a.createElement(g.u.span,{fontWeight:"inherit",color:"inherit",fontSize:"inherit"},"Assets Under Management ",f.a.createElement(g.u.span,{color:"cellTitle",fontWeight:3,fontSize:"70%"},"(V3 + V4)")))):f.a.createElement(g.o,{size:"30px"})}}]),t}(m.Component);t.a=k},4850:function(e,t,n){e.exports={twitterIcon:"TwitterShareButton_twitterIcon__2QCmn"}},4946:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),i=n(6),s=n(7),r=n(8),l=n(14),c=n(11),u=n(15),p=n(0),h=n.n(p),d=n(155),m=n(3),f=n(39),g=n(4782),b=n(267),k=n.n(b),v=n(288),x=n(78),y=n(4783),w=n(585),C=n(36),T=n(307),S=n(51),E=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),u=0;u<a;u++)r[u]=arguments[u];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={chartProps:{},chartType:null,chartData:null,chartWidth:null},n.functionsUtil=null,n.parseAum=function(e){return(parseInt(e)>=1e3?parseFloat(e/1e3).toFixed(1)+"K":parseFloat(e))+" "+n.props.selectedToken},n.loadApiData=Object(i.a)(o.a.mark(function e(){var t,a,s,r,l,c,u,p,d,f,g,b,v,T,E,U,j,D,M,O,A,I,B,P,z,F,R,Y,V,N,L,H,W,G,_,q,X,J,Z,Q,K;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.tokenConfig&&n.props.selectedToken&&n.props.chartMode&&n.props.apiResults){e.next=2;break}return e.abrupt("return",!1);case 2:t=function(e){return h.a.createElement(m.h,{mb:2,width:1,alignItems:"center",flexDirection:"row"},h.a.createElement(m.h,{pr:2,style:{flexBasis:"0",flex:"1 1 0px"},alignItems:"center",justifyContent:"flex-start"},e.color&&h.a.createElement(m.b,{mr:2,width:"10px",height:"10px",borderRadius:"50%",backgroundColor:e.color}),h.a.createElement(m.u,{fontSize:1,fontWeight:2,textAlign:"left",color:"dark-gray",style:{textTransform:"capitalize"}},e.label)),h.a.createElement(m.h,{style:{flexBasis:"0",flex:"1 1 0px"},alignItems:"center",justifyContent:"flex-end"},h.a.createElement(m.u,{fontSize:1,fontWeight:3,color:"cellText",textAlign:"right",style:{whiteSpace:"nowrap"},dangerouslySetInnerHTML:{__html:e.value}})))},a=function(e){return h.a.createElement(S.a,{key:e.point.id,cardProps:{py:2,px:3,width:1,left:e.point.data.itemPos>50?"-110%":"0"}},h.a.createElement(m.h,{width:1,flexDirection:"column"},e.point.data.xFormatted&&h.a.createElement(m.u,{mb:2,fontSize:1,fontWeight:3,color:"cellText",textAlign:"left"},e.point.data.xFormatted),e.children))},s=4,r=n.props.apiResults,l=n.props.apiResults_unfiltered,c=r.length,u=Object.assign([],n.props.tokenConfig.protocols),p=C.a.stats.versions[n.props.idleVersion],d={},f={},g=0,b=0,v=[],T={},E=w.a,U=[],j=0,D=0,M=null,O=null,e.t0=n.props.chartMode,e.next="VOL"===e.t0?25:"AUM"===e.t0?41:"ALL"===e.t0?50:"ALL_PERC"===e.t0?61:"APR"===e.t0?69:"SCORE"===e.t0?78:"PRICE_V4"===e.t0?88:"PRICE"===e.t0?105:118;break;case 25:for(A={},I=parseInt(l[0].timestamp),B=parseInt(k()()._d.getTime()/1e3),P=I;P<=B;P+=86400)z=k()(1e3*P).format("YYYY/MM/DD"),A[z]||(A[z]={date:z,timestamp:P,deposits:0,redeems:0});for(F=null,l.forEach(function(e){var t=k()(1e3*e.timestamp).format("YYYY/MM/DD"),a=n.functionsUtil.fixTokenDecimals(e.idleSupply,18);if(A[t]||(A[t]={date:t,timestamp:e.timestamp,deposits:0,redeems:0}),F){var o=n.functionsUtil.fixTokenDecimals(F.idleSupply,18);if(!a.eq(o)){var i=a.minus(o);i.gte(0)?(A[t].deposits+=parseFloat(i),j=Math.max(j,A[t].deposits)):(A[t].redeems+=parseFloat(i),j=Math.max(j,Math.abs(A[t].deposits)))}}else A[t].deposits+=parseFloat(a);F=e}),v=Object.values(A).filter(function(e){return(!n.props.startTimestamp||e.timestamp>=n.props.startTimestamp)&&(!n.props.endTimestamp||e.timestamp<=n.props.endTimestamp)}),R=0,v.forEach(function(e){R=Math.max(R,Math.abs(e.deposits),Math.abs(e.redeems))}),E=y.a,D=0,g=parseFloat(j/s),U=[0],Y=1;Y<=5;Y++)U.push(Y*g);return T={indexBy:"date",enableLabel:!1,minValue:-R,maxValue:R,label:function(e){return Math.abs(e.value)},axisBottom:n.props.isMobile?null:{tickSize:0,legend:"",format:function(e){if(D++%3===0)return k()(e,"YYYY/MM/DD HH:mm").format("MMM DD")},tickPadding:15,orient:"bottom",legendOffset:0,legendPosition:"middle",tickValues:"every 3 days"},axisLeft:null,axisRight:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:8,legendPosition:"middle",format:function(e){return n.functionsUtil.abbreviateNumber(Math.abs(e),0)}},markers:[{axis:"y",value:0,lineStyle:{strokeOpacity:0},textStyle:{fill:x.a.colors.transactions.action.deposit},legend:"deposits",legendPosition:"top-left",legendOrientation:"vertical",legendOffsetX:-20},{axis:"y",value:0,lineStyle:{stroke:x.a.colors["dark-gray"],strokeDasharray:"5 3"},textStyle:{fill:x.a.colors.transactions.action.redeem},legend:"redeems",legendPosition:"bottom-left",legendOrientation:"vertical",legendOffsetX:-20}],keys:["deposits","redeems"],padding:.4,colors:[x.a.colors.transactions.action.deposit,x.a.colors.transactions.action.redeem],labelTextColor:"inherit:darker(1.4)",labelSkipWidth:16,labelSkipHeight:16,pointSize:0,useMesh:!0,animate:!1,pointLabel:"y",curve:"linear",enableArea:!1,enableSlices:"x",enableGridX:!1,enableGridY:!0,pointBorderWidth:1,pointLabelYOffset:-12,legends:[{dataFrom:"keys",itemWidth:n.props.isMobile?80:100,itemHeight:18,translateX:0,translateY:n.props.isMobile?40:65,symbolSize:10,itemsSpacing:0,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:x.a.colors.legend,effects:[{on:"hover",style:{itemTextColor:"#000"}}]}],theme:{axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:x.a.colors.legend,fontFamily:x.a.fonts.sansSerif}}},grid:{line:{stroke:x.a.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontSize:n.props.isMobile?12:14,fontWeight:500,fontFamily:x.a.fonts.sansSerif}},tooltip:{container:{boxShadow:null,background:null}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:50,bottom:45,left:50}:{top:20,right:70,bottom:70,left:50},tooltip:function(e){var o=n.functionsUtil.strToMoment(e.indexValue).format("MMM DD"),i={id:e.id,data:{xFormatted:o}},s=n.functionsUtil.abbreviateNumber(e.data.deposits,2)+" "+n.props.selectedToken,r=n.functionsUtil.abbreviateNumber(e.data.redeems,2)+" "+n.props.selectedToken;return h.a.createElement(a,{point:i},h.a.createElement(t,{label:"Deposits",color:x.a.colors.deposit,value:s}),h.a.createElement(t,{label:"Redeem",color:x.a.colors.redeem,value:r}))}},e.abrupt("break",119);case 41:for(j=0,v.push({id:"AUM",color:"hsl("+C.a.stats.tokens[n.props.selectedToken].color.hsl.join(",")+")",data:r.map(function(e,t){var a=n.functionsUtil.fixTokenDecimals(e.idleSupply,18),o=n.functionsUtil.fixTokenDecimals(e.idlePrice,n.props.tokenConfig.decimals),i=a.times(o),s=k()(1e3*e.timestamp).format("YYYY/MM/DD HH:mm"),r=parseFloat(i.toString());return j=Math.max(j,r),{x:s,y:r}})}),n.props.tokenConfig.protocols.forEach(function(e,t){r.map(function(t,a){return t.protocolsData.filter(function(t,n){return t.protocolAddr.toLowerCase()===e.address.toLowerCase()}).map(function(a,o){if(!n.functionsUtil.BNify(a.rate).eq(0)){var i=k()(1e3*t.timestamp).format("YYYY/MM/DD HH:mm"),s=parseFloat(n.functionsUtil.fixTokenDecimals(a.allocation,n.props.tokenConfig.decimals));j=Math.max(j,s);var r=v[0].data.filter(function(e){return e.x===i});if(r){r=r[0];var l=v[0].data.indexOf(r);r.allocations||(r.allocations={}),r.allocations[e.name]=s,v[0].data[l]=r}}})[0]}).filter(function(e){return void 0!==e})}),E=w.a,g=parseFloat(j/s),U=[0],V=1;V<=5;V++)U.push(V*g);return T={xScale:{type:"time",format:"%Y/%m/%d %H:%M"},xFormat:"time:%b %d %H:%M",yFormat:function(e){return n.functionsUtil.formatMoney(e,e<1?3:0)},yScale:{type:"linear",stacked:!1},axisLeft:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:U,legendPosition:"middle",format:function(e){return n.functionsUtil.abbreviateNumber(e,e<1?3:0)}},axisBottom:n.props.isMobile?null:{tickSize:0,format:"%b %d",tickPadding:15,tickValues:n.props.isMobile?"every 4 days":n.props.showAdvanced?"every 3 days":"every 2 days",orient:"bottom",legend:"",legendOffset:0,legendPosition:"middle"},gridYValues:U,pointSize:0,useMesh:!0,animate:!1,pointLabel:"y",curve:"linear",enableArea:!0,enableSlices:"x",enableGridX:!1,enableGridY:!0,pointBorderWidth:1,colors:function(e){return e.color},pointLabelYOffset:-12,legends:[{itemWidth:n.props.isMobile?70:80,itemHeight:18,translateX:n.props.isMobile?-35:0,translateY:n.props.isMobile?40:65,symbolSize:10,itemsSpacing:5,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:x.a.colors.legend,effects:[{on:"hover",style:{itemTextColor:"#000"}}]}],theme:{axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:x.a.colors.legend,fontFamily:x.a.fonts.sansSerif}}},grid:{line:{stroke:x.a.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontSize:n.props.isMobile?12:14,fontWeight:500,fontFamily:x.a.fonts.sansSerif}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:20,bottom:40,left:65}:{top:20,right:40,bottom:70,left:70},sliceTooltip:function(e){var o=e.slice.points[0];return"object"===typeof o&&"object"===typeof o.data?h.a.createElement(a,{point:o},h.a.createElement(t,{label:o.serieId,color:o.serieColor,value:o.data.yFormatted}),o.data.allocations&&"object"===typeof o.data.allocations&&Object.keys(o.data.allocations).map(function(e){var a="hsl("+C.a.stats.protocols[e].color.hsl.join(",")+")",i=o.data.allocations[e],s=n.functionsUtil.formatMoney(i,i<1?3:0),r=n.functionsUtil.BNify(o.data.allocations[e]).div(n.functionsUtil.BNify(o.data.y)).times(100).toFixed(0)+"%";return h.a.createElement(t,{label:e,color:a,key:"".concat(o.id,"_").concat(e),value:"".concat(s," (").concat(r,")")})})):null}},e.abrupt("break",119);case 50:for(d={},f={},r.forEach(function(e,t){var a=k()(1e3*e.timestamp).format("YYYY/MM/DD"),o={date:a};e.protocolsData.forEach(function(e){var t=n.functionsUtil.BNify(e.rate).eq(0),a=n.props.tokenConfig.protocols.find(function(t){return t.address.toLowerCase()===e.protocolAddr.toLowerCase()});if(a){var i=n.functionsUtil.capitalize(a.name);if(t)o[i]=0;else{var s=parseFloat(n.functionsUtil.fixTokenDecimals(e.allocation,n.props.tokenConfig.decimals));d[i]=1,o[i]=s,o["".concat(i,"Color")]="hsl("+C.a.stats.protocols[i.toLowerCase()].color.hsl.join(",")+")",j=Math.max(j,s)}}}),f[a]=o}),v=Object.values(f),E=y.a,D=0,g=parseFloat(j/s),U=[0],N=1;N<=5;N++)U.push(N*g);return T={padding:.2,animate:!1,indexBy:"date",enableLabel:!1,labelSkipWidth:16,labelSkipHeight:16,keys:Object.keys(d),labelTextColor:"inherit:darker(1.4)",colors:function(e){var t=e.id;return e.data["".concat(t,"Color")]},axisLeft:{format:function(e){return n.functionsUtil.abbreviateNumber(e,e<1?3:0)},orient:"left",tickSize:0,tickPadding:10,tickRotation:0,legend:"",legendOffset:-65,tickValues:U,legendPosition:"middle"},gridYValues:U,axisBottom:n.props.isMobile?null:{legend:"",format:function(e){if(D++%3===0)return k()(e,"YYYY/MM/DD HH:mm").format("MMM DD")},tickSize:0,tickPadding:10,orient:"bottom-left",legendOffset:36,legendPosition:"middle",tickValues:"every 3 days"},legends:[{dataFrom:"keys",itemWidth:n.props.isMobile?70:80,itemHeight:18,translateX:n.props.isMobile?-35:0,translateY:n.props.isMobile?40:65,symbolSize:10,itemsSpacing:5,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:x.a.colors.legend,effects:[{on:"hover",style:{itemTextColor:"#000"}}]}],theme:{axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:x.a.colors.legend,fontFamily:x.a.fonts.sansSerif}}},grid:{line:{stroke:x.a.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontSize:n.props.isMobile?12:14,fontWeight:500,fontFamily:x.a.fonts.sansSerif}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:20,bottom:40,left:65}:{top:20,right:40,bottom:70,left:60},tooltip:function(e){var t=e.id,a=e.value,o=e.color,i=n.functionsUtil.formatMoney(a,0);return h.a.createElement("table",{style:{width:"100%",borderCollapse:"collapse"}},h.a.createElement("tbody",null,h.a.createElement("tr",null,h.a.createElement("td",{style:{padding:"3px 5px"}},h.a.createElement("span",{style:{display:"block",width:"12px",height:"12px",background:o}})),h.a.createElement("td",{style:{padding:"3px 5px",textTransform:"capitalize"}},t),h.a.createElement("td",{style:{padding:"3px 5px"}},h.a.createElement("strong",null,i," ",n.props.selectedToken)))))}},e.abrupt("break",119);case 61:return d={},f={},r.forEach(function(e,t){var a=k()(1e3*e.timestamp).format("YYYY/MM/DD"),o={date:k()(1e3*e.timestamp).format("YYYY/MM/DD HH:mm")};f[a]&&(o=f[a]);var i=e.protocolsData.reduce(function(e,t){var a=n.functionsUtil.fixTokenDecimals(t.allocation,n.props.tokenConfig.decimals);return n.functionsUtil.BNify(e).plus(a)},0);e.protocolsData.forEach(function(e){var t=n.functionsUtil.BNify(e.rate).eq(0),a=n.props.tokenConfig.protocols.filter(function(t){return t.address.toLowerCase()===e.protocolAddr.toLowerCase()})[0].name;if(t)void 0!==typeof o[a]&&(o[a]=0);else{var s=n.functionsUtil.fixTokenDecimals(e.allocation,n.props.tokenConfig.decimals),r=parseFloat(s.div(i).times(100));d[a]=1,o[a]=r,o["".concat(a,"Color")]="hsl("+C.a.stats.protocols[a].color.hsl.join(",")+")"}}),f[a]=o}),v=Object.values(f),E=y.a,D=0,T={padding:.2,animate:!1,indexBy:"date",data:v,enableLabel:!1,labelSkipWidth:16,labelSkipHeight:16,keys:Object.keys(d),labelTextColor:"inherit:darker(1.4)",margin:n.props.isMobile?{top:20,right:20,bottom:40,left:50}:{top:20,right:40,bottom:40,left:60},colors:function(e){var t=e.id;return e.data["".concat(t,"Color")]},axisLeft:{format:function(e){return parseInt(e)+"%"}},axisBottom:n.props.isMobile?null:{legend:"",format:function(e){if(D++%3===0)return k()(e,"YYYY/MM/DD HH:mm").format("MMM DD")},orient:"bottom",legendOffset:36,legendPosition:"middle",tickValues:"every 3 days"},tooltip:function(e){var t=e.id,a=e.value,o=e.color,i=100===parseInt(a)?n.functionsUtil.formatMoney(a,0):n.functionsUtil.formatMoney(a,2);return h.a.createElement("table",{style:{width:"100%",borderCollapse:"collapse"}},h.a.createElement("tbody",null,h.a.createElement("tr",null,h.a.createElement("td",{style:{padding:"3px 5px"}},h.a.createElement("span",{style:{display:"block",width:"12px",height:"12px",background:o}})),h.a.createElement("td",{style:{padding:"3px 5px",textTransform:"capitalize"}},t),h.a.createElement("td",{style:{padding:"3px 5px"}},h.a.createElement("strong",null,i,"%")))))}},e.abrupt("break",119);case 69:for(j=0,n.props.tokenConfig.protocols.forEach(function(e,t){v.filter(function(t){return t.name===e.name}).length||v.push({id:e.name,color:"hsl("+C.a.stats.protocols[e.name].color.hsl.join(",")+")",data:r.map(function(t,a){return t.protocolsData.filter(function(t,n){return t.protocolAddr.toLowerCase()===e.address.toLowerCase()}).map(function(e,a){if(!n.functionsUtil.BNify(e.rate).eq(0)){var o=k()(1e3*t.timestamp).format("YYYY/MM/DD HH:mm"),i=parseFloat(n.functionsUtil.fixTokenDecimals(e.rate,18));return j=Math.max(j,i),{x:o,y:i}}})[0]}).filter(function(e){return void 0!==e})})}),v.push({id:"Idle",color:"hsl("+C.a.stats.protocols.idle.color.hsl.join(",")+")",data:r.map(function(e,t){var a=k()(1e3*e.timestamp).format("YYYY/MM/DD HH:mm"),o=parseFloat(n.functionsUtil.fixTokenDecimals(e.idleRate,18));return j=Math.max(j,o),{x:a,y:o}})}),E=w.a,g=parseFloat(j/s),U=[0],L=1;L<=5;L++)U.push(L*g);return T={xScale:{type:"time",format:"%Y/%m/%d %H:%M"},xFormat:"time:%b %d %H:%M",yFormat:function(e){return parseFloat(e).toFixed(2)+"%"},yScale:{type:"linear",stacked:!1},axisLeft:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:U,legendPosition:"middle",format:function(e){return parseFloat(e).toFixed(1)+"%"}},axisBottom:n.props.isMobile?null:{tickSize:0,format:"%b %d",tickPadding:15,tickValues:n.props.isMobile?"every 4 days":n.props.showAdvanced?"every 3 days":"every 2 days",orient:"bottom",legend:"",legendOffset:0,legendPosition:"middle"},gridYValues:U,pointSize:0,useMesh:!0,animate:!1,pointLabel:"y",curve:"linear",enableArea:!1,enableSlices:"x",enableGridX:!1,enableGridY:!0,pointBorderWidth:1,colors:function(e){return e.color},pointLabelYOffset:-12,legends:[{itemWidth:n.props.isMobile?70:80,itemHeight:18,translateX:n.props.isMobile?-35:0,translateY:n.props.isMobile?40:65,symbolSize:10,itemsSpacing:0,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:x.a.colors.legend,effects:[{on:"hover",style:{itemTextColor:"#000"}}]}],theme:{axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:x.a.colors.legend,fontFamily:x.a.fonts.sansSerif}}},grid:{line:{stroke:x.a.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontSize:n.props.isMobile?12:14,fontWeight:500,fontFamily:x.a.fonts.sansSerif}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:20,bottom:40,left:65}:{top:20,right:40,bottom:70,left:70},sliceTooltip:function(e){var n=e.slice,o=n.points[0];return h.a.createElement(a,{point:o},"object"===typeof n.points&&n.points.length&&n.points.map(function(e){var n=e.serieId,a=e.data.yFormatted;return h.a.createElement(t,{key:e.id,color:e.color,label:n,value:a})}))}},e.abrupt("break",119);case 78:for(H=0,j=0,n.props.tokenConfig.protocols.forEach(function(e,t){v.filter(function(t){return t.name===e.name}).length||v.push({id:e.name,color:"hsl("+C.a.stats.protocols[e.name].color.hsl.join(",")+")",data:r.map(function(t,n){return t.protocolsData.filter(function(t,n){return t.protocolAddr.toLowerCase()===e.address.toLowerCase()}).map(function(e,n){var a=k()(1e3*t.timestamp).format("YYYY/MM/DD HH:mm"),o=parseFloat(e.defiScore);return o=isNaN(o)||!o?H:o,H=o,j=Math.max(j,o),{x:a,y:o}})[0]}).filter(function(e){return void 0!==e})})}),v.push({id:"Idle",color:"hsl("+C.a.stats.protocols.idle.color.hsl.join(",")+")",data:r.map(function(e,t){var n=k()(1e3*e.timestamp).format("YYYY/MM/DD HH:mm"),a=parseFloat(e.idleScore);return a=isNaN(a)||!a?H:a,H=a,j=Math.max(j,a),{x:n,y:a}})}),E=w.a,g=parseFloat(j/s),U=[0],W=1;W<=5;W++)U.push(W*g);return T={xScale:{type:"time",format:"%Y/%m/%d %H:%M"},xFormat:"time:%b %d %H:%M",yFormat:function(e){return parseFloat(e).toFixed(1)},yScale:{type:"linear",stacked:!1},axisLeft:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:U,legendPosition:"middle",format:function(e){return parseFloat(e).toFixed(1)}},axisBottom:n.props.isMobile?null:{tickSize:0,format:"%b %d",tickPadding:15,tickValues:n.props.isMobile?"every 4 days":n.props.showAdvanced?"every 3 days":"every 2 days",orient:"bottom",legend:"",legendOffset:0,legendPosition:"middle"},gridYValues:U,pointSize:0,useMesh:!0,animate:!1,pointLabel:"y",curve:"linear",enableArea:!1,enableSlices:"x",enableGridX:!1,enableGridY:!0,pointBorderWidth:1,colors:function(e){return e.color},pointLabelYOffset:-12,legends:[{itemWidth:n.props.isMobile?70:80,itemHeight:18,translateX:n.props.isMobile?-35:0,translateY:n.props.isMobile?40:65,symbolSize:10,itemsSpacing:0,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:x.a.colors.legend,effects:[{on:"hover",style:{itemTextColor:"#000"}}]}],theme:{axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:x.a.colors.legend,fontFamily:x.a.fonts.sansSerif}}},grid:{line:{stroke:x.a.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontSize:n.props.isMobile?12:14,fontWeight:500,fontFamily:x.a.fonts.sansSerif}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:20,bottom:40,left:65}:{top:20,right:40,bottom:70,left:70},sliceTooltip:function(e){var n=e.slice,o=n.points[0];return h.a.createElement(a,{point:o},"object"===typeof n.points&&n.points.length&&n.points.map(function(e){var n=e.serieId,a=e.data.yFormatted;return h.a.createElement(t,{key:e.id,color:e.color,label:n,value:a})}))}},e.abrupt("break",119);case 88:for(b=0,j=0,G=null,_=null,q=n.functionsUtil.BNify(1),X=n.functionsUtil.BNify(1),J=n.functionsUtil.BNify(0),M=r.map(function(e,t){var a=0,o=0,i=k()(1e3*e.timestamp).format("YYYY/MM/DD HH:mm"),s=n.functionsUtil.fixTokenDecimals(e.idleRate,18).div(100);if(J=J.plus(s.times(100)),G){var r=(e.timestamp-_.timestamp)/86400,l=X.times(G.times(r).div(365)),u=(X=X.plus(l)).div(q).minus(1).times(100);a=parseFloat(u),o=J.div(t+1).toFixed(2)}_=e,G=s,null===O&&(O=parseInt(e.blocknumber)),j=Math.max(j,a);var p=Math.floor(b/c*100),h=e.blocknumber;return b++,{x:i,y:a,apy:o,blocknumber:h,itemPos:p}}),p.additionalProtocols&&p.additionalProtocols.length>0&&p.additionalProtocols.forEach(function(e){var t=n.props.tokenConfig.protocols.find(function(t){return t.name===e.protocol});t&&(e.enabled=!0,e.address=t.address,u.unshift(e))}),u.forEach(function(e){var t=C.a.stats.protocols[e.name],a=t.rateField?t.rateField:"rate",o={id:t.label,color:"hsl("+t.color.hsl.join(",")+")",data:[]};b=0,G=null,_=null;var i=0,s=null,l=null;J=n.functionsUtil.BNify(0),q=n.functionsUtil.BNify(1),X=n.functionsUtil.BNify(1),r.forEach(function(t,r){var u=t.protocolsData.find(function(t,n){return t.protocolAddr.toLowerCase()===e.address.toLowerCase()});if(u){s||(s=u);var p="object"===typeof a&&a.length?a.reduce(function(e,t){return u[t]?n.functionsUtil.BNify(e).plus(n.functionsUtil.BNify(u[t])):n.functionsUtil.BNify(e)},0):n.functionsUtil.BNify(u[a]);if(!p.eq(0)){if(null===l&&(l=parseInt(t.blocknumber))>O){var h=M.find(function(e){return e.blocknumber>=l});h&&(i=h.y)}var d,m=0,f=0,g=k()(1e3*t.timestamp).format("YYYY/MM/DD HH:mm"),v=n.functionsUtil.fixTokenDecimals(p,18).div(100);if(J=J.plus(v.times(100)),_){var x=(t.timestamp-_.timestamp)/86400,y=X.times(G.times(x).div(365)),w=(X=X.plus(y)).div(q).minus(1).times(100);m=parseFloat(w)+i,f=J.div(r+1).toFixed(2)}_=t,G=v,null===O&&(O=parseInt(t.blocknumber)),j=Math.max(j,m);var C=Math.floor(b/c*100);b++,d={x:g,y:m,apy:f,itemPos:C},b++,o.data.push(d)}}}),v.push(o)}),g=parseFloat(j/s),U=[0],Z=1;Z<=5;Z++)U.push(Z*g);return v.push({id:"Idle",color:"hsl("+C.a.stats.protocols.idle.color.hsl.join(",")+")",data:M}),E=w.a,T={xScale:{type:"time",format:"%Y/%m/%d %H:%M"},xFormat:"time:%b %d %H:%M",yFormat:function(e){return parseFloat(e).toFixed(3)+"%"},yScale:{type:"linear",stacked:!1},axisLeft:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:U,legendPosition:"middle",format:function(e){return parseFloat(e).toFixed(2)+"%"}},axisBottom:n.props.isMobile?null:{legend:"",tickSize:0,format:"%b %d",tickPadding:10,legendOffset:0,orient:"bottom",legendPosition:"middle",tickValues:n.props.isMobile?"every 4 days":n.props.showAdvanced?"every 3 days":"every 2 days"},gridYValues:U,pointSize:0,useMesh:!0,animate:!1,pointLabel:"y",curve:"monotoneX",enableArea:!1,enableSlices:"x",enableGridX:!1,enableGridY:!0,pointBorderWidth:1,colors:function(e){return e.color},pointLabelYOffset:-12,legends:[{itemHeight:18,itemWidth:n.props.isMobile?70:100,translateX:n.props.isMobile?-35:0,translateY:n.props.isMobile?40:65,symbolSize:10,itemsSpacing:5,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:x.a.colors.legend,effects:[{on:"hover",style:{itemTextColor:"#000"}}]}],theme:{axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:x.a.colors.legend,fontFamily:x.a.fonts.sansSerif}}},grid:{line:{stroke:x.a.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontSize:n.props.isMobile?12:14,fontWeight:500,fontFamily:x.a.fonts.sansSerif}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:20,bottom:40,left:65}:{top:20,right:40,bottom:80,left:80},sliceTooltip:function(e){var n=e.slice,o=n.points[0];return h.a.createElement(a,{point:o},"object"===typeof n.points&&n.points.length&&n.points.map(function(e){var n=e.serieId,a=e.data.yFormatted,o=e.data.apy;return h.a.createElement(t,{key:e.id,label:n,color:e.color,value:"".concat(a," <small>(").concat(o,"% APY)</small>")})}))}},e.abrupt("break",119);case 105:return j=0,Q=null,M=r.map(function(e,t){var a=0,o=0,i=0,s=k()(1e3*e.timestamp).format("YYYY/MM/DD HH:mm"),l=n.functionsUtil.fixTokenDecimals(e.idlePrice,n.props.tokenConfig.decimals);Q?(a=parseFloat(l.div(Q).minus(1).times(100)),i=(e.timestamp-r[0].timestamp)/86400,o=l.div(Q).minus(1).times(100).times(365).div(i).toFixed(2)):Q=l;null===O&&(O=parseInt(e.blocknumber)),j=Math.max(j,a);var u=Math.floor(b/c*100),p=e.blocknumber;return b++,{x:s,y:a,apy:o,blocknumber:p,itemPos:u}}),p.additionalProtocols&&p.additionalProtocols.length>0&&p.additionalProtocols.forEach(function(e){var t=n.props.tokenConfig.protocols.find(function(t){return t.name===e.protocol});t&&(e.enabled=!0,e.address=t.address,u.unshift(e))}),e.next=111,n.functionsUtil.asyncForEach(u,function(){var e=Object(i.a)(o.a.mark(function e(t){var a,s,l,u,p,h,d,m;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=C.a.stats.protocols[t.name],s=a.rateField?a.rateField:"rate",l={id:a.label,color:"hsl("+a.color.hsl.join(",")+")",data:[]},b=0,u=0,Q=null,p=null,h=null,d=null,m=null,e.next=12,n.functionsUtil.asyncForEach(r,function(){var e=Object(i.a)(o.a.mark(function e(i){var f,g,v,x,y,w,T,S,E,U,D,A;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(f=i.protocolsData.find(function(e,n){return e.protocolAddr.toLowerCase()===t.address.toLowerCase()}))&&f[s]&&(d||(d=f),n.functionsUtil.BNify(f[s]).eq(0)||(null===m&&(m=parseInt(i.blocknumber))>O&&(g=M.find(function(e){return e.blocknumber>=m}))&&(u=g.y),{},x=f.price,y=n.functionsUtil.fixTokenDecimals(x,t.decimals),w=k()(1e3*i.timestamp).format("YYYY/MM/DD HH:mm"),a&&a.data&&a.data[t.address.toLowerCase()]&&a.data[t.address.toLowerCase()][i.blocknumber]&&(x=n.functionsUtil.BNify(C.a.stats.protocols[t.name].data[t.address.toLowerCase()][i.blocknumber]),y=n.functionsUtil.fixTokenDecimals(x,t.decimals)),T=u,S=0,Q?(y.lt(h)?(Q=y,E=l.data[l.data.length-1].y-l.data[l.data.length-2].y,T=p.y+E,u=T):T+=parseFloat(y.div(Q).minus(1).times(100)),U=(i.timestamp-r[0].timestamp)/86400,D=y.div(Q).minus(1).times(100),S=D.times(365).div(U).toFixed(2)):Q=y,T=Math.max(0,T),j=Math.max(j,T),A=Math.floor(b/c*100),b++,p=v={x:w,y:T,apy:S,itemPos:A},l.data.push(v),h=y));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 12:v.push(l);case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 111:for(g=parseFloat(j/s),U=[0],K=1;K<=5;K++)U.push(K*g);return v.push({id:"Idle",color:"hsl("+C.a.stats.protocols.idle.color.hsl.join(",")+")",data:M}),E=w.a,T={xScale:{type:"time",format:"%Y/%m/%d %H:%M"},xFormat:"time:%b %d %H:%M",yFormat:function(e){return parseFloat(e).toFixed(3)+"%"},yScale:{type:"linear",stacked:!1},axisLeft:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:U,legendPosition:"middle",format:function(e){return parseFloat(e).toFixed(2)+"%"}},axisBottom:n.props.isMobile?null:{legend:"",tickSize:0,format:"%b %d",tickPadding:10,legendOffset:0,orient:"bottom",legendPosition:"middle",tickValues:n.props.isMobile?"every 4 days":n.props.showAdvanced?"every 3 days":"every 2 days"},gridYValues:U,pointSize:0,useMesh:!0,animate:!1,pointLabel:"y",curve:"monotoneX",enableArea:!1,enableSlices:"x",enableGridX:!1,enableGridY:!0,pointBorderWidth:1,colors:function(e){return e.color},pointLabelYOffset:-12,legends:[{itemHeight:18,itemWidth:n.props.isMobile?70:100,translateX:n.props.isMobile?-35:0,translateY:n.props.isMobile?40:65,symbolSize:10,itemsSpacing:5,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:x.a.colors.legend,effects:[{on:"hover",style:{itemTextColor:"#000"}}]}],theme:{axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:x.a.colors.legend,fontFamily:x.a.fonts.sansSerif}}},grid:{line:{stroke:x.a.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontSize:n.props.isMobile?12:14,fontWeight:500,fontFamily:x.a.fonts.sansSerif}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:20,bottom:40,left:65}:{top:20,right:40,bottom:80,left:80},sliceTooltip:function(e){var n=e.slice,o=n.points[0];return h.a.createElement(a,{point:o},"object"===typeof n.points&&n.points.length&&n.points.map(function(e){var n=e.serieId,a=e.data.yFormatted,o=e.data.apy;return h.a.createElement(t,{key:e.id,label:n,color:e.color,value:"".concat(a," <small>(").concat(o,"% APY)</small>")})}))}},e.abrupt("break",119);case 118:return e.abrupt("break",119);case 119:n.setState({chartType:E,chartProps:T,chartData:v});case 120:case"end":return e.stop()}},e,this)})),n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({chartData:null,chartType:null,chartProps:null}),this.loadUtils(),this.loadApiData();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t){var n,a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.showAdvanced!==this.props.showAdvanced,a=t.apiResults!==this.props.apiResults,i=t.selectedToken!==this.props.selectedToken||JSON.stringify(t.tokenConfig)!==JSON.stringify(this.props.tokenConfig),(a||n||i)&&this.componentDidMount();case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"render",value:function(){return h.a.createElement(T.a,Object.assign({showLoader:!0},this.state.chartProps,{height:this.props.height,type:this.state.chartType,data:this.state.chartData,width:this.state.chartWidth,isMobile:this.props.isMobile,parentId:this.props.parentId,parentIdHeight:this.props.parentIdHeight}))}}]),t}(p.Component),U=n(34),j=n(163),D=n(208),M=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),u=0;u<a;u++)r[u]=arguments[u];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!0,processing:{rebalance:{txHash:null,loading:!1}},shouldRebalance:null},n.functionsUtil=null,n.checkRebalance=Object(i.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({loading:!0}),e.next=3,n.functionsUtil.checkRebalance(n.props.tokenConfig);case 3:t=e.sent,n.setState({loading:!1,shouldRebalance:t});case 5:case"end":return e.stop()}},e,this)})),n.rebalance=function(){var e=Object(i.a)(o.a.mark(function e(t){var a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),a=function(e,t){var a={eventCategory:"Rebalance",eventAction:n.props.selectedToken,eventLabel:e.status};t&&(a.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==a.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(a),"success"===e.status?window.toastProvider.addMessage("Rebalance completed",{secondaryMessage:"Now the pool is balanced!",colorTheme:"light",actionHref:"",actionText:"",variant:"success"}):window.toastProvider.addMessage("Rebalance error",{secondaryMessage:"The rebalance has failed, try again...",colorTheme:"light",actionHref:"",actionText:"",variant:"failure"}),n.setState(function(e){return{processing:Object(U.a)({},e.processing,{rebalance:{txHash:null,loading:!1}})}}),n.checkRebalance()},i=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(U.a)({},e.processing,{rebalance:Object(U.a)({},e.processing.rebalance,{txHash:t})})}})},n.props.contractMethodSendWrapper(n.props.tokenConfig.idle.token,"rebalance",[],null,a,i),n.setState({processing:{rebalance:{txHash:null,loading:!0}}});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),this.checkRebalance();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),a=t.account!==this.props.account,(t.selectedToken!==this.props.selectedToken||a)&&this.checkRebalance();case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return h.a.createElement(m.h,{px:3,width:1,minHeight:"100px",alignItems:"center",flexDirection:"column",justifyContent:"center"},this.state.loading?h.a.createElement(d.a,{flexProps:{flexDirection:"row"},loaderProps:{size:"30px"},textProps:{ml:2},text:"Checking rebalance..."}):this.state.processing.rebalance.loading?h.a.createElement(D.a,{web3:this.props.web3,waitText:"Rebalance estimated in",endMessage:"Finalizing rebalance request...",hash:this.state.processing.rebalance.txHash}):h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},h.a.createElement(m.u,{mt:0,mb:3,textAlign:"center"},this.state.shouldRebalance?"Rebalance the entire pool. All users will bless you.":"The pool is already balanced."),h.a.createElement(j.a,{buttonProps:{width:"auto",disabled:!this.state.shouldRebalance},handleClick:function(t){return e.rebalance(t)}},"Rebalance")))}}]),t}(p.Component),O=n(4766),A=n(496),I=n(4758),B=n(219),P=n(268),z=n(4765),F=n(589),R=n(1248),Y=n(66),V=(n(4834),n(4836)),N=(n(4848),function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={quickSelection:"",ranges:{startDate:n.props.startDate?n.props.startDate:new Date,endDate:n.props.endDate?n.props.endDate:new Date,key:"selection"}},n.componentDidUpdate=function(e){e.startDate===n.props.startDate&&e.endDate===n.props.endDate||n.setState({ranges:{startDate:n.props.startDate?n.props.startDate:new Date,endDate:n.props.endDate?n.props.endDate:new Date,key:"selection"}})},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"handleSelect",value:function(e){this.setState({quickSelection:"",ranges:e.selection})}},{key:"handleQuickSelect",value:function(e){var t=this,n=null,a=k()(new Date),o=e.target.value;switch(o){case"day":n=a.clone().subtract(1,"day");break;case"week":n=a.clone().subtract(1,"week");break;case"weeks":n=a.clone().subtract(2,"week");break;case"month":n=a.clone().subtract(1,"month");break;default:n=null,a=null}if(n&&a){var i={startDate:n=n._d,endDate:a=a._d,key:"selection"};this.setState({ranges:i,quickSelection:o},function(){t.closeModal()})}}},{key:"closeModal",value:function(){var e=this.props.handleSelect(this.state.ranges,this.state.quickSelection),t={startDate:e.startTimestampObj?e.startTimestampObj._d:new Date,endDate:e.endTimestampObj?e.endTimestampObj._d:new Date,key:"selection"};this.setState({ranges:t}),this.props.closeModal()}},{key:"render",value:function(){var e=this;return h.a.createElement(m.p,{isOpen:this.props.isOpen},h.a.createElement(Y.a,{closeFunc:this.props.closeModal},h.a.createElement(Y.a.Header,{title:"Select Date Range"}),h.a.createElement(Y.a.Body,null,h.a.createElement(m.h,{width:1,flexDirection:"column",alignItems:"center"},h.a.createElement(m.g,{label:"Quick Date Selection",style:{display:"flex",width:"100%",alignItems:"stretch",justifyContent:"center"}},h.a.createElement(m.t,{style:{color:"#7d888d",fontSize:"14px",height:"2.5em",boxShadow:"none"},width:"100%",required:!0,onChange:this.handleQuickSelect.bind(this),value:this.state.quickSelection,options:[{value:"",label:"Select an option"},{value:"day",label:"Last day"},{value:"week",label:"Last week"},{value:"weeks",label:"Last 2 weeks"},{value:"month",label:"Last month"}]})),h.a.createElement(V.DateRange,{ranges:[this.state.ranges],minDate:this.props.minDate,maxDate:this.props.maxDate,onChange:this.handleSelect.bind(this)}))),h.a.createElement(Y.a.Footer,null,h.a.createElement(m.h,{px:[2,0],flexDirection:["column","row"],width:1,justifyContent:"center"},h.a.createElement(m.c,{borderRadius:4,my:2,mx:[0,2],size:this.props.isMobile?"small":"medium",onClick:function(t){return e.closeModal(t)}},"APPLY")))))}}]),t}(h.a.Component)),L=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={txStatus:null,processing:{txHash:null,loading:!1}},n.functionsUtil=null,n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"cancelTransaction",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({processing:{txHash:null,loading:!1}});case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"execute",value:function(){var e=this;this.functionsUtil.contractMethodSendWrapper(this.props.contractName,this.props.methodName,this.props.params,function(t,n){var a={eventCategory:"Transaction",eventLabel:e.props.methodName,eventAction:e.props.contractName};n&&(a.eventLabel=e.functionsUtil.getTransactionError(n)),(n||"error"!==a.status)&&e.functionsUtil.sendGoogleAnalyticsEvent(a),"success"===t.status&&"function"===typeof e.props.callback&&e.props.callback(),e.setState({txStatus:t.status,processing:{txHash:null,loading:!1}})},function(t){var n=t.transactionHash;e.setState(function(e){return{txStatus:"processing",processing:Object(U.a)({},e.processing,{txHash:n})}})}),this.setState(function(e){return{txStatus:"loading",processing:Object(U.a)({},e.processing,{loading:!0})}})}},{key:"render",value:function(){var e=this.props.Component;return h.a.createElement(m.h,this.props.parentProps,"success"===this.state.txStatus&&this.props.children?this.props.children:this.state.processing&&this.state.processing.loading?h.a.createElement(D.a,{web3:this.props.web3,hash:this.state.processing.txHash,waitText:"".concat(this.props.action," estimated in"),cancelTransaction:this.cancelTransaction.bind(this),endMessage:"Finalizing ".concat(this.props.action," request...")}):h.a.createElement(e,Object.assign({onClick:this.execute.bind(this)},this.props.componentProps),this.props.componentProps.value))}}]),t}(p.Component),H=n(4771),W=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),u=0;u<a;u++)r[u]=arguments[u];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={aum:null,apr:null,days:"-",delta:null,earning:null,minDate:null,maxDate:null,carouselMax:1,rebalances:"-",buttonGroups:[],apiResults:null,carouselIndex:0,idleVersion:null,statsVersions:{},minStartTime:null,endTimestamp:null,showAdvanced:!0,govTokensPool:null,unlentBalance:null,quickSelection:null,startTimestamp:null,endTimestampObj:null,shouldRebalance:null,carouselOffsetLeft:0,startTimestampObj:null,showRefreshIdleSpeed:!1,apiResults_unfiltered:null,dateRangeModalOpened:!1},n.quickSelections={day:"Last day",week:"Last week",weeks:"Last 2 weeks",month:"Last month"},n.functionsUtil=null,n.componentUnmounted=null,n.setDateRange=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=k()(C.a.stats.tokens[n.props.selectedToken].startTimestamp),o=k()(e.startDate).isSameOrAfter(a)?k()(e.startDate):a,i=k()(e.endDate);o.isSame(i)&&i.add(1,"day"),i=k()(i.format("YYYY-MM-DD 23:59"),"YYYY-MM-DD HH:mm"),o.isBefore(n.state.minStartTime)&&(o=n.state.minStartTime),i.isAfter(n.state.maxEndDate)&&(i=n.state.maxEndDate);var s=parseInt(o._d.getTime()/1e3),r={minStartTime:a,endTimestamp:parseInt(i._d.getTime()/1e3),quickSelection:t,startTimestamp:s,endTimestampObj:i,startTimestampObj:o};return n.setStateSafe(r),r},n.toggleAdvancedCharts=function(e){e.preventDefault(),n.setStateSafe({showAdvanced:!n.state.showAdvanced})},n.setDateRangeModal=function(e){e!==n.state.dateRangeModalOpened&&n.setStateSafe({dateRangeModalOpened:e})},n.filterTokenData=function(e){return e.filter(function(e,t){return(!n.state.startTimestamp||e.timestamp>=n.state.startTimestamp)&&(!n.state.endTimestamp||e.timestamp<=n.state.endTimestamp)})},n.setIdleVersion=function(e){n.setStateSafe({idleVersion:e})},n.loadApiData=Object(i.a)(o.a.mark(function e(){var t,a,i,s,r,l,c,u,p,h,d,m,f,g,b,v,x,y,w,T,S,E,U,j,D,M,O;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.selectedToken&&n.props.tokenConfig){e.next=2;break}return e.abrupt("return",!1);case 2:return t=n.state.minDate?parseInt(n.functionsUtil.strToMoment(n.functionsUtil.strToMoment(n.state.minDate).format("DD/MM/YYYY 00:00:00"),"DD/MM/YYYY HH:mm:ss")._d.getTime()/1e3):null,a=n.state.maxDate?parseInt(n.functionsUtil.strToMoment(n.functionsUtil.strToMoment(n.state.maxDate).format("DD/MM/YYYY 23:59:59"),"DD/MM/YYYY HH:mm:ss")._d.getTime()/1e3):null,i=["v3","v4"].includes(n.state.idleVersion)&&"risk"===n.props.selectedStrategy,e.next=7,n.functionsUtil.getTokenApiData(n.props.tokenConfig.address,i,t,a,!0,7200);case 7:if(s=e.sent,(r=n.filterTokenData(s))&&s&&r.length&&s.length){e.next=11;break}return e.abrupt("return",!1);case 11:return l=r[0],c=Object.values(r).pop(),window.moment=k.a,0===(u=(c.timestamp-l.timestamp)/86400)&&(u=1),p=null,h="N/A",d=n.functionsUtil.fixTokenDecimals(c.idleSupply,18),m=n.functionsUtil.fixTokenDecimals(l.idlePrice,n.props.tokenConfig.decimals),f=n.functionsUtil.fixTokenDecimals(c.idlePrice,n.props.tokenConfig.decimals),g=d.times(f),e.next=24,n.functionsUtil.convertTokenBalance(g,n.props.selectedToken,n.props.tokenConfig,i);case 24:return g=e.sent,b=n.props.tokenConfig.protocols.filter(function(e){return"compound"===e.name})[0],v=b?l.protocolsData.filter(function(e){return e.protocolAddr.toLowerCase()===b.address.toLowerCase()})[0]:null,x=b?c.protocolsData.filter(function(e){return e.protocolAddr.toLowerCase()===b.address.toLowerCase()})[0]:null,"v4"===n.state.idleVersion?(p=(p=r.reduce(function(e,t){var a=n.functionsUtil.fixTokenDecimals(t.idleRate,18);return n.functionsUtil.BNify(e).plus(a)},0)).div(r.length),b&&(y=C.a.stats.protocols.compoundWithCOMP,w=y.rateField?y.rateField:"rate",T=(T=r.reduce(function(e,t){var a=t.protocolsData.find(function(e,t){return e.protocolAddr.toLowerCase()===b.address.toLowerCase()}),o="object"===typeof w&&w.length?w.reduce(function(e,t){return a[t]?n.functionsUtil.BNify(e).plus(n.functionsUtil.BNify(a[t])):n.functionsUtil.BNify(e)},0):n.functionsUtil.BNify(a[w]);return o=n.functionsUtil.fixTokenDecimals(o,18),n.functionsUtil.BNify(e).plus(o)},0)).div(r.length),h=p.minus(T),parseFloat(h)<0&&(h=0),h=h.toFixed(2)),p=p.toFixed(2)):(S=f.div(m).minus(1).times(100),p=S.times(365).div(u).toFixed(2),v&&x&&(E=n.functionsUtil.fixTokenDecimals(v.price,n.props.tokenConfig.decimals),U=n.functionsUtil.fixTokenDecimals(x.price,n.props.tokenConfig.decimals),j=U.div(E).minus(1).times(100),h=S.minus(j).times(365).div(u),parseFloat(h)<0&&(h=0),h=h.toFixed(2))),D=0,r.forEach(function(e,t){if(t){var a=r[t-1],o=e.protocolsData.reduce(function(e,t){var a=n.functionsUtil.fixTokenDecimals(t.allocation,n.props.tokenConfig.decimals);return n.functionsUtil.BNify(e).plus(a)},0),i=a.protocolsData.reduce(function(e,t){var a=n.functionsUtil.fixTokenDecimals(t.allocation,n.props.tokenConfig.decimals);return n.functionsUtil.BNify(e).plus(a)},0),s=!1;e.protocolsData.forEach(function(e){if(!s){var t=a.protocolsData.find(function(t){return t.protocolAddr.toLowerCase()===e.protocolAddr.toLowerCase()}),r=n.functionsUtil.fixTokenDecimals(e.allocation,n.props.tokenConfig.decimals),l=n.functionsUtil.fixTokenDecimals(t.allocation,n.props.tokenConfig.decimals);parseInt(parseFloat(r.div(o).times(100)))!==parseInt(parseFloat(l.div(i).times(100)))&&(D++,s=!0)}})}}),e.next=33,n.functionsUtil.getGovTokenPool(null,null,"DAI");case 33:return(M=e.sent)&&(g=g.plus(M)),g=n.functionsUtil.formatMoney(parseFloat(g)),e.next=38,n.functionsUtil.getUnlentBalance(n.props.tokenConfig);case 38:(O=e.sent)&&(O=n.functionsUtil.formatMoney(parseFloat(O))),n.setStateSafe({aum:g,apr:p,days:u,delta:h,apiResults:r,rebalances:D,govTokensPool:M,unlentBalance:O,apiResults_unfiltered:s});case 41:case"end":return e.stop()}},e,this)})),n.selectToken=function(){var e=Object(i.a)(o.a.mark(function e(t,a){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.setStrategyToken(t,a);case 2:n.props.changeToken(a);case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),n.handleCarousel=function(e){var t=n.state.carouselIndex;"next"===e&&t<n.state.carouselMax?t++:"back"===e&&t>0&&t--;var a=window.jQuery("#carousel-cursor > div:eq(".concat(t,")")),o=-parseFloat(a.position().left)+"px";n.setStateSafe({carouselIndex:t,carouselOffsetLeft:o})},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.loadParams();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.componentUnmounted=!0}},{key:"setStateSafe",value:function(){var e=Object(i.a)(o.a.mark(function e(t){var n,a=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:null,this.componentUnmounted){e.next=3;break}return e.abrupt("return",this.setState(t,n));case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"showRefreshIdleSpeed",value:function(){this.setState({showRefreshIdleSpeed:!0})}},{key:"getLatestAvailableVersion",value:function(){var e=this,t=C.a.stats.versions,n=null;return Object.keys(t).forEach(function(a){t[a].enabledStrategies.includes(e.props.selectedStrategy)&&(n=a)}),n}},{key:"getVersionInfo",value:function(e){if(e||(e=this.state.idleVersion),!C.a.stats.versions[e])return null;var t=Object.assign({},C.a.stats.versions[e]);if(t.strategiesParams&&t.strategiesParams[this.props.selectedStrategy]){var n=t.strategiesParams[this.props.selectedStrategy];Object.keys(n).forEach(function(e){t[e]=n[e]})}return t}},{key:"loadParams",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.selectedToken&&this.props.tokenConfig){e.next=2;break}return e.abrupt("return",!1);case 2:if(t={},n=this.props.match.params,a=Object.keys(this.props.availableTokens),n.customToken&&-1!==a.indexOf(n.customToken.toUpperCase())?t.selectedToken=n.customToken.toUpperCase():t.selectedToken=this.props.selectedToken.toUpperCase(),t.tokenConfig=this.props.availableTokens[t.selectedToken],t.minStartTime=k()(C.a.stats.tokens[this.props.selectedToken].startTimestamp,"YYYY-MM-DD"),t.maxEndDate=k()(),t.endTimestampObj=k()(k()().format("YYYY-MM-DD 23:59"),"YYYY-MM-DD HH:mm"),t.latestVersion=this.getLatestAvailableVersion(),t.idleVersion=null===this.state.idleVersion?t.latestVersion:this.state.idleVersion,i=this.getVersionInfo(t.idleVersion),t.idleVersion&&i.endTimestamp&&(s=k()(k()(1e3*i.endTimestamp).format("YYYY-MM-DD HH:mm"),"YYYY-MM-DD HH:mm"),t.endTimestampObj.isAfter(s)&&(t.endTimestampObj=s,t.endTimestamp=parseInt(t.endTimestampObj._d.getTime()/1e3)),t.maxEndDate&&!t.maxEndDate.isAfter(s)||(t.maxEndDate=s)),t.endTimestamp=parseInt(t.endTimestampObj._d.getTime()/1e3),t.startTimestampObj=t.endTimestampObj.clone().subtract(1,"month"),t.startTimestamp=parseInt(t.startTimestampObj._d.getTime()/1e3),t.idleVersion&&i.startTimestamp&&(r=k()(k()(1e3*i.startTimestamp).format("YYYY-MM-DD HH:mm"),"YYYY-MM-DD HH:mm"),t.startTimestampObj.isBefore(r)&&(t.startTimestampObj=r,t.startTimestamp=parseInt(t.startTimestampObj._d.getTime()/1e3)),t.minStartTime.isBefore(r)&&(t.minStartTime=r)),t.minDate=t.minStartTime._d,t.maxDate=t.maxEndDate._d,t===this.state){e.next=23;break}return e.next=23,this.setStateSafe(t);case 23:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.web3){e.next=3;break}return this.props.initWeb3(),e.abrupt("return",!1);case 3:return(t=document.createElement("style")).id="crisp-custom-style",t.type="text/css",t.innerHTML="\n    .crisp-client{\n      display:none !important;\n    }",document.body.appendChild(t),this.loadUtils(),e.next=11,this.loadParams();case 11:this.loadApiData(),this.loadCarousel();case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadCarousel",value:function(){var e=this.props.isMobile?3:2;this.setStateSafe({carouselMax:e})}},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a,i,s,r,l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.contractsInitialized!==this.props.contractsInitialized,i=t.selectedStrategy!==this.props.selectedStrategy,s=t.selectedToken!==this.props.selectedToken||JSON.stringify(t.tokenConfig)!==JSON.stringify(this.props.tokenConfig),r=n.startTimestamp!==this.state.startTimestamp||n.endTimestamp!==this.state.endTimestamp,l=n.idleVersion!==this.state.idleVersion,t.isMobile!==this.props.isMobile&&this.loadCarousel(),!(a||s||i||l)){e.next=12;break}return e.next=10,this.componentDidMount();case 10:e.next=13;break;case 12:r&&this.loadApiData();case 13:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.functionsUtil.getGlobalConfig(["govTokens","IDLE","enabled"]),n=this.functionsUtil.getGlobalConfig(["messages","apyLong"]);if(!this.props.availableStrategies)return h.a.createElement(d.a,{textProps:{textSize:4,fontWeight:2},loaderProps:{mb:3,size:"40px"},flexProps:{minHeight:"50vh",flexDirection:"column"},text:"Loading assets..."});if(this.props.selectedToken){var a=Object.keys(C.a.stats.versions).filter(function(t){var n=e.getVersionInfo(t);return n.enabledTokens.includes(e.props.selectedToken)&&n.enabledStrategies.includes(e.props.selectedStrategy)}).map(function(t){return{value:t,label:e.getVersionInfo(t).label}}),o=this.getVersionInfo(this.state.idleVersion),i=null;if(this.state.idleVersion&&o)i=this.functionsUtil.getGlobalConfig(["stats","versions",this.state.idleVersion,"showPerformanceTooltip"])?this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken,"performanceTooltip"]):null;var s=a.find(function(t){return t.value===e.state.idleVersion});return h.a.createElement(m.h,{p:0,width:1,flexDirection:"column"},h.a.createElement(m.b,{mb:[3,4]},h.a.createElement(m.h,{flexDirection:["column","row"]},h.a.createElement(m.h,{width:[1,.4]},h.a.createElement(I.a,{showPathMobile:!0,text:"ASSETS OVERVIEW",isMobile:this.props.isMobile,handleClick:function(t){return e.props.goToSection("stats")},path:[this.functionsUtil.getGlobalConfig(["strategies",this.props.selectedStrategy,"title"])]})),h.a.createElement(m.h,{mt:[3,0],width:[1,.6],flexDirection:["column","row"],justifyContent:["center","space-between"]},h.a.createElement(m.h,{width:[1,.26],flexDirection:"column"},h.a.createElement(P.a,{innerProps:{p:1,height:["100%","46px"]},name:"idle-version",options:a,defaultValue:s,onChange:function(t){return e.setIdleVersion(t)}})),h.a.createElement(m.h,{mt:[3,0],width:[1,.3],flexDirection:"column"},h.a.createElement(B.a,Object.assign({innerProps:{p:1}},this.props))),h.a.createElement(m.h,{mt:[3,0],width:[1,.39],flexDirection:"column"},h.a.createElement(S.a,{cardProps:{p:1,display:"flex",alignItems:"center",height:["46px","100%"],justifyContent:"center"},isInteractive:!0,handleClick:function(t){return e.setDateRangeModal(!0)}},h.a.createElement(m.u,{fontWeight:3,color:"copyColor"},this.state.quickSelection?this.quickSelections[this.state.quickSelection]:this.state.startTimestampObj&&this.state.endTimestampObj&&"".concat(this.state.startTimestampObj.format("DD/MM/YY")," - ").concat(this.state.endTimestampObj.format("DD/MM/YY")))))))),this.state.idleVersion&&o.startTimestamp>parseInt((new Date).getTime()/1e3)?h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},h.a.createElement(S.a,{cardProps:{p:3,width:[1,.5]}},h.a.createElement(m.h,{alignItems:"center",flexDirection:"column"},h.a.createElement(m.k,{size:"2.3em",color:"cellText",name:"AccessTime"}),h.a.createElement(m.u,{mt:2,fontSize:2,color:"cellText",textAlign:"center"},"Idle Stats ",this.state.idleVersion," will be available shortly!")))):h.a.createElement(m.b,{width:1},h.a.createElement(m.b,{mt:[3,0],mb:[3,4]},h.a.createElement(m.h,{width:1,alignItems:"center",justifyContent:"center",flexDirection:["column","row"]},h.a.createElement(m.h,{mb:[2,0],pr:[0,2],width:[1,.25],flexDirection:"column"},h.a.createElement(O.a,{value:this.state.aum,title:"Asset Under Management",label:this.state.unlentBalance?"Unlent funds: ".concat(this.state.unlentBalance," ").concat(this.props.selectedToken):this.props.selectedToken,labelTooltip:this.state.unlentBalance?this.functionsUtil.getGlobalConfig(["messages","cheapRedeem"]):null})),h.a.createElement(m.h,{mb:[2,0],pr:[0,2],width:[1,.25],flexDirection:"column"},h.a.createElement(O.a,{title:"Avg APY",label:"Annualized"},h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:["column","row"]},h.a.createElement(F.a,{direction:"up",iconPos:"right",iconSize:"1.8em",justifyContent:"flex-start",width:1},h.a.createElement(m.u,{lineHeight:1,fontWeight:[3,4],color:"statValue",fontSize:[4,5]},this.state.apr,h.a.createElement(m.u.span,{color:"statValue",fontWeight:3,fontSize:["90%","70%"]},"%")))))),h.a.createElement(m.h,{mb:[2,0],pr:[0,2],width:[1,.25],flexDirection:"column"},h.a.createElement(O.a,{title:"Overperformance on Compound",label:"Annualized"},this.state.delta&&!isNaN(this.state.delta)?h.a.createElement(F.a,{direction:"up",iconPos:"right",iconSize:"1.8em",justifyContent:"flex-start"},h.a.createElement(m.u,{lineHeight:1,fontSize:[4,5],fontWeight:[3,4],color:"statValue"},this.state.delta,h.a.createElement(m.u.span,{color:"statValue",fontWeight:3,fontSize:["90%","70%"]},"%"))):h.a.createElement(m.u,{lineHeight:1,fontSize:[4,5],fontWeight:[3,4],color:"statValue"},this.state.delta))),h.a.createElement(m.h,{mb:[2,0],pr:[0,2],width:[1,.25],flexDirection:"column"},h.a.createElement(O.a,{label:" ",title:"Rebalances",value:this.state.rebalances.toString()})))),h.a.createElement(S.a,{title:"Historical Performance",description:i,cardProps:{mb:[3,4]}},h.a.createElement(m.h,{id:"chart-PRICE",width:1,mb:3},h.a.createElement(E,Object.assign({height:350},this.state,{parentId:"chart-PRICE",isMobile:this.props.isMobile,contracts:this.props.contracts,apiResults:this.state.apiResults,idleVersion:this.state.idleVersion,apiResults_unfiltered:this.state.apiResults_unfiltered,chartMode:this.state.idleVersion===this.state.latestVersion?"PRICE_V4":"PRICE"})))),h.a.createElement(S.a,{cardProps:{pb:3,mb:[3,4]}},h.a.createElement(m.h,{flexDirection:["column","row"],justifyContent:"space-between"},this.state.idleVersion===this.state.latestVersion&&h.a.createElement(m.h,{pt:2,width:[1,1/3],id:"allocation-chart",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start"},h.a.createElement(R.a,Object.assign({height:310},this.props,{parentId:"allocation-chart"})),h.a.createElement(M,this.props)),h.a.createElement(m.h,{mb:[0,3],id:"chart-ALL",pl:[0,this.state.idleVersion===this.state.latestVersion?0:3],width:[1,this.state.idleVersion===this.state.latestVersion?2/3:1]},h.a.createElement(m.h,{alignItems:"flex-start",justifyContent:"flex-start",flexDirection:"column",width:1},h.a.createElement(m.j.h4,{mb:2,ml:3,mt:[3,4],fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"Allocations over time"),h.a.createElement(E,Object.assign({height:350},this.state,{chartMode:"ALL",parentId:"chart-ALL",isMobile:this.props.isMobile,contracts:this.props.contracts,apiResults:this.state.apiResults,idleVersion:this.state.idleVersion,apiResults_unfiltered:this.state.apiResults_unfiltered})))))),h.a.createElement(m.h,{position:"relative"},h.a.createElement(m.h,{width:1,id:"carousel-container",justifyContent:"flex-end"},h.a.createElement(z.a,{buttonProps:{mr:3},iconName:"ArrowBack",disabled:0===this.state.carouselIndex,handleClick:function(t){return e.handleCarousel("back")}}),h.a.createElement(z.a,{iconName:"ArrowForward",handleClick:function(t){return e.handleCarousel("next")},disabled:this.state.carouselIndex===this.state.carouselMax})),h.a.createElement(m.h,{mt:5,height:"400px",position:"absolute",id:"carousel-cursor",width:["444%","200%"],justifyContent:"flex-start",left:this.state.carouselOffsetLeft,style:{transition:"left 0.3s ease-in-out"}},h.a.createElement(S.a,{cardProps:{mr:4,height:"fit-content",style:this.props.isMobile?{width:"100%"}:{width:"32vw"}}},h.a.createElement(m.h,{width:1,id:"chart-AUM"},h.a.createElement(m.h,{mb:3,width:1,flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},h.a.createElement(m.j.h4,{ml:3,mt:3,mb:2,fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"Asset Under Management"),h.a.createElement(E,Object.assign({height:300},this.state,{chartMode:"AUM",parentId:"chart-AUM",isMobile:this.props.isMobile,contracts:this.props.contracts,apiResults:this.state.apiResults,idleVersion:this.state.idleVersion,apiResults_unfiltered:this.state.apiResults_unfiltered}))))),h.a.createElement(S.a,{cardProps:{mr:4,height:"fit-content",style:this.props.isMobile?{width:"100%"}:{width:"32vw"}}},h.a.createElement(m.h,{id:"chart-APR",width:1},h.a.createElement(m.h,{mb:3,width:1,flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},h.a.createElement(m.j.h4,{mb:2,ml:3,mt:3,fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"APRs"),h.a.createElement(E,Object.assign({height:300},this.state,{chartMode:"APR",parentId:"chart-APR",isMobile:this.props.isMobile,contracts:this.props.contracts,apiResults:this.state.apiResults,idleVersion:this.state.idleVersion,apiResults_unfiltered:this.state.apiResults_unfiltered}))))),h.a.createElement(S.a,{cardProps:{mr:4,height:"fit-content",style:this.props.isMobile?{width:"100%"}:{width:"32vw"}},title:"Risk Score",description:"Idle Risk Score is a weighted average of the underlying protocols risks assessed by DeFi Score",titleParentProps:{ml:16,mt:16}},h.a.createElement(m.h,{id:"chart-SCORE",width:1},h.a.createElement(m.h,{mb:3,width:1,flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},h.a.createElement(E,Object.assign({height:300},this.state,{chartMode:"SCORE",parentId:"chart-SCORE",isMobile:this.props.isMobile,contracts:this.props.contracts,apiResults:this.state.apiResults,idleVersion:this.state.idleVersion,apiResults_unfiltered:this.state.apiResults_unfiltered}))))),h.a.createElement(S.a,{cardProps:{mr:4,height:"fit-content",style:this.props.isMobile?{width:"100%"}:{width:"32vw"}}},h.a.createElement(m.h,{id:"chart-VOL",width:1},h.a.createElement(m.h,{mb:3,width:1,flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},h.a.createElement(m.j.h4,{mb:2,ml:3,mt:3,fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"Volume"),h.a.createElement(E,Object.assign({height:300},this.state,{chartMode:"VOL",parentId:"chart-VOL",isMobile:this.props.isMobile,contracts:this.props.contracts,apiResults:this.state.apiResults,idleVersion:this.state.idleVersion,apiResults_unfiltered:this.state.apiResults_unfiltered})))))))),h.a.createElement(N,{minDate:this.state.minDate,maxDate:this.state.maxDate,handleSelect:this.setDateRange,isOpen:this.state.dateRangeModalOpened,closeModal:function(t){return e.setDateRangeModal(!1)},startDate:this.state.startTimestampObj?this.state.startTimestampObj._d:null,endDate:this.state.endTimestampObj?this.state.endTimestampObj._d:null}))}var r=this.functionsUtil.getGlobalConfig(["strategies"]),l=[],c=this.functionsUtil.getGlobalConfig(["stats","tokens"]),u=this.functionsUtil.getGlobalConfig(["stats","protocols"]);return Object.keys(c).forEach(function(e){c[e].enabled&&l.push(e)}),h.a.createElement(m.h,{mb:3,width:1,flexDirection:"column"},h.a.createElement(H.a,this.props),Object.keys(r).map(function(t){var a=r[t],o=e.props.availableStrategies[t];return!!o&&h.a.createElement(m.b,{mb:2,width:1,flexDirection:"column",justifyContent:"center",key:"strategy-container-".concat(t)},h.a.createElement(v.a,{mt:3,mb:[3,4]},h.a.createElement(m.h,{flexDirection:"row",alignItems:"baseline",justifyContent:"center"},a.title,a.titlePostfix&&h.a.createElement(m.u,{ml:2,fontWeight:3,fontSize:[2,4],color:"dark-gray"},a.titlePostfix))),h.a.createElement(A.a,Object.assign({enabledTokens:l,handleClick:function(n){return e.selectToken(t,n.token)},cols:[{title:"CURRENCY",props:{width:[.26,.15]},fields:[{name:"icon",props:{mr:2,height:["1.4em","2.3em"]}},{name:"tokenName"}]},{title:"POOL",props:{width:[.22,.14]},fields:[{name:"allocationChart",mobile:!1,parentProps:{width:.3},style:{overflow:"visible"},showLoader:!1},{name:"pool",props:{ml:1},parentProps:{width:[1,.7]}}]},{title:"APY",desc:n,props:{width:[.29,.14]},parentProps:{flexDirection:"column",alignItems:"flex-start"},fields:[{name:"apy",showTooltip:!0},{name:"idleDistribution",showLoader:!1,props:{decimals:e.props.isMobile?1:2,fontSize:e.props.isMobile?"9px":0}}]},{title:"RISK SCORE",desc:e.functionsUtil.getGlobalConfig(["messages","riskScore"]),mobile:!1,props:{width:[.27,.16]},fields:[{name:"score"}]},{title:"APR LAST WEEK",mobile:!1,props:{width:.25},parentProps:{width:1,pr:[2,4]},fields:[{name:"aprChart"}]},{title:"",props:{width:[.23,.16]},parentProps:{width:1},fields:[{name:"button",label:e.props.isMobile?"View":"View stats",props:{width:1,fontSize:3,fontWeight:3,height:"45px",borderRadius:4,boxShadow:null,mainColor:"redeem",size:e.props.isMobile?"small":"medium",handleClick:function(n){return e.selectToken(t,n.token)}}}]}]},e.props,{selectedStrategy:t,availableTokens:o})),!e.props.isMobile&&h.a.createElement(m.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"flex-end"},Object.values(u).filter(function(e){return e.legend}).map(function(e,t){return h.a.createElement(m.h,{mr:3,alignItems:"center",flexDirection:"row",key:"legend_".concat(t)},h.a.createElement(m.b,{mr:1,width:"10px",height:"10px",borderRadius:"50%",backgroundColor:"rgb(".concat(e.color.rgb.join(","),")")}),h.a.createElement(m.u.span,{fontSize:1,color:"cellText"},e.label))})))}),t&&!this.state.showRefreshIdleSpeed?h.a.createElement(m.h,{width:1,my:[2,3],alignItems:"center",flexDirection:"row",justifyContent:"center"},h.a.createElement(m.n,{hoverColor:"primary",onClick:this.showRefreshIdleSpeed.bind(this)},"Refresh Idle Speed")):t&&this.state.showRefreshIdleSpeed&&h.a.createElement(m.h,{p:2,width:1,my:[2,3],borderRadius:1,alignItems:"center",flexDirection:"column",justifyContent:"center",backgroundColor:"#f3f6ff",boxShadow:"0px 0px 0px 1px rgba(0,54,255,0.3)"},h.a.createElement(m.u,{fontWeight:500,color:"#3f4e9a",textAlign:"center",fontSize:[1,"15px"]},"By executing this transaction you can adjust the IDLE distribution speed among the pools."),h.a.createElement(L,Object.assign({action:"Refresh",Component:m.c,parentProps:{mt:1},componentProps:{size:"small",value:"REFRESH IDLE SPEED"},params:[],contractName:"IdleController",methodName:"refreshIdleSpeeds"},this.props),h.a.createElement(m.h,{flexDirection:"row",alignItems:"center",justifyContent:"center"},h.a.createElement(m.k,{mr:1,name:"Done",size:"1.4em",color:this.props.theme.colors.transactions.status.completed}),h.a.createElement(m.u,{fontWeight:500,fontSize:"15px",color:"copyColor",textAlign:"center"},"Idle Speed Refreshed")))))}}]),t}(p.Component),G=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).functionsUtil=null,n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.selectedSubsection&&this.props.selectedSubsection.subComponent?this.props.selectedSubsection.subComponent:null;return h.a.createElement(m.h,{width:1,flexDirection:"column"},this.props.selectedSubsection?h.a.createElement(m.b,{width:1},h.a.createElement(m.h,{width:1},h.a.createElement(I.a,{showPathMobile:!0,isMobile:this.props.isMobile,path:[this.props.selectedSubsection.label],text:this.props.selectedSection.label.toUpperCase(),handleClick:function(t){return e.props.goToSection(e.props.selectedSection.route)}})),h.a.createElement(m.h,{my:[2,3],flexDirection:"column",justifyContent:"center"},h.a.createElement(v.a,{mb:2},this.props.selectedSubsection.label),h.a.createElement(m.u,{textAlign:"center"},this.props.selectedSubsection.desc)),h.a.createElement(t,Object.assign({},this.props,this.props.selectedSubsection.directProps,{toolProps:this.props.selectedSubsection.props}))):h.a.createElement(m.h,{my:[2,3],flexDirection:"column",justifyContent:"center"},h.a.createElement(v.a,{mb:3},"Tools"),h.a.createElement(m.h,{width:1,style:{flexWrap:"wrap"}},this.props.selectedSection.submenu.map(function(t,n){return h.a.createElement(S.a,{isInteractive:!0,key:"tool_".concat(n),cardProps:{p:[3,4],mb:[3,3],mr:[0,"2%"],style:{flex:e.props.isMobile?"1 1 100%":"0 0 31%"},alignItems:"center",flexDirection:"column",justifyContent:"center"},handleClick:function(n){return e.props.goToSection(e.props.selectedSection.route+"/"+t.route)}},h.a.createElement(m.u,{fontSize:[3,4],textAlign:"center"},t.label),h.a.createElement(m.h,{justifyContent:"center"},t.image?h.a.createElement(m.l,{my:[0,2],height:"2.2em",src:t.image}):t.icon&&h.a.createElement(m.k,{my:[0,2],size:"3em",name:t.icon})),h.a.createElement(m.u,{fontSize:[2,2],textAlign:"center"},t.desc))}))))}}]),t}(p.Component),_=n(35),q=n(600),X=n(115),J=n(1372),Z=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={govTokensAprs:null,aggregatedValues:[],govTokensTotalApr:null,govTokensUserBalance:null,govTokensDistribution:null,govTokensTotalBalance:null,govTokensTotalAprTooltip:null,idleTokenUserDistribution:null,govTokensDistributionTooltip:null,govTokensTotalBalanceTooltip:null},n.functionsUtil=null,n.idleGovToken=null,n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props),this.idleGovToken=this.functionsUtil.getIdleGovToken()}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l,c,u,p,d,f,g,b=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t={})[this.props.selectedToken]=this.props.tokenConfig,e.next=4,Promise.all([this.functionsUtil.getGovTokensAprs(this.props.selectedToken,this.props.tokenConfig),this.idleGovToken.getUserDistribution(this.props.account,t,!0),this.functionsUtil.getGovTokensUserBalances(this.props.account,t,null),this.functionsUtil.loadAssetField("avgAPY",this.props.selectedToken,this.props.tokenConfig,this.props.account),this.functionsUtil.loadAssetField("daysFirstDeposit",this.props.selectedToken,this.props.tokenConfig,this.props.account)]);case 4:n=e.sent,a=Object(_.a)(n,5),i=a[0],s=a[1],r=a[2],l=a[3],c=a[4],u=r?Object.values(r).reduce(function(e,t){return e.plus(b.functionsUtil.BNify(t))},this.functionsUtil.BNify(0)):null,p=r?Object.keys(r).map(function(e){var t=r[e];return t.gt(0)?"+".concat(t.toFixed(2)," ").concat(e):null}).filter(function(e){return null!==e}):null,d=i?Object.values(i).reduce(function(e,t){return e.plus(b.functionsUtil.BNify(t))},this.functionsUtil.BNify(0)):null,f=i?Object.keys(i).map(function(e){var t=i[e];return t.gt(0)?"".concat(e,": ").concat(t.toFixed(2),"%"):null}).filter(function(e){return null!==e}):null,g=[{flexProps:{width:[1,.32]},props:{title:"Avg APY",children:h.a.createElement(m.h,{width:1,alignItems:"center",height:["55px","59px"],flexDirection:"column",justifyContent:"center"},h.a.createElement(m.u,{lineHeight:1,fontWeight:[3,4],color:"copyColor",fontFamily:"counter",fontSize:["1.7em","1.7em"],dangerouslySetInnerHTML:{__html:l?l.toFixed(2)+"%":"-"}}))}},{flexProps:{width:[1,.32]},props:{title:"Current Allocation",children:h.a.createElement(m.h,{width:1,id:"allocationChart",height:["55px","59px"],flexDirection:"column"},h.a.createElement(X.a,Object.assign({},this.props,{showLoader:!0,fieldInfo:{name:"allocationChart"},parentId:"allocationChart",token:this.props.selectedToken,tokenConfig:this.props.tokenConfig}))),label:""}},{flexProps:{width:[1,.32]},props:{title:"Days since first deposit",children:h.a.createElement(m.h,{width:1,alignItems:"center",height:["55px","59px"],flexDirection:"column",justifyContent:"center"},h.a.createElement(m.u,{lineHeight:1,fontWeight:[3,4],color:"copyColor",fontFamily:"counter",fontSize:["1.7em","1.7em"],dangerouslySetInnerHTML:{__html:c?parseInt(c):"-"}}))}}],this.setState({govTokensAprs:i,aggregatedValues:g,govTokensTotalApr:d,govTokensUserBalance:r,govTokensTotalBalance:u,govTokensTotalAprTooltip:f,idleTokenUserDistribution:s,govTokensTotalBalanceTooltip:p});case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){return h.a.createElement(m.h,{width:1,flexDirection:"column"},this.state.aggregatedValues.length>0&&h.a.createElement(m.h,{width:1,mb:[0,3],mt:[2,0],alignItems:"center",flexDirection:["column","row"],justifyContent:"space-between"},this.state.aggregatedValues.map(function(e,t){return h.a.createElement(m.h,Object.assign({},e.flexProps,{flexDirection:"column",key:"aggregatedValue_".concat(t)}),h.a.createElement(S.a,{cardProps:{py:[2,3],mb:[3,0]}},h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},e.props.children?e.props.children:h.a.createElement(m.u,{lineHeight:1,fontWeight:[3,4],color:"copyColor",fontFamily:"counter",fontSize:[4,"1.7em"],dangerouslySetInnerHTML:{__html:e.props.value}}),h.a.createElement(m.u,{mt:2,fontWeight:2,fontSize:[1,2],color:"cellText"},e.props.title))))})),h.a.createElement(S.a,{cardProps:{px:2,py:3}},h.a.createElement(m.h,{width:1,ml:[0,3],id:"funds-overview"},h.a.createElement(J.a,Object.assign({},this.props,{chartHeight:350,parentId:"funds-overview",chartToken:this.props.selectedToken,enabledTokens:[this.props.selectedToken],frequencySeconds:this.functionsUtil.getFrequencySeconds("day",1)}))),h.a.createElement(m.h,{width:1,flexDirection:["column","row"]},h.a.createElement(m.h,{mb:[2,0],width:[1,1/6],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},h.a.createElement(v.a,{mb:2,fontSize:[3,4],component:m.j.h3},"Deposited"),h.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"amountLent",props:{decimals:4,maxPrecision:8,fontWeight:300,fontSize:["1.8em","1.9em"],color:x.a.colors.counter,flexProps:{justifyContent:"center"}}}}))),h.a.createElement(m.h,{mb:[2,0],width:[1,1/6],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},h.a.createElement(v.a,{mb:2,fontSize:[3,4],component:m.j.h3},"Redeemable"),h.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"redeemableBalanceCounter",props:{decimals:7,maxPrecision:8,style:{fontWeight:300,color:x.a.colors.counter,fontSize:this.props.isMobile?"1.8em":"1.9em"},flexProps:{justifyContent:"center"}}}})),h.a.createElement(m.h,{width:1,mt:"-9px"},h.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"earningsPerc",props:{fontSize:1,fontWeight:2,color:"cellText",flexProps:{justifyContent:"center"}}}})))),h.a.createElement(m.h,{mb:[2,0],width:[1,1/6],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},h.a.createElement(v.a,{mb:2,fontSize:[3,4],component:m.j.h3},"Earnings"),h.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"earningsCounter",props:{decimals:7,maxPrecision:8,style:{fontWeight:300,fontSize:this.props.isMobile?"1.8em":"1.9em",color:x.a.colors.counter},flexProps:{justifyContent:"center"}}}})),this.state.govTokensTotalBalanceTooltip&&this.state.govTokensTotalBalanceTooltip.length>0&&h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},this.state.govTokensTotalBalanceTooltip.map(function(e,t){return h.a.createElement(m.u,{fontSize:1,lineHeight:1,fontWeight:2,color:"cellText",textAlign:"center",mt:t?1:0,key:"govToken_".concat(t)},e)}))),h.a.createElement(m.h,{mb:[2,0],width:[1,1/6],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},h.a.createElement(v.a,{mb:2,fontSize:[3,4],component:m.j.h3},"Fees"),h.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"feesCounter",props:{decimals:7,maxPrecision:8,style:{fontWeight:300,fontSize:this.props.isMobile?"1.8em":"1.9em",color:x.a.colors.counter},flexProps:{justifyContent:"center"}}}}))),h.a.createElement(m.h,{mb:[2,0],width:[1,1/6],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},h.a.createElement(v.a,{mb:2,fontSize:[3,4],component:m.j.h3},"Current APY"),h.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"apy",props:{decimals:2,fontWeight:300,fontSize:["1.8em","1.9em"],color:x.a.colors.counter,flexProps:{justifyContent:"center"}}}})),this.state.idleTokenUserDistribution&&h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},h.a.createElement(m.u,{mt:1,fontSize:1,lineHeight:1,fontWeight:2,color:"cellText",textAlign:"center"},this.state.idleTokenUserDistribution.toFixed(4)," ",this.idleGovToken.tokenName,"/",this.idleGovToken.tokenConfig.distributionFrequency))),h.a.createElement(m.h,{mb:[2,0],width:[1,1/6],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},h.a.createElement(v.a,{mb:2,fontSize:[3,4],component:m.j.h3},"Risk Score"),h.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"score",props:{decimals:1,fontWeight:300,fontSize:["1.8em","1.9em"],color:x.a.colors.counter,flexProps:{justifyContent:"center"}}}}))))))}}]),t}(p.Component),Q=n(141),K=n(94),$=n(487),ee=n(4791),te=n(118),ne=n(358),ae=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={processing:{txHash:null,loading:!1},inputValue:null,maxSlippage:.2,tokenConfig:null,unevenAmounts:null,selectedToken:null,availableTokens:null,buttonDisabled:!1,showMaxSlippage:!1,redeemUnderlying:!0,curveTokenConfig:null,curvePoolContract:null,curveSwapContract:null,curveTokenBalance:null,curveTokensAmounts:null,fastBalanceSelector:null,redeemUnevenAmounts:!1,curveRedeemableIdleTokens:null},n.functionsUtil=null,n.toggleUnevenAmounts=function(e){n.setState({redeemUnevenAmounts:e})},n.checkButtonDisabled=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e||(e=n.state.inputValue);var t;t=!e||e.gt(n.state.curveTokenBalance),n.setState({buttonDisabled:t})},n.changeInputValue=function(e){var t=e.target.value.length&&!isNaN(e.target.value)?n.functionsUtil.BNify(e.target.value):n.functionsUtil.BNify(0);n.checkButtonDisabled(t);n.setState(function(e){return{inputValue:t,fastBalanceSelector:null}})},n.setFastBalanceSelector=function(e){n.setState({fastBalanceSelector:e})},n.setMaxSlippage=function(e){n.setState({maxSlippage:e})},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.initToken();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"showMaxSlippage",value:function(){this.setState({showMaxSlippage:!0})}},{key:"calculateSlippage",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l,c,u,p,h=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.length>0&&void 0!==h[0]?h[0]:null,(n=this.state.inputValue?this.functionsUtil.BNify(this.state.inputValue):null)&&!n.lte(0)){e.next=4;break}return e.abrupt("return",!1);case 4:if(a=this.functionsUtil.normalizeTokenAmount(n,this.state.curvePoolContract.decimals),i=null,s=null,r=null,!this.state.redeemUnevenAmounts){e.next=20;break}return e.next=11,Promise.all([this.functionsUtil.getCurveTokensAmounts(this.props.account,a,!0),this.functionsUtil.getCurveIdleTokensAmounts(this.props.account,a)]);case 11:return l=e.sent,c=Object(_.a)(l,2),s=c[0],r=c[1],e.next=17,this.functionsUtil.getCurveSlippage(this.state.tokenConfig.idle.token,a,!1,r);case 17:i=e.sent,e.next=29;break;case 20:return e.next=22,this.functionsUtil.getCurveSlippage(this.state.tokenConfig.idle.token,a,!1);case 22:return i=e.sent,e.next=25,this.functionsUtil.getCurveTokenPrice();case 25:u=e.sent,p=n.times(u).minus(n.times(i.times(100).plus(this.state.maxSlippage||this.functionsUtil.BNify(0)).div(100))),(s={})[this.state.selectedToken]=p;case 29:return i&&(i=i.times(100)),this.setState({withdrawSlippage:i,curveTokensAmounts:s,curveIdleTokensAmounts:r}),i&&t&&(i=i.plus(t)),e.abrupt("return",i);case 33:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a,i,s,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadUtils(),!(t.tokenConfig.idle.token!==this.props.tokenConfig.idle.token)){e.next=5;break}return e.next=5,this.initToken();case 5:a=n.redeemUnevenAmounts!==this.state.redeemUnevenAmounts,(this.state.fastBalanceSelector!==n.fastBalanceSelector||a)&&this.setInputValue(),i=n.inputValue!==this.state.inputValue,s=parseFloat(n.maxSlippage)!==parseFloat(this.state.maxSlippage),r=JSON.stringify(n.tokenConfig)!==JSON.stringify(this.state.tokenConfig),(i||r||s)&&this.calculateSlippage(),n.selectedToken!==this.state.selectedToken&&this.loadSelectedTokenConfig();case 14:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"setInputValue",value:function(){if(null===this.state.fastBalanceSelector)return!1;var e,t=this.functionsUtil.BNify(this.state.fastBalanceSelector).div(100);e=this.state.curveTokenBalance?this.functionsUtil.BNify(this.state.curveTokenBalance).times(t):null,this.checkButtonDisabled(e),this.setState({inputValue:e})}},{key:"selectDestinationToken",value:function(e){this.setState({selectedToken:e})}},{key:"loadSelectedTokenConfig",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.functionsUtil.getGlobalConfig(["curve"]),n=this.state.availableTokens[this.state.selectedToken],a=t.availableTokens[n.idle.token],this.setState({tokenConfig:n,curveTokenConfig:a});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"initToken",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l,c,u,p,h,d,m;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.functionsUtil.getCurvePoolContract(),this.functionsUtil.getCurveSwapContract()]);case 2:return t=e.sent,n=Object(_.a)(t,2),a=n[0],i=n[1],e.next=8,Promise.all([this.functionsUtil.getCurveTokenPrice(),this.functionsUtil.getCurveTokenBalance(this.props.account),this.functionsUtil.getCurveRedeemableIdleTokens(this.props.account)]);case 8:s=e.sent,r=Object(_.a)(s,3),l=r[0],c=r[1],u=r[2],p=[],h=c?c.times(l):this.functionsUtil.BNify(0),d=this.functionsUtil.getCurveAvailableTokens(),m=Object.keys(d)[0],this.setState({selectedToken:m,unevenAmounts:p,curveTokenPrice:l,availableTokens:d,curvePoolContract:a,curveSwapContract:i,curveTokenBalance:c,redeemableBalance:h,curveRedeemableIdleTokens:u});case 19:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"redeem",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l,c,u,p,h,d=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.curveTokenBalance){e.next=2;break}return e.abrupt("return",!1);case 2:return t=function(e,t){var n="success"===e.status,a={eventLabel:e.status,eventCategory:"CurveRedeem",eventAction:d.props.selectedToken,eventValue:d.state.curveTokenBalance.toFixed()};t&&(a.eventLabel=d.functionsUtil.getTransactionError(t)),(t||"error"!==a.status)&&d.functionsUtil.sendGoogleAnalyticsEvent(a),d.setState(function(e){return{processing:{txHash:null,loading:!1}}}),"function"===typeof d.props.callbackRedeem&&n&&d.props.callbackRedeem(e)},n=function(e){var t=e.transactionHash;d.setState(function(e){return{processing:Object(U.a)({},e.processing,{txHash:t})}})},a=this.state.curveSwapContract.name,e.next=7,this.calculateSlippage(this.state.maxSlippage);case 7:if(i=e.sent,s=this.functionsUtil.BNify(this.state.maxSlippage).div(100),r=this.state.inputValue?this.functionsUtil.BNify(this.state.inputValue):null,l=this.functionsUtil.normalizeTokenAmount(r,this.state.curvePoolContract.decimals),!this.state.redeemUnevenAmounts){e.next=26;break}if(!this.state.redeemUnderlying){e.next=18;break}return e.next=15,this.functionsUtil.getCurveTokensAmounts(this.props.account,l,!1,!0);case 15:e.t0=e.sent,e.next=21;break;case 18:return e.next=20,this.functionsUtil.getCurveIdleTokensAmounts(this.props.account,l,s);case 20:e.t0=e.sent;case 21:c=e.t0,console.log("remove_liquidity",l.toString(),c),this.props.contractMethodSendWrapper(a,"remove_liquidity",[l,c,this.state.redeemUnderlying],null,t,n),e.next=33;break;case 26:return u=this.state.curveTokenConfig.migrationParams.coinIndex,e.next=29,this.functionsUtil.getCurveTokenPrice();case 29:p=e.sent,h=this.functionsUtil.normalizeTokenAmount(r.times(p).minus(r.times(i.div(100))),this.state.tokenConfig.decimals),console.log("remove_liquidity_one_coin",l,u,h),this.props.contractMethodSendWrapper(a,"remove_liquidity_one_coin",[l,u,h,this.state.redeemUnderlying],null,t,n);case 33:this.setState(function(e){return{processing:Object(U.a)({},e.processing,{loading:!0})}});case 34:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cancelTransaction",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({processing:{txHash:null,loading:!1}});case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getFastBalanceSelector",value:function(){return null!==this.state.fastBalanceSelector&&this.functionsUtil.BNify(this.state.fastBalanceSelector).div(100)}},{key:"render",value:function(){var e=this,t=!this.state.buttonDisabled&&this.state.withdrawSlippage,n=this.functionsUtil.getGlobalConfig(["curve","poolContract","token"]);return h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},h.a.createElement(m.h,{width:[1,.36],alignItems:"stretch",flexDirection:"column",justifyContent:"center"},this.state.curveTokenBalance?this.state.processing.loading?h.a.createElement(S.a,{cardProps:{p:3,mt:3}},h.a.createElement(m.h,{flexDirection:"column"},h.a.createElement(D.a,{web3:this.props.web3,hash:this.state.processing.txHash,endMessage:"Finalizing redeem request...",cancelTransaction:this.cancelTransaction.bind(this),waitText:this.props.waitText?this.props.waitText:"Redeem estimated in"}))):h.a.createElement(m.h,{width:1,flexDirection:"column"},h.a.createElement(S.a,{cardProps:{p:3,mb:2}},h.a.createElement(m.h,{alignItems:"center",flexDirection:"column"},h.a.createElement(m.k,{size:"1.8em",color:"cellText",name:"FileUpload"}),h.a.createElement(m.u,{mt:1,fontSize:2,color:"cellText",textAlign:"center"},"Withdraw from the Curve Pool in a specific token or in uneven amounts of tokens (with no slippage)."),h.a.createElement(m.h,{mt:2,alignItems:"center",flexDirection:"row"},h.a.createElement(m.e,{required:!1,label:"Redeem with no slippage",checked:this.state.redeemUnevenAmounts,onChange:function(t){return e.toggleUnevenAmounts(t.target.checked)}}),h.a.createElement(m.y,{placement:"top",message:"You will receive an uneven amounts of ".concat(Object.keys(this.state.availableTokens).join(", ")," proportional to the token availailability in the Curve pool.")},h.a.createElement(m.k,{size:"1em",color:"cellTitle",name:"InfoOutline"}))))),!this.state.redeemUnevenAmounts&&h.a.createElement(m.b,{mb:2,width:1},this.state.tokenConfig&&h.a.createElement(m.b,{width:1},h.a.createElement(m.u,{mb:1},"Select destination token:"),h.a.createElement(B.a,Object.assign({},this.props,{id:"token-from",showBalance:!1,tokenConfig:this.state.tokenConfig,selectedToken:this.state.selectedToken,availableTokens:this.state.availableTokens,onChange:this.selectDestinationToken.bind(this)})))),this.state.curveTokensAmounts&&!this.state.buttonDisabled&&h.a.createElement(S.a,{cardProps:{mt:1,mb:2,py:2,px:1}},h.a.createElement(m.h,{alignItems:"center",flexDirection:"column"},h.a.createElement(m.u,{mt:1,fontSize:2,color:"cellText",textAlign:"center"},"You will receive:"),h.a.createElement(m.h,{mt:2,width:1,boxShadow:0,style:{flexWrap:"wrap"},alignItems:"center",justifyContent:"center"},Object.keys(this.state.curveTokensAmounts).map(function(t){var n=e.state.curveTokensAmounts[t];return h.a.createElement(m.h,{mb:1,mx:1,width:"auto",flexDirection:"row",key:"tokenBalance_".concat(t),justifyContent:"flex-start"},h.a.createElement(X.a,{token:t,tokenConfig:{token:t},fieldInfo:{name:"icon",props:{mr:1,width:["1.4em","1.6em"],height:["1.4em","1.6em"]}}}),h.a.createElement(te.a,{ml:1,fontSize:[0,1],fontWeight:500,maxPrecision:4,color:"cellText",number:n.toString()}))})))),this.state.showMaxSlippage&&t&&h.a.createElement(m.b,{mb:2,width:1},h.a.createElement(m.h,{alignItems:"center",flexDirection:"row"},h.a.createElement(m.u,null,"Choose max slippage:"),h.a.createElement(m.y,{placement:"top",message:"Max additional slippage on top of the one shown below"},h.a.createElement(m.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))),h.a.createElement(m.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[.2,.5,1,5].map(function(t){return h.a.createElement(ne.a,{cardProps:{p:1},textProps:{fontSize:1},percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setMaxSlippage(t)},isActive:e.state.maxSlippage===parseFloat(t)})}))),h.a.createElement(m.h,{mb:3,width:1,flexDirection:"column"},h.a.createElement(m.h,{mb:1,alignItems:"center",flexDirection:"row",justifyContent:"flex-end"},t&&h.a.createElement(m.h,{width:1,maxWidth:"40%",alignItems:"center",flexDirection:"row"},h.a.createElement(m.u,{fontSize:1,fontWeight:3,textAlign:"right",style:{whiteSpace:"nowrap"},color:parseFloat(this.state.withdrawSlippage.toFixed(3))>0?this.props.theme.colors.transactions.status.failed:this.props.theme.colors.transactions.status.completed},0===parseFloat(this.state.withdrawSlippage.toFixed(3))?"No Slippage":"".concat(this.state.withdrawSlippage.gt(0)?"Slippage: ":"Bonus: "," ").concat(this.state.withdrawSlippage.abs().toFixed(3),"%")),h.a.createElement(m.y,{placement:"top",message:this.state.redeemUnevenAmounts?"You will receive an uneven amounts of ".concat(Object.keys(this.state.availableTokens).join(", ")," proportional to the token availailability in the Curve pool."):this.state.withdrawSlippage.gt(0)?"Slippage comes from depositing too many coins not in balance, and current coin prices are additionally accounted for":"Bonus comes as an advantage from current coin prices which usually appears for coins which are high in balance"},h.a.createElement(m.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"})),!this.state.redeemUnevenAmounts&&h.a.createElement(m.n,{ml:1,color:"copyColor",hoverColor:"primary",onClick:this.showMaxSlippage.bind(this)},"change")),h.a.createElement(m.h,{width:1,maxWidth:"60%",alignItems:"center",flexDirection:"row",justifyContent:"flex-end"},h.a.createElement(m.n,{fontSize:1,fontWeight:3,color:"dark-gray",textAlign:"right",hoverColor:"copyColor",onClick:function(t){return e.setFastBalanceSelector(100)},style:{maxWidth:"100%",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},this.state.curveTokenBalance.toFixed(this.props.isMobile?2:4)," ",n))),h.a.createElement(m.m,{min:0,type:"number",required:!0,height:"3.4em",borderRadius:2,fontWeight:500,boxShadow:"none !important",placeholder:"Insert amount",onChange:this.changeInputValue.bind(this),border:"1px solid ".concat(this.props.theme.colors.divider),value:null!==this.state.inputValue?this.functionsUtil.BNify(this.state.inputValue).toFixed():""}),h.a.createElement(m.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[25,50,75,100].map(function(t){return h.a.createElement(ne.a,{percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setFastBalanceSelector(t)},isActive:e.state.fastBalanceSelector===parseInt(t)})}))),h.a.createElement(m.h,{justifyContent:"center"},h.a.createElement(j.a,{buttonProps:{mt:2,width:[1,.5],disabled:this.state.buttonDisabled},handleClick:this.redeem.bind(this)},"Redeem"))):h.a.createElement(S.a,{cardProps:{p:3,mt:3,minHeight:"195px",style:{display:"flex",alignItems:"center",justifyContent:"center"}}},h.a.createElement(d.a,{flexProps:{flexDirection:"row"},loaderProps:{size:"30px"},textProps:{ml:2},text:"Checking Curve Pool..."}))))}}]),t}(p.Component),oe=n(4850),ie=n.n(oe),se=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).functionsUtil=null,n.share=function(){n.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"Share",eventAction:"twitter",eventLabel:n.props.parent});var e=Math.min(window.innerWidth,600),t=(window.innerWidth-e)/2;window.open("https://twitter.com/intent/tweet?text=".concat(n.props.tweet),"_blank","toolbar=yes,scrollbars=no,resizable=no,top=".concat(150,",left=").concat(t,",width=").concat(e,",height=").concat(350))},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){this.loadUtils()}},{key:"componentDidMount",value:function(){this.loadUtils()}},{key:"componentDidUpdate",value:function(){this.loadUtils()}},{key:"render",value:function(){var e=this;return h.a.createElement(m.c,{borderRadius:1,mainColor:"#2aa6f2",contrastColor:"white",onClick:function(t){e.share()}},h.a.createElement(m.h,{flexDirection:"row",alignItems:"center",justifyContent:"center"},h.a.createElement(m.b,{className:ie.a.twitterIcon}),h.a.createElement(m.u,{color:"white",fontWeight:3,ml:2},this.props.text?this.props.text:"Tweet")))}}]),t}(p.Component),re=n(4852),le=n.n(re),ce=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),u=0;u<a;u++)r[u]=arguments[u];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).functionsUtil=null,n.closeModal=function(){var e=Object(i.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.functionsUtil.getGlobalConfigs().analytics.google.events.enabled){e.next=7;break}return e.next=4,n.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"Share",eventAction:t,eventLabel:"ShareModal"});case 4:n.props.closeModal(),e.next=8;break;case 7:n.props.closeModal();case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){this.loadUtils()}},{key:"componentDidMount",value:function(){this.loadUtils()}},{key:"componentDidUpdate",value:function(){this.loadUtils()}},{key:"render",value:function(){var e=this,t=window.escape(this.props.tweet),n={__html:this.props.text};return h.a.createElement(m.p,{isOpen:this.props.isOpen},h.a.createElement(Y.a,{closeFunc:this.props.closeModal},this.props.confettiEnabled&&h.a.createElement(le.a,{style:{position:"fixed",zIndex:9999},run:!0,recycle:!0,width:window.innerWidth,height:window.innerHeight}),h.a.createElement(Y.a.Header,{title:this.props.title,icon:this.props.icon}),h.a.createElement(Y.a.Body,null,h.a.createElement(m.h,{my:3,width:1,flexDirection:"column",mx:"auto"},h.a.createElement(m.u,{color:"dark-gray",textAlign:"center",fontSize:3,mb:2,dangerouslySetInnerHTML:n})),h.a.createElement(m.h,{mb:3,flexDirection:"column",alignItems:"center",justifyContent:"center"},h.a.createElement(se,{tweet:t,text:"Share now",parent:"ShareModal"}),h.a.createElement(m.n,{mt:2,onClick:function(t){return e.closeModal("continue_without_sharing")},hoverColor:"blue"},"continue without sharing")))))}}]),t}(h.a.Component),ue=n(243),pe=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),u=0;u<a;u++)r[u]=arguments[u];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={txError:{},tokenAPY:"-",inputValue:{},processing:{},curveAPY:null,canRedeem:!1,maxSlippage:.2,canDeposit:!1,action:"deposit",directMint:!1,activeModal:null,showBuyFlow:!1,unlentBalance:null,tokenApproved:!1,skipMigration:!1,showRedeemFlow:!1,contractPaused:!1,buttonDisabled:!1,canRedeemCurve:!1,showMaxSlippage:!1,redeemGovTokens:!1,canDepositCurve:!1,fastBalanceSelector:{},actionProxyContract:{},migrationEnabled:!1,componentMounted:!1,curveTokenBalance:null,redeemCurveEnabled:!1,depositCurveBalance:null,depositCurveEnabled:!0,showAdvancedOptions:!1,depositCurveSlippage:null,metaTransactionsEnabled:!0},n.functionsUtil=null,n.setShowRedeemFlow=function(e){n.setState({showRedeemFlow:e})},n.setShowBuyFlow=function(e){n.setState({showBuyFlow:e})},n.toggleShowAdvancedOptions=function(e){n.setState(function(e){return{showAdvancedOptions:!e.showAdvancedOptions}})},n.toggleSkipMigration=function(e){n.setState({skipMigration:e})},n.toggleRedeemCurve=function(e){n.setState({redeemCurveEnabled:e})},n.toggleDepositCurve=function(e){n.setState({depositCurveEnabled:e})},n.toggleSkipMint=function(e){n.setState({directMint:e})},n.toggleRedeemGovTokens=function(e){n.setState({redeemGovTokens:e})},n.toggleMetaTransactionsEnabled=function(e){n.setState({metaTransactionsEnabled:e})},n.resetModal=function(){n.setState({activeModal:null})},n.setActiveModal=function(e){n.setState({activeModal:e})},n.approveContract=function(){var e=Object(i.a)(o.a.mark(function e(t,a){var i,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.state.depositCurveEnabled?(i=n.functionsUtil.getGlobalConfig(["curve","depositContract"]),n.functionsUtil.enableERC20(n.props.selectedToken,i.address,t,a)):(s=n.state.actionProxyContract[n.state.action])&&n.state.metaTransactionsEnabled&&n.props.biconomy?n.functionsUtil.enableERC20(n.props.selectedToken,s.address,t,a):n.functionsUtil.enableERC20(n.props.selectedToken,n.props.tokenConfig.idle.address,t,a);case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),n.checkTokenApproved=Object(i.a)(o.a.mark(function e(){var t,a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!1,!n.state.depositCurveEnabled){e.next=8;break}return a=n.functionsUtil.getGlobalConfig(["curve","depositContract"]),e.next=5,n.functionsUtil.checkTokenApproved(n.props.selectedToken,a.address,n.props.account);case 5:t=e.sent,e.next=18;break;case 8:if(!((i=n.state.actionProxyContract[n.state.action])&&n.state.metaTransactionsEnabled&&n.props.biconomy)){e.next=15;break}return e.next=12,n.functionsUtil.checkTokenApproved(n.props.selectedToken,i.address,n.props.account);case 12:t=e.sent,e.next=18;break;case 15:return e.next=17,n.functionsUtil.checkTokenApproved(n.props.selectedToken,n.props.tokenConfig.idle.address,n.props.account);case 17:t=e.sent;case 18:return e.abrupt("return",t);case 19:case"end":return e.stop()}},e,this)})),n.approveToken=Object(i.a)(o.a.mark(function e(){var t,a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.checkTokenApproved();case 2:if(!(t=e.sent)){e.next=5;break}return e.abrupt("return",n.setState(function(e){return{tokenApproved:t,processing:Object(U.a)({},e.processing,{approve:{txHash:null,loading:!1}})}}));case 5:a=function(e,t){var a={eventCategory:"Approve",eventAction:n.props.selectedToken,eventLabel:e.status};t&&(a.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==a.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(a),n.setState(function(t){return{tokenApproved:"success"===e.status,processing:Object(U.a)({},t.processing,{approve:{txHash:null,loading:!1}})}})},i=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(U.a)({},e.processing,{approve:Object(U.a)({},e.processing.approve,{txHash:t})})}})},n.approveContract(a,i),n.setState(function(e){return{processing:Object(U.a)({},e.processing,{approve:{txHash:null,loading:!0}})}});case 9:case"end":return e.stop()}},e,this)})),n.loadTokenInfo=Object(i.a)(o.a.mark(function e(){var t,a,i,s,r,l,c,u,p,h,d,m,f,g,b,k,v,x,y;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.state.componentMounted&&n.setState({componentMounted:!1}),t=n.functionsUtil.getGlobalConfig(["curve"]),a=n.functionsUtil.getGlobalConfig(["curve","availableTokens",n.props.tokenConfig.idle.token]),i=t.enabled&&a&&a.enabled,e.next=6,Promise.all([n.checkTokenApproved(),n.functionsUtil.checkContractPaused(),n.functionsUtil.getCurveSwapContract(),n.functionsUtil.getCurveDepositContract(),n.functionsUtil.getUnlentBalance(n.props.tokenConfig),n.functionsUtil.checkMigration(n.props.tokenConfig,n.props.account),i?n.functionsUtil.getCurveTokenBalance(n.props.account):null]);case 6:s=e.sent,r=Object(_.a)(s,7),l=r[0],c=r[1],u=r[2],p=r[3],h=r[4],d=r[5].migrationEnabled,m=r[6],f=n.props.tokenBalance&&n.functionsUtil.BNify(n.props.tokenBalance).gt(0),g=n.props.idleTokenBalance&&n.functionsUtil.BNify(n.props.idleTokenBalance).gt(0),k=b=i&&f,v=i&&m&&m.gt(0),x=v,(y=Object(U.a)({},n.state)).depositCurveEnabled&&!i&&(y.depositCurveEnabled=!1),y.canRedeem=g,y.canDeposit=f,y.unlentBalance=h,y.tokenApproved=l,y.contractPaused=c,y.canRedeemCurve=v,y.canDepositCurve=b,y.migrationEnabled=d,y.curveTokenBalance=m,y.curveSwapContract=u,y.redeemCurveEnabled=x,y.depositCurveEnabled=k,y.curveDepositContract=p,y.txError={redeem:!1,deposit:!1},y.processing={redeem:{txHash:null,loading:!1},deposit:{txHash:null,loading:!1},approve:{txHash:null,loading:!1},boost:{txHash:null,loading:!1}},y.inputValue={boost:null,redeem:null,deposit:null},y.fastBalanceSelector={boost:null,redeem:null,deposit:null},y.componentMounted=!0,n.setState(y,function(){n.checkAction(),n.loadAPY()});case 42:case"end":return e.stop()}},e,this)})),n.cancelTransaction=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.setState(function(e){return{processing:Object(U.a)({},e.processing,Object(K.a)({approve:{txHash:null,loading:!1}},n.state.action,{txHash:null,loading:!1}))}});case 1:case"end":return e.stop()}},e,this)})),n.executeAction=Object(i.a)(o.a.mark(function e(){var t,a,i,s,r,l,c,u,p,h,d,m,f,g,b,k,v,x,y,w,C,T,S,E,j,D,M,O,A,I,B,P,z,F;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=null,a=n.state.redeemGovTokens,i=n.state.inputValue[n.state.action],s=n.getFastBalanceSelector(),r=!0,e.t0=n.state.action,e.next="deposit"===e.t0?8:"redeem"===e.t0?68:98;break;case 8:if(!n.state.buttonDisabled&&i&&!n.functionsUtil.BNify(i).lte(0)){e.next=10;break}return e.abrupt("return",!1);case 10:if(n.state.tokenApproved){e.next=12;break}return e.abrupt("return",n.approveToken());case 12:if(localStorage&&n.functionsUtil.setLocalStorage("redirectToFundsAfterLogged",0),n.setState({lendingProcessing:n.props.account,lendAmount:"",genericError:""}),l=function(e,t){!e&&t&&(e={status:"error"});var a="error"===e.status,o="success"===e.status,s={eventCategory:"Deposit",eventAction:n.props.selectedToken,eventLabel:e.status,eventValue:parseInt(i)};t&&(s.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==s.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(s),n.setState(function(e){return{processing:Object(U.a)({},e.processing,Object(K.a)({},n.state.action,{txHash:null,loading:!1}))}}),o?n.setState(function(e){return{activeModal:"share",inputValue:Object(U.a)({},e.inputValue,Object(K.a)({},n.state.action,n.functionsUtil.BNify(0)))}}):n.state.metaTransactionsEnabled&&a&&n.setState({txError:Object(K.a)({},n.state.action,!0)})},c=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(U.a)({},e.processing,Object(K.a)({},n.state.action,Object(U.a)({},e.processing[n.state.action],{txHash:t})))}})},u=n.functionsUtil.getGlobalConfig(["curve"]),!(u.enabled&&n.functionsUtil.getGlobalConfig(["curve","availableTokens",n.props.tokenConfig.idle.token,"enabled"]))||!n.state.depositCurveEnabled){e.next=34;break}return p=n.functionsUtil.getGlobalConfig(["curve","poolContract"]),h=n.functionsUtil.normalizeTokenAmount(i,p.decimals),e.next=23,n.functionsUtil.getCurveAmounts(n.props.tokenConfig.idle.token,h);case 23:return d=e.sent,e.next=26,n.functionsUtil.getCurveTokenAmount(d);case 26:return m=e.sent,n.state.maxSlippage&&(m=(m=n.functionsUtil.BNify(m)).minus(m.times(n.functionsUtil.BNify(n.state.maxSlippage).div(100))),m=n.functionsUtil.integerValue(m)),f=[d,m],e.next=31,n.functionsUtil.contractMethodSendWrapper(n.state.curveDepositContract.name,"add_liquidity",f,l,c);case 31:t=e.sent,e.next=67;break;case 34:if(g=n.functionsUtil.normalizeTokenAmount(i,n.props.tokenConfig.decimals),b=n.functionsUtil.getGlobalConfig(["contract","methods","deposit","metaTransactionsEnabled"]),k=[],v=n.state.actionProxyContract[n.state.action],!(b&&v&&n.props.biconomy&&n.state.metaTransactionsEnabled)){e.next=53;break}if(x=n.state.actionProxyContract[n.state.action].contract,k=[g,n.props.tokenConfig.idle.address],!n.state.metaTransactionsEnabled){e.next=48;break}return w=(y=x.methods)[v.function].apply(y,Object(Q.a)(k)).encodeABI(),e.next=45,n.functionsUtil.sendBiconomyTxWithPersonalSign(v.name,w,l,c);case 45:t=e.sent,e.next=51;break;case 48:return e.next=50,n.functionsUtil.contractMethodSendWrapper(v.name,v.function,k,l,c);case 50:t=e.sent;case 51:e.next=67;break;case 53:if(C=!n.state.directMint&&n.functionsUtil.getGlobalConfig(["contract","methods","deposit","skipMint"]),!(C="undefined"!==typeof n.props.tokenConfig.skipMintForDeposit?n.props.tokenConfig.skipMintForDeposit:C)){e.next=63;break}return e.next=58,Promise.all([n.functionsUtil.genericContractCall("idleDAIYield","maxUnlentPerc"),n.functionsUtil.loadAssetField("pool",n.props.selectedToken,n.props.tokenConfig,n.props.account)]);case 58:T=e.sent,S=Object(_.a)(T,2),E=S[0],j=S[1],E&&j&&(D=i.div(j).times(100),E=n.functionsUtil.BNify(E).div(1e3),D.gte(E.times(2))&&(C=!1));case 63:return k=[g,C,"0x0000000000000000000000000000000000000000"],e.next=66,n.functionsUtil.contractMethodSendWrapper(n.props.tokenConfig.idle.token,"mintIdleToken",k,l,c);case 66:t=e.sent;case 67:return e.abrupt("break",100);case 68:if(!a){e.next=76;break}return M=function(e,t){var a="success"===e.status,o={eventCategory:"Redeem_gov",eventAction:n.props.selectedToken,eventLabel:e.status,eventValue:0};t&&(o.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==o.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(o),n.setState(function(e){return{processing:Object(U.a)({},e.processing,Object(K.a)({},n.state.action,{txHash:null,loading:!1}))}}),a&&n.setState(function(e){return{inputValue:Object(U.a)({},e.inputValue,Object(K.a)({},n.state.action,n.functionsUtil.BNify(0)))}})},O=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(U.a)({},e.processing,Object(K.a)({},n.state.action,Object(U.a)({},e.processing[n.state.action],{txHash:t})))}})},e.next=73,n.functionsUtil.contractMethodSendWrapper(n.props.tokenConfig.idle.token,"redeemIdleToken",[0],M,O);case 73:t=e.sent,e.next=97;break;case 76:if(!n.state.buttonDisabled&&i&&!n.functionsUtil.BNify(i).lte(0)){e.next=78;break}return e.abrupt("return",!1);case 78:if(A={value:n.functionsUtil.BNify(i)},I=null,!s){e.next=84;break}I=n.functionsUtil.BNify(n.props.idleTokenBalance).times(s),e.next=88;break;case 84:return e.next=86,n.functionsUtil.genericContractCall(n.props.tokenConfig.idle.token,"tokenPrice");case 86:B=e.sent,I=n.functionsUtil.BNify(n.functionsUtil.normalizeTokenAmount(i,n.props.tokenConfig.decimals)).div(B);case 88:if(I=n.functionsUtil.normalizeTokenAmount(I,18)){e.next=91;break}return e.abrupt("return",!1);case 91:return P=function(e,t){var a="success"===e.status,o={eventCategory:"Redeem_partial",eventAction:n.props.selectedToken,eventLabel:e.status,eventValue:parseInt(i)};t&&(o.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==o.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(o),n.setState(function(e){return{processing:Object(U.a)({},e.processing,Object(K.a)({},n.state.action,{txHash:null,loading:!1}))}}),a&&n.setState(function(e){return{inputValue:Object(U.a)({},e.inputValue,Object(K.a)({},n.state.action,n.functionsUtil.BNify(0)))}})},z=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(U.a)({},e.processing,Object(K.a)({},n.state.action,Object(U.a)({},e.processing[n.state.action],{txHash:t})))}})},F=[I],e.next=96,n.functionsUtil.contractMethodSendWrapper(n.props.tokenConfig.idle.token,"redeemIdleToken",F,P,z,A);case 96:t=e.sent;case 97:return e.abrupt("break",100);case 98:return r=!1,e.abrupt("break",100);case 100:!1!==t&&n.setState(function(e){return{processing:Object(U.a)({},e.processing,Object(K.a)({},n.state.action,Object(U.a)({},e.processing[n.state.action],{loading:r})))}});case 101:case"end":return e.stop()}},e,this)})),n.setMaxSlippage=function(e){n.setState({maxSlippage:e})},n.showMaxSlippage=function(){n.setState({showMaxSlippage:!0})},n.checkAction=function(){var e=n.state.action;switch(e){case"redeem":n.state.canRedeem||(e="deposit")}e!==n.state.action?n.setState({action:e},function(){n.checkButtonDisabled()}):n.checkButtonDisabled()},n.checkButtonDisabled=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!n.state.action)return!1;e||(e=n.state.inputValue[n.state.action]);var t=!1;switch(n.state.action){case"deposit":t=t||e&&e.gt(n.props.tokenBalance);break;case"redeem":t=!n.state.canRedeemCurve&&!n.state.redeemGovTokens&&(t||e&&e.gt(n.props.redeemableBalance))}n.setState({buttonDisabled:t})},n.setInputValue=function(){if(!n.state.action||null===n.state.fastBalanceSelector[n.state.action])return!1;var e=n.functionsUtil.BNify(n.state.fastBalanceSelector[n.state.action]).div(100),t=null;switch(n.state.action){case"deposit":t=n.props.tokenBalance?n.functionsUtil.BNify(n.props.tokenBalance).times(e):null;break;case"redeem":t=n.props.redeemableBalance?n.functionsUtil.BNify(n.props.redeemableBalance).times(e):null}n.checkButtonDisabled(t),n.setState(function(e){return{inputValue:Object(U.a)({},e.inputValue,Object(K.a)({},n.state.action,t))}})},n.getFastBalanceSelector=function(){return null!==n.state.fastBalanceSelector[n.state.action]&&n.functionsUtil.BNify(n.state.fastBalanceSelector[n.state.action]).div(100)},n.setFastBalanceSelector=function(e){if(!n.state.action)return!1;n.setState(function(t){return{fastBalanceSelector:Object(U.a)({},t.fastBalanceSelector,Object(K.a)({},n.state.action,e))}})},n.changeInputValue=function(e){if(!n.state.action)return!1;var t=e.target.value.length&&!isNaN(e.target.value)?n.functionsUtil.BNify(e.target.value):n.functionsUtil.BNify(0);n.checkButtonDisabled(t),n.setState(function(e){return{fastBalanceSelector:Object(U.a)({},e.fastBalanceSelector,Object(K.a)({},n.state.action,null)),inputValue:Object(U.a)({},e.inputValue,Object(K.a)({},n.state.action,t))}})},n.setAction=function(e){switch(e.toLowerCase()){case"deposit":break;case"redeem":n.state.canRedeem||n.state.canRedeemCurve||(e=null);break;default:e=null}null!==e&&n.setState({action:e})},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.loadProxyContracts();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadProxyContracts",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=["deposit","redeem"],n={actionProxyContract:{}},e.next=4,this.functionsUtil.asyncForEach(t,function(){var e=Object(i.a)(o.a.mark(function e(t){var i,s,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=a.functionsUtil.getGlobalConfig(["contract","methods",t,"proxyContract"]),s=i&&i.enabled,n.actionProxyContract[t]=s?i:null,!s){e.next=11;break}return e.next=6,a.props.initContract(i.name,i.address,i.abi);case 6:return r=e.sent,n.actionProxyContract[t].contract=r.contract,e.next=10,a.functionsUtil.checkTokenApproved(a.props.selectedToken,i.address,a.props.account);case 10:n.actionProxyContract[t].approved=e.sent;case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 4:this.setState(n);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadAPY",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.functionsUtil.getTokenAprs(this.props.tokenConfig);case 2:if(!(t=e.sent)||null===t.avgApy){e.next=12;break}if(n=this.functionsUtil.BNify(t.avgApy).toFixed(2),a=null,!this.state.canDepositCurve){e.next=11;break}return e.next=9,this.functionsUtil.getCurveAPY();case 9:(a=e.sent)&&(a=a.plus(n));case 11:this.setState({tokenAPY:n,curveAPY:a});case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a,i,s,r,l,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadUtils(),null!==this.props.tokenBalance){e.next=3;break}return e.abrupt("return",!1);case 3:if(a=t.selectedToken!==this.props.selectedToken,i=t.tokenBalance!==this.props.tokenBalance&&null!==this.props.tokenBalance,!a&&!i){e.next=10;break}return e.next=8,this.loadProxyContracts();case 8:return this.loadTokenInfo(),e.abrupt("return",!1);case 10:if(s=this.state.action!==n.action,r=this.state.fastBalanceSelector[this.state.action]!==n.fastBalanceSelector[this.state.action],(s||r)&&this.setInputValue(),(n.redeemGovTokens!==this.state.redeemGovTokens||s)&&this.checkButtonDisabled(),l=n.depositCurveEnabled!==this.state.depositCurveEnabled,!(n.metaTransactionsEnabled!==this.state.metaTransactionsEnabled)&&!l){e.next=22;break}return e.next=20,this.checkTokenApproved();case 20:c=e.sent,this.setState({tokenApproved:c});case 22:n.inputValue[this.state.action]!==this.state.inputValue[this.state.action]&&this.calculateCurveSlippage();case 24:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"calculateCurveSlippage",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.state.inputValue[this.state.action]?this.functionsUtil.BNify(this.state.inputValue[this.state.action]):null)&&!t.lte(0)){e.next=3;break}return e.abrupt("return",!1);case 3:n=this.functionsUtil.getGlobalConfig(["curve","poolContract"]),a=this.functionsUtil.normalizeTokenAmount(t,n.decimals),i={},e.t0=this.state.action,e.next="deposit"===e.t0?9:"redeem"===e.t0?14:15;break;case 9:return i.depositCurveBalance=t,e.next=12,this.functionsUtil.getCurveSlippage(this.props.tokenConfig.idle.token,a,!0);case 12:return i.depositCurveSlippage=e.sent,e.abrupt("break",16);case 14:case 15:return e.abrupt("break",16);case 16:this.setState(i);case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;if(!this.props.selectedToken||!this.props.tokenConfig)return null;var t=this.props.tokenConfig.govTokensDisabled,n=this.functionsUtil.getGlobalConfig(["strategies",this.props.selectedStrategy,"govTokensEnabled"]),a="undefined"===typeof this.props.tokenConfig.skipMintForDeposit||this.props.tokenConfig.skipMintForDeposit,o=this.functionsUtil.getGlobalConfig(["contract","methods","deposit","skipMintCheckboxEnabled"])&&a,i=this.functionsUtil.getGlobalConfig(["contract","methods","redeemGovTokens","enabled"])&&!t&&n,s=i&&this.state.redeemGovTokens&&"redeem"===this.state.action,r=this.props.biconomy&&this.state.actionProxyContract[this.state.action],l=r&&this.state.metaTransactionsEnabled,c="deposit"===this.state.action?this.props.tokenBalance:this.props.redeemableBalance,u=this.state.migrationEnabled&&void 0!==this.props.tokenConfig.migration.message?this.props.tokenConfig.migration.message:null,p=this.functionsUtil.getGlobalConfig(["curve"]),f=p.enabled&&this.functionsUtil.getGlobalConfig(["curve","availableTokens",this.props.tokenConfig.idle.token,"enabled"]),g=f&&this.state.depositCurveEnabled&&"deposit"===this.state.action,b="deposit"===this.state.action&&!this.state.contractPaused&&(f||this.state.tokenApproved),k="deposit"===this.state.action&&this.state.canDeposit||"redeem"===this.state.action&&this.state.canRedeem||s,v=b&&f&&this.state.componentMounted&&(!this.state.migrationEnabled||this.state.skipMigration)&&this.state.canDepositCurve&&"deposit"===this.state.action,y=f&&this.state.componentMounted&&(!this.state.migrationEnabled||this.state.skipMigration)&&this.state.canRedeemCurve&&"redeem"===this.state.action,w=!s&&k,C=this.state.componentMounted&&(!v||this.state.showBuyFlow)&&!this.state.depositCurveEnabled&&this.state.tokenApproved&&!this.state.contractPaused&&(!this.state.migrationEnabled||this.state.skipMigration)&&"deposit"===this.state.action&&!this.state.canDeposit,T=this.state.canRedeem&&(!this.state.redeemCurveEnabled||this.state.showRedeemFlow),E=g&&this.state.depositCurveSlippage&&this.state.depositCurveBalance&&!this.state.buttonDisabled,U=b&&this.state.canDeposit&&o&&"deposit"===this.state.action,M=v||U,O=this.functionsUtil.getGlobalConfig(["tools","batchDeposit"]),A=O.enabled&&"undefined"!==typeof O.props.availableTokens[this.props.tokenConfig.idle.token],I=O.depositEnabled,P=A&&I&&!this.props.isMigrationTool&&"deposit"===this.state.action;return h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},h.a.createElement(m.h,{width:[1,.36],alignItems:"stretch",flexDirection:"column",justifyContent:"center"},h.a.createElement(m.b,{width:1},h.a.createElement(m.u,{mb:1},"Select your asset:"),h.a.createElement(B.a,this.props)),h.a.createElement($.a,Object.assign({},this.props,{migrateTextBefore:u,migrateText:null!==u?"":null,toggleSkipMigration:this.toggleSkipMigration.bind(this)}),this.props.account?this.state.componentMounted?this.state.action?h.a.createElement(m.b,{width:1},h.a.createElement(m.h,{mt:2,flexDirection:"column"},h.a.createElement(m.u,{mb:2},"Choose the action:"),h.a.createElement(m.h,{alignItems:"center",flexDirection:"row",justifyContent:"space-between"},h.a.createElement(S.a,{cardProps:{p:3,width:.48,onMouseDown:function(){e.setAction("deposit")}},isInteractive:!0,isActive:"deposit"===this.state.action},h.a.createElement(m.h,{my:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},h.a.createElement(ue.a,{transaction:{action:"deposit"},fieldInfo:{name:"icon",props:{mr:3}}}),h.a.createElement(m.u,{fontSize:3,fontWeight:3},"Deposit"))),h.a.createElement(S.a,{cardProps:{p:3,width:.48,onMouseDown:function(){e.setAction("redeem")}},isInteractive:!0,isActive:"redeem"===this.state.action,isDisabled:!this.state.canRedeem&&!this.state.canRedeemCurve},h.a.createElement(m.h,{my:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},h.a.createElement(ue.a,{transaction:{action:"redeem"},fieldInfo:{name:"icon",props:{mr:3}}}),h.a.createElement(m.u,{fontSize:3,fontWeight:3},"Redeem"))))),M?h.a.createElement(S.a,{cardProps:{pt:2,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",pb:this.state.showAdvancedOptions?3:2}},h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},h.a.createElement(m.n,{ml:1,mainColor:"primary",hoverColor:"primary",onClick:this.toggleShowAdvancedOptions},this.state.showAdvancedOptions?"Hide":"Show"," advanced options"),h.a.createElement(m.k,{size:"1.8em",color:"cellText",name:this.state.showAdvancedOptions?"ArrowDropUp":"ArrowDropDown"})),this.state.showAdvancedOptions&&h.a.createElement(m.h,{mt:1,flexDirection:"column"},v&&h.a.createElement(m.h,{alignItems:"center",justifyContent:"row"},h.a.createElement(m.e,{required:!1,disabled:this.state.directMint,label:"Deposit in the Curve Pool",checked:this.state.depositCurveEnabled,onChange:function(t){return e.toggleDepositCurve(t.target.checked)}}),h.a.createElement(m.n,{mainColor:"primary",hoverColor:"primary",onClick:function(t){return e.props.openTooltipModal("How Curve works",e.functionsUtil.getGlobalConfig(["messages","curveInstructions"]))}},"(read more)")),U&&h.a.createElement(m.h,{alignItems:"center",justifyContent:"row"},h.a.createElement(m.e,{required:!1,label:"Rebalance the pool",checked:this.state.directMint,disabled:this.state.depositCurveEnabled,onChange:function(t){return e.toggleSkipMint(t.target.checked)}}),h.a.createElement(m.y,{placement:"bottom",message:this.functionsUtil.getGlobalConfig(["messages","directMint"])},h.a.createElement(m.k,{size:"1em",color:"cellTitle",name:"InfoOutline"}))))):h.a.createElement(m.h,{width:1,flexDirection:"column"},v&&h.a.createElement(m.h,{width:1,flexDirection:"column",justifyContent:"center"},h.a.createElement(S.a,{isRainbow:!0,cardProps:{py:3,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},h.a.createElement(m.l,{height:"1.8em",src:p.params.image}),h.a.createElement(m.u,{mt:2,px:2,fontSize:1,color:"dark-gray",textAlign:"center"},"Deposit your tokens in the Curve Pool and boost your APY up to ",this.state.curveAPY?this.state.curveAPY.toFixed(2):"-","%.",h.a.createElement(m.n,{ml:1,mainColor:"primary",hoverColor:"primary",onClick:function(t){return e.props.openTooltipModal("How Curve works",e.functionsUtil.getGlobalConfig(["messages","curveInstructions"]))}},"Read More")),h.a.createElement(m.e,{mt:2,required:!1,label:"Deposit in Curve",checked:this.state.depositCurveEnabled,onChange:function(t){return e.toggleDepositCurve(t.target.checked)}}))),!this.state.showBuyFlow&&!this.state.depositCurveEnabled&&!this.state.canDeposit&&h.a.createElement(m.n,{textAlign:"center",hoverColor:"primary",onClick:function(t){return e.setShowBuyFlow(!0)}},"I just want to deposit more ",this.props.selectedToken)),U&&h.a.createElement(S.a,{cardProps:{py:3,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},h.a.createElement(m.k,{size:"1.8em",color:"cellText",name:"InfoOutline"}),h.a.createElement(m.u,{mt:1,px:2,fontSize:1,color:"cellText",textAlign:"center"},"By checking this flag you can rebalance the pool and help all users gain an additional APR")),h.a.createElement(m.e,{mt:2,required:!1,label:"Rebalance the pool",checked:this.state.directMint,onChange:function(t){return e.toggleSkipMint(t.target.checked)}}))),r&&!C&&!this.state.contractPaused&&h.a.createElement(S.a,{cardProps:{py:3,px:2,my:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},this.state.metaTransactionsEnabled&&this.state.txError[this.state.action]&&this.state.actionProxyContract[this.state.action].approved?h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},h.a.createElement(m.k,{size:"1.8em",name:"Warning",color:"cellText"}),h.a.createElement(m.u,{mt:1,fontSize:1,color:"cellText",textAlign:"center"},"Seems like you are having some trouble with Meta-Transactions... Disable them by unchecking the box below and try again!")):"WalletConnect"===this.functionsUtil.getWalletProvider()&&this.state.metaTransactionsEnabled?h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},h.a.createElement(m.k,{size:"1.8em",name:"Warning",color:"cellText"}),h.a.createElement(m.u,{mt:1,fontSize:1,color:"cellText",textAlign:"center"},"Please disable Meta-Transactions if you are using Argent Wallet to avoid failed transactions!")):h.a.createElement(m.u,{mt:1,fontSize:1,color:"cellText",textAlign:"center"},"Meta-Transactions are ",this.state.metaTransactionsEnabled?"available":"disabled"," for ",this.state.action,"s!",h.a.createElement("br",null),this.state.metaTransactionsEnabled&&!this.state.actionProxyContract[this.state.action].approved&&"Please either enable the Smart-Contract to enjoy gas-less ".concat(this.state.action," or just disable meta-tx.")),h.a.createElement(m.e,{mt:2,required:!1,checked:this.state.metaTransactionsEnabled,onChange:function(t){return e.toggleMetaTransactionsEnabled(t.target.checked)},label:"".concat(this.functionsUtil.capitalize(this.state.action)," with Meta-Transaction")})),P&&h.a.createElement(m.h,{p:2,mt:3,width:1,borderRadius:2,alignItems:"center",flexDirection:"row",justifyContent:"center",backgroundColor:"white",border:"1px solid ".concat(this.props.theme.colors.primary)},h.a.createElement(m.n,{textAlign:"center",hoverColor:"primary",href:"/#/dashboard/tools/".concat(O.route,"/").concat(this.props.tokenConfig.idle.token)},"Gas fees too high? Save gas with our Batch Deposit!"),h.a.createElement(m.k,{ml:1,size:"1em",color:"primary",name:"LocalGasStation"})),y&&this.state.canRedeem&&h.a.createElement(m.h,{width:1,flexDirection:"column",justifyContent:"center"},h.a.createElement(S.a,{isRainbow:!0,cardProps:{py:3,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},h.a.createElement(m.l,{height:"1.8em",src:p.params.image}),h.a.createElement(m.u,{mt:2,px:2,fontSize:1,color:"dark-gray",textAlign:"center"},"Redeem your tokens from the Curve Pool.",h.a.createElement(m.n,{ml:1,mainColor:"primary",hoverColor:"primary",onClick:function(t){return e.props.openTooltipModal("How Curve works",e.functionsUtil.getGlobalConfig(["messages","curveInstructions"]))}},"Read More")),this.state.canRedeem&&h.a.createElement(m.e,{mt:2,required:!1,label:"Redeem from Curve",checked:this.state.redeemCurveEnabled,onChange:function(t){return e.toggleRedeemCurve(t.target.checked)}}))),this.canRedeem&&h.a.createElement(m.n,{textAlign:"center",hoverColor:"primary",onClick:function(t){return e.setShowRedeemFlow(!0)}},"I just want to redeem my ",this.props.selectedToken)),"redeem"===this.state.action&&this.state.unlentBalance&&T&&h.a.createElement(S.a,{cardProps:{py:2,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},h.a.createElement(m.k,{size:"1.8em",color:"cellText",name:"LocalGasStation"}),h.a.createElement(m.u,{px:2,fontSize:1,color:"cellText",textAlign:"center"},"Available balance for Cheap Redeem"),h.a.createElement(m.h,{alignItems:"center",flexDirection:"row"},h.a.createElement(m.u,{fontSize:1,fontWeight:3,color:"dark-gray",textAlign:"center",hoverColor:"copyColor"},this.state.unlentBalance.toFixed(4)," ",this.props.selectedToken),h.a.createElement(m.y,{placement:"top",message:this.functionsUtil.getGlobalConfig(["messages","cheapRedeem"])},h.a.createElement(m.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))))),"redeem"===this.state.action&&i&&T&&h.a.createElement(S.a,{cardProps:{py:3,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},h.a.createElement(m.k,{size:"1.8em",color:"cellText",name:"InfoOutline"}),h.a.createElement(m.u,{mt:1,px:2,fontSize:1,color:"cellText",textAlign:"center"},"By redeeming your ",this.props.selectedToken," you will automatically get also the proportional amount of governance tokens accrued",this.props.govTokensBalance&&this.props.govTokensBalance.gt(0)?" (~ $".concat(this.props.govTokensBalance.toFixed(2),")"):null,".")),h.a.createElement(m.e,{mt:2,required:!1,checked:this.state.redeemGovTokens,label:"Redeem governance tokens only",onChange:function(t){return e.toggleRedeemGovTokens(t.target.checked)}})),this.state.contractPaused&&"deposit"===this.state.action?h.a.createElement(S.a,{cardProps:{p:3,mt:3}},h.a.createElement(m.h,{alignItems:"center",flexDirection:"column"},h.a.createElement(m.k,{size:"1.8em",name:"Warning",color:"cellText"}),h.a.createElement(m.u,{mt:1,fontSize:2,color:"cellText",textAlign:"center"},"Deposits for ",this.props.selectedToken," are temporarily unavailable due to Smart-Contract maintenance. Redeems are always available."))):this.state.tokenApproved||"deposit"!==this.state.action?!C&&k&&(this.state.processing[this.state.action].loading?h.a.createElement(m.h,{mt:4,flexDirection:"column"},h.a.createElement(D.a,{web3:this.props.web3,cancelTransaction:this.cancelTransaction.bind(this),hash:this.state.processing[this.state.action].txHash,endMessage:"Finalizing ".concat(this.state.action," request..."),waitText:"".concat(this.functionsUtil.capitalize(this.state.action)," estimated in")})):h.a.createElement(m.h,{mt:2,flexDirection:"column"},w&&h.a.createElement(m.h,{mb:3,width:1,flexDirection:"column"},(c||this.props.tokenFeesPercentage)&&h.a.createElement(m.b,{mb:1,width:1},this.state.showMaxSlippage&&E&&h.a.createElement(m.b,{mb:2,width:1},h.a.createElement(m.h,{alignItems:"center",flexDirection:"row"},h.a.createElement(m.u,null,"Choose max slippage:"),h.a.createElement(m.y,{placement:"top",message:"Max additional slippage on top of the one shown below"},h.a.createElement(m.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))),h.a.createElement(m.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[.2,.5,1,5].map(function(t){return h.a.createElement(ne.a,{cardProps:{p:1},textProps:{fontSize:1},percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setMaxSlippage(t)},isActive:e.state.maxSlippage===parseFloat(t)})}))),h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},E?h.a.createElement(m.h,{width:1,maxWidth:"50%",alignItems:"center",flexDirection:"row"},h.a.createElement(m.u,{fontSize:1,fontWeight:3,textAlign:"right",style:{whiteSpace:"nowrap"},color:this.state.depositCurveSlippage.gt(0)?this.props.theme.colors.transactions.status.failed:this.props.theme.colors.transactions.status.completed},0===parseFloat(this.state.depositCurveSlippage.times(100).toFixed(2))?"No Slippage":"".concat(this.state.depositCurveSlippage.gt(0)?"Slippage: ":"Bonus: "," ").concat(this.state.depositCurveSlippage.times(100).abs().toFixed(2),"%")),h.a.createElement(m.y,{placement:"top",message:this.functionsUtil.getGlobalConfig(["messages","curveBonusSlippage"])},h.a.createElement(m.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"})),h.a.createElement(m.n,{ml:1,color:"copyColor",hoverColor:"primary",onClick:this.showMaxSlippage},"change")):this.props.tokenFeesPercentage&&h.a.createElement(m.h,{alignItems:"center",flexDirection:"row"},h.a.createElement(m.u,{fontSize:1,fontWeight:3,color:"dark-gray",textAlign:"right",hoverColor:"copyColor"},"Performance fee: ",this.props.tokenFeesPercentage.times(100).toFixed(2),"%"),h.a.createElement(m.y,{placement:"top",message:this.functionsUtil.getGlobalConfig(["messages","performanceFee"])},h.a.createElement(m.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))),c&&h.a.createElement(m.n,{fontSize:1,fontWeight:3,color:"dark-gray",textAlign:"right",hoverColor:"copyColor",onClick:function(t){return e.setFastBalanceSelector(100)}},c.toFixed(6)," ",this.props.selectedToken))),h.a.createElement(m.m,{min:0,type:"number",required:!0,height:"3.4em",borderRadius:2,fontWeight:500,boxShadow:"none !important",placeholder:"Insert amount",onChange:this.changeInputValue.bind(this),border:"1px solid ".concat(x.a.colors.divider),value:null!==this.state.inputValue[this.state.action]?this.functionsUtil.BNify(this.state.inputValue[this.state.action]).toFixed():""}),h.a.createElement(m.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[25,50,75,100].map(function(t){return h.a.createElement(ne.a,{percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setFastBalanceSelector(t)},isActive:e.state.fastBalanceSelector[e.state.action]===parseInt(t)})}))),k&&h.a.createElement(m.h,{justifyContent:"center",mt:s?2:0},h.a.createElement(j.a,{buttonProps:{width:"auto",minWidth:[1,.5],style:{textTransform:"capitalize"},disabled:this.state.buttonDisabled},handleClick:this.state.buttonDisabled?null:this.executeAction.bind(this)},this.state.action,s?" Gov Tokens":"")))):h.a.createElement(S.a,{cardProps:{p:3,mt:3}},this.state.processing.approve&&this.state.processing.approve.loading?h.a.createElement(m.h,{flexDirection:"column"},h.a.createElement(D.a,{web3:this.props.web3,waitText:"Approve estimated in",endMessage:"Finalizing approve request...",hash:this.state.processing.approve.txHash,cancelTransaction:this.cancelTransaction.bind(this)})):h.a.createElement(m.h,{alignItems:"center",flexDirection:"column"},h.a.createElement(m.k,{size:"1.8em",name:"LockOpen",color:"cellText"}),h.a.createElement(m.u,{mt:3,fontSize:2,color:"cellText",textAlign:"center"},this.state.depositCurveEnabled?"To ".concat(this.functionsUtil.capitalize(this.state.action)," your ").concat(this.props.selectedToken," in the Curve Pool you need to approve the Smart-Contract first."):l?"To ".concat(this.functionsUtil.capitalize(this.state.action)," your ").concat(this.props.selectedToken," into Idle using Meta-Transaction you need to approve our Smart-Contract first."):"To ".concat(this.functionsUtil.capitalize(this.state.action)," your ").concat(this.props.selectedToken," into Idle you need to approve our Smart-Contract first.")),h.a.createElement(j.a,{buttonProps:{mt:3,width:[1,.5]},handleClick:this.approveToken.bind(this)},"Approve")))):null:h.a.createElement(m.h,{mt:4,flexDirection:"column"},h.a.createElement(d.a,{flexProps:{flexDirection:"row"},loaderProps:{size:"30px"},textProps:{ml:2},text:"Loading asset info..."})):h.a.createElement(ee.a,this.props))),y&&this.state.redeemCurveEnabled&&h.a.createElement(m.b,{mt:3,width:1},h.a.createElement(ae,this.props)),C&&h.a.createElement(m.h,{mt:3,width:[1,.5],alignItems:"stretch",flexDirection:"column",justifyContent:"center"},h.a.createElement(q.a,Object.assign({},this.props,{showInline:!0,availableMethods:[],buyToken:this.props.selectedToken}))),h.a.createElement(ce,{confettiEnabled:!0,icon:"images/medal.svg",title:"Congratulations!",account:this.props.account,closeModal:this.resetModal,tokenName:this.props.selectedToken,isOpen:"share"===this.state.activeModal,text:"You have successfully deposited in Idle!<br />Enjoy <strong>".concat(this.state.tokenAPY,"% APY</strong> on your <strong>").concat(this.props.selectedToken,"</strong>!"),tweet:"I'm earning ".concat(this.state.tokenAPY,"% APY on my ").concat(this.props.selectedToken," with @idlefinance! Go to ").concat(this.functionsUtil.getGlobalConfig(["baseURL"])," and start earning now from your idle tokens!")}))}}]),t}(p.Component),he=n(4770),de=n(1126),me=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={tokenApy:null,chartData:null,chartProps:null,inputValue:1e3,maxInputValue:999999999999999},n.functionsUtil=null,n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadChart();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),t.selectedToken!==this.props.selectedToken&&this.loadChart();case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getTokenApy",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.state.tokenApy,e.t0){e.next=5;break}return e.next=4,this.functionsUtil.getTokenApy(this.props.tokenConfig);case 4:e.t0=e.sent;case 5:return t=e.t0,this.state.tokenApy!==t&&this.setState({tokenApy:t}),e.abrupt("return",t);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadChart",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l,c,u,p,h,d,m,f,g=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTokenApy();case 2:for(t=e.sent,n=this.functionsUtil.BNify(this.state.inputValue),a=n.times(t.div(100)),i=parseFloat(a.div(12)),s=parseFloat(a.div(4)),r=parseFloat(a.div(2)),l=parseFloat(a.div(1)),c=[{perc:1/12,label:"MONTH",value:i,month:i,color:this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken,"color","rgb"]).join(","),monthColor:"hsl("+this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken,"color","hsl"]).join(",")+")"},{perc:.25,label:"3 MONTHS",value:s,month3:s,color:this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken,"color","rgb"]).join(","),month3Color:"hsl("+this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken,"color","hsl"]).join(",")+")"},{perc:.5,label:"6 MONTHS",value:r,month6:r,color:this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken,"color","rgb"]).join(","),month6Color:"hsl("+this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken,"color","hsl"]).join(",")+")"},{perc:1,label:"YEAR",year:l,value:l,color:this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken,"color","rgb"]).join(","),yearColor:"hsl("+this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken,"color","hsl"]).join(",")+")"}],u=this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken,"chart","labelTextColorModifiers"]),4,p=l/4,h=[0],d=1;d<=4;d++)m=d*p,h.push(m);f={padding:.2,animate:!1,indexBy:"label",labelSkipWidth:16,labelSkipHeight:16,keys:["month","month3","month6","year"],colors:function(e){var t=e.id;return e.data["".concat(t,"Color")]},label:function(e){return g.functionsUtil.abbreviateNumber(e.value,2,4)+" "+g.props.selectedToken},labelTextColor:u?{from:"color",modifiers:[u]}:null,isInteractive:!1,minValue:0,gridYValues:h,axisLeft:{format:function(e){return g.functionsUtil.abbreviateNumber(e,1,3)},tickValues:h,orient:"left",tickSize:0,tickPadding:5,tickRotation:0,legend:"",legendPosition:"middle"},axisBottom:{legend:"",tickSize:0,tickPadding:15,orient:"bottom"},theme:{labels:{text:{fontSize:15,fontWeight:600,fill:x.a.colors.counter,fontFamily:x.a.fonts.sansSerif}},axis:{ticks:{text:{fontSize:14,fontWeight:600,fill:x.a.colors.legend,fontFamily:x.a.fonts.sansSerif}}},grid:{line:{stroke:"#dbdbdb",strokeDasharray:"9 5"}}},margin:this.props.isMobile?{top:0,right:0,bottom:30,left:0}:{top:10,right:0,bottom:50,left:65}},this.setState({chartData:c,chartProps:f});case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"changeInputValue",value:function(e){var t=e.target.value.length&&!isNaN(e.target.value)?Math.min(this.state.maxInputValue,parseFloat(e.target.value)):0;t=this.functionsUtil.BNify(t),this.setState({inputValue:t})}},{key:"render",value:function(){var e=this;if(!this.props.selectedToken||!this.props.tokenConfig)return null;var t=this.functionsUtil.getGlobalConfig(["govTokens","IDLE","enabled"])&&this.functionsUtil.getGlobalConfig(["govTokens","IDLE","showAPR"]);return h.a.createElement(S.a,{cardProps:{p:[3,4]}},h.a.createElement(m.h,{width:1,flexDirection:["column","row"]},h.a.createElement(m.h,{width:[1,.3],flexDirection:"column",justifyContent:"flex-start"},h.a.createElement(m.h,{alignItems:"center",flexDirection:"column",justifyContent:"center"},h.a.createElement(X.a,{token:this.props.selectedToken,fieldInfo:{name:"icon",props:{mb:2,height:"2.5em"}}}),h.a.createElement(m.u,{fontSize:2,color:"cellText",textAlign:"center"},"Set the amount and see your estimated earnings on time based on the current APY: ",this.state.tokenApy?"".concat(this.state.tokenApy.toFixed(2),"%"):null,t&&h.a.createElement(m.h,{style:{display:"inline-flex",verticalAlign:"middle"}},h.a.createElement(m.y,{placement:"top",message:this.functionsUtil.getGlobalConfig(["messages","apyLong"])},h.a.createElement(m.k,{ml:1,name:"Info",size:"1em",color:"cellTitle"}))))),h.a.createElement(m.h,{mt:3,flexDirection:"column"},h.a.createElement(m.m,{min:0,max:this.state.maxInputValue,type:"number",required:!0,height:["3em","3.4em"],borderRadius:2,fontWeight:500,textAlign:"center",boxShadow:"none !important",onChange:this.changeInputValue.bind(this),border:"1px solid ".concat(x.a.colors.divider),placeholder:"Insert ".concat(this.props.selectedToken.toUpperCase()," amount"),value:this.state.inputValue&&!isNaN(this.state.inputValue)?this.state.inputValue:""})),h.a.createElement(m.h,{mt:3,justifyContent:"center"},h.a.createElement(j.a,{buttonProps:{width:[1,.5]},handleClick:this.loadChart.bind(this)},"CALCULATE"))),h.a.createElement(m.h,{mt:[3,0],width:[1,.7],id:"estimated-earnings-chart"},this.props.isMobile?h.a.createElement(m.h,{width:1,flexDirection:"column"},null!==this.state.chartData&&this.state.chartData.map(function(t,n){return h.a.createElement(m.h,{py:2,my:2,width:1,flexDirection:"row",key:"earnings_".concat(n)},h.a.createElement(m.h,{width:.35,alignItems:"center",justifyContent:"flex-start"},h.a.createElement(m.u,{fontSize:1,fontWeight:3,color:"legend"},t.label)),h.a.createElement(m.h,{width:.65,position:"relative",alignItems:"center",minHeight:["20px","35px"],justifyContent:"center"},h.a.createElement(m.h,{zIndex:1,position:"relative",alignItems:"center",flexDirection:"column",justifyContent:"center"},h.a.createElement(m.u,{fontSize:1,fontWeight:3,color:"counter"},e.functionsUtil.abbreviateNumber(t.value,2,4)," ",e.props.selectedToken)),h.a.createElement(m.h,{right:0,width:t.perc,position:"absolute",height:["20px","35px"],borderRadius:["20px 0 0 20px","35px 0 0 35px"],style:{background:"linear-gradient(-90deg, rgba(".concat(t.color,",0) 0%, rgba(").concat(t.color,",1) 100%)")}})))})):h.a.createElement(T.a,Object.assign({type:y.a,height:250,showLoader:!0},this.state.chartProps,{data:this.state.chartData,parentId:"estimated-earnings-chart"})))))}}]),t}(p.Component),fe=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={tokenFees:{},tokenBalance:{},tokenApproved:{},activeModal:null,govTokensBalance:{},idleTokenBalance:{},redeemableBalance:{},govTokensDisabled:{},availableGovTokens:{},tokenFeesPercentage:{},componentMounted:!1},n.functionsUtil=null,n.resetModal=function(){n.setState({activeModal:null})},n.setActiveModal=function(e){n.setState({activeModal:e})},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"loadTokensInfo",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.account){e.next=7;break}return t=Object(U.a)({},this.state),e.next=4,this.functionsUtil.asyncForEach(Object.keys(this.props.availableTokens),function(){var e=Object(i.a)(o.a.mark(function e(a){var i,s,r,l,c,u,p,h,d,m,f;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.props.availableTokens[a],(s={})[a]=i,e.next=5,Promise.all([n.functionsUtil.getTokenFees(i),n.functionsUtil.getTokenBalance(a,n.props.account),n.functionsUtil.getUserTokenFees(i,n.props.account),n.functionsUtil.genericContractCall(i.idle.token,"tokenPrice"),n.functionsUtil.getTokenBalance(i.idle.token,n.props.account),n.functionsUtil.checkTokenApproved(a,i.idle.address,n.props.account),n.functionsUtil.getGovTokensUserTotalBalance(n.props.account,s,"DAI")]);case 5:r=e.sent,l=Object(_.a)(r,7),c=l[0],u=l[1],p=l[2],h=l[3],d=l[4],m=l[5],f=l[6],t.tokenFees[a]=p,t.tokenBalance[a]=u,t.tokenApproved[a]=m,t.idleTokenBalance[a]=d,t.govTokensBalance[a]=f,t.tokenFeesPercentage[a]=c,t.govTokensDisabled[a]=i.govTokensDisabled,t.redeemableBalance[a]=d?n.functionsUtil.fixTokenDecimals(d.times(h),i.decimals):n.functionsUtil.BNify(0);case 22:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 4:t.availableGovTokens=this.functionsUtil.getTokenGovTokens(this.props.tokenConfig),t.componentMounted=!0,this.setState(t);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.loadTokensInfo();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),a=t.transactions&&this.props.transactions&&Object.values(t.transactions).filter(function(e){return"success"===e.status}).length!==Object.values(this.props.transactions).filter(function(e){return"success"===e.status}).length,(t.account!==this.props.account||a)&&this.loadTokensInfo();case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.account&&this.state.idleTokenBalance[this.props.selectedToken]&&this.functionsUtil.BNify(this.state.idleTokenBalance[this.props.selectedToken]).gt(0);return h.a.createElement(m.b,{width:1},h.a.createElement(m.h,{width:1,mb:[3,4],alignItems:"center",flexDirection:"row",justifyContent:"flex-start"},h.a.createElement(m.h,{width:.5},h.a.createElement(I.a,{isMobile:this.props.isMobile,path:[this.props.selectedToken],handleClick:function(t){return e.props.goToSection(e.props.selectedStrategy)},text:this.functionsUtil.getGlobalConfig(["strategies",this.props.selectedStrategy,"title"])})),h.a.createElement(m.h,{width:.5,justifyContent:"flex-end"},h.a.createElement(he.a,Object.assign({icon:"Add"},this.props,{text:"Add funds",handleClick:function(t){return e.setActiveModal("buy")}})))),h.a.createElement(v.a,{mb:[3,4]},"Deposit / Redeem"),h.a.createElement(m.h,{width:1},h.a.createElement(pe,Object.assign({},this.props,{tokenFees:this.state.tokenFees[this.props.selectedToken],tokenBalance:this.state.tokenBalance[this.props.selectedToken],tokenApproved:this.state.tokenApproved[this.props.selectedToken],govTokensBalance:this.state.govTokensBalance[this.props.selectedToken],idleTokenBalance:this.state.idleTokenBalance[this.props.selectedToken],redeemableBalance:this.state.redeemableBalance[this.props.selectedToken],tokenFeesPercentage:this.state.tokenFeesPercentage[this.props.selectedToken]}))),t&&h.a.createElement(m.h,{mb:[0,4],width:1,flexDirection:"column",id:"funds-overview-container"},h.a.createElement(v.a,{my:[3,4]},"Funds Overview"),h.a.createElement(Z,Object.assign({},this.props,{tokenFees:this.state.tokenFees[this.props.selectedToken]}))),t&&this.props.account&&!this.state.govTokensDisabled[this.props.selectedToken]&&Object.keys(this.state.availableGovTokens).length>0&&h.a.createElement(m.h,{width:1,id:"yield-farming",flexDirection:"column"},h.a.createElement(v.a,{my:[3,4]},"Yield Farming"),h.a.createElement(A.a,Object.assign({enabledTokens:Object.keys(this.state.availableGovTokens),cols:[{title:"TOKEN",props:{width:[.3,.15]},fields:[{name:"icon",props:{mr:2,height:["1.4em","2.3em"]}},{name:"tokenName"}]},{mobile:!1,title:"BALANCE",props:{width:[.33,.25]},fields:[{name:"tokenBalance",props:{decimals:this.props.isMobile?6:8}}]},{title:"REDEEMABLE",desc:this.functionsUtil.getGlobalConfig(["messages","govTokenRedeemableBalance"]),props:{width:[.35,.3],justifyContent:["center","flex-start"]},fields:[{name:"redeemableBalance",props:{decimals:this.props.isMobile?6:8}}]},{title:"DISTRIBUTION",desc:this.functionsUtil.getGlobalConfig(["messages","userDistributionSpeed"]),props:{width:[.35,.3]},fields:[{name:"userDistributionSpeed",props:{decimals:6}}]}]},this.props,{availableTokens:this.state.availableGovTokens}))),this.props.account&&h.a.createElement(m.h,{mb:[3,4],width:1,flexDirection:"column",id:"estimated-earnings-container"},h.a.createElement(v.a,{my:[3,4]},"Estimated earnings"),h.a.createElement(me,this.props)),this.props.account&&h.a.createElement(m.h,{mb:[3,4],width:1,flexDirection:"column",id:"transactions-container"},h.a.createElement(v.a,{my:[3,4]},"Transactions"),h.a.createElement(de.a,Object.assign({},this.props,{enabledTokens:[this.props.selectedToken],cols:[{title:this.props.isMobile?"":"HASH",props:{width:[.15,.24]},fields:[{name:"icon",props:{mr:[0,2]}},{name:"hash",mobile:!1}]},{title:"ACTION",mobile:!1,props:{width:.15},fields:[{name:"action"}]},{title:"DATE",props:{width:[.32,.23]},fields:[{name:"date"}]},{title:"STATUS",props:{width:[.18,.22],justifyContent:["center","flex-start"]},fields:[{name:"statusIcon",props:{mr:[0,2]}},{mobile:!1,name:"status"}]},{title:"AMOUNT",props:{width:.19},fields:[{name:"amount"}]},{title:"ASSET",props:{width:[.15,.2],justifyContent:["center","flex-start"]},fields:[{name:"tokenIcon",props:{mr:[0,2],height:["1.4em","1.6em"]}},{mobile:!1,name:"tokenName"}]}]}))),h.a.createElement(q.a,Object.assign({},this.props,{closeModal:this.resetModal,buyToken:this.props.selectedToken,isOpen:"buy"===this.state.activeModal})))}}]),t}(p.Component),ge=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),u=0;u<a;u++)r[u]=arguments[u];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={processing:{txHash:null,loading:!1},inputValue:null,maxSlippage:.2,depositSlippage:null,redeemableBalance:null,migrationContract:null,curveTokensBalance:null,migrationSucceeded:!1,fastBalanceSelector:null,migrationContractApproved:!1},n.functionsUtil=null,n.changeInputValue=function(e){var t=e.target.value.length&&!isNaN(e.target.value)?n.functionsUtil.BNify(e.target.value):n.functionsUtil.BNify(0);n.checkButtonDisabled(t);n.setState(function(e){return{inputValue:t,fastBalanceSelector:null}})},n.setInputValue=function(){if(null===n.state.fastBalanceSelector)return!1;var e=n.functionsUtil.BNify(n.state.fastBalanceSelector).div(100),t=n.props.idleTokenBalance?n.functionsUtil.BNify(n.props.idleTokenBalance).times(e):null;n.checkButtonDisabled(t),n.setState({inputValue:t})},n.getFastBalanceSelector=function(){return null!==n.state.fastBalanceSelector&&n.functionsUtil.BNify(n.state.fastBalanceSelector).div(100)},n.setFastBalanceSelector=function(e){n.setState({fastBalanceSelector:e})},n.checkButtonDisabled=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e||(e=n.state.inputValue);var t=!e||e.gt(n.state.idleTokenBalance);n.setState({buttonDisabled:t})},n.approve=Object(i.a)(o.a.mark(function e(){var t,a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=n.state.migrationContract)){e.next=6;break}return e.next=4,n.checkMigrationContractApproved();case 4:e.sent?n.setState({migrationContractApproved:!0}):(a=function(e,t){var a={eventAction:"approve",eventCategory:"CurveDeposit",eventLabel:e?e.status:null},o=e&&"success"===e.status;t&&(a.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==a.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(a),n.setState(function(e){return{migrationContractApproved:o,processing:Object(U.a)({},e.processing,{txHash:null,loading:!1})}}),"function"===typeof n.props.callbackApprove&&o&&n.props.callbackApprove(e),n.checkMigration()},i=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(U.a)({},e.processing,{txHash:t})}})},n.functionsUtil.enableERC20(n.props.selectedToken,t.address,a,i),n.setState(function(e){return{processing:Object(U.a)({},e.processing,{txHash:null,loading:!0}),migrationContractApproved:!1}}));case 6:case"end":return e.stop()}},e,this)})),n.deposit=Object(i.a)(o.a.mark(function e(){var t,a,i,s,r,l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.inputValue?n.functionsUtil.BNify(n.state.inputValue):null){e.next=3;break}return e.abrupt("return",!1);case 3:return a=function(e,a){var o="success"===e.status,i={eventLabel:e.status,eventCategory:"CurveDeposit",eventAction:n.props.selectedToken,eventValue:t.toFixed()};a&&(i.eventLabel=n.functionsUtil.getTransactionError(a)),(a||"error"!==i.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(i),n.setState(function(e){return{processing:{txHash:null,loading:!1}}}),"function"===typeof n.props.callbackDeposit&&o&&n.props.callbackDeposit(e)},i=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(U.a)({},e.processing,{txHash:t})}})},s=n.state.migrationContract.name,r=n.functionsUtil.normalizeTokenAmount(t,n.props.tokenConfig.decimals),e.next=9,n.getMigrationParams(r);case 9:l=e.sent,n.props.contractMethodSendWrapper(s,"add_liquidity",l,null,a,i),n.setState(function(e){return{processing:Object(U.a)({},e.processing,{loading:!0})}});case 12:case"end":return e.stop()}},e,this)})),n.cancelTransaction=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.setState({processing:{txHash:null,loading:!1}});case 1:case"end":return e.stop()}},e,this)})),n.setMaxSlippage=function(e){n.setState({maxSlippage:e})},n.approveCallback=function(){n.initToken()},n.migrationCallback=function(){n.setState({migrationSucceeded:!0})},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initToken();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadUtils(),a=t.account!==this.props.account,i=t.idleTokenBalance!==this.props.idleTokenBalance,!a&&!i){e.next=6;break}return e.next=6,this.initToken();case 6:this.state.fastBalanceSelector!==n.fastBalanceSelector&&this.setInputValue(),this.state.inputValue!==n.inputValue&&this.calculateSlippage();case 10:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getMigrationParams",value:function(){var e=Object(i.a)(o.a.mark(function e(t){var n,a,i,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],a=this.functionsUtil.getGlobalConfig(["curve","availableTokens",this.props.selectedToken])){e.next=4;break}return e.abrupt("return",!1);case 4:if(!a.migrationParams.n_coins){e.next=15;break}return e.next=8,this.functionsUtil.getCurveAmounts(this.props.selectedToken,t,!0);case 8:return i=e.sent,e.next=11,this.functionsUtil.getCurveTokenAmount(i);case 11:s=e.sent,this.state.maxSlippage&&(s=(s=this.functionsUtil.BNify(s)).minus(s.times(this.functionsUtil.BNify(this.state.maxSlippage).div(100))),s=this.functionsUtil.integerValue(s)),n.push(i),n.push(s);case 15:return e.abrupt("return",n);case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"calculateSlippage",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.state.inputValue?this.functionsUtil.BNify(this.state.inputValue):null)){e.next=17;break}if(!(n=t)){e.next=10;break}return e.next=6,this.functionsUtil.getIdleTokenPrice(this.props.tokenConfig);case 6:(a=e.sent)&&(n=n.times(a)),e.next=11;break;case 10:n=this.functionsUtil.BNify(0);case 11:return i=this.functionsUtil.normalizeTokenAmount(n,this.props.tokenConfig.decimals),e.next=14,this.functionsUtil.getCurveSlippage(this.props.tokenConfig.idle.token,i);case 14:(s=e.sent)&&(s=s.times(100)),this.setState({depositSlippage:s});case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkMigrationContractApproved",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.state.migrationContract,e.t0){e.next=5;break}return e.next=4,this.functionsUtil.getCurveSwapContract();case 4:e.t0=e.sent;case 5:if(!(t=e.t0)){e.next=10;break}return e.next=9,this.functionsUtil.checkTokenApproved(this.props.tokenConfig.idle.token,t.address,this.props.account);case 9:return e.abrupt("return",e.sent);case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"initToken",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.functionsUtil.getCurveSwapContract();case 2:return t=e.sent,e.next=5,this.checkMigrationContractApproved();case 5:n=e.sent,this.setState({migrationContract:t,migrationContractApproved:n});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;if(!this.props.selectedToken)return null;var t=this.state.curveTokensBalance&&this.state.curveTokensBalance.gt(0);return h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},h.a.createElement(m.h,{width:[1,.36],alignItems:"stretch",flexDirection:"column",justifyContent:"center"},this.props.idleTokenBalance&&this.props.idleTokenBalance.gt(0)&&h.a.createElement(m.b,{width:1},h.a.createElement(S.a,{cardProps:{p:3,px:[2,4]}},h.a.createElement(m.h,{alignItems:"center",flexDirection:"column"},h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"row"},h.a.createElement(m.k,{size:"1.5em",name:this.state.migrationContractApproved?"CheckBox":"LooksOne",color:this.state.migrationContractApproved?this.props.theme.colors.transactions.status.completed:"cellText"}),h.a.createElement(m.u,{ml:2,fontSize:2,color:"cellText",textAlign:"left"},"Approve the Curve contract")),h.a.createElement(m.h,{mt:2,width:1,alignItems:"center",flexDirection:"row"},h.a.createElement(m.k,{size:"1.5em",name:t?"CheckBox":"LooksTwo",color:t?this.props.theme.colors.transactions.status.completed:"cellText"}),h.a.createElement(m.u,{ml:2,fontSize:2,color:"cellText",textAlign:"left"},"Deposit your ",this.props.tokenConfig.idle.token)))),this.state.migrationContractApproved?this.state.processing.loading?h.a.createElement(m.h,{mt:3,flexDirection:"column"},h.a.createElement(D.a,{web3:this.props.web3,waitText:"Deposit estimated in",hash:this.state.processing.txHash,endMessage:"Finalizing deposit request...",cancelTransaction:this.cancelTransaction.bind(this)})):h.a.createElement(m.b,{mt:2,width:1},h.a.createElement(m.h,{alignItems:"center",flexDirection:"row"},h.a.createElement(m.u,null,"Choose max slippage:"),h.a.createElement(m.y,{placement:"top",message:"Max additional slippage on top of the one shown below"},h.a.createElement(m.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))),h.a.createElement(m.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[.2,.5,1,5].map(function(t){return h.a.createElement(ne.a,{cardProps:{p:1},textProps:{fontSize:1},percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setMaxSlippage(t)},isActive:e.state.maxSlippage===parseFloat(t)})})),h.a.createElement(m.h,{mt:2,mb:3,width:1,flexDirection:"column"},h.a.createElement(m.h,{mb:1,alignItems:"center",flexDirection:"row",justifyContent:this.state.depositSlippage?"space-between":"flex-end"},this.state.depositSlippage&&h.a.createElement(m.h,{width:1,maxWidth:"50%",alignItems:"center",flexDirection:"row"},h.a.createElement(m.u,{fontSize:1,fontWeight:3,textAlign:"right",style:{whiteSpace:"nowrap"},color:parseFloat(this.state.depositSlippage.toFixed(3))>0?this.props.theme.colors.transactions.status.failed:this.props.theme.colors.transactions.status.completed},0===parseFloat(this.state.depositSlippage.toFixed(3))?"No Slippage":"".concat(this.state.depositSlippage.gt(0)?"Slippage: ":"Bonus: "," ").concat(this.state.depositSlippage.abs().toFixed(3),"%")),h.a.createElement(m.y,{placement:"top",message:this.state.depositSlippage.gt(0)?"Slippage comes from depositing too many coins not in balance, and current coin prices are additionally accounted for":"Bonus comes as an advantage from current coin prices which usually appears for coins which are high in balance"},h.a.createElement(m.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))),this.props.idleTokenBalance&&h.a.createElement(m.h,{width:1,maxWidth:"50%",alignItems:"center",flexDirection:"row",justifyContent:"flex-end"},h.a.createElement(m.n,{fontSize:1,fontWeight:3,color:"dark-gray",textAlign:"right",hoverColor:"copyColor",onClick:function(t){return e.setFastBalanceSelector(100)},style:{maxWidth:"100%",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},this.props.idleTokenBalance.toFixed(this.props.isMobile?2:4)," ",this.props.selectedToken))),h.a.createElement(m.m,{min:0,type:"number",required:!0,height:"3.4em",borderRadius:2,fontWeight:500,boxShadow:"none !important",placeholder:"Insert amount",onChange:this.changeInputValue.bind(this),border:"1px solid ".concat(this.props.theme.colors.divider),value:null!==this.state.inputValue?this.functionsUtil.BNify(this.state.inputValue).toFixed():""}),h.a.createElement(m.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[25,50,75,100].map(function(t){return h.a.createElement(ne.a,{percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setFastBalanceSelector(t)},isActive:e.state.fastBalanceSelector===parseInt(t)})})),h.a.createElement(m.h,{mt:2,justifyContent:"center"},h.a.createElement(j.a,{buttonProps:{mt:2,width:[1,.5],disabled:this.state.buttonDisabled},handleClick:this.deposit.bind(this)},"Deposit")))):this.state.processing.loading?h.a.createElement(m.h,{mt:3,flexDirection:"column"},h.a.createElement(D.a,{web3:this.props.web3,waitText:"Approve estimated in",hash:this.state.processing.txHash,endMessage:"Finalizing approve request...",cancelTransaction:this.cancelTransaction.bind(this)})):h.a.createElement(S.a,{cardProps:{p:3,mt:3}},h.a.createElement(m.h,{alignItems:"center",flexDirection:"column"},h.a.createElement(m.k,{size:"2.3em",name:"LockOpen",color:"cellText"}),h.a.createElement(m.u,{mt:1,fontSize:2,color:"cellText",textAlign:"center"},"To deposit your ",this.props.selectedToken," in the Curve Pool you need to approve the Smart-Contract first."),h.a.createElement(j.a,{buttonProps:{mt:3,width:[1,.5]},handleClick:this.approve.bind(this)},"Approve"))))))}}]),t}(p.Component),be=n(1373),ke=n(1095),ve=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={startDate:null,chartData:null,chartProps:null,chartwidth:null,chartHeight:null},n.functionsUtil=null,n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),this.loadChartData();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a,i=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),a=t.quickDateSelection!==this.props.quickDateSelection,(JSON.stringify(t.enabledTokens)!==JSON.stringify(this.props.enabledTokens)||a)&&this.setState({chartData:null},function(){i.componentDidMount()}),t.isMobile!==this.props.isMobile&&this.loadChartData();case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadChartData",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l,c,u,p,d,m,f,g,b,k,v,y,w,C,T,S,E,U,j,D,M,O,A,I,B,P,z=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.props.enabledTokens)&&t.length||(t=Object.keys(this.props.availableTokens)),e.next=4,this.functionsUtil.getCurveTxs(this.props.account,0,"latest",t);case 4:n=e.sent,a=[],i=[],s={},r=null,l=this.functionsUtil.BNify(0),c=this.functionsUtil.getGlobalConfig(["curve","poolContract"]),n&&n.length&&n.forEach(function(e,t){if(s[e.hash]||(s[e.hash]=[]),!s[e.hash].includes(e.action)){r=r?Math.min(r,parseInt(e.timeStamp)):parseInt(e.timeStamp);var n=z.functionsUtil.BNify(e.curveTokens);switch(e.action){case"CurveIn":case"CurveZapIn":case"CurveDepositIn":case"CurveTransferIn":l=l.plus(n);break;case"CurveOut":case"CurveZapOut":case"CurveDepositOut":case"CurveTransferOut":l=l.minus(n)}l.lt(0)&&(l=z.functionsUtil.BNify(0));var a=e.action,o=l,u=parseInt(e.timeStamp),p=z.functionsUtil.fixTokenDecimals(e.curveTokenPrice,c.decimals);p.isNaN()||p.isNaN()||(i.push({action:a,balance:o,timeStamp:u,curveTokens:n,curveTokenPrice:p}),s[e.hash].push(a))}}),u=null,p=this.functionsUtil.strToMoment(new Date),e.t0=this.props.quickDateSelection,e.next="week"===e.t0?17:"month"===e.t0?19:"month3"===e.t0?21:"month6"===e.t0?23:25;break;case 17:return u=p.clone().subtract(1,"week"),e.abrupt("break",27);case 19:return u=p.clone().subtract(1,"month"),e.abrupt("break",27);case 21:return u=p.clone().subtract(3,"month"),e.abrupt("break",27);case 23:return u=p.clone().subtract(6,"month"),e.abrupt("break",27);case 25:return u=null,e.abrupt("break",27);case 27:return d={},m={},f=null,g=null,b=null,k={},v={},y=this.functionsUtil.BNify(0),w=parseInt((new Date).getTime()/1e3)+86400,e.next=38,this.functionsUtil.getTokenApiData(Object.values(this.props.availableTokens)[0].address,!1,r,null,!1,3600);case 38:C=e.sent,T=o.a.mark(function e(t){var n,a,s,l,p,h,x,T,E,U,j,D,M;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},a={},t=Math.min(w,t),s=z.functionsUtil.strToMoment(1e3*t),l=C.filter(function(e){return e.timestamp>=f&&e.timestamp<=t}),(p=i.filter(function(e){return e.timeStamp<=t&&(!f||e.timeStamp>f)})).length){e.next=21;break}if(!m){e.next=20;break}if(p=m,h=Object.values(p).pop(),x=parseFloat(h.balance),T=Object.values(l).pop(),E=null,!T){e.next=17;break}return e.next=16,z.functionsUtil.getCurveTokenPrice(T.blocknumber);case 16:E=e.sent;case 17:x>0&&t>r&&E&&(h.curveTokenPrice=E,p=[h]),e.next=21;break;case 20:p=[{balance:z.functionsUtil.BNify(0),curveTokenPrice:z.functionsUtil.BNify(0)}];case 21:U=Object.assign([],p).pop(),j=z.functionsUtil.BNify(U.balance).times(U.curveTokenPrice),a[c.token]=z.functionsUtil.BNify(U.balance),y=j,n=p,(null===u||s.isSameOrAfter(u))&&(s.isAfter(new Date,"day")&&(s=z.functionsUtil.strToMoment(new Date)),D=s.format("YYYY/MM/DD 00:00"),d[s.format("YYYY/MM/DD")]=1,M=parseFloat(parseFloat(y.toFixed(6))),k[D]=M,v[D]=a,g=null===g?M:Math.min(g,M),b=null===b?M:Math.max(b,M)),f=t,m=n,S=t;case 30:case"end":return e.stop()}},e,this)}),S=r;case 41:if(!(S<=w)){e.next=46;break}return e.delegateYield(T(S),"t1",43);case 43:S+=this.props.frequencySeconds,e.next=41;break;case 46:for(E=Object.keys(k).map(function(e){return{x:e,y:k[e],balances:v[e]}}),U=0,E.forEach(function(e,t){var n=Math.floor(U/E.length*100);E[t].itemPos=n,U++}),a.push({id:"USD",color:"hsl("+this.functionsUtil.getGlobalConfig(["stats","tokens","USD","color","hsl"]).join(",")+")",data:E}),j=2,b-g<1&&(j=4),b===g&&(g=Math.max(0,b-1)),5,D=(b-g)/5,M=[],O=0;O<=5;O++)A=parseFloat(parseFloat(g+O*D).toFixed(6)),M.push(A);10,I=Object.values(d).length,B=Math.max(1,Math.ceil(I/10)),P={xScale:{type:"time",format:"%Y/%m/%d %H:%M"},yScale:{type:"linear",stacked:!1,min:g,max:b},xFormat:"time:%b %d %Y",yFormat:function(e){return z.functionsUtil.formatMoney(e,j)},axisBottom:this.props.isMobile?null:{legend:"",tickSize:0,format:"%b %d",tickPadding:15,orient:"bottom",legendOffset:36,legendPosition:"middle",tickValues:"every "+B+" days"},gridYValues:M,pointSize:0,useMesh:!0,axisLeft:this.props.isMobile?null:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:M,legendPosition:"middle",format:function(e){return z.functionsUtil.abbreviateNumber(e,2)}},animate:!0,pointLabel:"y",areaOpacity:.1,enableArea:!0,enableSlices:"x",enableGridY:!0,curve:"monotoneX",enableGridX:!1,pointBorderWidth:1,colors:function(e){return e.color},pointLabelYOffset:-12,areaBaselineValue:g,pointColor:{from:"color",modifiers:[]},theme:{axis:{ticks:{text:{fontSize:12,fontWeight:600,fill:x.a.colors.legend,fontFamily:x.a.fonts.sansSerif}}},grid:{line:{stroke:"#dbdbdb",strokeDasharray:"8 4"}}},margin:this.props.isMobile?{top:20,right:25,bottom:25,left:20}:{top:30,right:50,bottom:45,left:50},sliceTooltip:function(e){var t=e.slice.points[0];return h.a.createElement(be.a,{point:t},h.a.createElement(ke.a,{color:t.color,label:t.serieId,value:"$ ".concat(t.data.yFormatted)}),"object"===typeof t.data.balances&&Object.keys(t.data.balances).length>0&&Object.keys(t.data.balances).map(function(e){if(e===t.serieId)return null;var n=z.functionsUtil.getGlobalConfig(["stats","tokens",e]);if(n){var a=n.name?n.name:e,o=n.color.hex,i=t.data.balances[e],s=z.functionsUtil.formatMoney(i,2);if(parseFloat(i)>=.01)return h.a.createElement(ke.a,{label:a,color:o,key:"row_".concat(e),value:"".concat(s)})}return null}))}},this.setState({chartData:a,chartProps:P});case 62:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return h.a.createElement(T.a,Object.assign({type:w.a,showLoader:!0},this.state.chartProps,{data:this.state.chartData,parentId:this.props.parentId,height:this.props.chartHeight,parentIdHeight:this.props.parentIdHeight}))}}]),t}(p.Component),xe=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={compAPR:null,aggregatedValues:[],govTokensUserBalance:null},n.functionsUtil=null,n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.functionsUtil.getCurveAvgBuyPrice();case 2:return e.next=4,this.functionsUtil.getCurveAvgSlippage();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){return h.a.createElement(m.h,{width:1,flexDirection:"column"},this.state.aggregatedValues.length>0&&h.a.createElement(m.h,{width:1,mb:[0,3],mt:[2,0],alignItems:"center",flexDirection:["column","row"],justifyContent:"space-between"},this.state.aggregatedValues.map(function(e,t){return h.a.createElement(m.h,Object.assign({},e.flexProps,{flexDirection:"column",key:"aggregatedValue_".concat(t)}),h.a.createElement(S.a,{cardProps:{py:[2,3],mb:[3,0]}},h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},e.props.children?e.props.children:h.a.createElement(m.u,{lineHeight:1,fontWeight:[3,4],color:"copyColor",fontFamily:"counter",fontSize:[4,"1.7em"],dangerouslySetInnerHTML:{__html:e.props.value}}),h.a.createElement(m.u,{mt:2,fontWeight:2,fontSize:[1,2],color:"cellText"},e.props.title))))})),h.a.createElement(S.a,{cardProps:{px:2,py:3}},h.a.createElement(m.h,{width:1,ml:[0,3],id:"funds-overview"},h.a.createElement(ve,Object.assign({},this.props,{chartHeight:350,parentId:"funds-overview",frequencySeconds:this.functionsUtil.getFrequencySeconds("day",1)}))),h.a.createElement(m.h,{width:1,flexDirection:["column","row"]},h.a.createElement(m.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},h.a.createElement(v.a,{mb:2,fontSize:[3,4],component:m.j.h3},"Deposited"),h.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"amountLentCurve",props:{decimals:4,maxPrecision:8,fontWeight:300,fontSize:["1.8em","1.9em"],color:x.a.colors.counter,flexProps:{justifyContent:"center"}}}}))),h.a.createElement(m.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},h.a.createElement(v.a,{mb:2,fontSize:[3,4],component:m.j.h3},"Redeemable"),h.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"redeemableBalanceCounterCurve",props:{decimals:7,maxPrecision:8,style:{fontWeight:300,color:x.a.colors.counter,fontSize:this.props.isMobile?"1.8em":"1.9em"},flexProps:{justifyContent:"center"}}}})),h.a.createElement(m.h,{width:1,mt:"-9px"},h.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"earningsPercCurve",props:{fontSize:1,fontWeight:2,color:"cellText",flexProps:{justifyContent:"center"}}}})))),h.a.createElement(m.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},h.a.createElement(v.a,{mb:2,fontSize:[3,4],component:m.j.h3},"Earnings"),h.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"earningsCounterCurve",props:{decimals:7,maxPrecision:8,style:{fontWeight:300,fontSize:this.props.isMobile?"1.8em":"1.9em",color:x.a.colors.counter},flexProps:{justifyContent:"center"}}}}))),h.a.createElement(m.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},h.a.createElement(v.a,{mb:2,fontSize:[3,4],component:m.j.h3},"Current APY"),h.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"curveApy",props:{decimals:2,fontWeight:300,fontSize:["1.8em","1.9em"],color:x.a.colors.counter,flexProps:{justifyContent:"center"}}}}))),h.a.createElement(m.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},h.a.createElement(v.a,{mb:2,fontSize:[3,4],component:m.j.h3},"Avg Slippage"),h.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"curveAvgSlippage",props:{decimals:2,fontWeight:300,fontSize:["1.8em","1.9em"],color:x.a.colors.counter,flexProps:{justifyContent:"center"}}}}))))))}}]),t}(p.Component),ye=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),u=0;u<a;u++)r[u]=arguments[u];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={inputValue:{},processing:{},tokenFees:null,canRedeem:null,canDeposit:null,action:"deposit",activeModal:null,tokenConfig:null,tokenBalance:null,tokenApproved:null,selectedToken:null,availableTokens:{},redeemBalance:null,depositBalance:null,buttonDisabled:!1,curveTokenPrice:null,depositSlippage:null,idleTokenBalance:null,withdrawSlippage:null,govTokensBalance:null,curveZapContract:null,curveTokenConfig:null,curveTokensAmounts:{},govTokensDisabled:null,componentMounted:!1,curvePoolContract:null,curveSwapContract:null,curveTokenBalance:null,redeemableBalance:null,fastBalanceSelector:{},curveAvailableTokens:{},tokenFeesPercentage:null,redeemUnevenAmounts:!1,curveDepositContract:null},n.functionsUtil=null,n.resetModal=function(){n.setState({activeModal:null})},n.setActiveModal=function(e){n.setState({activeModal:e})},n.toggleUnevenAmounts=function(e){n.setState({redeemUnevenAmounts:e})},n.changeFromToken=function(e){var t=n.functionsUtil.getGlobalConfig(["curve"]);n.props.goToSection("".concat(t.params.route,"/").concat(e))},n.setSelectedToken=function(){var e=Object(i.a)(o.a.mark(function e(t){var a,i,s,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=n.functionsUtil.getCurveAvailableTokens(),i=n.functionsUtil.getGlobalConfig(["curve","availableTokens"]),s=i[t],r=a[s.baseToken],n.setState({tokenConfig:r,selectedToken:t,availableTokens:a,curveTokenConfig:s});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.loadTokensInfo=Object(i.a)(o.a.mark(function e(){var t,a,i,s,r,l,c,u,p,h,d,m,f,g;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.functionsUtil.getGlobalConfig(["curve","availableTokens"]),n.setState({curveAvailableTokens:t}),!(a=n.getSelectedToken())||a===n.props.urlParams.param1){e.next=10;break}return n.changeFromToken(a),e.next=7,n.setSelectedToken(a);case 7:return e.abrupt("return",e.sent);case 10:if(a===n.state.selectedToken){e.next=13;break}return e.next=13,n.setSelectedToken(a);case 13:return i=Object(U.a)({},n.state),s=n.functionsUtil.getCurveAvailableTokens(),i.selectedToken!==a&&(i.selectedToken=a),r=t[a],l=s[r.baseToken],e.next=20,Promise.all([n.functionsUtil.getCurveZapContract(),n.functionsUtil.getCurvePoolContract(),n.functionsUtil.getCurveSwapContract(),n.functionsUtil.getCurveDepositContract()]);case 20:if(c=e.sent,u=Object(_.a)(c,4),p=u[0],h=u[1],d=u[2],m=u[3],i.curveZapContract=p,i.curvePoolContract=h,i.curveSwapContract=d,i.curveDepositContract=m,i.availableTokens=s,{}[a]=l,i.tokenConfig=l,i.curveTokenConfig=r,!n.props.account){e.next=57;break}return e.next=38,Promise.all([n.functionsUtil.getCurveTokenPrice(),n.functionsUtil.getCurveTokenBalance(),n.functionsUtil.getTokenFees(l),n.functionsUtil.getUserTokenFees(l,n.props.account),n.functionsUtil.getTokenBalance(a,n.props.account),n.functionsUtil.getTokenBalance(l.idle.token,n.props.account),n.functionsUtil.checkTokenApproved(a,m.address,n.props.account)]);case 38:f=e.sent,g=Object(_.a)(f,7),i.curveTokenPrice=g[0],i.curveTokenBalance=g[1],i.tokenFeesPercentage=g[2],i.tokenFees=g[3],i.tokenBalance=g[4],i.idleTokenBalance=g[5],i.tokenApproved=g[6],i.processing={redeem:{txHash:null,loading:!1},deposit:{txHash:null,loading:!1},approve:{txHash:null,loading:!1}},i.inputValue={redeem:null,deposit:null},i.fastBalanceSelector={redeem:null,deposit:null},i.componentMounted=!0,i.depositBalance=i.tokenBalance,i.redeemBalance=i.redeemableBalance,i.govTokensDisabled=l.govTokensDisabled,i.canRedeem=i.curveTokenBalance&&i.curveTokenBalance.gt(0),i.canDeposit=i.idleTokenBalance&&i.idleTokenBalance.gt(0),i.redeemableBalance=i.curveTokenBalance?i.curveTokenBalance.times(i.curveTokenPrice):n.functionsUtil.BNify(0);case 57:n.setState(i);case 58:case"end":return e.stop()}},e,this)})),n.updateAssetSelector=Object(i.a)(o.a.mark(function e(){var t,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={},e.t0=n.state.action,e.next="deposit"===e.t0?4:"redeem"===e.t0?6:12;break;case 4:return n.loadTokensInfo(),e.abrupt("break",13);case 6:return a=n.functionsUtil.getGlobalConfig(["curve","poolContract"]),t.curveAvailableTokens={},t.curveTokenConfig=a,t.selectedToken=a.token,t.curveAvailableTokens[a.token]=a,e.abrupt("break",13);case 12:return e.abrupt("break",13);case 13:n.setState(t);case 14:case"end":return e.stop()}},e,this)})),n.getFastBalanceSelector=function(){return null!==n.state.fastBalanceSelector[n.state.action]&&n.functionsUtil.BNify(n.state.fastBalanceSelector[n.state.action]).div(100)},n.setFastBalanceSelector=function(e){if(!n.state.action)return!1;n.setState(function(t){return{fastBalanceSelector:Object(U.a)({},t.fastBalanceSelector,Object(K.a)({},n.state.action,e))}})},n.setInputValue=function(){if(!n.state.action||null===n.state.fastBalanceSelector[n.state.action])return!1;var e=n.functionsUtil.BNify(n.state.fastBalanceSelector[n.state.action]).div(100),t=null;switch(n.state.action){case"deposit":t=n.state.tokenBalance?n.functionsUtil.BNify(n.state.tokenBalance).times(e):null;break;case"redeem":t=n.state.redeemUnevenAmounts?n.state.curveTokenBalance?n.functionsUtil.BNify(n.state.curveTokenBalance).times(e):null:n.state.redeemableBalance?n.functionsUtil.BNify(n.state.redeemableBalance).times(e):null}n.checkButtonDisabled(t),n.setState(function(e){return{inputValue:Object(U.a)({},e.inputValue,Object(K.a)({},n.state.action,t))}})},n.changeInputValue=function(e){if(!n.state.action)return!1;var t=e.target.value.length&&!isNaN(e.target.value)?n.functionsUtil.BNify(e.target.value):n.functionsUtil.BNify(0);n.checkButtonDisabled(t),n.setState(function(e){return{fastBalanceSelector:Object(U.a)({},e.fastBalanceSelector,Object(K.a)({},n.state.action,null)),inputValue:Object(U.a)({},e.inputValue,Object(K.a)({},n.state.action,t))}})},n.checkButtonDisabled=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!n.state.action)return!1;e||(e=n.state.inputValue[n.state.action]);var t=!1;switch(n.state.action){case"deposit":t=t||e&&e.gt(n.state.tokenBalance);break;case"redeem":t=n.state.redeemUnevenAmounts?!n.state.canRedeem||t||e&&e.gt(n.state.curveTokenBalance):!n.state.canRedeem||t||e&&e.gt(n.state.redeemableBalance)}n.setState({buttonDisabled:t})},n.cancelTransaction=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.setState(function(e){return{processing:Object(U.a)({},e.processing,Object(K.a)({approve:{txHash:null,loading:!1}},n.state.action,{txHash:null,loading:!1}))}});case 1:case"end":return e.stop()}},e,this)})),n.approveToken=Object(i.a)(o.a.mark(function e(){var t,a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=n.state.tokenApproved)){e.next=3;break}return e.abrupt("return",n.setState(function(e){return{tokenApproved:t,processing:Object(U.a)({},e.processing,{approve:{txHash:null,loading:!1}})}}));case 3:a=function(e,t){var a={eventCategory:"Approve",eventAction:n.state.selectedToken,eventLabel:e.status};t&&(a.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==a.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(a),n.setState(function(t){return{tokenApproved:"success"===e.status,processing:Object(U.a)({},t.processing,{approve:{txHash:null,loading:!1}})}})},i=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(U.a)({},e.processing,{approve:Object(U.a)({},e.processing.approve,{txHash:t})})}})},n.functionsUtil.enableERC20(n.state.selectedToken,n.state.curveDepositContract.address,a,i),n.setState(function(e){return{processing:Object(U.a)({},e.processing,{approve:{txHash:null,loading:!0}})}});case 7:case"end":return e.stop()}},e,this)})),n.executeAction=Object(i.a)(o.a.mark(function e(){var t,a,i,s,r,l,c,u,p,h,d,m,f,g,b,k,v;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=null,a=n.state.inputValue[n.state.action],i=n.getFastBalanceSelector(),s=!0,e.t0=n.state.action,e.next="deposit"===e.t0?7:"redeem"===e.t0?23:56;break;case 7:if(!n.state.buttonDisabled&&a&&!n.functionsUtil.BNify(a).lte(0)){e.next=9;break}return e.abrupt("return",!1);case 9:return r=n.functionsUtil.normalizeTokenAmount(a,n.state.curvePoolContract.decimals),l=function(e,t){!e&&t&&(e={status:"error"});var o="error"===e.status,i="success"===e.status,s={eventCategory:"Deposit",eventAction:n.state.selectedToken,eventLabel:e.status,eventValue:parseInt(a)};t&&(s.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==s.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(s),n.setState(function(e){return{processing:Object(U.a)({},e.processing,Object(K.a)({},n.state.action,{txHash:null,loading:!1}))}}),i?n.setState(function(e){return{activeModal:"share",inputValue:Object(U.a)({},e.inputValue,Object(K.a)({},n.state.action,n.functionsUtil.BNify(0)))}}):n.state.metaTransactionsEnabled&&o&&n.setState({txError:Object(K.a)({},n.state.action,!0)})},c=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(U.a)({},e.processing,Object(K.a)({},n.state.action,Object(U.a)({},e.processing[n.state.action],{txHash:t})))}})},e.next=14,n.functionsUtil.getCurveAmounts(n.state.tokenConfig.idle.token,r);case 14:return u=e.sent,e.next=17,n.functionsUtil.genericContractCall(n.state.curveSwapContract.name,"calc_token_amount",[u,!0]);case 17:return p=e.sent,h=[u,p],e.next=21,n.props.contractMethodSendWrapper(n.state.curveDepositContract.name,"add_liquidity",h,null,l,c);case 21:return t=e.sent,e.abrupt("break",58);case 23:if(!n.state.buttonDisabled&&a&&!n.functionsUtil.BNify(a).lte(0)){e.next=25;break}return e.abrupt("return",!1);case 25:if(d=null,!i){e.next=30;break}d=n.functionsUtil.BNify(n.state.curveTokenBalance).times(i),e.next=36;break;case 30:if(d=n.functionsUtil.BNify(n.functionsUtil.normalizeTokenAmount(a,n.state.curvePoolContract.decimals)),n.state.redeemUnevenAmounts){e.next=36;break}return e.next=34,n.functionsUtil.getCurveTokenPrice();case 34:m=e.sent,d=d.div(m);case 36:if(d){e.next=38;break}return e.abrupt("return",!1);case 38:return f=function(e,t){var a="success"===e.status,o={eventLabel:e.status,eventCategory:"CurveRedeem",eventAction:n.state.selectedToken,eventValue:d.toFixed()};t&&(o.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==o.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(o),n.setState(function(e){return{processing:Object(U.a)({},e.processing,Object(K.a)({},n.state.action,{txHash:null,loading:!1}))}}),a&&n.setState(function(e){return{inputValue:Object(U.a)({},e.inputValue,Object(K.a)({},n.state.action,n.functionsUtil.BNify(0)))}})},g=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(U.a)({},e.processing,Object(K.a)({},n.state.action,Object(U.a)({},e.processing[n.state.action],{txHash:t})))}})},b=n.functionsUtil.normalizeTokenAmount(d,n.state.curvePoolContract.decimals).toString(),e.next=43,n.functionsUtil.getCurveAmounts(n.state.tokenConfig.idle.token,0);case 43:if(k=e.sent,v=n.state.curveDepositContract.name,!n.state.redeemUnevenAmounts){e.next=50;break}console.log("remove_liquidity_imbalance",n.functionsUtil.BNify(a).toString(),b.toString(),k),n.props.contractMethodSendWrapper(v,"remove_liquidity_imbalance",[k,b],null,f,g),e.next=55;break;case 50:return e.next=52,n.functionsUtil.getCurveAmounts(n.state.tokenConfig.idle.token,b);case 52:k=e.sent,console.log("remove_liquidity",n.functionsUtil.BNify(a).toString(),b.toString(),k),n.props.contractMethodSendWrapper(v,"remove_liquidity",[b,k],null,f,g);case 55:return e.abrupt("break",58);case 56:return s=!1,e.abrupt("break",58);case 58:!1!==t&&n.setState(function(e){return{processing:Object(U.a)({},e.processing,Object(K.a)({},n.state.action,Object(U.a)({},e.processing[n.state.action],{loading:s})))}});case 59:case"end":return e.stop()}},e,this)})),n.setAction=function(e){switch(e.toLowerCase()){case"deposit":break;case"redeem":n.state.canRedeem||(e=null);break;default:e=null}null!==e&&n.setState({action:e})},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"getSelectedToken",value:function(){var e=this.functionsUtil.getGlobalConfig(["curve","availableTokens"]);return this.props.urlParams.param1&&e[this.props.urlParams.param1]?this.props.urlParams.param1:Object.keys(e)[0]}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.loadTokensInfo();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"calculateSlippage",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.state.inputValue[this.state.action]?this.functionsUtil.BNify(this.state.inputValue[this.state.action]):null)&&!t.lte(0)){e.next=3;break}return e.abrupt("return",!1);case 3:n=this.functionsUtil.normalizeTokenAmount(t,this.state.curvePoolContract.decimals),a={},e.t0=this.state.action,e.next="deposit"===e.t0?8:"redeem"===e.t0?13:18;break;case 8:return a.depositBalance=t,e.next=11,this.functionsUtil.getCurveSlippage(this.state.tokenConfig.idle.token,n,!0);case 11:return a.depositSlippage=e.sent,e.abrupt("break",19);case 13:return a.redeemBalance=t,e.next=16,this.functionsUtil.getCurveSlippage(this.state.tokenConfig.idle.token,n,!0);case 16:return a.withdrawSlippage=e.sent,e.abrupt("break",19);case 18:return e.abrupt("break",19);case 19:this.setState(a);case 20:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a,i,s,r,l,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadUtils(),a=t.account!==this.props.account,i=t.urlParams.param1!==this.props.urlParams.param1,s=t.transactions&&this.props.transactions&&Object.values(t.transactions).filter(function(e){return"success"===e.status}).length!==Object.values(this.props.transactions).filter(function(e){return"success"===e.status}).length,!(a||s||i)){e.next=7;break}return e.next=7,this.loadTokensInfo();case 7:r=this.state.action!==n.action,l=this.state.redeemUnevenAmounts!==n.redeemUnevenAmounts,c=this.state.fastBalanceSelector[this.state.action]!==n.fastBalanceSelector[this.state.action],(r||c||l)&&this.setInputValue(),r&&this.updateAssetSelector(),n.inputValue[this.state.action]!==this.state.inputValue[this.state.action]&&this.calculateSlippage();case 14:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.account&&this.state.curveTokenBalance&&this.functionsUtil.BNify(this.state.curveTokenBalance).gt(0);return h.a.createElement(m.b,{width:1},h.a.createElement(m.h,{width:1,mb:[3,4],alignItems:"center",flexDirection:"row",justifyContent:"flex-start"},h.a.createElement(m.h,{width:.5},h.a.createElement(I.a,{isMobile:this.props.isMobile,path:["Boost",this.state.selectedToken],handleClick:function(t){return e.props.goToSection("best")},text:this.functionsUtil.getGlobalConfig(["strategies","best","title"])}))),h.a.createElement(v.a,{mb:[3,4]},"Curve Pool"),h.a.createElement(m.h,{width:1},h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},h.a.createElement(m.h,{width:[1,.36],alignItems:"stretch",flexDirection:"column",justifyContent:"center"},h.a.createElement(m.b,{width:1},h.a.createElement(m.u,{mb:1},"Select your asset:"),h.a.createElement(B.a,Object.assign({},this.props,{id:"token-from",onChange:this.changeFromToken,selectedToken:this.state.selectedToken,tokenConfig:this.state.curveTokenConfig,showBalance:"deposit"===this.state.action,availableTokens:this.state.curveAvailableTokens}))),h.a.createElement(m.b,{width:1},h.a.createElement(m.h,{mt:2,flexDirection:"column"},h.a.createElement(m.u,{mb:2},"Choose the action:"),h.a.createElement(m.h,{alignItems:"center",flexDirection:"row",justifyContent:"space-between"},h.a.createElement(S.a,{cardProps:{p:[2,3],width:.48,onMouseDown:function(){e.setAction("deposit")}},isInteractive:!0,isActive:"deposit"===this.state.action},h.a.createElement(m.h,{my:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},h.a.createElement(ue.a,{transaction:{action:"deposit"},fieldInfo:{name:"icon",props:{mr:[1,3]}}}),h.a.createElement(m.u,{fontSize:3,fontWeight:3},"Deposit"))),h.a.createElement(S.a,{cardProps:{p:[2,3],width:.48,onMouseDown:function(){e.setAction("redeem")}},isInteractive:!0,isDisabled:!this.state.canRedeem,isActive:"redeem"===this.state.action},h.a.createElement(m.h,{my:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},h.a.createElement(ue.a,{transaction:{action:"redeem"},fieldInfo:{name:"icon",props:{mr:[1,3]}}}),h.a.createElement(m.u,{fontSize:3,fontWeight:3},"Redeem"))))))),h.a.createElement(m.h,{width:1,mt:this.props.account?3:0},"deposit"===this.state.action?h.a.createElement(ge,Object.assign({},this.props,this.state)):"redeem"===this.state.action&&h.a.createElement(ae,Object.assign({},this.props,this.state))))),t&&h.a.createElement(m.h,{mb:[0,4],width:1,flexDirection:"column",id:"funds-overview-container"},h.a.createElement(v.a,{my:[3,4]},"Funds Overview"),h.a.createElement(xe,Object.assign({},this.props,{tokenFees:this.state.tokenFees,tokenConfig:this.state.tokenConfig,selectedToken:this.state.selectedToken,availableTokens:this.state.availableTokens,enabledTokens:Object.keys(this.state.availableTokens)}))),this.props.account&&h.a.createElement(m.h,{mb:[3,4],width:1,flexDirection:"column",id:"transactions-container"},h.a.createElement(v.a,{my:[3,4]},"Transactions"),h.a.createElement(de.a,Object.assign({},this.props,{availableTokens:this.state.availableTokens,enabledTokens:Object.keys(this.state.availableTokens),enabledActions:["CurveIn","CurveOut","CurveZapIn","CurveZapOut","CurveTransferIn","CurveTransferOut","CurveDepositIn","CurveDepositOut"],cols:[{title:this.props.isMobile?"":"HASH",props:{width:[.15,.24]},fields:[{name:"icon",props:{mr:[0,2]}},{name:"hash",mobile:!1}]},{title:"ACTION",mobile:!1,props:{width:.15},fields:[{name:"action"}]},{title:"DATE",props:{width:[.32,.23]},fields:[{name:"date"}]},{title:"STATUS",props:{width:[.18,.22],justifyContent:["center","flex-start"]},fields:[{name:"statusIcon",props:{mr:[0,2]}},{mobile:!1,name:"status"}]},{title:"AMOUNT",props:{width:.19},fields:[{name:"amount"}]},{title:"ASSET",props:{width:[.15,.2],justifyContent:["center","flex-start"]},fields:[{name:"tokenIcon",props:{mr:[0,2],height:["1.4em","1.6em"]}},{mobile:!1,name:"tokenName"}]}]}))),h.a.createElement(q.a,Object.assign({},this.props,{closeModal:this.resetModal,buyToken:this.state.selectedToken,isOpen:"buy"===this.state.activeModal})))}}]),t}(p.Component),we=n(12),Ce=n(584),Te=n.n(Ce),Se=n(109),Ee=n(308),Ue=n.n(Ee),je=n(1119),De=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={email:null,error:!1,subscribed:!1,sendingForm:!1},n.functionsUtil=null,n.componentDidUpdate=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.functionsUtil.setProps(n.props);case 1:case"end":return e.stop()}},e,this)})),n.sendUserInfo=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=n.functionsUtil.getWalletProvider(),a={address:n.props.account,provider:t};e&&null!==n.state.email&&(a.email=n.state.email),n.functionsUtil.simpleIDPassUserInfo(a)},n.closeModal=Object(i.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=function(){n.props.closeModal()};try{n.sendUserInfo(!1),C.a.analytics.google.events.enabled?(n.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UI",eventAction:"continue_without_email",eventLabel:"WelcomeModal"},t),setTimeout(t,1e3)):t()}catch(a){t()}case 2:case"end":return e.stop()}},e,this)})),n.functionsUtil=new f.a(e),n.handleSubmit=n.handleSubmit.bind(Object(we.a)(Object(we.a)(n))),n.handleValidation=n.handleValidation.bind(Object(we.a)(Object(we.a)(n))),n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"handleSubmit",value:function(e){var t=this;if(e.preventDefault(),!this.state.email)return!1;var n=function(){t.setState({sendingForm:!1,subscribed:!0}),window.setTimeout(t.props.closeModal,2500)};if(this.sendUserInfo(),this.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UI",eventAction:"send_email",eventLabel:"WelcomeModal"}),Te.a.post(C.a.newsletterSubscription.endpoint,{email:this.state.email}).then(function(e){n()}).catch(function(e){n()}),localStorage){var a=this.props.account.toLowerCase(),o=localStorage.getItem("lastLogin")?JSON.parse(localStorage.getItem("lastLogin")):null;o&&o[a]&&!o[a].signedUp&&(o[a].signedUp=!0,this.functionsUtil.setLocalStorage("lastLogin",JSON.stringify(o)))}this.setState({sendingForm:!0})}},{key:"handleValidation",value:function(e){e&&e.target&&(this.setState({email:e.target.value}),e.target.parentNode.classList.add("was-validated"))}},{key:"render",value:function(){return h.a.createElement(m.p,{isOpen:this.props.isOpen},this.state.subscribed?h.a.createElement(Y.a,{closeFunc:this.closeModal},h.a.createElement(Y.a.Header,{title:"All done",icon:"images/done.svg"}),h.a.createElement(Y.a.Body,null,h.a.createElement(m.h,{width:1,flexDirection:"column",mb:3},h.a.createElement(m.u,{color:"dark-gray",textAlign:"center",fontSize:3,my:0},"Thanks for subscribing!"),h.a.createElement(m.c,{my:3,width:"100%",borderRadius:4,onClick:this.closeModal},"CLOSE")))):h.a.createElement(Y.a,{closeFunc:this.closeModal},h.a.createElement(Y.a.Header,{title:"Stay up-to-date!",icon:"images/notification.svg"}),h.a.createElement(Y.a.Body,null,h.a.createElement(m.i,{onSubmit:this.handleSubmit},h.a.createElement(m.h,{width:1,flexDirection:"column",mb:3},h.a.createElement(m.u,{color:"mid-gray",textAlign:"left",fontSize:3,my:0},"Add your e-mail to receive updates about:")),h.a.createElement(m.h,{width:1,flexDirection:"column",mt:2},h.a.createElement(m.h,{my:2,flexDirection:"row",alignItems:"center"},h.a.createElement(m.k,{name:"CheckCircle",color:Se.b.green,size:"32"}),h.a.createElement(m.u,{color:"dark-gray",textAlign:"left",fontSize:3,fontWeight:2,my:0,ml:2},"Performance reports")),h.a.createElement(m.h,{my:2,flexDirection:"row"},h.a.createElement(m.k,{name:"CheckCircle",color:Se.b.green,size:"32"}),h.a.createElement(m.u,{color:"dark-gray",textAlign:"left",fontSize:3,fontWeight:2,my:0,ml:2},"New Protocols & Tokens")),h.a.createElement(m.h,{my:2,flexDirection:"row"},h.a.createElement(m.k,{name:"CheckCircle",color:Se.b.green,size:"32"}),h.a.createElement(m.u,{color:"dark-gray",textAlign:"left",fontSize:3,fontWeight:2,my:0,ml:2},"Latest updates")),h.a.createElement(m.i.Field,{width:1,label:""},h.a.createElement(m.i.Input,{type:"email",name:"EMAIL",width:1,outline:"none",border:0,px:3,py:4,fontSize:3,textAlign:["center","left"],placeholder:"Enter your e-mail",onChange:this.handleValidation,required:!0})),h.a.createElement(m.h,{mb:3,flexDirection:"column",alignItems:"center",justifyContent:"center"},h.a.createElement(je.a,{buttonText:"SUBMIT",isLoading:this.state.sendingForm,buttonProps:{className:Ue.a.gradientButton,width:"100%",type:"submit"}}),h.a.createElement(m.n,{mt:2,onClick:this.closeModal,hoverColor:"blue"},"continue without e-mail")))))))}}]),t}(h.a.Component),Me=n(4792),Oe=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={dontShowAgain:!1},n.functionsUtil=null,n.componentDidUpdate=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.loadUtils();case 1:case"end":return e.stop()}},e,this)})),n.closeModal=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.functionsUtil.getGlobalConfig(["globalConfigs","analytics","google","events","enabled"])){e.next=7;break}return e.next=4,n.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UI",eventAction:"continue_without_migrate",eventLabel:"MigrateModal"});case 4:n.props.closeModal(),e.next=8;break;case 7:n.props.closeModal();case 8:case"end":return e.stop()}},e,this)})),n.toggleDontShowAgain=function(e){e?n.functionsUtil.setLocalStorage("dontShowMigrateModal","true"):n.functionsUtil.removeStoredItem("dontShowMigrateModal"),n.setState({dontShowAgain:e})},n.migrate=function(){var e=n.functionsUtil.getGlobalConfig(["tools","tokenMigration","route"]);n.props.goToSection("tools/"+e),n.props.closeModal()},n.loadUtils(),n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}}]),Object(r.a)(t,[{key:"render",value:function(){var e=this,t={fontWeight:3,fontSize:[2,3],color:"cellText",flexProps:{justifyContent:"flex-start"}};return h.a.createElement(m.p,{isOpen:this.props.isOpen},h.a.createElement(Y.a,{maxWidth:["960px","750px"],closeFunc:this.props.closeModal},h.a.createElement(Y.a.Header,{iconHeight:"40px",title:"Migrate to Idle",icon:"images/migrate.svg"}),h.a.createElement(Y.a.Body,null,h.a.createElement(m.h,{mb:0,width:1,flexDirection:"column"},h.a.createElement(m.u,{my:0,fontSize:3,color:"mid-gray",textAlign:"center"},"You can migrate your funds from Compound, Aave, Fulcrum, Yearn and Idle V2 with just one transaction.")),h.a.createElement(m.h,{width:1,flexDirection:"column"},h.a.createElement(m.h,{my:2,alignItems:"center",flexDirection:"column"},this.props.protocolsTokensBalances&&Object.keys(this.props.protocolsTokensBalances).map(function(n){return h.a.createElement(m.h,{mb:2,alignItems:"center",flexDirection:"row",key:"token_".concat(n),justifyContent:"space-between"},h.a.createElement(X.a,{token:n,fieldInfo:{name:"icon",props:{mr:2,height:"2.3em"}},tokenConfig:e.props.protocolsTokensBalances[n].tokenConfig}),h.a.createElement(te.a,Object.assign({mr:2},t,{minPrecision:5,number:e.props.protocolsTokensBalances[n].balance})),h.a.createElement(X.a,{token:n,fieldInfo:{name:"tokenName",props:t},tokenConfig:e.props.protocolsTokensBalances[n].tokenConfig}))}),h.a.createElement(m.u,{mb:0,fontSize:1,color:"red",fontWeight:500,textAlign:"center"},"Please be aware that by migrating your tokens from other protocols, your open positions might be liquidated if collateralized with migrated tokens.")),h.a.createElement(m.h,{mb:3,alignItems:"center",flexDirection:"column",justifyContent:"center"},h.a.createElement(je.a,{buttonText:"MIGRATE",handleClick:this.migrate,isLoading:this.state.sendingForm,buttonProps:{width:["100%","50%"],className:Ue.a.gradientButton}}),h.a.createElement(m.e,{mt:2,required:!1,color:"mid-gray",checked:this.state.dontShowAgain,label:"Don't show this popup again",onChange:function(t){return e.toggleDontShowAgain(t.target.checked)}}))))))}}]),t}(h.a.Component),Ae=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={dontShowAgain:!1},n.functionsUtil=null,n.componentDidUpdate=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.loadUtils();case 1:case"end":return e.stop()}},e,this)})),n.closeModal=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.functionsUtil.getGlobalConfig(["globalConfigs","analytics","google","events","enabled"])){e.next=7;break}return e.next=4,n.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UI",eventAction:"close_upgrade_modal",eventLabel:"UpgradeModal"});case 4:n.props.closeModal(),e.next=8;break;case 7:n.props.closeModal();case 8:case"end":return e.stop()}},e,this)})),n.toggleDontShowAgain=function(e){e?n.functionsUtil.setLocalStorage("dontShowUpgradeModal","true"):n.functionsUtil.removeStoredItem("dontShowUpgradeModal"),n.setState({dontShowAgain:e})},n.migrate=function(){var e=Object(i.a)(o.a.mark(function e(t){var a,i=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((a=i.length>1&&void 0!==i[1]?i[1]:null)||(a=n.props.selectedStrategy),!n.functionsUtil.getGlobalConfig(["globalConfigs","analytics","google","events","enabled"])){e.next=10;break}return e.next=6,n.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UpgradeModal",eventAction:"migrate",eventLabel:"".concat(n.props.selectedStrategy,"_").concat(t)});case 6:n.props.goToSection("".concat(a,"/").concat(t)),n.props.closeModal(),e.next=12;break;case 10:n.props.goToSection("".concat(a,"/").concat(t)),n.props.closeModal();case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.convert=function(){var e=Object(i.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.functionsUtil.getGlobalConfig(["tools","tokenMigration"]),!n.functionsUtil.getGlobalConfig(["globalConfigs","analytics","google","events","enabled"])){e.next=9;break}return e.next=5,n.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UpgradeModal",eventAction:"migrate",eventLabel:"".concat(n.props.selectedStrategy,"_").concat(t)});case 5:n.props.goToSection("tools/".concat(a.route,"/").concat(t)),n.props.closeModal(),e.next=11;break;case 9:n.props.goToSection("tools/".concat(a.route,"/").concat(t)),n.props.closeModal();case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.loadUtils(),n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}}]),Object(r.a)(t,[{key:"render",value:function(){var e=this;if(!this.props.availableStrategies||!this.props.availableTokens)return null;var t={fontWeight:3,fontSize:[2,3],color:"cellText",flexProps:{justifyContent:"flex-start"}};return h.a.createElement(m.p,{isOpen:this.props.isOpen},h.a.createElement(Y.a,{maxWidth:["960px","750px"],closeFunc:this.props.closeModal},h.a.createElement(Y.a.Header,{icon:"images/migrate.svg",title:"Upgrade Available",iconHeight:["35px","40px"]}),h.a.createElement(Y.a.Body,null,h.a.createElement(m.h,{mb:0,width:1,flexDirection:"column"},h.a.createElement(m.u,{my:0,fontSize:[2,3],color:"mid-gray",textAlign:"center"},"Idle now supports yield farming and governance tokens distribution, migrate now your portfolio with just one click!")),h.a.createElement(m.h,{width:1,flexDirection:"column"},h.a.createElement(m.h,{mt:[2,3],alignItems:"center",flexDirection:"row"},h.a.createElement(m.h,{fontSize:[2,3],width:[.5,.28],fontWeight:[4,5],color:"copyColor"},this.props.isMobile?"ASSET":"ASSET TO MIGRATE"),!this.props.isMobile&&h.a.createElement(m.h,{width:.19,fontWeight:[4,5],color:"copyColor",justifyContent:"center"},"BALANCE"),!this.props.isMobile&&h.a.createElement(m.h,{width:.19,fontWeight:[4,5],color:"copyColor",justifyContent:"center"},"OLD APY"),h.a.createElement(m.h,{fontSize:[2,3],fontWeight:[4,5],width:[.25,.19],color:"copyColor",justifyContent:"center"},this.props.isMobile?"APY":"NEW APY"),h.a.createElement(m.h,{width:[.25,.15]})),h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column"},this.props.tokensToMigrate&&Object.keys(this.props.tokensToMigrate).map(function(n){var a=e.props.tokensToMigrate[n].token,o=e.props.tokensToMigrate[n].strategy,i=e.props.tokensToMigrate[n].tokenConfig,s=e.props.tokensToMigrate[n].oldContractBalanceFormatted;return h.a.createElement(m.h,{mt:2,width:1,alignItems:"center",flexDirection:"row",key:"token_".concat(n),justifyContent:"space-between"},h.a.createElement(m.h,{width:[.5,.28],alignItems:"center",flexDirection:"row"},h.a.createElement(X.a,{fieldInfo:{name:"icon",props:{mr:2,height:["1.8em","2.3em"]}},tokenConfig:i,token:i.idle.token}),h.a.createElement(X.a,{fieldInfo:{name:"tokenName",props:t},tokenConfig:i,token:i.idle.token})),!e.props.isMobile&&h.a.createElement(m.h,{width:.19,alignItems:"center",justifyContent:"center"},h.a.createElement(te.a,Object.assign({},t,{minPrecision:5,number:s,flexProps:{justifyContent:"center"}}))),!e.props.isMobile&&h.a.createElement(m.h,{width:.19,alignItems:"center",justifyContent:"center"},h.a.createElement(X.a,Object.assign({},e.props,{fieldInfo:{name:"oldApy",props:t},token:a,tokenConfig:i}))),h.a.createElement(m.h,{width:[.25,.19],alignItems:"center",justifyContent:"center"},h.a.createElement(X.a,Object.assign({},e.props,{fieldInfo:{name:"apy",props:t},token:a,tokenConfig:i}))),h.a.createElement(m.h,{width:[.25,.15],alignItems:"center",justifyContent:"center"},h.a.createElement(j.a,{handleClick:function(t){return e.migrate(a,o)},buttonProps:{size:"small",width:"100%",className:Ue.a.gradientButton}},"MIGRATE")))})),h.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column"},this.props.oldIdleTokensToMigrate&&Object.keys(this.props.oldIdleTokensToMigrate).map(function(n){var a=e.props.oldIdleTokensToMigrate[n].tokenConfig;if(!a)return null;var o=e.props.oldIdleTokensToMigrate[n].balance,i=null;return i=a.availableStrategies&&!e.props.availableTokens[a.baseToken]?e.props.availableStrategies[a.availableStrategies[0]][a.baseToken]:e.props.availableTokens[a.baseToken],h.a.createElement(m.h,{mt:2,width:1,alignItems:"center",flexDirection:"row",key:"token_".concat(n),justifyContent:"space-between"},h.a.createElement(m.h,{width:.28,alignItems:"center",flexDirection:"row"},h.a.createElement(X.a,{fieldInfo:{name:"icon",props:{mr:2,height:"2.3em"}},tokenConfig:a,token:n}),h.a.createElement(X.a,{fieldInfo:{name:"tokenName",props:t},tokenConfig:a,token:n})),h.a.createElement(m.h,{width:.19,alignItems:"center",justifyContent:"center"},h.a.createElement(te.a,Object.assign({},t,{minPrecision:5,number:o,flexProps:{justifyContent:"center"}}))),h.a.createElement(m.h,{width:.19,alignItems:"center",justifyContent:"center"},h.a.createElement(X.a,Object.assign({},e.props,{fieldInfo:{name:"oldApy",props:t},token:i.token,tokenConfig:i}))),h.a.createElement(m.h,{width:.19,alignItems:"center",justifyContent:"center"},h.a.createElement(X.a,Object.assign({},e.props,{fieldInfo:{name:"apy",props:t},token:i.token,tokenConfig:i}))),h.a.createElement(m.h,{width:.15,alignItems:"center",justifyContent:"center"},h.a.createElement(j.a,{handleClick:function(t){return e.convert(n)},buttonProps:{size:"small",width:"100%",className:Ue.a.gradientButton}},"MIGRATE")))})),h.a.createElement(m.h,{my:3,alignItems:"center",flexDirection:"column",justifyContent:"center"},h.a.createElement(j.a,{handleClick:this.closeModal,buttonProps:{fontSize:[2,3],width:["100%","40%"]}},"MIGRATE LATER"),h.a.createElement(m.e,{mt:2,required:!1,color:"mid-gray",checked:this.state.dontShowAgain,label:"Don't show this popup again",onChange:function(t){return e.toggleDontShowAgain(t.target.checked)}}))))))}}]),t}(h.a.Component),Ie=n(4794),Be=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),u=0;u<a;u++)r[u]=arguments[u];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={menu:[],baseRoute:null,clickEvent:null,activeModal:null,currentRoute:null,pageComponent:null,currentSection:null,selectedSection:null,tokensToMigrate:null,showResetButton:!1,selectedSubsection:null,oldIdleTokensToMigrate:null,protocolsTokensBalances:null},n.timeoutId=null,n.functionsUtil=null,n.resetModal=function(){n.setState({activeModal:null})},n.openTooltipModal=function(e,t){n.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UI",eventAction:e,eventLabel:"TooltipModal"}),n.setState({modalTitle:e,modalContent:t},function(){n.setActiveModal("tooltip")})},n.setActiveModal=function(e){n.setState({activeModal:e})},n.logout=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.props.setConnector("Infura","Infura"),e.next=3,n.props.initWeb3("Infura");case 3:case"end":return e.stop()}},e,this)})),n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props),window.functionsUtil=this.functionsUtil}},{key:"loadMenu",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.functionsUtil.getGlobalConfig(["dashboard","baseRoute"]),n=this.functionsUtil.getGlobalConfig(["strategies"]),a=Object.keys(n).filter(function(e){return!n[e].comingSoon}).map(function(e){return{submenu:[],color:"#fff",selected:!1,route:t+"/"+e,label:n[e].title,image:n[e].icon,imageInactive:n[e].iconInactive,bgColor:n[e].color,component:n[e].component}}),(i=this.functionsUtil.getGlobalConfig(["curve"])).enabled&&(s=Object.assign({submenu:[],selected:!1,component:ye},i.params),a.push(s)),a.push({icon:"Equalizer",label:"Stats",bgColor:"#21f36b",color:"dark-gray",component:W,selected:!1,route:"/dashboard/stats",submenu:[]}),a.push({icon:"Build",label:"Tools",color:"dark-gray",component:G,selected:!1,route:"/dashboard/tools",bgColor:this.props.theme.colors.primary,submenu:Object.values(this.functionsUtil.getGlobalConfig(["tools"])).filter(function(e){return e.enabled})}),a.push({submenu:[],icon:"Forum",mobile:!1,label:"Forum",selected:!1,component:null,color:"dark-gray",bgColor:"#ff0000",isExternalLink:!0,route:this.functionsUtil.getGlobalConfig(["forumURL"])}),e.next=10,this.setState({menu:a});case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadParams",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l,c,u,p,h,d,m,f,g,b;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.match.params,n=this.functionsUtil.getGlobalConfig(["dashboard","baseRoute"]),a=n,i=null,s=null,r=null,l=null,t.section&&(r=t.section,c=t.param1,u=t.param2,p=Object.keys(this.props.availableStrategies).includes(r.toLowerCase()),h=c&&Object.keys(this.props.availableStrategies).includes(c.toLowerCase()),p||h?(a+="/"+(l=p?r:c),d=c&&Object.keys(this.props.availableStrategies[l]).includes(c.toUpperCase()),m=u&&Object.keys(this.props.availableStrategies[l]).includes(u.toUpperCase()),(d||m)&&(s=d?c.toUpperCase():u.toUpperCase(),a+="/"+s,p&&(i=fe))):(a+="/"+t.section,t.param1&&t.param1.length&&(a+="/"+t.param1))),f=this.state.menu,g=null,b=null,f.forEach(function(e){e.selected=!1;var o=n+"/"+t.section;a.toLowerCase()===e.route.toLowerCase()||!e.submenu.length&&e.route.toLowerCase()===o.toLowerCase()?(e.selected=!0,null===i&&(i=e.component)):e.submenu.length&&e.submenu.forEach(function(t){t.selected=!1,(e.route+"/"+t.route).toLowerCase()===a.toLowerCase()&&(e.selected=!0,t.selected=!0,null===i&&(i=t.component?t.component:e.component)),t.selected&&(b=t)}),e.selected&&(g=e)}),i){e.next=14;break}return e.abrupt("return",this.goToSection("/",!1));case 14:return e.next=16,this.props.setStrategyToken(l,s);case 16:return e.next=18,this.setState({menu:f,params:t,baseRoute:n,currentRoute:a,pageComponent:i,currentSection:r,selectedSection:g,selectedSubsection:b});case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.timeoutId&&window.clearTimeout(this.timeoutId)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.loadMenu();case 3:this.loadParams();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.timeoutId=window.setTimeout(function(){t.props.accountInizialized&&t.props.contractsInitialized||t.setState({showResetButton:!0})},2e4),this.props.web3){e.next=5;break}return e.abrupt("return",this.props.initWeb3());case 5:if(this.props.accountInizialized){e.next=9;break}return e.abrupt("return",this.props.initAccount());case 9:if(this.props.contractsInitialized){e.next=11;break}return e.abrupt("return",this.props.initializeContracts());case 11:return this.loadUtils(),e.next=14,this.loadMenu();case 14:this.loadParams(),this.checkModals();case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a,i,s,r,l,c,u=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadUtils(),a=t.match.params,i=this.props.match.params,JSON.stringify(a)===JSON.stringify(i)){e.next=6;break}return e.next=6,this.setState({pageComponent:null},function(){u.loadParams()});case 6:s=t.account!==this.props.account,r=this.props.selectedStrategy&&t.selectedStrategy!==this.props.selectedStrategy,l=this.props.accountInizialized&&t.accountInizialized!==this.props.accountInizialized,c=this.props.contractsInitialized&&t.contractsInitialized!==this.props.contractsInitialized,(s||l||c||r)&&this.checkModals();case 11:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"checkModals",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.selectedToken&&this.props.accountInizialized&&this.props.contractsInitialized&&this.props.availableStrategies&&this.props.availableTokens){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,this.checkTokensToMigrate();case 4:return e.next=6,this.checkWelcomeModal();case 6:return e.next=8,this.checkProtocolsTokensBalances();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkTokensToMigrate",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null===this.functionsUtil.getStoredItem("dontShowUpgradeModal",!1,null),!this.props.selectedToken&&t&&this.props.availableTokens){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,this.functionsUtil.getTokensToMigrate();case 5:return n=e.sent,e.next=8,this.functionsUtil.getProtocolsTokensBalances("idle");case 8:if(a=e.sent,!(n&&Object.keys(n).length>0||a&&Object.keys(a).length>0)){e.next=14;break}if("upgrade","upgrade"===this.state.activeModal){e.next=14;break}return this.setState({activeModal:"upgrade",tokensToMigrate:n,oldIdleTokensToMigrate:a}),e.abrupt("return","upgrade");case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkWelcomeModal",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.account&&this.props.accountInizialized&&this.props.contractsInitialized){e.next=2;break}return e.abrupt("return",null);case 2:if(!this.props.account||null!==this.state.activeModal){e.next=10;break}if(t=!1,(n=this.functionsUtil.getGlobalConfig(["modals","welcome"])).enabled&&localStorage&&(a=(new Date).getTime(),i=this.props.account.toLowerCase(),(s=localStorage.getItem("lastLogin")?JSON.parse(localStorage.getItem("lastLogin")):{})[i]?s[i].signedUp||(r=parseInt(s[i].lastTime),t=(a-r)/1e3>=n.frequency):(s[i]={signedUp:!1,lastTime:a},t=!0),t&&(s[i].lastTime=a,this.functionsUtil.setLocalStorage("lastLogin",JSON.stringify(s)))),l=t?"welcome":this.state.activeModal,this.state.activeModal===l){e.next=10;break}return this.setState({activeModal:l}),e.abrupt("return",l);case 10:return e.abrupt("return",null);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkProtocolsTokensBalances",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.account&&this.props.accountInizialized&&this.props.contractsInitialized){e.next=2;break}return e.abrupt("return",null);case 2:if(t=this.functionsUtil.getGlobalConfig(["modals","migrate","enabled"]),n=null===this.functionsUtil.getStoredItem("dontShowMigrateModal",!1,null),null!==this.state.activeModal||!t||!n||this.state.protocolsTokensBalances){e.next=12;break}return e.next=7,this.functionsUtil.getProtocolsTokensBalances();case 7:return a=e.sent,i=a&&Object.keys(a).length>0?"migrate":null,s={activeModal:i,protocolsTokensBalances:a},this.setState(s),e.abrupt("return",i);case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"goToSection",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&(e=e.replace(this.state.baseRoute+"/",""));var n=t?this.state.baseRoute+"/"+e:e;window.location.hash=n,this.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UI",eventAction:"goToSection",eventLabel:n}),window.scrollTo(0,0)}},{key:"changeToken",value:function(e){if(e=e.toUpperCase(),Object.keys(this.props.availableTokens).includes(e)){var t=[];this.state.currentSection.toLowerCase()!==this.props.selectedStrategy.toLowerCase()&&t.push(this.state.currentSection),t.push(this.props.selectedStrategy),t.push(e),this.goToSection(t.join("/"))}}},{key:"propagateClickEvent",value:function(e){this.setState({clickEvent:e.target})}},{key:"render",value:function(){var e=this.state.pageComponent?this.state.pageComponent:null;return h.a.createElement(m.h,{width:"100%",position:"fixed",flexDirection:"row",backgroundColor:["dashboardBg","white"],height:[window.innerHeight-61+"px","100vh"]},h.a.createElement(m.h,{bottom:0,zIndex:1,width:[1,1/6],flexDirection:"column",position:["fixed","relative"]},h.a.createElement(m.d,{p:[0,3],width:["100vw","auto"],height:["auto","100vh"]},h.a.createElement(g.a,Object.assign({},this.props,{menu:this.state.menu})))),h.a.createElement(m.h,{py:3,px:[3,5],mb:0,width:[1,5/6],style:{overflowY:"scroll",overflowX:"hidden"},flexDirection:"columns",backgroundColor:"dashboardBg"},this.props.accountInizialized&&this.props.contractsInitialized&&e?h.a.createElement(m.h,{width:1,flexDirection:"column"},h.a.createElement(Ie.a,Object.assign({clickEvent:this.state.clickEvent,goToSection:this.goToSection.bind(this)},this.props)),e&&h.a.createElement(e,Object.assign({},this.props,{match:{params:{}},urlParams:this.state.params,changeToken:this.changeToken.bind(this),goToSection:this.goToSection.bind(this),selectedSection:this.state.selectedSection,selectedSubsection:this.state.selectedSubsection,openTooltipModal:this.openTooltipModal.bind(this)}))):h.a.createElement(m.h,{width:1,minHeight:"50vg",alignItems:"center",flexDirection:"column",justifyContent:"center"},this.state.showResetButton?h.a.createElement(S.a,{cardProps:{p:3,mt:3,width:[1,.35]}},h.a.createElement(m.h,{alignItems:"center",flexDirection:"column"},h.a.createElement(m.k,{size:"2.3em",name:"Warning",color:"cellText"}),h.a.createElement(m.u,{mt:2,fontSize:2,color:"cellText",textAlign:"center"},"Idle can't connect to your wallet!",h.a.createElement("br",null),"Make sure that your wallet is unlocked and try again."),h.a.createElement(j.a,{buttonProps:{mt:3,width:[1,.5]},handleClick:this.logout.bind(this)},"Logout"))):h.a.createElement(d.a,{textProps:{textSize:4,fontWeight:2},loaderProps:{mb:3,size:"40px"},flexProps:{my:3,flexDirection:"column"},text:this.props.accountInizialized?this.props.contractsInitialized?"Loading assets...":"Loading contracts...":"Loading account..."}))),h.a.createElement(Ae,Object.assign({},this.props,{closeModal:this.resetModal,goToSection:this.goToSection.bind(this),tokensToMigrate:this.state.tokensToMigrate,isOpen:"upgrade"===this.state.activeModal,oldIdleTokensToMigrate:this.state.oldIdleTokensToMigrate})),h.a.createElement(Oe,Object.assign({},this.props,{closeModal:this.resetModal,goToSection:this.goToSection.bind(this),isOpen:"migrate"===this.state.activeModal,protocolsTokensBalances:this.state.protocolsTokensBalances})),h.a.createElement(Me.a,{closeModal:this.resetModal,title:this.state.modalTitle,content:this.state.modalContent,isOpen:"tooltip"===this.state.activeModal}),h.a.createElement(De,{closeModal:this.resetModal,account:this.props.account,simpleID:this.props.simpleID,network:this.props.network.current,tokenName:this.props.selectedToken,initSimpleID:this.props.initSimpleID,baseTokenName:this.props.selectedToken,isOpen:"welcome"===this.state.activeModal}))}}]),t}(p.Component);t.default=Be}}]);
//# sourceMappingURL=3.d5aef382.chunk.js.map