(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{4901:function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},4902:function(t,e,n){var a=n(4913),i="object"==typeof self&&self&&self.Object===Object&&self,o=a||i||Function("return this")();t.exports=o},4903:function(t,e,n){var a=n(4902).Symbol;t.exports=a},4910:function(t,e,n){"use strict";var a,i=(a=n(4911))&&"object"===typeof a&&"default"in a?a.default:a;var o=function(){var t=void 0,e=void 0;return{promise:new Promise(function(n,a){t=n,e=a}),resolve:t,reject:e}};t.exports=function(t,e,n){var a=[],s=o(),r=i(function(){try{var e=t.apply(void 0,arguments);s.resolve&&s.resolve(e)}catch(n){s.reject&&s.reject(n)}a=[],s=o()},e,n);return function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return a=a.concat(t),r.apply(void 0,[a].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(n))),s.promise}}},4911:function(t,e,n){var a=n(4901),i=n(4912),o=n(4914),s="Expected a function",r=Math.max,l=Math.min;t.exports=function(t,e,n){var c,u,p,h,d,f,m=0,g=!1,v=!1,b=!0;if("function"!=typeof t)throw new TypeError(s);function w(e){var n=c,a=u;return c=u=void 0,m=e,h=t.apply(a,n)}function y(t){var n=t-f;return void 0===f||n>=e||n<0||v&&t-m>=p}function x(){var t=i();if(y(t))return E(t);d=setTimeout(x,function(t){var n=e-(t-f);return v?l(n,p-(t-m)):n}(t))}function E(t){return d=void 0,b&&c?w(t):(c=u=void 0,h)}function k(){var t=i(),n=y(t);if(c=arguments,u=this,f=t,n){if(void 0===d)return function(t){return m=t,d=setTimeout(x,e),g?w(t):h}(f);if(v)return clearTimeout(d),d=setTimeout(x,e),w(f)}return void 0===d&&(d=setTimeout(x,e)),h}return e=o(e)||0,a(n)&&(g=!!n.leading,p=(v="maxWait"in n)?r(o(n.maxWait)||0,e):p,b="trailing"in n?!!n.trailing:b),k.cancel=function(){void 0!==d&&clearTimeout(d),m=0,c=f=u=d=void 0},k.flush=function(){return void 0===d?h:E(i())},k}},4912:function(t,e,n){var a=n(4902);t.exports=function(){return a.Date.now()}},4913:function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,n(26))},4914:function(t,e,n){var a=n(4901),i=n(4915),o=NaN,s=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(i(t))return o;if(a(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=a(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(s,"");var n=l.test(t);return n||c.test(t)?u(t.slice(2),n?2:8):r.test(t)?o:+t}},4915:function(t,e,n){var a=n(4916),i=n(4919),o="[object Symbol]";t.exports=function(t){return"symbol"==typeof t||i(t)&&a(t)==o}},4916:function(t,e,n){var a=n(4903),i=n(4917),o=n(4918),s="[object Null]",r="[object Undefined]",l=a?a.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?r:s:l&&l in Object(t)?i(t):o(t)}},4917:function(t,e,n){var a=n(4903),i=Object.prototype,o=i.hasOwnProperty,s=i.toString,r=a?a.toStringTag:void 0;t.exports=function(t){var e=o.call(t,r),n=t[r];try{t[r]=void 0;var a=!0}catch(l){}var i=s.call(t);return a&&(e?t[r]=n:delete t[r]),i}},4918:function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},4919:function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},4930:function(t,e,n){var a=n(1),i=n(117),o=n(118),s=n(19),r=n(4910),l=[{constant:!1,inputs:[{name:"targets",type:"address[]"},{name:"values",type:"uint256[]"},{name:"datas",type:"bytes[]"}],name:"batchSend",outputs:[],payable:!0,stateMutability:"payable",type:"function"}];t.exports=function(t,e,n,c){var u=new t.eth.Contract(l,e),p=[],h=r(function(){var e=s(a.mark(function e(s){var r,l,c,d;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=s.length>0?p.push(s)-1:p.length,e.next=3,Promise.all(p.map(function(t){return Promise.all(t.map(function(t){return t.method.apply(t,o(t.args?t.args:[])).estimateGas({value:t.value||0}).then(function(e){return i({},t,{args:t.args||[],gas:e,value:t.value||0})},function(t){})})).then(function(t){return t.filter(function(t){return t})})})).then(function(t){return p=t});case 3:if(!((c=(r=[]).concat.apply(r,o(p)).reduce(function(t,e){return t.datas.push(e.method.apply(e,o(e.args)).encodeABI()),t.targets.push(e.to),t.totalGas+=e.gas,t.totalValue+=e.value,t.values.push(e.value),t},{datas:[],targets:[],totalGas:0,totalValue:0,values:[]})).targets.length>0)){e.next=24;break}return d=u.methods.batchSend(c.targets,c.values,c.datas),e.t0=t.eth,e.t1=t.eth.accounts,e.t2=d.encodeABI(),e.next=11,d.estimateGas({value:c.totalValue});case 11:return e.t3=e.sent,e.t4=c.totalGas,e.t5=e.t3+e.t4,e.t6=u.options.address,e.t7=c.totalValue,e.t8={data:e.t2,gas:e.t5,to:e.t6,value:e.t7},e.t9=n,e.next=20,e.t1.signTransaction.call(e.t1,e.t8,e.t9);case 20:e.t10=e.sent.rawTransaction,e.t11=function(t){console.info("Batch receipt: ",t),(p=p.slice(l+1)).length>0&&h([])},e.t12=function(t){console.error("Batch error: ",t)},e.t0.sendSignedTransaction.call(e.t0,e.t10).on("receipt",e.t11).on("error",e.t12);case 24:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),c);return h}},4999:function(t,e,n){t.exports={radioBtn:"ProposalListFilters_radioBtn__2_8YL"}},5001:function(t,e,n){t.exports={input:"NewProposal_input__KvbCb"}},5084:function(t,e,n){"use strict";n.r(e);var a=n(33),i=n(1),o=n.n(i),s=n(11),r=n(5),l=n(6),c=n(10),u=n(7),p=n(9),h=n(0),d=n.n(h),f=n(113),m=n(3),g=n(4895),v=n(4920),b=n(306),w=n(4905),y=n(482),x=n(483),E=n(41),k=n(123),C=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(i)))).state={},n.functionsUtil=null,n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new E.a(this.props)}},{key:"componentWillMount",value:function(){var t=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils();case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=Object(s.a)(o.a.mark(function t(e,n){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils();case 1:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=null,e=null,n=null,a=this.props.fieldInfo,i=Object.assign({},this.props.proposal),o={fontWeight:3,fontSize:[0,2],color:"cellText",style:{maxWidth:"100%",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},flexProps:{justifyContent:"flex-start"}};switch(a.props&&Object.keys(a.props).length&&Object.keys(a.props).forEach(function(t){o[t]=a.props[t]}),a.name){case"date":var s=this.functionsUtil.strToMoment(1e3*i.timestamp).format("DD MMM, YYYY");n=d.a.createElement(m.u,o,s);break;case"statusIcon":switch(a.state?a.state:i.state){case"Pending":t="HourglassEmpty",e="#a5a5a5";break;case"Active":t="Adjust",e="#a5a5a5";break;case"Canceled":t="Cancel",e="#fa0000";break;case"Defeated":t="Block",e="#fa0000";break;case"Succeeded":t="Done",e="#00b84a";break;case"Queued":t="Timelapse",e="#ff9900";break;case"Expired":t="ErrorOutline",e="#a5a5a5";break;case"Executed":t="CheckCircle",e="#00b84a"}n=d.a.createElement(m.h,Object.assign({},o,{alignItems:"center",justifyContent:"center"}),d.a.createElement(m.k,{name:t,color:e,align:"center",size:o.size?o.size:this.props.isMobile?"1em":"1.8em"}));break;case"id":n=d.a.createElement(m.u,o,i.id);break;case"title":n=d.a.createElement(m.u,o,i.title);break;case"votes":var r=this.functionsUtil.BNify(i.forVotes).div(1e18),l=this.functionsUtil.BNify(i.againstVotes).div(1e18),c=r.plus(l);n=d.a.createElement(m.u,o,this.functionsUtil.formatMoney(c.toFixed(0,1),0));break;case"status":n=d.a.createElement(m.u,o,i.state);break;case"support":var u=null;if(this.props.delegate){var p=this.props.delegate.delegate.toLowerCase(),h=i.votes.find(function(t){return t.voter.toLowerCase()===p});h&&(u=h.support)}n=d.a.createElement(m.u,o,null===u?"NONE":u?"FOR":"AGAINST");break;case"forVotes":n=d.a.createElement(k.a,Object.assign({},o,{number:i.forVotes}));break;case"againstVotes":n=d.a.createElement(k.a,Object.assign({},o,{number:i.againstVotes}))}return n}}]),e}(h.Component),j=n(103),O=n(34),D=n(4999),U=n.n(D),S=n(47),I=n(780),P=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(i)))).state={maxWidth:.4,minWidth:.18,maxHeight:425,isOpened:!1,activeFilters:{status:null,assets:null,actions:null}},n.setFilter=function(t,e){n.setState(function(n){return{activeFilters:Object(O.a)({},n.activeFilters,Object(j.a)({},t,e))}})},n.applyFilters=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];"function"===typeof n.props.applyFilters&&n.props.applyFilters(n.state.activeFilters),t&&n.toggleOpened()},n.resetFilter=function(t){n.setState(function(e){return{activeFilters:Object(O.a)({},e.activeFilters,Object(j.a)({},t,null))}},function(){n.applyFilters(!1)})},n.resetFilters=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.setState({activeFilters:{status:null,assets:null,actions:null}},function(){"function"===typeof n.props.resetFilters&&n.props.resetFilters(),t&&n.toggleOpened()})},n.toggleOpened=function(){n.setState(function(t){return{isOpened:!t.isOpened}})},n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this;return d.a.createElement(m.h,{mb:3,top:0,width:1,zIndex:1,flexDirection:"column",alignItems:"flex-start",justifyContent:"center",position:["relative","absolute"]},d.a.createElement(S.a,{cardProps:{py:2,px:3,width:[1,this.state.isOpened?this.state.maxWidth:this.state.minWidth],style:{transition:"width 0.3s ease-in-out"}},isInteractive:!this.state.isOpened,handleClick:this.state.isOpened?null:this.toggleOpened},d.a.createElement(m.h,{width:1,style:{cursor:"pointer"},alignItems:"center",flexDirection:"row",justifyContent:"space-between",onClick:this.state.isOpened?this.toggleOpened:null},d.a.createElement(m.u,{fontSize:2,fontWeight:500,color:"copyColor"},"Filters"),d.a.createElement(m.k,{color:"copyColor",size:this.props.isMobile?"1.3em":"1.5em",name:this.state.isOpened?"Close":"Tune"})),d.a.createElement(m.h,{flexDirection:"column",style:{overflow:"hidden",transition:"max-height 0.3s ease-in-out",maxHeight:this.state.isOpened?this.state.maxHeight:0}},d.a.createElement(m.h,{mt:2,py:2,width:1,flexDirection:"row",borderTop:"1px solid ".concat(this.props.theme.colors.divider)},Object.keys(this.props.filters).map(function(e){var n=t.props.filters[e];return d.a.createElement(m.h,{flexDirection:"column",key:"filter_".concat(e),style:{flexBasis:"0",flex:"1 1 0px"}},d.a.createElement(I.a,{pb:2,fontWeight:3,fontSize:[0,2],color:"cellText"},e.toUpperCase()),Object.keys(n).map(function(a){var i=n[a],o=t.state.activeFilters[e]===a;return d.a.createElement(m.s,{my:2,fontSize:[0,2],label:i,checked:o,className:U.a.radioBtn,key:"filter_".concat(e,"_").concat(a),onChange:function(n){return t.setFilter(e,a)}})}))})),d.a.createElement(m.h,{flexDirection:"row"},d.a.createElement(m.c.Text,{fontWeight:4,fontSize:[2,3],mainColor:"copyColor",onClick:this.applyFilters},"Apply filters"),d.a.createElement(m.c.Text,{ml:3,fontWeight:4,fontSize:[2,3],mainColor:"copyColor",onClick:this.resetFilters},"Reset")))),!this.state.isOpened&&this.props.activeFilters&&Object.values(this.props.activeFilters).filter(function(t){return null!==t}).length>0&&d.a.createElement(m.h,{mt:3,width:1,flexDirection:["column","row"],alignItems:["flex-start","flex-end"],justifyContent:["flex-end","flex-start"]},Object.keys(this.props.activeFilters).map(function(e){var n=t.props.activeFilters[e];if(null!==n){var a=t.props.filters[e][n];return d.a.createElement(S.a,{cardProps:{py:2,px:3,mb:[2,0],mr:[0,3],width:[1,t.state.minWidth]},isInteractive:!0,key:"filter_".concat(e)},d.a.createElement(m.h,{width:1,style:{cursor:"pointer"},alignItems:"center",flexDirection:"row",justifyContent:"space-between",onClick:function(n){return t.resetFilter(e)}},d.a.createElement(m.u,{fontSize:2,fontWeight:500,color:"cellText",style:{textTransform:"capitalize"}},a),d.a.createElement(m.k,{name:"Close",color:"cellText",size:t.props.isMobile?"1.3em":"1.5em"})))}return null}),d.a.createElement(m.n,{mt:[2,0],fontSize:[3,2],fontWeight:[3],color:"dark-gray",hoverColor:"copyColor",textAlign:["center","left"],onClick:function(e){return t.resetFilters(!1)}},"Clear all filters")))}}]),e}(h.Component),A=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(i)))).state={page:1,loading:!0,rowsPerPage:10,totalRows:null,totalPages:null,activeFilters:{status:null},filters:{status:{pending:"Pending",active:"Active",canceled:"Canceled",defeated:"Defeated",succeeded:"Succeeded",queued:"Queued",expired:"Expired",executed:"Executed"}},processedRows:null,lastBlockNumber:null},n.functionsUtil=null,n.applyFilters=function(t){n.setState({activeFilters:t},function(){n.processList()})},n.resetFilters=function(){n.setState({activeFilters:{status:null}},function(){n.processList()})},n.processList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!n.props.proposals)return!1;t=t||n.state.page;var e=n.props.rowsPerPage?n.props.rowsPerPage:n.state.rowsPerPage,a=Object.values(n.props.proposals).filter(function(t){return null===n.state.activeFilters.status||t.state.toLowerCase()===n.state.activeFilters.status.toLowerCase()}).sort(function(t,e){return t.timestamp>e.timestamp?-1:1}),i=a.length,o=Math.ceil(i/e),s=[];a.forEach(function(n,a){a>=(t-1)*e&&a<(t-1)*e+e&&s.push(n)});n.setState({loading:!1,totalRows:i,totalPages:o,processedRows:s})},n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new E.a(this.props)}},{key:"prevPage",value:function(t){t&&t.preventDefault();var e=Math.max(1,this.state.page-1);this.setState({page:e})}},{key:"nextPage",value:function(t){t&&t.preventDefault();var e=Math.min(this.state.totalPages,this.state.page+1);this.processList(e),this.setState({page:e})}},{key:"componentDidMount",value:function(){var t=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),this.processList();case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=Object(s.a)(o.a.mark(function t(e,n){var a,i;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),a=n.page!==this.state.page,i=JSON.stringify(e.proposals)!==JSON.stringify(this.props.proposals),(a||i)&&this.processList();case 4:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this,e="undefined"===typeof this.props.filtersEnabled||this.props.filtersEnabled,n=e&&Object.values(this.state.activeFilters).filter(function(t){return null!==t}).length>0,a=this.state.processedRows?Object.values(this.state.processedRows):null,i=a&&a.length>0;return d.a.createElement(m.h,{flexDirection:"column",width:1,m:"0 auto"},this.state.loading||null===!this.state.processedRows?d.a.createElement(f.a,{flexProps:{minHeight:"50vh",flexDirection:"row"},loaderProps:{size:"30px"},textProps:{ml:2},text:"Loading Proposals..."}):d.a.createElement(m.h,{width:1,position:"relative",flexDirection:"column",id:"proposals-list-container",pt:[0,e&&i?n?"116px":5:0]},i?d.a.createElement(m.h,{width:1,flexDirection:"column"},e&&d.a.createElement(P,Object.assign({},this.props,{filters:this.state.filters,activeFilters:this.state.activeFilters,resetFilters:this.resetFilters.bind(this),applyFilters:this.applyFilters.bind(this)})),d.a.createElement(x.a,{cols:this.props.cols,isMobile:this.props.isMobile}),d.a.createElement(m.h,{id:"proposals-list",flexDirection:"column"},a.map(function(e,n){var a=e.id;return d.a.createElement(y.a,Object.assign({},t.props,{rowProps:{isInteractive:!0},id:a,proposal:e,handleClick:function(e){return a?t.props.goToSection("proposals/".concat(a)):null},key:"proposal-".concat(a),fieldComponent:C,rowId:"proposal-col-".concat(a),cardId:"proposal-card-".concat(a)}))})),d.a.createElement(m.h,{height:"50px",alignItems:"center",flexDirection:"row",justifyContent:"flex-end",id:"proposals-list-pagination"},d.a.createElement(m.h,{mr:3},d.a.createElement(m.n,{mr:1,onClick:function(e){return t.prevPage(e)}},d.a.createElement(m.k,{name:"KeyboardArrowLeft",size:"2em",color:this.state.page>1?"pageActive":"pageInactive"})),d.a.createElement(m.n,{onClick:function(e){return t.nextPage(e)}},d.a.createElement(m.k,{name:"KeyboardArrowRight",size:"2em",color:this.state.page<this.state.totalPages?"pageActive":"pageInactive"}))),d.a.createElement(m.h,{alignItems:"center"},d.a.createElement(m.u,{fontSize:1,fontWeight:3,color:"cellText"},"Page ",this.state.page," of ",this.state.totalPages)))):d.a.createElement(m.j.h3,{fontWeight:2,fontSize:[2,3],color:"dark-gray",textAlign:"center",fontFamily:"sansSerif"},"There are no proposals")))}}]),e}(h.Component),T=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(i)))).state={value:null},n.functionsUtil=null,n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new E.a(this.props)}},{key:"componentWillMount",value:function(){var t=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),this.loadData();case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=Object(s.a)(o.a.mark(function t(e,n){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),JSON.stringify(e.delegate)!==JSON.stringify(this.props.delegate)&&this.loadData();case 3:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"loadData",value:function(){var t=Object(s.a)(o.a.mark(function t(){var e,n,a,i;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this.props.fieldInfo,n=Object.assign({},this.props.delegate),a=n[e.name],t.t0=e.name,t.next="votes"===t.t0?6:"delegate"===t.t0?8:13;break;case 6:return a=this.functionsUtil.formatMoney(this.functionsUtil.BNify(a).toFixed(2,1),2),t.abrupt("break",14);case 8:return t.next=10,this.functionsUtil.getENSName(a);case 10:return i=t.sent,a=i||a,t.abrupt("break",14);case 13:return t.abrupt("break",14);case 14:this.setState({value:a});case 15:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=null,e=this.props.fieldInfo,n=Object.assign({},this.props.delegate),a={fontWeight:3,fontSize:[0,2],color:"cellText",style:{maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis"},flexProps:{justifyContent:"flex-start"}};switch(e.props&&Object.keys(e.props).length&&Object.keys(e.props).forEach(function(t){a[t]=e.props[t]}),e.name){case"avatar":t=d.a.createElement(m.h,Object.assign({},a,{alignItems:"center",justifyContent:"center"}),d.a.createElement(m.a,{opts:{size:7,color:"#dfe",bgcolor:"#a71",spotcolor:"#000",seed:n.delegate}}));break;default:t=null!==this.state.value?d.a.createElement(m.u,a,this.state.value):d.a.createElement(m.o,{size:"20px"})}return t}}]),e}(h.Component),F=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(i)))).state={page:1,filters:{},loading:!0,rowsPerPage:10,totalRows:null,totalPages:null,activeFilters:{},processedRows:null,lastBlockNumber:null},n.functionsUtil=null,n.applyFilters=function(t){n.setState({activeFilters:t},function(){n.processList()})},n.resetFilters=function(){n.setState({activeFilters:{status:null}},function(){n.processList()})},n.processList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!n.props.delegates)return!1;t=t||n.state.page;var e=n.props.rowsPerPage?n.props.rowsPerPage:n.state.rowsPerPage,a=Object.values(n.props.delegates).sort(function(t,e){return t.timestamp>e.timestamp?-1:1});null!==n.props.maxRows&&n.props.maxRows>0&&(a=a.splice(0,n.props.maxRows));var i=a.length,o=Math.ceil(i/e),s=[];a.forEach(function(n,a){a>=(t-1)*e&&a<(t-1)*e+e&&s.push(n)});n.setState({loading:!1,totalRows:i,totalPages:o,processedRows:s})},n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new E.a(this.props)}},{key:"prevPage",value:function(t){t&&t.preventDefault();var e=Math.max(1,this.state.page-1);this.setState({page:e})}},{key:"nextPage",value:function(t){t&&t.preventDefault();var e=Math.min(this.state.totalPages,this.state.page+1);this.processList(e),this.setState({page:e})}},{key:"componentDidMount",value:function(){var t=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),this.processList();case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=Object(s.a)(o.a.mark(function t(e,n){var a,i;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),a=n.page!==this.state.page,i=JSON.stringify(e.delegates)!==JSON.stringify(this.props.delegates),(a||i)&&this.processList();case 4:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this,e=this.state.processedRows?Object.values(this.state.processedRows):null;return d.a.createElement(m.h,{flexDirection:"column",width:1,m:"0 auto"},this.state.loading||null===!this.state.processedRows?d.a.createElement(f.a,{flexProps:{minHeight:"50vh",flexDirection:"row"},loaderProps:{size:"30px"},textProps:{ml:2},text:"Loading Leaderboard..."}):d.a.createElement(m.h,{width:1,position:"relative",flexDirection:"column",id:"delegates-list-container"},e&&e.length>0?d.a.createElement(m.h,{width:1,flexDirection:"column"},d.a.createElement(x.a,{cols:this.props.cols,isMobile:this.props.isMobile}),d.a.createElement(m.h,{id:"delegates-list",flexDirection:"column"},e.map(function(e,n){var a=e.delegate;return d.a.createElement(y.a,Object.assign({},t.props,{rowProps:{isInteractive:!0},id:a,delegate:e,key:"delegate-".concat(n),handleClick:function(e){return a?t.props.goToSection("leaderboard/".concat(a)):null},fieldComponent:T,rowId:"delegate-col-".concat(n),cardId:"delegate-card-".concat(n)}))})),d.a.createElement(m.h,{height:"50px",alignItems:"center",flexDirection:"row",justifyContent:"flex-end",id:"delegates-list-pagination"},d.a.createElement(m.h,{mr:3},d.a.createElement(m.n,{mr:1,onClick:function(e){return t.prevPage(e)}},d.a.createElement(m.k,{size:"2em",name:"KeyboardArrowLeft",color:this.state.page>1?"pageActive":"pageInactive"})),d.a.createElement(m.n,{onClick:function(e){return t.nextPage(e)}},d.a.createElement(m.k,{size:"2em",name:"KeyboardArrowRight",color:this.state.page<this.state.totalPages?"pageActive":"pageInactive"}))),d.a.createElement(m.h,{alignItems:"center"},d.a.createElement(m.u,{fontSize:1,fontWeight:3,color:"cellText"},"Page ",this.state.page," of ",this.state.totalPages)))):d.a.createElement(m.j.h3,{fontWeight:2,fontSize:[2,3],color:"dark-gray",textAlign:"center",fontFamily:"sansSerif"},"There are no delegates")))}}]),e}(h.Component),M=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(i)))).state={delegates:[],proposals:[],totalSupply:0,dataLoaded:!1,votesDelegated:0},n.functionsUtil=null,n.governanceUtil=null,n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"loadUtils",value:function(){this.governanceUtil?this.governanceUtil.setProps(this.props):this.governanceUtil=new g.a(this.props),this.functionsUtil=this.governanceUtil.functionsUtil}},{key:"componentWillMount",value:function(){var t=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),this.loadData();case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=Object(s.a)(o.a.mark(function t(e,n){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils();case 1:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"loadData",value:function(){var t=Object(s.a)(o.a.mark(function t(){var e,n,i,s,r,l;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([this.governanceUtil.getDelegates(),this.governanceUtil.getProposals(),this.governanceUtil.getTotalSupply()]);case 2:e=t.sent,n=Object(a.a)(e,3),i=n[0],s=n[1],r=n[2],l=i.reduce(function(t,e){return t+=parseFloat(e.votes)},0),!0,this.setState({delegates:i,proposals:s,dataLoaded:!0,totalSupply:r,votesDelegated:l});case 10:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return d.a.createElement(m.b,{width:1},d.a.createElement(b.a,{mb:[3,4]},"Governance Overview"),this.state.dataLoaded?d.a.createElement(m.b,{width:1},d.a.createElement(m.h,{width:1,mb:[3,4],alignItems:"center",justifyContent:"center",flexDirection:["column","row"]},d.a.createElement(m.h,{mb:[2,0],pr:[0,1],width:[1,.25],flexDirection:"column"},d.a.createElement(w.a,{label:null,labelTooltip:null,title:"Votes Delegated",minHeight:["130px","143px"],titleMinHeight:["auto","50px"],value:this.functionsUtil.formatMoney(this.state.votesDelegated.toFixed(2,1),2)})),d.a.createElement(m.h,{mb:[2,0],pl:[0,1],pr:[0,1],width:[1,.25],flexDirection:"column"},d.a.createElement(w.a,{label:null,labelTooltip:null,title:"Voting Addresses",minHeight:["130px","143px"],titleMinHeight:["auto","50px"],value:this.state.delegates.length})),d.a.createElement(m.h,{mb:[2,0],pl:[0,1],pr:[0,1],width:[1,.25],flexDirection:"column"},d.a.createElement(w.a,{label:null,labelTooltip:null,title:"Proposals",minHeight:["130px","143px"],titleMinHeight:["auto","50px"],value:this.state.proposals.length})),d.a.createElement(m.h,{pl:[0,1],mb:[2,0],width:[1,.25],flexDirection:"column"},d.a.createElement(w.a,{label:null,labelTooltip:null,title:"IDLE Circulating",minHeight:["130px","143px"],titleMinHeight:["auto","50px"],value:this.functionsUtil.formatMoney(this.state.totalSupply,0)}))),d.a.createElement(m.b,{width:1,mt:[4,5]},d.a.createElement(b.a,{mb:[3,4]},"Recent Proposals"),d.a.createElement(m.h,{mb:[3,4],width:1,id:"transactions",flexDirection:"column"},d.a.createElement(A,Object.assign({},this.props,{rowsPerPage:5,filtersEnabled:!1,proposals:this.state.proposals,cols:[{title:"#",props:{width:[.1,.05]},fields:[{name:"id",props:{}}]},{title:"DATE",mobile:!1,props:{width:[.15,.12]},fields:[{name:"date"}]},{title:"TITLE",props:{width:[.75,.6]},fields:[{name:"title"}]},{mobile:!1,title:"VOTES",props:{width:[.11,.11]},fields:[{name:"votes"}]},{title:"STATUS",props:{width:[.15,.12],alignItems:["center","flex-start"],justifyContent:["center","flex-start"]},parentProps:{justifyContent:["center","flex-start"]},fields:[{name:"statusIcon",props:{mr:[0,2]}},{mobile:!1,name:"status"}]}]})))),d.a.createElement(m.b,{width:1},d.a.createElement(b.a,{mb:[3,4]},"Leaderboard"),d.a.createElement(m.h,{mb:[3,4],width:1,id:"transactions",flexDirection:"column"},d.a.createElement(F,Object.assign({maxRows:100},this.props,{rowsPerPage:5,delegates:this.state.delegates,cols:[{title:"RANK",props:{width:[.13,.08]},fields:[{name:"rank"}]},{title:"ADDRESS",props:{width:[.6,.5]},fields:[{mobile:!1,name:"avatar",props:{mr:2}},{name:"delegate"}]},{title:"VOTES",props:{width:[.27,.12]},fields:[{name:"votes"}]},{mobile:!1,title:"VOTE WEIGHT",props:{width:[.15,.15]},fields:[{name:"vote_weight",parentProps:{alignItems:"center"}}]},{mobile:!1,title:"PROPOSALS VOTED",props:{width:[.15,.15]},fields:[{name:"proposals",parentProps:{alignItems:"center"}}]}]}))))):d.a.createElement(f.a,{flexProps:{minHeight:"50vh",flexDirection:"row"},loaderProps:{size:"30px"},textProps:{ml:2},text:"Loading Data..."}))}}]),e}(h.Component),z=n(4897),B=n(1177),H=n(143),V=n(217),W=n(4931),L=n.n(W),N=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(i)))).state={newDelegate:"",processing:{txHash:null,loading:!1}},n.functionsUtil=null,n.governanceUtil=null,n.checkNewDelegate=function(){return n.functionsUtil.checkAddress(n.state.newDelegate)&&n.state.newDelegate.toLowerCase()!==n.props.currentDelegate.toLowerCase()},n.changeDelegate=function(t){var e=t.target.value;n.setState({newDelegate:e})},n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"loadUtils",value:function(){this.governanceUtil?this.governanceUtil.setProps(this.props):this.governanceUtil=new g.a(this.props),this.functionsUtil=this.governanceUtil.functionsUtil}},{key:"componentWillMount",value:function(){var t=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils();case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=Object(s.a)(o.a.mark(function t(e,n){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils();case 1:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"cancelTransaction",value:function(){var t=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.setState({processing:{txHash:null,loading:!1}});case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"setDelegate",value:function(t){var e=this;if(this.functionsUtil.checkAddress(t)){this.governanceUtil.setDelegate(t,function(n,a){var i={eventCategory:"Delegate",eventAction:t,eventLabel:n.status};a&&(i.eventLabel=e.functionsUtil.getTransactionError(a)),(a||"error"!==i.status)&&e.functionsUtil.sendGoogleAnalyticsEvent(i),"function"===typeof e.props.loadUserData&&"success"===n.status&&e.props.loadUserData(),e.setState({processing:{txHash:null,loading:!1}})},function(t){var n=t.transactionHash;e.setState(function(t){return{processing:Object(O.a)({},t.processing,{txHash:n})}})}),this.setState(function(t){return{processing:Object(O.a)({},t.processing,{loading:!0})}})}return null}},{key:"render",value:function(){var t=this,e=0===parseInt(this.props.currentDelegate);return d.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},this.props.account?this.props.currentDelegate?d.a.createElement(S.a,{cardProps:{mb:2,py:[2,3],px:[3,4],width:[1,.5],position:"relative"},isInteractive:!1},this.props.canClose&&d.a.createElement(m.b,{top:"0",zIndex:1,right:"0",position:"absolute"},d.a.createElement(m.c.Text,{icononly:!0,icon:"Close",size:"2.5em",mainColor:"statValue",onClick:this.props.closeFunc})),d.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},d.a.createElement(m.u,{mb:1,fontWeight:3,color:"statValue",textAlign:"center"},"Current Delegate:"),d.a.createElement(m.h,{mb:3,width:1,alignItems:"center",justifyContent:e?"center":"stretch"},e?d.a.createElement(m.u,{fontWeight:3,fontSize:[1,2],color:"dark-gray",textAlign:"center"},"Undelegated"):d.a.createElement(m.f,{width:1,address:this.props.currentDelegate,className:"light"===this.props.themeMode?L.a.ethInput:L.a.ethInputDark})),this.state.processing&&this.state.processing.loading?d.a.createElement(m.h,{width:1,flexDirection:"column"},d.a.createElement(V.a,{web3:this.props.web3,waitText:"Delegate estimated in",hash:this.state.processing.txHash,endMessage:"Finalizing delegate request...",cancelTransaction:this.cancelTransaction.bind(this)})):d.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},d.a.createElement(m.u,{mb:1,fontWeight:3,color:"statValue",textAlign:"center"},"Set New Delegate:"),d.a.createElement(m.m,{min:0,type:"text",width:"100%",required:!0,height:"3.4em",borderRadius:2,fontWeight:500,textAlign:"center",borderColor:"cardBorder",backgroundColor:"cardBg",boxShadow:"none !important",value:this.state.newDelegate,placeholder:"Insert delegate address",onChange:this.changeDelegate.bind(this),border:"1px solid ".concat(this.props.theme.colors.divider)}),d.a.createElement(m.h,{mt:3,width:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},d.a.createElement(H.a,{buttonProps:{mx:1,fontSize:[1,2],width:["auto","10em"],disabled:!this.checkNewDelegate()},handleClick:function(e){return t.setDelegate(t.state.newDelegate)}},"Delegate"),d.a.createElement(H.a,{buttonProps:{mx:1,fontSize:[1,2],width:["auto","10em"],mainColor:this.props.theme.colors.redeem,disabled:this.props.currentDelegate.toLowerCase()===this.props.account.toLowerCase()},handleClick:function(e){return t.setDelegate(t.props.account)}},"Self-delegate"))))):d.a.createElement(f.a,{flexProps:{minHeight:"50vh",flexDirection:"row"},loaderProps:{size:"30px"},textProps:{ml:2},text:"Loading Delegate..."}):d.a.createElement(m.h,{width:[1,.36],alignItems:"stretch",flexDirection:"column",justifyContent:"center"},d.a.createElement(B.a,this.props)))}}]),e}(h.Component),R=function(t){function e(){return Object(r.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this;return d.a.createElement(m.b,{width:1},d.a.createElement(m.h,{mb:3,width:1,alignItems:"center",flexDirection:"row",justifyContent:"flex-start"},d.a.createElement(z.a,Object.assign({},this.props,{text:"Governance",path:["Delegate votes"],isMobile:this.props.isMobile,handleClick:function(e){return t.props.goToSection("")}}))),d.a.createElement(m.b,{width:1},d.a.createElement(b.a,{mb:[3,4]},"Delegate Votes"),d.a.createElement(m.h,{px:[0,3],mb:[3,4],width:1,flexDirection:"column",id:"delegate-container"},d.a.createElement(N,this.props))))}}]),e}(h.Component),_=n(5001),G=n.n(_),q=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(i)))).state={title:"",actions:[],txError:!1,actionValue:0,customABI:null,description:"",processing:{txHash:null,loading:!1},validated:!1,newAction:!1,editAction:null,actionInputs:null,actionValid:!1,customAddress:null,contractOptions:[],proposalCreated:!1,functionsOptions:null,selectedContract:null,selectedFunction:null,selectedSignature:null,availableFunctions:null,availableContracts:null},n.functionsUtil=null,n.governanceUtil=null,n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"loadUtils",value:function(){this.governanceUtil?this.governanceUtil.setProps(this.props):this.governanceUtil=new g.a(this.props),this.functionsUtil=this.governanceUtil.functionsUtil}},{key:"componentWillMount",value:function(){var t=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),this.loadData();case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=Object(s.a)(o.a.mark(function t(e,n){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),this.validateForm(),this.checkInputs(),n.customABI!==this.state.customABI&&"custom"===this.state.selectedContract&&this.loadFunctionsOptions();case 5:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"loadData",value:function(){var t=this.functionsUtil.getGlobalConfig(["governance","props","availableContracts"]),e=[{label:"Select a Contract",value:null}];Object.keys(t).forEach(function(t){e.push({label:t,value:t})}),e.push({label:"Custom",value:"custom"}),this.setState({contractOptions:e,availableContracts:t})}},{key:"handleInput",value:function(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=e.target.value;this.setState(Object(j.a)({},t,n))}},{key:"validateForm",value:function(){var t=this.state.title.length>0&&this.state.description.length>0&&Object.values(this.state.actions).length>0;t!==this.state.validated&&this.setState({validated:t})}},{key:"getContractABI",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t=t||this.state.selectedContract;var e=null;try{e="custom"===t?JSON.parse(this.state.customABI):this.state.availableContracts[t]}catch(n){}return e}},{key:"loadFunctionsOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=null,n=null,a=this.getContractABI(t);a&&(e=(n=a.filter(function(t){return!t.constant&&"function"===t.type&&t.inputs.length>0&&["nonpayable","payable"].includes(t.stateMutability)})).map(function(t,e){return{label:t.name,value:e}})).unshift({label:"Select a Function",value:null}),this.setState({actionInputs:null,functionsOptions:e,selectedFunction:null,selectedSignature:null,availableFunctions:n})}},{key:"changeContract",value:function(t){var e=t.target.value;if(e!==this.state.selectedContract){var n={selectedContract:e,selectedFunction:null,selectedSignature:null};if(null!==e)this.getContractABI(e)?this.loadFunctionsOptions(e):n.functionsOptions=null;this.setState(n)}}},{key:"changeFunction",value:function(t){var e=null,n=t.target.value,a=this.state.availableFunctions.find(function(t,e){return e===parseInt(n)});a?e=new Array(a.inputs.length):a=null,this.setState({actionValue:0,actionInputs:e,selectedFunction:a,selectedSignature:n})}},{key:"validateField",value:function(t,e){if(null===t)return!1;var n=!0;if("json"===e)n=this.functionsUtil.isValidJSON(t);else{var a=this.getPatternByFieldType(e);a&&(n=null!==t.toString().match(a))}return n}},{key:"getPatternByFieldType",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null;switch(t){case"address":n="^0x[a-fA-F0-9]{40}$";break;case"address[]":n="^((0x[a-fA-F0-9]{40})[,]?)+$";break;case"string":n="[\\w]+";break;case"bool":n="(0|1)";break;case"uint256":case"uint8":n="[\\d]+";break;default:n=null}return!e&&n&&(n=new RegExp(n)),n}},{key:"checkInputs",value:function(){var t=this;if(!this.state.actionInputs||!this.state.selectedFunction)return!1;var e=this.state.selectedFunction.inputs,n=Object.values(this.state.actionInputs).length===e.length;n&&Object.values(this.state.actionInputs).forEach(function(a,i){var o=e[i],s=t.getPatternByFieldType(o.type),r=!s||null!==a.match(s);n=n&&r}),n&&"custom"===this.state.selectedContract&&(n=n&&this.validateField(this.state.customABI,"json")&&this.validateField(this.state.customAddress,"address")),n!==this.state.actionValid&&this.setState({actionValid:n})}},{key:"valueChange",value:function(t,e){var n=t.target.value;this.setState({actionValue:n})}},{key:"inputChange",value:function(t,e){var n=t.target.value;this.setState(function(t){return{actionInputs:Object(O.a)({},t.actionInputs,Object(j.a)({},e,n))}})}},{key:"deleteAction",value:function(){if(null!==this.state.editAction){var t=this.state.actions;if(t[this.state.editAction]){delete t[this.state.editAction],t=Object.values(t);this.setState({actions:t,editAction:null,actionInputs:null,selectedContract:null,selectedFunction:null,selectedSignature:null})}}}},{key:"addAction",value:function(){var t=this,e=Object.values(this.state.actionInputs).filter(function(t){return t.length>0}).map(function(e,n){var a=t.state.selectedFunction.inputs[n];switch(a.type){case"address[]":e=e.split(",");break;case"uint256[]":e=e.split(",").map(function(e){return t.functionsUtil.toBN(e)});break;case"uint256":e=t.functionsUtil.toBN(e);break;default:"[]"===a.type.substr(-2)&&(e=e.split(","))}return e});if(e.length<this.state.selectedFunction.inputs.length)return!1;var n=null;if("custom"!==this.state.selectedContract){var a=this.functionsUtil.getContractByName(this.state.selectedContract);if(!a)return!1;n=a._address}else{if(!this.functionsUtil.isValidJSON(this.state.customABI))return!1;n=this.state.customAddress}var i=this.state.customABI,o=this.state.customAddress,s=this.state.selectedFunction.inputs.map(function(t){return t.type}),r=this.props.web3.eth.abi.encodeParameters(s,e),l=this.state.selectedFunction.name+"("+s.join(",")+")",c={params:{value:this.state.actionValue?this.functionsUtil.BNify(this.state.actionValue).toFixed(0):this.functionsUtil.BNify(0).toFixed(0),target:n,calldata:r,signature:l},customABI:i,customAddress:o,inputs:this.state.actionInputs,function:this.state.selectedFunction,contract:this.state.selectedContract,signature:this.state.selectedSignature},u=Object.values(this.state.actions);null===this.state.editAction?u.push(c):u[this.state.editAction]=c;this.setState({actions:u,newAction:!1,editAction:null})}},{key:"setEditAction",value:function(t){if(!this.state.actions[t])return!1;if(t===this.state.editAction)return!1;var e=this.state.actions[t],n=e.inputs,a=e.customABI,i=e.params.value,o=e.contract,s=e.function,r=e.customAddress,l=e.signature;this.setState({customABI:a,newAction:!1,editAction:t,actionValue:i,actionInputs:n,customAddress:r,selectedContract:o,selectedFunction:s,selectedSignature:l})}},{key:"setNewAction",value:function(t){if(t===this.state.newAction)return!1;this.setState({newAction:t,editAction:null,selectedContract:null,selectedFunction:null})}},{key:"cancelTransaction",value:function(){var t=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.setState({processing:{txHash:null,loading:!1}});case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"handleSubmit",value:function(t){var e=this;t.preventDefault();var n=[],a=[],i=[],o=[],s="#"+this.state.title+"\n"+this.state.description;return Object.values(this.state.actions).forEach(function(t){a.push(t.params.value),n.push(t.params.target),o.push(t.params.calldata),i.push(t.params.signature)}),this.governanceUtil.propose(n,a,i,o,s,function(t,n){var a={eventLabel:t.status,eventAction:"propose",eventCategory:"Proposal"};n&&(a.eventLabel=e.functionsUtil.getTransactionError(n)),(n||"error"!==a.status)&&e.functionsUtil.sendGoogleAnalyticsEvent(a);var i={processing:{txHash:null,loading:!1}};"success"===t.status?(i.actionValue=0,i.customABI=null,i.newAction=null,i.editAction=null,i.actionInputs=null,i.customAddress=null,i.proposalCreated=!0,i.selectedContract=null,i.functionsOptions=null,i.selectedFunction=null,i.selectedSignature=null):i.txError=!0,e.setState(i)},function(t){var n=t.transactionHash;e.setState(function(t){return{processing:Object(O.a)({},t.processing,{txHash:n})}})}),this.setState(function(t){return{processing:Object(O.a)({},t.processing,{loading:!0})}}),!1}},{key:"formValidated",value:function(){}},{key:"render",value:function(){var t=this;return d.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},d.a.createElement(b.a,{mb:[3,4]},"Create Proposal"),this.state.proposalCreated?d.a.createElement(S.a,{cardProps:{py:3,px:4,width:[1,"auto"]}},d.a.createElement(m.h,{alignItems:"center",flexDirection:"column",justifyContent:"center"},d.a.createElement(m.k,{name:"Done",align:"center",size:this.props.isMobile?"1.4em":"2.2em",color:this.props.theme.colors.transactions.status.completed}),d.a.createElement(m.u,{mt:1,fontWeight:3,fontSize:[2,3],color:"dark-gray",textAlign:"center"},"The proposal has been successfully created"))):this.props.votes&&this.functionsUtil.BNify(this.props.votes).gte(this.props.proposalThreshold)?d.a.createElement(m.i,{width:1,validated:this.state.validated,onSubmit:this.handleSubmit.bind(this)},d.a.createElement(m.h,{mb:2,width:1,flexDirection:["column","row"],justifyContent:["center","space-between"]},d.a.createElement(m.h,{width:[1,.48],flexDirection:"column"},d.a.createElement(m.h,{pb:2,width:1,mb:[2,3],borderColor:"divider",borderBottom:"1px solid transparent"},d.a.createElement(m.j.h4,{fontSize:[2,3],fontWeight:[2,3]},"Proposal Description")),d.a.createElement(m.h,{flexDirection:"column"},d.a.createElement(m.g,{width:1,label:"Title",validated:this.state.validated},d.a.createElement(m.m,{required:!0,width:1,type:"text",className:G.a.input,value:this.state.title,borderColor:"cardBorder",backgroundColor:"cardBg",placeholder:"Title of your proposal",onChange:function(e){return t.handleInput("title",e)}}))),d.a.createElement(m.h,{flexDirection:"column"},d.a.createElement(m.g,{width:1,label:"Description",validated:this.state.validated},d.a.createElement(m.v,{required:!0,rows:8,width:1,className:G.a.input,borderColor:"cardBorder",backgroundColor:"cardBg",value:this.state.description,placeholder:"Description of your proposal",onChange:function(e){return t.handleInput("description",e)}})))),d.a.createElement(m.h,{width:[1,.48],flexDirection:"column"},d.a.createElement(m.h,{pb:2,width:1,mb:[2,3],borderColor:"divider",borderBottom:"1px solid transparent"},d.a.createElement(m.j.h4,{fontSize:[2,3],fontWeight:[2,3]},"Actions")),d.a.createElement(m.h,{flexDirection:"column"},Object.values(this.state.actions).map(function(e,n){return d.a.createElement(S.a,{cardProps:{py:2,px:3,mb:3,width:1},titleParentProps:{ml:0,my:1,justifyContent:"center"},titleProps:{fontSize:2,fontWeight:3},isInteractive:!0,key:"action_".concat(n),handleClick:function(e){return t.setEditAction(n)},title:t.state.editAction===n?"Edit Action":null},t.state.editAction===n?d.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},d.a.createElement(m.g,{style:{width:"100%",display:"flex",alignItems:"stretch",flexDirection:"column"},label:"Select Contract"},d.a.createElement(m.t,{style:{width:"100%",color:t.props.theme.colors.counter,backgroundColor:t.props.theme.colors.cardBg},required:!0,value:t.state.selectedContract,options:t.state.contractOptions,onChange:t.changeContract.bind(t)})),t.state.selectedContract&&"custom"===t.state.selectedContract&&d.a.createElement(m.h,{width:1,flexDirection:"column"},d.a.createElement(m.g,{width:1,label:"Contract Address",validated:t.state.validated},d.a.createElement(m.m,{required:!0,width:1,type:"text",className:G.a.input,borderColor:"cardBorder",backgroundColor:"cardBg",placeholder:"Custom contract address",pattern:t.getPatternByFieldType("address",!0),onChange:function(e){return t.handleInput("customAddress",e,"address")},value:t.state.customAddress?t.state.customAddress:""})),d.a.createElement(m.g,{width:1,label:"Custom ABI",validated:t.state.validated},d.a.createElement(m.v,{required:!0,rows:8,width:1,className:G.a.input,placeholder:"Insert the ABI of your contract",onChange:function(e){return t.handleInput("customABI",e,"json")},value:t.state.customABI?t.state.customABI:""}))),t.state.selectedContract&&t.state.functionsOptions&&d.a.createElement(m.g,{style:{width:"100%",display:"flex",alignItems:"stretch",flexDirection:"column"},label:"Select Function"},d.a.createElement(m.t,{style:{width:"100%",color:t.props.theme.colors.counter,backgroundColor:t.props.theme.colors.cardBg},required:!0,options:t.state.functionsOptions,onChange:t.changeFunction.bind(t),value:t.state.selectedSignature?t.state.selectedSignature:""})),t.state.selectedFunction&&t.state.selectedFunction.payable&&d.a.createElement(m.g,{label:"Value",style:{width:"100%",display:"flex",alignItems:"stretch",flexDirection:"column"}},d.a.createElement(m.m,{required:!0,width:1,type:"number",className:G.a.input,borderColor:"cardBorder",backgroundColor:"cardBg",placeholder:"Enter ETH value",onChange:function(e){return t.valueChange(e)},value:t.state.actionValue?t.state.actionValue:0})),t.state.selectedFunction&&t.state.selectedFunction.inputs.map(function(e,n){var a=["uint256","bool"].includes(e.type)?"number":"text",i=t.getPatternByFieldType(e.type,!0);return d.a.createElement(m.g,{style:{width:"100%",display:"flex",alignItems:"stretch",flexDirection:"column"},key:"input_".concat(n),label:"".concat(e.name," (").concat(e.type,")")},d.a.createElement(m.m,{required:!0,width:1,type:a,pattern:i,className:G.a.input,borderColor:"cardBorder",backgroundColor:"cardBg",placeholder:"".concat(e.name," (").concat(e.type,")"),onChange:function(e){return t.inputChange(e,n)},value:t.state.actionInputs[n]?t.state.actionInputs[n]:""}))}),t.state.selectedContract&&t.state.selectedFunction&&d.a.createElement(m.h,{mb:2,width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},d.a.createElement(H.a,{buttonProps:{px:[0,4],width:[1,"auto"],type:"button",disabled:!t.state.actionValid},handleClick:t.addAction.bind(t)},"Save Action"),d.a.createElement(m.n,{mt:2,color:"red",hoverColor:"red",onClick:t.deleteAction.bind(t)},"Delete Action"))):d.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},d.a.createElement(m.u,null,e.contract," - ",e.params.signature),d.a.createElement(m.h,{p:["4px","7px"],borderRadius:"50%",alignItems:"center",justifyContent:"center",backgroundColor:t.props.theme.colors.transactions.actionBg.redeem},d.a.createElement(m.k,{name:"Edit",align:"center",color:"redeem",size:t.props.isMobile?"1.2em":"1.4em"}))))}),(!this.state.actions||Object.values(this.state.actions).length<this.props.proposalMaxOperations)&&d.a.createElement(S.a,{cardProps:{py:2,px:3,mb:3,width:1},titleParentProps:{ml:0,my:1,justifyContent:"center"},titleProps:{fontSize:2,fontWeight:3},isInteractive:!0,handleClick:function(e){return t.setNewAction(!0)},title:this.state.newAction?"Add Action":null},this.state.newAction?d.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},d.a.createElement(m.g,{style:{width:"100%",display:"flex",alignItems:"stretch",flexDirection:"column"},label:"Select Contract"},d.a.createElement(m.t,{style:{width:"100%",color:this.props.theme.colors.counter,backgroundColor:this.props.theme.colors.cardBg},required:!0,options:this.state.contractOptions,onChange:this.changeContract.bind(this)})),this.state.selectedContract&&"custom"===this.state.selectedContract&&d.a.createElement(m.h,{width:1,flexDirection:"column"},d.a.createElement(m.g,{width:1,label:"Contract Address",validated:this.state.validated},d.a.createElement(m.m,{required:!0,width:1,type:"text",className:G.a.input,borderColor:"cardBorder",backgroundColor:"cardBg",placeholder:"Custom contract address",pattern:this.getPatternByFieldType("address",!0),onChange:function(e){return t.handleInput("customAddress",e,"address")},value:this.state.customAddress?this.state.customAddress:""})),d.a.createElement(m.g,{width:1,label:"Custom ABI",validated:this.state.validated},d.a.createElement(m.v,{required:!0,rows:8,width:1,className:G.a.input,placeholder:"Insert the ABI of your contract",onChange:function(e){return t.handleInput("customABI",e,"json")},value:this.state.customABI?this.state.customABI:""}))),this.state.selectedContract&&this.state.functionsOptions&&d.a.createElement(m.g,{style:{width:"100%",display:"flex",alignItems:"stretch",flexDirection:"column"},label:"Select Function"},d.a.createElement(m.t,{style:{width:"100%",color:this.props.theme.colors.counter,backgroundColor:this.props.theme.colors.cardBg},required:!0,options:this.state.functionsOptions,onChange:this.changeFunction.bind(this),value:this.state.selectedSignature?this.state.selectedSignature:""})),this.state.selectedFunction&&this.state.selectedFunction.payable&&d.a.createElement(m.g,{label:"Value",style:{width:"100%",display:"flex",alignItems:"stretch",flexDirection:"column"}},d.a.createElement(m.m,{required:!0,width:1,type:"number",className:G.a.input,borderColor:"cardBorder",backgroundColor:"cardBg",placeholder:"Enter ETH value",onChange:function(e){return t.valueChange(e)},value:this.state.actionValue?this.state.actionValue:0})),this.state.selectedFunction&&this.state.selectedFunction.inputs.map(function(e,n){var a=["uint256","bool"].includes(e.type)?"number":"text",i=t.getPatternByFieldType(e.type,!0);return d.a.createElement(m.g,{style:{width:"100%",display:"flex",alignItems:"stretch",flexDirection:"column"},key:"input_".concat(n),label:"".concat(e.name," (").concat(e.type,")")},d.a.createElement(m.m,{required:!0,width:1,type:a,pattern:i,className:G.a.input,borderColor:"cardBorder",backgroundColor:"cardBg",placeholder:"".concat(e.name," (").concat(e.type,")"),onChange:function(e){return t.inputChange(e,n)},value:t.state.actionInputs[n]?t.state.actionInputs[n]:""}))}),this.state.selectedContract&&this.state.selectedFunction&&d.a.createElement(m.h,{width:1,alignItems:"center",justifyContent:"center"},d.a.createElement(H.a,{buttonProps:{px:[0,4],type:"button",width:[1,"auto"],disabled:!this.state.actionValid},handleClick:this.addAction.bind(this)},"Add Action"))):d.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},d.a.createElement(m.u,null,"Add Action"),d.a.createElement(m.h,{p:["4px","7px"],borderRadius:"50%",alignItems:"center",justifyContent:"center",backgroundColor:this.props.theme.colors.transactions.actionBg.redeem},d.a.createElement(m.k,{name:"Add",align:"center",color:"redeem",size:this.props.isMobile?"1.2em":"1.4em"}))))))),d.a.createElement(m.h,{mb:3,width:1,alignItems:"center",justifyContent:"center"},this.state.processing&&this.state.processing.loading?d.a.createElement(V.a,{web3:this.props.web3,hash:this.state.processing.txHash,waitText:"Proposal creation estimated in",endMessage:"Finalizing proposal creation request...",cancelTransaction:this.cancelTransaction.bind(this)}):d.a.createElement(H.a,{buttonProps:{type:"submit",width:[1,"15em"],disabled:!this.state.validated}},"Submit Proposal"))):this.props.balance&&this.functionsUtil.BNify(this.props.balance).gte(this.props.proposalThreshold)?d.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},d.a.createElement(m.u,{mb:3,fontWeight:2,fontSize:[2,3],color:"dark-gray",textAlign:"center"},"Please delegate your votes to yourself to create a new proposal."),d.a.createElement(N,this.props)):d.a.createElement(m.u,{fontWeight:2,fontSize:[2,3],color:"dark-gray",textAlign:"center"},"You need at least ",this.functionsUtil.formatMoney(this.functionsUtil.fixTokenDecimals(this.props.proposalThreshold,18),0)," delegated votes to send a new proposal."))}}]),e}(h.Component),Y=n(820),J=n(144),K=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(i)))).state={vote:null,loaded:!1,userVote:null,processing:{txHash:null,loading:!1},voteSucceed:!1,showDelegateBox:!1},n.functionsUtil=null,n.governanceUtil=null,n.setVote=function(t){n.setState({vote:t})},n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"loadUtils",value:function(){this.governanceUtil?this.governanceUtil.setProps(this.props):this.governanceUtil=new g.a(this.props),this.functionsUtil=this.governanceUtil.functionsUtil}},{key:"componentWillMount",value:function(){var t=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),this.loadData();case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=Object(s.a)(o.a.mark(function t(e,n){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),e.account!==this.props.account&&this.loadData();case 3:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"loadData",value:function(){var t=Object(s.a)(o.a.mark(function t(){var e,n=this;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.props.account&&(e=this.props.proposal.votes.find(function(t){return t.voter.toLowerCase()===n.props.account.toLowerCase()}),this.setState({userVote:e,loaded:!0}));case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"cancelTransaction",value:function(){var t=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.setState({processing:{txHash:null,loading:!1}});case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"toggleDelegateBox",value:function(t){this.setState({showDelegateBox:t})}},{key:"castVote",value:function(){var t=this;if(null===this.state.vote)return!1;var e="for"===this.state.vote,n=parseInt(this.props.proposal.id);this.governanceUtil.castVote(n,e,function(e,n){var a={eventCategory:"Proposal",eventAction:"CastVote",eventLabel:t.state.vote};n&&(a.eventLabel=t.functionsUtil.getTransactionError(n)),(n||"error"!==a.status)&&t.functionsUtil.sendGoogleAnalyticsEvent(a);var i=null;"success"===e.status&&(i={voter:t.props.account,votes:t.props.votes.toString(),support:"for"===t.state.vote,proposalId:t.props.proposal.id},"function"===typeof t.props.callback&&t.props.callback()),t.setState({userVote:i,processing:{txHash:null,loading:!1}})},function(e){var n=e.transactionHash;t.setState(function(t){return{processing:Object(O.a)({},t.processing,{txHash:n})}})}),this.setState(function(t){return{processing:Object(O.a)({},t.processing,{loading:!0})}})}},{key:"render",value:function(){var t=this;return this.state.userVote?d.a.createElement(m.h,{p:3,width:1,mb:[2,3],alignItems:"center",flexDirection:"column",justifyContent:"center"},d.a.createElement(m.u,{mb:2,fontWeight:4,fontSize:[2,3],color:"dark-gray",textAlign:"center"},"You have voted for the proposal #",this.props.proposal.id,":"),d.a.createElement(S.a,{cardProps:{mb:2,py:[2,3],px:[3,4],width:"auto"},isInteractive:!1},d.a.createElement(m.h,{my:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},d.a.createElement(C,{fieldInfo:{name:"statusIcon",state:this.state.userVote.support?"Executed":"Canceled",props:{mr:2}}}),d.a.createElement(m.u,{fontWeight:3,fontSize:[2,3]},this.state.userVote.support?"For":"Against"))),d.a.createElement(m.u,{fontSize:1,fontWeight:500,color:"statValue",textAlign:"center"},"voted with ",this.functionsUtil.formatMoney(this.functionsUtil.fixTokenDecimals(this.state.userVote.votes,18).toFixed(0,1),0)," votes")):"Active"===this.props.proposal.state&&d.a.createElement(m.b,{p:3,width:1,mb:[2,3]},this.state.loaded?!this.props.votes||this.functionsUtil.BNify(this.props.votes).lte(0)||this.state.showDelegateBox?d.a.createElement(N,Object.assign({},this.props,{canClose:this.state.showDelegateBox,closeFunc:function(e){return t.toggleDelegateBox(!1)}})):d.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},d.a.createElement(m.u,{mb:1,fontWeight:4,fontSize:[2,3],color:"dark-gray",textAlign:"center"},"Cast your vote for the proposal #",this.props.proposal.id,":"),d.a.createElement(m.u,{mb:2,fontSize:1,color:"red",fontWeight:500,textAlign:"center"},"Make sure you have been delegated before this proposal has been submitted"),this.state.processing&&this.state.processing.loading?d.a.createElement(m.h,{width:1,flexDirection:"column"},d.a.createElement(V.a,{web3:this.props.web3,waitText:"Vote estimated in",hash:this.state.processing.txHash,endMessage:"Finalizing vote request...",cancelTransaction:this.cancelTransaction.bind(this)})):d.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},d.a.createElement(m.h,{mb:2,width:[1,.4],alignItems:"center",flexDirection:"row",justifyContent:"space-between"},d.a.createElement(S.a,{cardProps:{p:[2,3],width:.48,onMouseDown:function(){t.setVote("for")}},isInteractive:!0,isActive:"for"===this.state.vote},d.a.createElement(m.h,{my:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},d.a.createElement(C,{fieldInfo:{name:"statusIcon",state:"Executed",props:{mr:2}}}),d.a.createElement(m.u,{fontWeight:3,fontSize:[2,3]},"For"))),d.a.createElement(S.a,{cardProps:{p:[2,3],width:.48,onMouseDown:function(){t.setVote("against")}},isInteractive:!0,isActive:"against"===this.state.vote},d.a.createElement(m.h,{my:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},d.a.createElement(C,{fieldInfo:{name:"statusIcon",state:"Canceled",props:{mr:2}}}),d.a.createElement(m.u,{fontWeight:3,fontSize:[2,3]},"Against")))),d.a.createElement(m.u,{mb:0,fontSize:1,fontWeight:500,color:"statValue",textAlign:"center"},"You have ",this.functionsUtil.formatMoney(this.functionsUtil.fixTokenDecimals(this.props.votes,18).toFixed(0,1),0)," votes delegated"),this.props.balance&&this.functionsUtil.BNify(this.props.balance).gt(0)&&d.a.createElement(m.n,{mt:0,mainColor:"primary",hoverColor:"primary",onClick:function(e){return t.toggleDelegateBox(!0)}},"change delegate"),d.a.createElement(H.a,{buttonProps:{mt:2,width:[1,.2],disabled:null===this.state.vote},handleClick:this.castVote.bind(this)},"Vote"))):d.a.createElement(f.a,{flexProps:{flexDirection:"row"},loaderProps:{size:"30px"},textProps:{ml:2},text:"Loading data..."}))}}]),e}(h.Component),$=n(1169),Q=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(i)))).state={showActionParams:null,processing:{action:null,txHash:null,loading:!1}},n.functionsUtil=null,n.governanceUtil=null,n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"loadUtils",value:function(){this.governanceUtil?this.governanceUtil.setProps(this.props):this.governanceUtil=new g.a(this.props),this.functionsUtil=this.governanceUtil.functionsUtil}},{key:"toggleShowParams",value:function(t){this.state.showActionParams===t&&(t=null),this.setState({showActionParams:t})}},{key:"cancelTransaction",value:function(){var t=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.setState({processing:{action:null,txHash:null,loading:!1}});case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"queueProposal",value:function(){var t=Object(s.a)(o.a.mark(function t(){var e,n,a=this;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=function(t,e){var n={eventAction:"queue",eventCategory:"Governance",eventLabel:a.props.proposal.id};(e||"error"!==n.status)&&a.functionsUtil.sendGoogleAnalyticsEvent(n),"function"===typeof a.props.loadData&&"success"===t.status&&a.props.loadData(),a.setState({processing:{action:null,txHash:null,loading:!1}})},n=function(t){var e=t.transactionHash;a.setState(function(t){return{processing:Object(O.a)({},t.processing,{txHash:e})}})},this.governanceUtil.queueProposal(this.props.proposal.id,e,n),this.setState(function(t){return{processing:Object(O.a)({},t.processing,{loading:!0,action:"Queue"})}});case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"executeProposal",value:function(){var t=Object(s.a)(o.a.mark(function t(){var e,n,a=this;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=function(t,e){var n={eventAction:"execute",eventCategory:"Governance",eventLabel:a.props.proposal.id};(e||"error"!==n.status)&&a.functionsUtil.sendGoogleAnalyticsEvent(n),"function"===typeof a.props.loadData&&"success"===t.status&&a.props.loadData(),a.setState({processing:{action:null,txHash:null,loading:!1}})},n=function(t){var e=t.transactionHash;a.setState(function(t){return{processing:Object(O.a)({},t.processing,{txHash:e})}})},this.governanceUtil.executeProposal(this.props.proposal.id,e,n),this.setState(function(t){return{processing:Object(O.a)({},t.processing,{loading:!0,action:"Execute"})}});case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentWillMount",value:function(){var t=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),window.loadData=this.props.loadData;case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=Object(s.a)(o.a.mark(function t(e,n){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils();case 1:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this,e=this.props.proposal,n=1e3*e.states[0].start_time,a=Object.values(e.states).pop(),i=e.votes&&e.votes.length>0,o=this.functionsUtil.BNify(e.forVotes).div(1e18),s=this.functionsUtil.BNify(e.againstVotes).div(1e18),r=o.plus(s),l=o.div(r).times(100).toFixed(2),c=s.div(r).times(100).toFixed(2),u=1e3*(e.states[0].start_time+parseInt(this.functionsUtil.blocksToSeconds(this.props.votingPeriod))),p=e.votes.filter(function(t){return t.support}).sort(function(e,n){return t.functionsUtil.BNify(e.votes).lt(t.functionsUtil.BNify(n.votes))?1:-1}),h=e.votes.filter(function(t){return!t.support}).sort(function(e,n){return t.functionsUtil.BNify(e.votes).lt(t.functionsUtil.BNify(n.votes))?1:-1}),f="succeeded"===e.state.toLowerCase(),g="queued"===e.state.toLowerCase()&&parseInt((new Date).getTime()/1e3)-parseInt(e.states[e.states.length-1].start_time)>=parseInt(this.props.timelockDelay);return d.a.createElement(m.b,{width:1},d.a.createElement(b.a,{mb:[3,4]},e.title),d.a.createElement(m.h,{mb:3,width:1,alignItems:"center",justifyContent:"center",flexDirection:["column","row"]},d.a.createElement(m.h,{mb:[2,0],pr:[0,1],width:[1,.25],flexDirection:"column"},d.a.createElement(w.a,{labelTooltip:null,title:"Proposal ID",value:"#".concat(e.id),minHeight:["110px","143px"],titleMinHeight:["auto","50px"],label:"Created on ".concat(this.functionsUtil.strToMoment(n).utc().format("DD MMM, YYYY @ HH:mm")," UTC")})),d.a.createElement(m.h,{mb:[2,0],pl:[0,1],pr:[0,1],width:[1,.25],flexDirection:"column"},d.a.createElement(w.a,{titleMinHeight:["auto","50px"],minHeight:["110px","143px"],labelTooltip:null,title:"Proposer",label:null},d.a.createElement(m.h,{alignItems:"center",flexDirection:"row",justifyContent:"center"},d.a.createElement(m.a,{opts:{size:12,color:"#dfe",bgcolor:"#a71",spotcolor:"#000",seed:e.address}}),d.a.createElement(J.a,{href:this.functionsUtil.getEtherscanAddressUrl(e.proposer)},d.a.createElement(m.h,{flexDirection:"row",alignItems:"flex-end",justifyContent:"flex-start"},d.a.createElement($.a,Object.assign({ml:2,lineHeight:1},this.props,{fontSize:[3,4],fontWeight:[3,4],color:"statValue",hash:e.proposer})),d.a.createElement(m.k,{ml:1,size:"1.2em",name:"OpenInNew",color:"statValue"})))))),d.a.createElement(m.h,{mb:[2,0],pl:[0,1],pr:[0,1],width:[1,.25],flexDirection:"column"},d.a.createElement(w.a,{title:"Status",labelTooltip:null,minHeight:["110px","143px"],titleMinHeight:["auto","50px"],label:"Active"===e.state?"Ending on ".concat(this.functionsUtil.strToMoment(u).utc().format("DD MMM, YYYY @ HH:mm")," UTC"):"Updated on ".concat(this.functionsUtil.strToMoment(1e3*a.start_time).utc().format("DD MMM, YYYY @ HH:mm")," UTC")},d.a.createElement(m.h,{alignItems:"center",flexDirection:"row",justifyContent:"center"},d.a.createElement(C,Object.assign({},this.props,{proposal:e,fieldInfo:{name:"statusIcon",props:{size:this.props.isMobile?"1.7em":"2em"}}})),d.a.createElement(m.u,{ml:2,lineHeight:1,fontSize:[4,5],fontWeight:[3,4],color:"statValue"},e.state)))),d.a.createElement(m.h,{pl:[0,1],mb:[2,0],width:[1,.25],flexDirection:"column"},d.a.createElement(w.a,{label:null,title:"Total Votes",labelTooltip:null,minHeight:["110px","143px"],titleMinHeight:["auto","50px"],value:this.functionsUtil.formatMoney(r.toFixed(0,1),0)}))),this.props.account&&d.a.createElement(K,Object.assign({},this.props,{callback:this.props.loadData})),d.a.createElement(m.h,{width:1,mb:[2,3],id:"details-container",justifyContent:"space-between",flexDirection:["column","row"]},d.a.createElement(S.a,{cardProps:{p:3,mb:[2,0],mr:[0,1],width:[1,.5]},title:"Actions",titleParentProps:{mt:0,ml:0}},d.a.createElement(m.h,{pt:2,width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},e.actions.signatures.map(function(n,a){var i=e.actions.calldatas[a],o=null,s=n.match(/\(([a-z0-9,]+(\[\])?)\)/i);return(s=s?s[1].split(","):null)&&(o=t.props.web3.eth.abi.decodeParameters(s,i))&&(o=Object.values(o).splice(0,s.length)),d.a.createElement(m.h,{py:1,width:1,flexDirection:"column",alignItems:"flex-start",key:"action_".concat(a),justifyContent:"flex-start",borderBottom:"1px solid ".concat(t.props.theme.colors["near-white"])},d.a.createElement(m.h,{mb:1,width:1,flexDirection:["column","row"],alignItems:["flex-start","center"]},d.a.createElement(m.h,{flexDirection:"row"},d.a.createElement(m.u,{fontSize:1,fontWeight:3,color:"dark-gray"},parseInt(a)+1),d.a.createElement(m.u,{ml:2,fontSize:1,fontWeight:2,color:"dark-gray"},n)),o&&d.a.createElement(m.n,{mt:[1,0],ml:[0,1],fontSize:1,fontWeight:2,textAlign:"left",lineHeight:"initial",hoverColor:"primary",onClick:function(e){return t.toggleShowParams(a)}},t.state.showActionParams===a?"(hide params)":"(show params)")),o&&t.state.showActionParams===a&&d.a.createElement(m.h,{pl:[0,3],width:1,flexDirection:"column"},o.map(function(t,e){return d.a.createElement(m.u,{fontSize:0,color:"statValue",key:"param_".concat(e)},t)})))}))),d.a.createElement(S.a,{cardProps:{p:3,ml:[0,1],width:[1,.5]}},d.a.createElement(m.h,{mb:2,width:1,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},d.a.createElement(m.u,{fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"Proposal History"),d.a.createElement(m.u,{fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"Date")),d.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},e.states.map(function(n,a){return d.a.createElement(m.h,{py:2,width:1,alignItems:"center",key:"state_".concat(a),justifyContent:"space-between",borderBottom:"1px solid ".concat(t.props.theme.colors["near-white"])},d.a.createElement(m.h,{alignItems:"center",flexDirection:"row"},d.a.createElement(C,Object.assign({},t.props,{proposal:e,fieldInfo:{name:"statusIcon",state:n.state,props:{size:t.props.isMobile?"1.3em":"1.5em"}}})),d.a.createElement(m.n,{ml:2,fontSize:1,fontWeight:2,target:"_blank",textAlign:"left",color:"dark-gray",lineHeight:"initial",hoverColor:"primary",rel:"nofollow noopener noreferrer",href:t.functionsUtil.getEtherscanTransactionUrl(n.trx_hash)},n.state)),d.a.createElement(m.u,{fontSize:1,fontWeight:2,textAlign:"left",color:"dark-gray",lineHeight:"initial"},t.functionsUtil.strToMoment(1e3*n.start_time).utc().format("DD MMM, YYYY @ HH:mm")," UTC"))}),this.state.processing&&this.state.processing.loading?d.a.createElement(m.h,{mt:3,width:1,flexDirection:"column"},d.a.createElement(V.a,{web3:this.props.web3,hash:this.state.processing.txHash,cancelTransaction:this.cancelTransaction.bind(this),waitText:"".concat(this.state.processing.action," estimated in"),endMessage:"Finalizing ".concat(this.state.processing.action.toLowerCase()," request...")})):f?d.a.createElement(H.a,{buttonProps:{mt:3,width:[1,"auto"]},handleClick:this.queueProposal.bind(this)},"Queue Proposal"):g&&d.a.createElement(H.a,{buttonProps:{mt:3,width:[1,"auto"]},handleClick:this.executeProposal.bind(this)},"Execute Proposal")))),d.a.createElement(S.a,{cardProps:{p:3,mb:[2,3]},title:"Details",titleParentProps:{mt:0,ml:0}},d.a.createElement(m.u,{mt:2,fontSize:[1,2],style:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:e.description}})),i&&d.a.createElement(S.a,{cardProps:{p:3,mb:[2,3]}},d.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},d.a.createElement(m.h,{mb:2,width:1,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},d.a.createElement(m.u,{fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"For (",l,"%)"),d.a.createElement(m.u,{fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"Against (",c,"%)")),d.a.createElement(m.h,{mb:2,width:1,height:"20px",alignItems:"center",flexDirection:"row",id:"votes-cursor-container"},d.a.createElement(m.h,{height:"100%",width:"".concat(l,"%"),style:{background:"rgba(0, 211, 149, 1)"},borderRadius:100===parseFloat(l)?"20px":"20px 0 0 20px"}),d.a.createElement(m.h,{height:"100%",width:"".concat(c,"%"),style:{background:"rgba(211, 0, 0, 1)"},borderRadius:100===parseFloat(c)?"20px":"0 20px 20px 0"})),d.a.createElement(m.h,{width:1,height:"20px",alignItems:"center",flexDirection:"row",id:"votes-number-container"},d.a.createElement(m.h,{width:.5,height:"100%",justifyContent:"flex-end"},d.a.createElement(m.h,{width:1,height:"100%",justifyContent:"flex-start"},d.a.createElement(m.u,{fontWeight:3,fontSize:[1,2],textAlign:"left",color:"statValue",lineHeight:"initial"},this.functionsUtil.formatMoney(o.toFixed(0,1),0)))),d.a.createElement(m.h,{width:.5,height:"100%",justifyContent:"flex-start"},d.a.createElement(m.h,{width:1,height:"100%",minWidth:"10%",justifyContent:"flex-end"},d.a.createElement(m.u,{fontWeight:3,fontSize:[1,2],textAlign:"right",color:"statValue",lineHeight:"initial"},this.functionsUtil.formatMoney(s.toFixed(0,1),0))))))),i&&d.a.createElement(m.h,{mb:4,width:1,id:"votes-addresses-container",justifyContent:"space-between",flexDirection:["column","row"]},d.a.createElement(S.a,{cardProps:{p:3,mb:[2,0],mr:[0,1],width:[1,.5]},id:"for-votes-addresses-container"},d.a.createElement(m.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},d.a.createElement(m.h,{mb:2,width:1,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},d.a.createElement(m.u,{fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"For Addresses (",p.length,")"),d.a.createElement(m.u,{fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"Votes")),d.a.createElement(m.h,{width:1,style:{overflow:"scroll"},maxHeight:"400px",flexDirection:"column"},p.map(function(e,n){var a=t.functionsUtil.formatMoney(t.functionsUtil.BNify(e.votes).div(1e18).toFixed(4,1),4);return d.a.createElement(m.h,{py:2,width:1,alignItems:"center",flexDirection:"row",key:"vote_for_".concat(n),justifyContent:"space-between",borderBottom:"1px solid ".concat(t.props.theme.colors["near-white"])},d.a.createElement(m.h,{alignItems:"center",flexDirection:"row",justifyContent:"flex-start"},d.a.createElement(m.a,{opts:{size:7,color:"#dfe",bgcolor:"#a71",spotcolor:"#000",seed:e.voter}}),d.a.createElement(m.n,{ml:2,fontSize:1,fontWeight:2,target:"_blank",textAlign:"left",color:"statValue",lineHeight:"initial",hoverColor:"primary",rel:"nofollow noopener noreferrer",href:"/#/governance/leaderboard/".concat(e.voter)},t.props.isMobile?d.a.createElement($.a,Object.assign({fontSize:1,fontWeight:2},t.props,{textAlign:"left",color:"statValue",hash:e.voter,lineHeight:"initial"})):e.voter)),d.a.createElement(m.u,{fontSize:1,fontWeight:2,textAlign:"left",color:"statValue",lineHeight:"initial"},a))})))),d.a.createElement(S.a,{cardProps:{p:3,ml:[0,1],width:[1,.5]},id:"against-votes-addresses-container"},d.a.createElement(m.h,{mb:2,width:1,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},d.a.createElement(m.u,{fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"Against Addresses (",h.length,")"),d.a.createElement(m.u,{fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"Votes")),d.a.createElement(m.h,{width:1,style:{overflow:"scroll"},maxHeight:"400px",flexDirection:"column"},h.map(function(e,n){var a=t.functionsUtil.formatMoney(t.functionsUtil.BNify(e.votes).div(1e18).toFixed(4,1),4);return d.a.createElement(m.h,{py:2,width:1,alignItems:"center",flexDirection:"row",justifyContent:"space-between",key:"vote_against_".concat(n),borderBottom:"1px solid ".concat(t.props.theme.colors["near-white"])},d.a.createElement(m.h,{alignItems:"center",flexDirection:"row",justifyContent:"flex-start"},d.a.createElement(m.a,{opts:{size:7,color:"#dfe",bgcolor:"#a71",spotcolor:"#000",seed:e.voter}}),d.a.createElement(m.n,{ml:2,fontSize:1,fontWeight:2,target:"_blank",textAlign:"left",color:"statValue",lineHeight:"initial",hoverColor:"primary",rel:"nofollow noopener noreferrer",href:"/#/governance/leaderboard/".concat(e.voter)},e.voter)),d.a.createElement(m.u,{fontSize:1,fontWeight:2,textAlign:"left",color:"statValue",lineHeight:"initial"},a))})))))}}]),e}(h.Component),X=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(i)))).state={proposals:null,addProposal:!1,selectedProposal:null},n.governanceUtil=null,n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"loadUtils",value:function(){this.governanceUtil?this.governanceUtil.setProps(this.props):this.governanceUtil=new g.a(this.props)}},{key:"componentWillMount",value:function(){var t=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),this.loadData();case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=Object(s.a)(o.a.mark(function t(e,n){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),this.props.contractsInitialized&&e.contractsInitialized!==this.props.contractsInitialized&&this.loadData();case 3:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"loadData",value:function(){var t=Object(s.a)(o.a.mark(function t(){var e,n,a,i,s,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.props.contractsInitialized){t.next=2;break}return t.abrupt("return",!1);case 2:return t.next=4,this.governanceUtil.getProposals();case 4:e=t.sent,n=this.props.match.params,a=!1,i=null,n.item_id&&parseInt(n.item_id)?(s=parseInt(n.item_id),(r=e.find(function(t){return parseInt(t.id)===s}))&&(i=r)):n.item_id&&"new"===n.item_id.toLowerCase()&&(a=!0),this.setState({proposals:e,addProposal:a,selectedProposal:i});case 10:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return d.a.createElement(m.b,{width:1},d.a.createElement(m.h,{mb:3,width:1,alignItems:"center",flexDirection:"row",justifyContent:this.state.selectedProposal||this.state.addProposal?"space-between":"flex-end"},this.state.selectedProposal?d.a.createElement(m.h,{alignItems:"center",width:.5},d.a.createElement(z.a,Object.assign({},this.props,{text:"Governance",pathLink:["proposals"],isMobile:this.props.isMobile,handleClick:function(e){return t.props.goToSection("/")},path:["Proposals",this.state.selectedProposal.title]}))):this.state.addProposal?d.a.createElement(m.h,{alignItems:"center",width:.5},d.a.createElement(z.a,Object.assign({},this.props,{text:"Governance",pathLink:["proposals"],isMobile:this.props.isMobile,path:["Proposals","Add proposal"],handleClick:function(e){return t.props.goToSection("/")}}))):d.a.createElement(m.h,{alignItems:"center",width:.5},d.a.createElement(z.a,Object.assign({},this.props,{text:"Governance",path:["Proposals"],isMobile:this.props.isMobile,handleClick:function(e){return t.props.goToSection("/")}}))),!this.state.addProposal&&d.a.createElement(m.h,{width:.5,alignItems:"center",justifyContent:"flex-end"},d.a.createElement(Y.a,Object.assign({icon:"Add"},this.props,{text:"New Proposal",handleClick:function(e){return t.props.goToSection("proposals/new")}})))),this.state.selectedProposal?d.a.createElement(m.b,{width:1},d.a.createElement(Q,Object.assign({},this.props,{loadData:this.loadData.bind(this),proposal:this.state.selectedProposal}))):this.state.addProposal?d.a.createElement(m.b,{width:1},d.a.createElement(q,this.props)):d.a.createElement(m.b,{width:1},d.a.createElement(b.a,{mb:[3,4]},"Governance Proposals"),d.a.createElement(m.h,{mb:3,width:1,id:"proposals",flexDirection:"column"},d.a.createElement(A,Object.assign({},this.props,{proposals:this.state.proposals,cols:[{title:"#",props:{width:[.1,.05]},fields:[{name:"id",props:{}}]},{title:"DATE",mobile:!1,props:{width:[.15,.12]},fields:[{name:"date"}]},{title:"TITLE",props:{width:[.75,.6]},fields:[{name:"title"}]},{mobile:!1,title:"VOTES",props:{width:[.11,.11]},fields:[{name:"votes"}]},{title:"STATUS",props:{width:[.15,.12],alignItems:["center","flex-start"],justifyContent:["center","flex-start"]},parentProps:{justifyContent:["center","flex-start"]},fields:[{name:"statusIcon",props:{mr:[0,2]}},{mobile:!1,name:"status"}]}]})))))}}]),e}(h.Component),Z=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(i)))).state={proposals:null},n.functionsUtil=null,n.governanceUtil=null,n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"loadUtils",value:function(){this.governanceUtil?this.governanceUtil.setProps(this.props):this.governanceUtil=new g.a(this.props),this.functionsUtil=this.governanceUtil.functionsUtil}},{key:"componentWillMount",value:function(){var t=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),this.loadProposals();case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=Object(s.a)(o.a.mark(function t(e,n){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),JSON.stringify(e.delegate)!==JSON.stringify(this.props.delegate)&&this.loadProposals();case 3:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"loadProposals",value:function(){var t=Object(s.a)(o.a.mark(function t(){var e,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.props.delegate,t.next=3,this.governanceUtil.getProposals(e.delegate);case 3:n=t.sent,this.setState({proposals:n});case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this.props.delegate;return d.a.createElement(m.b,{width:1},d.a.createElement(b.a,{mb:[3,4]},"Delegate Details"),d.a.createElement(m.h,{mb:3,width:1,alignItems:"center",justifyContent:"center",flexDirection:["column","row"]},d.a.createElement(m.h,{mb:[2,0],pr:[0,1],width:[1,.25],flexDirection:"column"},d.a.createElement(w.a,{label:null,title:"Rank",value:t.rank,labelTooltip:null,minHeight:["100px","143px"],titleMinHeight:["auto","50px"]})),d.a.createElement(m.h,{mb:[2,0],pl:[0,1],pr:[0,1],width:[1,.25],flexDirection:"column"},d.a.createElement(w.a,{titleMinHeight:["auto","50px"],minHeight:["100px","143px"],labelTooltip:null,title:"Address",label:null},d.a.createElement(m.h,{alignItems:"center",flexDirection:"row",justifyContent:"center"},d.a.createElement(m.a,{opts:{size:12,color:"#dfe",bgcolor:"#a71",spotcolor:"#000",seed:t.delegate}}),d.a.createElement(J.a,{href:this.functionsUtil.getEtherscanAddressUrl(t.delegate)},d.a.createElement(m.h,{flexDirection:"row",alignItems:"flex-end",justifyContent:"flex-start"},d.a.createElement($.a,Object.assign({ml:2,lineHeight:1},this.props,{fontSize:[3,4],fontWeight:[3,4],color:"statValue",hash:t.delegate})),d.a.createElement(m.k,{ml:1,size:"1.2em",name:"OpenInNew",color:"statValue"})))))),d.a.createElement(m.h,{mb:[2,0],pl:[0,1],pr:[0,1],width:[1,.25],flexDirection:"column"},d.a.createElement(w.a,{label:null,title:"Votes",labelTooltip:null,minHeight:["100px","143px"],titleMinHeight:["auto","50px"],value:this.functionsUtil.formatMoney(this.functionsUtil.BNify(t.votes).toFixed(2,1),2)})),d.a.createElement(m.h,{pl:[0,1],mb:[2,0],width:[1,.25],flexDirection:"column"},d.a.createElement(w.a,{label:null,labelTooltip:null,title:"Proposals Voted",value:t.proposals,minHeight:["100px","143px"],titleMinHeight:["auto","50px"]}))),d.a.createElement(m.b,{width:1,mt:[4,5]},d.a.createElement(b.a,{mb:[2,3]},"Voting History"),d.a.createElement(m.h,{mb:[3,4],width:1,id:"transactions",flexDirection:"column"},d.a.createElement(A,Object.assign({},this.props,{rowsPerPage:5,delegate:t,filtersEnabled:!1,proposals:this.state.proposals,cols:[{title:"#",props:{width:[.08,.05]},fields:[{name:"id",props:{}}]},{title:"DATE",mobile:!1,props:{width:.12},fields:[{name:"date"}]},{title:"TITLE",props:{width:[.66,.57]},fields:[{name:"title"}]},{title:"VOTE",props:{width:[.14,.14],textAlign:"center"},fields:[{name:"support",parentProps:{alignItems:"center"}}]},{title:"STATUS",props:{width:[.12,.12],justifyContent:["center","flex-start"]},parentProps:{justifyContent:["center","flex-start"]},fields:[{name:"statusIcon",props:{mr:[0,2]}},{mobile:!1,name:"status"}]}]})))))}}]),e}(h.Component),tt=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(i)))).state={maxRows:100,delegates:null,selectedDelegate:null},n.governanceUtil=null,n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"loadUtils",value:function(){this.governanceUtil?this.governanceUtil.setProps(this.props):this.governanceUtil=new g.a(this.props)}},{key:"componentWillMount",value:function(){var t=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils(),this.loadData();case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=Object(s.a)(o.a.mark(function t(e,n){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loadUtils();case 1:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"loadData",value:function(){var t=Object(s.a)(o.a.mark(function t(){var e,n,a,i,s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.governanceUtil.getDelegates();case 2:e=t.sent,n=this.props.match.params,a=null,n.item_id&&(i=n.item_id.toLowerCase(),(s=e.find(function(t){return t.delegate.toLowerCase()===i}))&&(a=s)),this.setState({delegates:e,selectedDelegate:a});case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return d.a.createElement(m.b,{width:1},this.state.selectedDelegate?d.a.createElement(m.b,{width:1},d.a.createElement(m.h,{mb:3,width:1,alignItems:"center",flexDirection:"row",justifyContent:"flex-start"},d.a.createElement(m.h,{width:1},d.a.createElement(z.a,Object.assign({},this.props,{text:"Governance",pathLink:["leaderboard"],isMobile:this.props.isMobile,handleClick:function(e){return t.props.goToSection("")},path:["Leaderboard",this.state.selectedDelegate.delegate]})))),d.a.createElement(Z,Object.assign({},this.props,{delegate:this.state.selectedDelegate}))):d.a.createElement(m.b,{width:1},d.a.createElement(m.h,{mb:3,width:1,alignItems:"center",flexDirection:"row",justifyContent:"flex-start"},d.a.createElement(z.a,Object.assign({},this.props,{text:"Governance",path:["Leaderboard"],isMobile:this.props.isMobile,handleClick:function(e){return t.props.goToSection("")}}))),d.a.createElement(b.a,{mb:[3,4]},"Governance Leaderboard"),d.a.createElement(m.h,{mb:3,width:1,id:"leaderboard",flexDirection:"column"},d.a.createElement(F,Object.assign({},this.props,{delegates:this.state.delegates,cols:[{title:"RANK",props:{width:[.13,.08]},fields:[{name:"rank"}]},{title:"ADDRESS",props:{width:[.6,.5]},fields:[{mobile:!1,name:"avatar",props:{mr:2}},{name:"delegate"}]},{title:"VOTES",props:{width:[.27,.12]},fields:[{name:"votes"}]},{mobile:!1,title:"VOTE WEIGHT",props:{width:[.15,.15]},fields:[{name:"vote_weight",parentProps:{alignItems:"center"}}]},{mobile:!1,title:"PROPOSALS VOTED",props:{width:[.15,.15]},fields:[{name:"proposals",parentProps:{alignItems:"center"}}]}]})))))}}]),e}(h.Component),et=n(4929),nt=n(4932),at=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return(n=Object(c.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(i)))).state={menu:[],votes:null,balance:null,baseRoute:null,modalTitle:null,activeModal:null,blockNumber:null,currentRoute:null,votingPeriod:null,modalContent:null,pageComponent:null,timelockDelay:null,currentSection:null,selectedSection:null,currentDelegate:null,proposalThreshold:null,selectedSubsection:null,proposalMaxOperations:null},n.timeoutId=null,n.functionsUtil=null,n.governanceUtil=null,n.resetModal=function(){n.setState({activeModal:null})},n.openTooltipModal=function(t,e){n.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UI",eventAction:t,eventLabel:"TooltipModal"}),n.setState({modalTitle:t,modalContent:e},function(){n.setActiveModal("tooltip")})},n.setActiveModal=function(t){n.setState({activeModal:t})},n.logout=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.props.setConnector("Infura","Infura"),t.next=3,n.props.initWeb3("Infura");case 3:case"end":return t.stop()}},t,this)})),n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"loadUtils",value:function(){this.governanceUtil?this.governanceUtil.setProps(this.props):this.governanceUtil=new g.a(this.props),window.governanceUtil=this.governanceUtil,window.functionsUtil=this.functionsUtil=this.governanceUtil.functionsUtil}},{key:"loadMenu",value:function(){var t=Object(s.a)(o.a.mark(function t(){var e,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=[],n=this.functionsUtil.getGlobalConfig(["governance","baseRoute"]),e.push({submenu:[],selected:!0,route:n,icon:"Dashboard",label:"Overview",color:"dark-gray",component:M,bgColor:this.props.theme.colors.primary}),e.push({submenu:[],selected:!1,label:"Proposals",bgColor:"#00acff",color:"dark-gray",icon:"LightbulbOutline",component:X,route:"".concat(n,"/proposals")}),e.push({submenu:[],selected:!1,bgColor:"#ff0000",color:"dark-gray",label:"Leaderboard",component:tt,icon:"FormatListNumbered",route:"".concat(n,"/leaderboard")}),e.push({submenu:[],selected:!1,label:"Delegate",color:"dark-gray",bgColor:"#ff0000",component:R,icon:"CompareArrows",route:"".concat(n,"/delegate")}),e.push({submenu:[],icon:"Forum",mobile:!1,label:"Forum",selected:!1,component:null,color:"dark-gray",bgColor:"#ff0000",isExternalLink:!0,route:this.functionsUtil.getGlobalConfig(["forumURL"])}),t.next=9,this.setState({menu:e,baseRoute:n});case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"loadParams",value:function(){var t=Object(s.a)(o.a.mark(function t(){var e,n,a,i,s,r,l,c;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.props.match.params,n=this.state.baseRoute,a=window.location.hash.substr(1),i=null,s=null,r=this.state.menu,l=null,c=null,r.forEach(function(t){t.selected=!1;var o=n+"/"+e.section;a.toLowerCase()===t.route.toLowerCase()||!t.submenu.length&&t.route.toLowerCase()===o.toLowerCase()?(t.selected=!0,null===i&&(i=t.component)):t.submenu.length&&t.submenu.forEach(function(e){e.selected=!1,(t.route+"/"+e.route).toLowerCase()===a.toLowerCase()&&(t.selected=!0,e.selected=!0,null===i&&(i=e.component?e.component:t.component)),e.selected&&(c=e)}),t.selected&&(l=t)}),i){t.next=11;break}return t.abrupt("return",this.goToSection("/",!1));case 11:return t.next=13,this.setState({menu:r,params:e,baseRoute:n,currentRoute:a,pageComponent:i,currentSection:s,selectedSection:l,selectedSubsection:c});case 13:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.timeoutId&&window.clearTimeout(this.timeoutId)}},{key:"componentWillMount",value:function(){var t=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.props.setCurrentSection("governance"),this.loadUtils(),t.next=4,this.loadMenu();case 4:this.loadParams();case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var t=Object(s.a)(o.a.mark(function t(){var e=this;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.timeoutId=window.setTimeout(function(){e.props.accountInizialized&&e.props.contractsInitialized||e.setState({showResetButton:!0})},2e4),this.loadUtils(),t.next=4,this.loadMenu();case 4:this.loadParams(),this.loadData();case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=Object(s.a)(o.a.mark(function t(e,n){var a,i,s,r,l,c=this;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.loadUtils(),a=e.match.params,i=this.props.match.params,JSON.stringify(a)===JSON.stringify(i)){t.next=6;break}return t.next=6,this.setState({pageComponent:null},function(){c.loadParams()});case 6:s=e.account!==this.props.account,r=this.props.accountInizialized&&e.accountInizialized!==this.props.accountInizialized,l=this.props.contractsInitialized&&e.contractsInitialized!==this.props.contractsInitialized,(s||r||l)&&this.loadData();case 10:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"goToSection",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&(t=t.replace(this.state.baseRoute+"/",""));var n=(e?this.state.baseRoute+(t.length>0?"/"+t:""):t).replace(/[\/]+$/,"");window.location.hash=n,this.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UI",eventLabel:n,eventAction:"goToSection"}),window.scrollTo(0,0)}},{key:"loadData",value:function(){var t=Object(s.a)(o.a.mark(function t(){var e,n,i,s,r,l,c,u,p,h,d,f,m,g;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.props.web3&&this.props.contractsInitialized){t.next=2;break}return t.abrupt("return",!1);case 2:return e={},t.next=5,Promise.all([this.functionsUtil.getBlockNumber(),this.governanceUtil.getVotingPeriod(),this.governanceUtil.getTimelockDelay(),this.governanceUtil.getProposalParams()]);case 5:if(n=t.sent,i=Object(a.a)(n,4),s=i[0],r=i[1],l=i[2],c=i[3],u=c.proposalThreshold,p=c.proposalMaxOperations,e.blockNumber=s,e.votingPeriod=r,e.timelockDelay=l,e.proposalThreshold=u,e.proposalMaxOperations=p,!this.props.account){t.next=29;break}return t.next=21,Promise.all([this.governanceUtil.getCurrentVotes(this.props.account),this.governanceUtil.getTokensBalance(this.props.account),this.governanceUtil.getCurrentDelegate(this.props.account)]);case 21:h=t.sent,d=Object(a.a)(h,3),f=d[0],m=d[1],g=d[2],e.votes=f,e.balance=m,e.currentDelegate=g;case 29:this.setState(e);case 30:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this.state.pageComponent?this.state.pageComponent:null;return d.a.createElement(m.h,{width:"100%",position:"fixed",flexDirection:"row",className:this.props.themeMode,backgroundColor:["dashboardBg","white"],height:[window.innerHeight-61+"px","100vh"]},d.a.createElement(m.h,{bottom:0,zIndex:1,width:[1,1/6],flexDirection:"column",position:["fixed","relative"]},d.a.createElement(m.d,{p:[0,3],border:0,width:["100vw","auto"],height:["auto","100vh"],backgroundColor:"menuBg",borderColor:this.props.theme.colors.menuRightBorder,borderRight:"1px solid ".concat(this.props.theme.colors.menuRightBorder)},d.a.createElement(v.a,Object.assign({},this.props,{menu:this.state.menu})))),d.a.createElement(m.h,{py:3,px:[3,5],mb:0,width:[1,5/6],style:{overflowY:"scroll",overflowX:"hidden"},flexDirection:"columns",backgroundColor:"dashboardBg"},this.props.accountInizialized&&this.props.contractsInitialized&&t?d.a.createElement(m.h,{width:1,flexDirection:"column"},d.a.createElement(nt.a,Object.assign({goToSection:this.goToSection.bind(this)},this.props)),t&&d.a.createElement(t,Object.assign({},this.props,{votes:this.state.votes,balance:this.state.balance,urlParams:this.state.params,blockNumber:this.state.blockNumber,votingPeriod:this.state.votingPeriod,loadUserData:this.loadData.bind(this),timelockDelay:this.state.timelockDelay,goToSection:this.goToSection.bind(this),currentDelegate:this.state.currentDelegate,selectedSection:this.state.selectedSection,proposalThreshold:this.state.proposalThreshold,selectedSubsection:this.state.selectedSubsection,openTooltipModal:this.openTooltipModal.bind(this),proposalMaxOperations:this.state.proposalMaxOperations}))):d.a.createElement(m.h,{width:1,minHeight:"50vg",alignItems:"center",flexDirection:"column",justifyContent:"center"},this.state.showResetButton?d.a.createElement(S.a,{cardProps:{p:3,mt:3,width:[1,.35]}},d.a.createElement(m.h,{alignItems:"center",flexDirection:"column"},d.a.createElement(m.k,{size:"2.3em",name:"Warning",color:"cellText"}),d.a.createElement(m.u,{mt:2,fontSize:2,color:"cellText",textAlign:"center"},"Idle can't connect to your wallet!",d.a.createElement("br",null),"Make sure that your wallet is unlocked and try again."),d.a.createElement(H.a,{buttonProps:{mt:3,width:[1,.5]},handleClick:this.logout.bind(this)},"Logout"))):d.a.createElement(f.a,{textProps:{textSize:4,fontWeight:2},loaderProps:{mb:3,size:"40px"},flexProps:{my:3,flexDirection:"column"},text:this.props.accountInizialized?this.props.contractsInitialized?"Loading assets...":"Loading contracts...":"Loading account..."}))),d.a.createElement(et.a,{closeModal:this.resetModal,title:this.state.modalTitle,content:this.state.modalContent,isOpen:"tooltip"===this.state.activeModal}))}}]),e}(h.Component);e.default=at}}]);
//# sourceMappingURL=4.8f5ed9c8.chunk.js.map