(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{4761:function(e,t,n){},4799:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),i=n(7),s=n(5),r=n(6),l=n(10),c=n(8),p=n(9),u=n(0),m=n.n(u),h=n(84),d=n(2),f=n(29),g=n(34),b=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={activeNews:null},n.functionsUtil=null,n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),t=this.functionsUtil.getGlobalConfig(["tools","stake"]),n=this.functionsUtil.getGlobalConfig(["tools","nexusMutual"]),a={1:[{name:"Governance Forum",icon:"LightbulbOutline",text:"Do you have any idea to improve the Idle Protocol? Let's discuss it in our",link:{text:"Governance Forum",url:this.functionsUtil.getGlobalConfig(["forumURL"])}},{icon:t.icon,name:t.label,text:"You can now stake your $IDLE token and take part of the fee-sharing for long-term holders.",link:{text:"Stake Now",url:this.functionsUtil.getDashboardSectionUrl("tools/".concat(t.route))}},{icon:n.icon,name:n.label,text:"Protect your funds against smart-contract attacks with Nexus Mutual.",link:{text:"Get Covered",url:this.functionsUtil.getDashboardSectionUrl("tools/".concat(this.functionsUtil.getGlobalConfig(["tools","nexusMutual","route"])))}}],137:[]},i=this.functionsUtil.getRequiredNetworkId(),r=(s=a[i]).length?s[Math.floor(Math.random()*s.length)]:null,this.setState({activeNews:r});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.activeNews?m.a.createElement(g.a,{cardProps:{p:2,mb:3,width:1},isActive:!0,isInteractive:!1},m.a.createElement(d.h,{alignItems:"center",justifyContent:"center",flexDirection:["column","row"]},m.a.createElement(d.k,{mr:1,size:"1.2em",color:"flashColor",name:this.state.activeNews.icon}),m.a.createElement(d.u,{fontWeight:500,fontSize:"15px",color:"flashColor",textAlign:"center"},this.state.activeNews.text),m.a.createElement(h.a,{ml:1,fontWeight:500,color:"primary",fontSize:"15px",hoverColor:"primary",href:this.state.activeNews.link.url,onClick:function(t){return e.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UI",eventAction:"flashNews",eventLabel:e.state.activeNews.name})}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"row",justifyContent:"center"},this.state.activeNews.link.text,m.a.createElement(d.k,{ml:1,size:"0.9em",color:"primary",name:"OpenInNew"}),".")))):null}}]),t}(u.Component),k=n(71),v=n(4705),x=n(260),y=n.n(x),T=n(81),w=n(524),C=n(27),S=n(4708),E=n(332),M=n(40),D=n(188),U=n(822),j=n(823),O=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),p=0;p<a;p++)r[p]=arguments[p];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={chartProps:{},chartType:null,chartData:null,chartWidth:null},n.functionsUtil=null,n.parseAum=function(e){return(parseInt(e)>=1e3?parseFloat(e/1e3).toFixed(1)+"K":parseFloat(e))+" "+n.props.selectedToken},n.loadApiData=Object(i.a)(o.a.mark(function e(){var t,a,s,r,l,c,p,u,h,d,f,b,k,v,x,T,w,D,O,A,I,P,Y,B,F,z,R,H,N,V,G,W,L,_,q,X,J,K,$,Q,Z,ee,te,ne,ae,oe,ie,se,re,le,ce,pe,ue,me,he,de,fe,ge,be,ke,ve,xe,ye,Te,we;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.tokenConfig&&n.props.selectedToken&&n.props.chartMode&&(n.props.apiResults||n.props.apiResults_aa)){e.next=2;break}return e.abrupt("return",!1);case 2:t=4,a=n.props.apiResults,s=n.props.apiResults_aa,r=n.props.apiResults_bb,l=n.props.apiResults_unfiltered,c=Object.assign([],n.props.tokenConfig.protocols),p=s?s.length:a.length,u=n.functionsUtil.getGlobalConfig(["tranches"]),h=M.a.stats.versions[n.props.idleVersion],d={},f={},b=0,k=0,v=0,x=[],T={},w=E.a,D=[],O=0,A=0,I=null,P=null,Y=null,B=12,F=n.functionsUtil.capitalize(u.AA.baseName),z=n.functionsUtil.capitalize(u.BB.baseName),e.t0=n.props.chartMode,e.next="APR_TRANCHE"===e.t0?31:"PRICE_TRANCHE"===e.t0?45:"VOL_TRANCHE"===e.t0?66:"VOL"===e.t0?85:"AUM_TRANCHE"===e.t0?104:"COVERAGE_TRANCHE"===e.t0?117:"AUM"===e.t0?129:"ALL"===e.t0?142:"ALL_PERC"===e.t0?157:"APR"===e.t0?165:"SCORE"===e.t0?180:"PRICE_V4"===e.t0?194:"PRICE"===e.t0?217:230;break;case 31:for(O=0,x.push({id:"APR ".concat(F),color:u.AA.color.hex,data:s.map(function(e,t){var a=y()(1e3*e.timeStamp).format("YYYY/MM/DD HH:mm"),o=parseFloat(n.functionsUtil.fixTokenDecimals(e.apr,18));return O=Math.max(O,o),{x:a,y:o}})}),x.push({id:"APR ".concat(z),color:u.BB.color.hex,data:r.map(function(e,t){var a=y()(1e3*e.timeStamp).format("YYYY/MM/DD HH:mm"),o=parseFloat(n.functionsUtil.fixTokenDecimals(e.apr,18));return O=Math.max(O,o),{x:a,y:o}})}),w=E.a,b=parseFloat(O/t),D=[0],R=1;R<=5;R++)D.push(R*b);return A=0,B=6,H=x[x.length-1].data.sort(function(e,t){return y()(e.x,"YYYY/MM/DD HH:mm").isBefore(y()(t.x,"YYYY/MM/DD HH:mm"))?-1:1}),v=y()(H[H.length-1].x,"YYYY/MM/DD HH:mm").diff(y()(H[0].x,"YYYY/MM/DD HH:mm"),"days"),I=Math.max(1,Math.ceil(v/B)),T={xScale:{type:"time",format:"%Y/%m/%d %H:%M"},xFormat:"time:%b %d %H:%M",yFormat:function(e){return parseFloat(e).toFixed(2)+"%"},yScale:{type:"linear",stacked:!1},axisLeft:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:D,legendPosition:"middle",format:function(e){return parseFloat(e).toFixed(1)+"%"}},axisBottom:n.props.isMobile?null:{legend:"",tickSize:0,tickPadding:15,legendOffset:0,orient:"bottom",format:function(e){if(A++%I===0)return y()(e,"YYYY/MM/DD HH:mm").format("MMM DD")},tickValues:"every day",legendPosition:"middle"},gridYValues:D,pointSize:0,useMesh:!0,animate:!1,pointLabel:"y",curve:"linear",enableArea:!1,enableSlices:"x",enableGridX:!1,enableGridY:!0,pointBorderWidth:1,colors:function(e){return e.color},pointLabelYOffset:-12,legends:[{itemWidth:n.props.isMobile?110:120,itemHeight:18,translateX:n.props.isMobile?-35:0,translateY:n.props.isMobile?40:65,symbolSize:10,itemsSpacing:0,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:n.props.theme.colors.legend,effects:[{on:"hover",style:{itemTextColor:"light"===n.props.themeMode?"#000":"#fff"}}]}],theme:{axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:n.props.theme.colors.legend,fontFamily:n.props.theme.fonts.sansSerif}}},grid:{line:{stroke:n.props.theme.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontWeight:500,fill:n.props.theme.colors.legend,textTransform:"capitalize",fontFamily:n.props.theme.fonts.sansSerif,fontSize:n.props.isMobile?12:14}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:20,bottom:40,left:65}:{top:20,right:40,bottom:70,left:70},sliceTooltip:function(e){var t=e.slice,n=t.points[0];return m.a.createElement(U.a,{point:n},"object"===typeof t.points&&t.points.length&&t.points.map(function(e){var t=e.serieId,n=e.data.yFormatted;return m.a.createElement(j.a,{key:e.id,color:e.color,label:t,value:n})}))}},e.abrupt("break",231);case 45:for(O=0,N=null,V=null,G=null,null,L=null,G=s.map(function(e,t){var a=0,o=0,i=0,r=y()(1e3*e.timeStamp).format("YYYY/MM/DD HH:mm"),l=n.functionsUtil.fixTokenDecimals(e.virtualPrice,n.props.tokenConfig.decimals);N?(a=parseFloat(l.div(N).minus(1).times(100)),i=(e.timeStamp-s[0].timeStamp)/86400,o=l.div(N).minus(1).times(100).times(365).div(i).toFixed(2)):N=l;null===L&&(L=parseInt(e.blockNumber)),O=Math.max(O,a);var c=Math.floor(k/p*100),u=parseInt(e.blockNumber);return k++,{x:r,y:a,apy:o,blocknumber:u,itemPos:c}}),W=r.map(function(e,t){var a=0,o=0,i=0,s=y()(1e3*e.timeStamp).format("YYYY/MM/DD HH:mm"),l=n.functionsUtil.fixTokenDecimals(e.virtualPrice,n.props.tokenConfig.decimals);V?(a=parseFloat(l.div(V).minus(1).times(100)),i=(e.timeStamp-r[0].timeStamp)/86400,o=l.div(V).minus(1).times(100).times(365).div(i).toFixed(2)):V=l;null===Y&&(Y=parseInt(e.blockNumber)),O=Math.max(O,a);var c=Math.floor(k/p*100),u=parseInt(e.blockNumber);return k++,{x:s,y:a,apy:o,blocknumber:u,itemPos:c}}),b=parseFloat(O/t),D=[0],_=1;_<=5;_++)D.push(_*b);return G.splice(0,1),x.push({id:"Performance ".concat(F),color:u.AA.color.hex,data:G}),x.push({id:"Performance ".concat(z),color:u.BB.color.hex,data:W}),w=E.a,A=0,B=12,v=y()(G[G.length-1].x,"YYYY/MM/DD HH:mm").diff(y()(G[0].x,"YYYY/MM/DD HH:mm"),"days"),I=Math.max(1,Math.ceil(v/B)),T={xScale:{type:"time",format:"%Y/%m/%d %H:%M"},xFormat:"time:%b %d %H:%M",yFormat:function(e){return parseFloat(e).toFixed(3)+"%"},yScale:{type:"linear",stacked:!1},axisLeft:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:D,legendPosition:"middle",format:function(e){return parseFloat(e).toFixed(2)+"%"}},axisBottom:n.props.isMobile?null:{legend:"",tickSize:0,format:function(e){if(A++%I===0)return y()(e,"YYYY/MM/DD HH:mm").format("MMM DD")},tickPadding:10,legendOffset:0,orient:"bottom",tickValues:"every day",legendPosition:"middle"},gridYValues:D,pointSize:0,useMesh:!0,animate:!1,pointLabel:"y",curve:"monotoneX",enableArea:!1,enableSlices:"x",enableGridX:!1,enableGridY:!0,pointBorderWidth:1,colors:function(e){return e.color},pointLabelYOffset:-12,legends:[{itemHeight:18,symbolSize:10,itemsSpacing:5,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:n.props.theme.colors.legend,itemWidth:n.props.isMobile?70:160,translateX:n.props.isMobile?-35:0,translateY:n.props.isMobile?40:65,effects:[{on:"hover",style:{itemTextColor:"light"===n.props.themeMode?"#000":"#fff"}}]}],theme:{axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:n.props.theme.colors.legend,fontFamily:n.props.theme.fonts.sansSerif}}},grid:{line:{stroke:n.props.theme.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontSize:n.props.isMobile?12:14,fill:n.props.theme.colors.legend,fontWeight:500,fontFamily:n.props.theme.fonts.sansSerif}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:20,bottom:40,left:65}:{top:20,right:40,bottom:80,left:80},sliceTooltip:function(e){var t=e.slice,n=t.points[0];return m.a.createElement(U.a,{point:n},"object"===typeof t.points&&t.points.length&&t.points.map(function(e){var t=e.serieId,n=e.data.yFormatted,a=e.data.apy;return m.a.createElement(j.a,{key:e.id,label:t,color:e.color,value:"".concat(n," <small>(").concat(a,"% APY)</small>")})}))}},e.abrupt("break",231);case 66:for(q={},X=parseInt(l[0].timeStamp),J=parseInt(y()()._d.getTime()/1e3),K=X;K<=J;K+=86400)$=y()(1e3*K).format("YYYY/MM/DD"),q[$]||(q[$]={date:$,timestamp:K,deposits:0,redeems:0});for(Q=null,l.forEach(function(e){var t=y()(1e3*e.timeStamp).format("YYYY/MM/DD"),a=n.functionsUtil.fixTokenDecimals(e.totalSupply,18);if(q[t]||(q[t]={date:t,timestamp:e.timeStamp,deposits:0,redeems:0}),Q){var o=n.functionsUtil.fixTokenDecimals(Q.totalSupply,18);if(!a.eq(o)){var i=a.minus(o);i.gte(0)?(q[t].deposits+=parseFloat(i),O=Math.max(O,q[t].deposits)):(q[t].redeems+=parseFloat(i),O=Math.max(O,Math.abs(q[t].deposits)))}}else q[t].deposits+=parseFloat(a);Q=e}),x=Object.values(q).filter(function(e){return(!n.props.startTimestamp||e.timestamp>=n.props.startTimestamp)&&(!n.props.endTimestamp||e.timestamp<=n.props.endTimestamp)}).sort(function(e,t){return e.timestamp<t.timestamp?-1:1}),Z=0,x.forEach(function(e){Z=Math.max(Z,Math.abs(e.deposits),Math.abs(e.redeems))}),w=S.a,b=parseFloat(O/t),D=[0],ee=1;ee<=5;ee++)D.push(ee*b);return A=0,B=6,v=y()(x[x.length-1].date,"YYYY/MM/DD").diff(y()(x[0].date,"YYYY/MM/DD"),"days"),I=Math.max(1,Math.ceil(v/B)),T={indexBy:"date",enableLabel:!1,minValue:-Z,maxValue:Z,label:function(e){return Math.abs(e.value)},axisBottom:n.props.isMobile?null:{tickSize:0,legend:"",tickPadding:15,orient:"bottom",legendOffset:0,tickValues:"every day",format:function(e){if(A++%I===0)return y()(e,"YYYY/MM/DD").format("MMM DD")},legendPosition:"middle"},axisLeft:null,axisRight:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:8,legendPosition:"middle",format:function(e){return n.functionsUtil.abbreviateNumber(Math.abs(e),0)}},markers:[{axis:"y",value:0,lineStyle:{strokeOpacity:0},textStyle:{fill:n.props.theme.colors.transactions.action.deposit},legend:"deposits",legendPosition:"top-left",legendOrientation:"vertical",legendOffsetX:-20},{axis:"y",value:0,lineStyle:{stroke:n.props.theme.colors["dark-gray"],strokeDasharray:"5 3"},textStyle:{fill:n.props.theme.colors.transactions.action.redeem},legend:"redeems",legendPosition:"bottom-left",legendOrientation:"vertical",legendOffsetX:-20}],keys:["deposits","redeems"],padding:.4,colors:[n.props.theme.colors.transactions.action.deposit,n.props.theme.colors.transactions.action.redeem],labelTextColor:"inherit:darker(1.4)",labelSkipWidth:16,labelSkipHeight:16,pointSize:0,useMesh:!0,animate:!1,pointLabel:"y",curve:"linear",enableArea:!1,enableSlices:"x",enableGridX:!1,enableGridY:!0,pointBorderWidth:1,pointLabelYOffset:-12,legends:[{dataFrom:"keys",itemWidth:n.props.isMobile?80:100,itemHeight:18,translateX:0,translateY:n.props.isMobile?40:65,symbolSize:10,itemsSpacing:0,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:n.props.theme.colors.legend,effects:[{on:"hover",style:{itemTextColor:"light"===n.props.themeMode?"#000":"#fff"}}]}],theme:{axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:n.props.theme.colors.legend,fontFamily:n.props.theme.fonts.sansSerif}}},grid:{line:{stroke:n.props.theme.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontWeight:500,fill:n.props.theme.colors.legend,textTransform:"capitalize",fontFamily:n.props.theme.fonts.sansSerif,fontSize:n.props.isMobile?12:14}},tooltip:{container:{boxShadow:null,background:null}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:50,bottom:45,left:50}:{top:20,right:70,bottom:70,left:50},tooltip:function(e){var t=n.functionsUtil.strToMoment(1e3*e.data.timestamp).format("MMM DD HH:ss"),a={id:e.id,data:{xFormatted:t}},o=n.functionsUtil.abbreviateNumber(e.data.deposits,4)+" "+n.props.selectedToken,i=n.functionsUtil.abbreviateNumber(e.data.redeems,4)+" "+n.props.selectedToken;return m.a.createElement(U.a,{point:a},m.a.createElement(j.a,{label:"Deposits",color:n.props.theme.colors.deposit,value:o}),m.a.createElement(j.a,{label:"Redeem",color:n.props.theme.colors.redeem,value:i}))}},e.abrupt("break",231);case 85:for(q={},te=parseInt(l[0].timestamp),ne=parseInt(y()()._d.getTime()/1e3),ae=te;ae<=ne;ae+=86400)oe=y()(1e3*ae).format("YYYY/MM/DD"),q[oe]||(q[oe]={date:oe,timestamp:ae,deposits:0,redeems:0});for(Q=null,l.forEach(function(e){var t=y()(1e3*e.timestamp).format("YYYY/MM/DD"),a=n.functionsUtil.fixTokenDecimals(e.idleSupply,18);if(q[t]||(q[t]={date:t,timestamp:e.timestamp,deposits:0,redeems:0}),Q){var o=n.functionsUtil.fixTokenDecimals(Q.idleSupply,18);if(!a.eq(o)){var i=a.minus(o);i.gte(0)?(q[t].deposits+=parseFloat(i),O=Math.max(O,q[t].deposits)):(q[t].redeems+=parseFloat(i),O=Math.max(O,Math.abs(q[t].deposits)))}}else q[t].deposits+=parseFloat(a);Q=e}),x=Object.values(q).filter(function(e){return(!n.props.startTimestamp||e.timestamp>=n.props.startTimestamp)&&(!n.props.endTimestamp||e.timestamp<=n.props.endTimestamp)}).sort(function(e,t){return e.timestamp<t.timestamp?-1:1}),Z=0,x.forEach(function(e){Z=Math.max(Z,Math.abs(e.deposits),Math.abs(e.redeems))}),w=S.a,b=parseFloat(O/t),D=[0],ie=1;ie<=5;ie++)D.push(ie*b);return A=0,B=6,v=y()(x[x.length-1].date,"YYYY/MM/DD").diff(y()(x[0].date,"YYYY/MM/DD"),"days"),I=Math.max(1,Math.ceil(v/B)),T={indexBy:"date",enableLabel:!1,minValue:-Z,maxValue:Z,label:function(e){return Math.abs(e.value)},axisBottom:n.props.isMobile?null:{tickSize:0,legend:"",tickPadding:15,orient:"bottom",legendOffset:0,tickValues:"every day",format:function(e){if(A++%I===0)return y()(e,"YYYY/MM/DD").format("MMM DD")},legendPosition:"middle"},axisLeft:null,axisRight:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:8,legendPosition:"middle",format:function(e){return n.functionsUtil.abbreviateNumber(Math.abs(e),0)}},markers:[{axis:"y",value:0,lineStyle:{strokeOpacity:0},textStyle:{fill:n.props.theme.colors.transactions.action.deposit},legend:"deposits",legendPosition:"top-left",legendOrientation:"vertical",legendOffsetX:-20},{axis:"y",value:0,lineStyle:{stroke:n.props.theme.colors["dark-gray"],strokeDasharray:"5 3"},textStyle:{fill:n.props.theme.colors.transactions.action.redeem},legend:"redeems",legendPosition:"bottom-left",legendOrientation:"vertical",legendOffsetX:-20}],keys:["deposits","redeems"],padding:.4,colors:[n.props.theme.colors.transactions.action.deposit,n.props.theme.colors.transactions.action.redeem],labelTextColor:"inherit:darker(1.4)",labelSkipWidth:16,labelSkipHeight:16,pointSize:0,useMesh:!0,animate:!1,pointLabel:"y",curve:"linear",enableArea:!1,enableSlices:"x",enableGridX:!1,enableGridY:!0,pointBorderWidth:1,pointLabelYOffset:-12,legends:[{dataFrom:"keys",itemWidth:n.props.isMobile?80:100,itemHeight:18,translateX:0,translateY:n.props.isMobile?40:65,symbolSize:10,itemsSpacing:0,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:n.props.theme.colors.legend,effects:[{on:"hover",style:{itemTextColor:"light"===n.props.themeMode?"#000":"#fff"}}]}],theme:{axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:n.props.theme.colors.legend,fontFamily:n.props.theme.fonts.sansSerif}}},grid:{line:{stroke:n.props.theme.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontWeight:500,fill:n.props.theme.colors.legend,textTransform:"capitalize",fontFamily:n.props.theme.fonts.sansSerif,fontSize:n.props.isMobile?12:14}},tooltip:{container:{boxShadow:null,background:null}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:50,bottom:45,left:50}:{top:20,right:70,bottom:70,left:50},tooltip:function(e){var t=n.functionsUtil.strToMoment(1e3*e.data.timestamp).format("MMM DD HH:ss"),a={id:e.id,data:{xFormatted:t}},o=n.functionsUtil.abbreviateNumber(e.data.deposits,2)+" "+n.props.selectedToken,i=n.functionsUtil.abbreviateNumber(e.data.redeems,2)+" "+n.props.selectedToken;return m.a.createElement(U.a,{point:a},m.a.createElement(j.a,{label:"Deposits",color:n.props.theme.colors.deposit,value:o}),m.a.createElement(j.a,{label:"Redeem",color:n.props.theme.colors.redeem,value:i}))}},e.abrupt("break",231);case 104:for(O=0,x.push({id:"AUM ".concat(F),color:u.AA.color.hex,data:s.map(function(e,t){var a=n.functionsUtil.fixTokenDecimals(e.contractValue,18),o=y()(1e3*e.timeStamp).format("YYYY/MM/DD HH:mm"),i=parseFloat(a.toString());return O=Math.max(O,i),{x:o,y:i}})}),x.push({id:"AUM ".concat(z),color:u.BB.color.hex,data:r.map(function(e,t){var a=n.functionsUtil.fixTokenDecimals(e.contractValue,18),o=y()(1e3*e.timeStamp).format("YYYY/MM/DD HH:mm"),i=parseFloat(a.toString());return O=Math.max(O,i),{x:o,y:i}})}),w=E.a,b=parseFloat(O/t),D=[0],se=1;se<=5;se++)D.push(se*b);return A=0,B=6,v=y()(x[0].data[x[0].data.length-1].x,"YYYY/MM/DD HH:mm").diff(y()(x[0].data[0].x,"YYYY/MM/DD HH:mm"),"days"),I=Math.max(1,Math.ceil(v/B)),T={xScale:{type:"time",format:"%Y/%m/%d %H:%M"},xFormat:"time:%b %d %H:%M",yFormat:function(e){return n.functionsUtil.formatMoney(e,e<1?3:0)},yScale:{type:"linear",stacked:!1},axisLeft:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:D,legendPosition:"middle",format:function(e){return n.functionsUtil.abbreviateNumber(e,e<1?3:0)}},axisBottom:n.props.isMobile?null:{legend:"",tickSize:0,format:function(e){if(A++%I===0)return y()(e,"YYYY/MM/DD HH:mm").format("MMM DD")},tickPadding:15,orient:"bottom",legendOffset:0,tickValues:"every day",legendPosition:"middle"},gridYValues:D,pointSize:0,useMesh:!0,animate:!1,pointLabel:"y",curve:"linear",enableArea:!1,enableSlices:"x",enableGridX:!1,enableGridY:!0,pointBorderWidth:1,colors:function(e){return e.color},pointLabelYOffset:-12,legends:[{itemHeight:18,itemWidth:n.props.isMobile?90:100,translateX:n.props.isMobile?-35:0,translateY:n.props.isMobile?40:65,symbolSize:10,itemsSpacing:5,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:n.props.theme.colors.legend,effects:[{on:"hover",style:{itemTextColor:"light"===n.props.themeMode?"#000":"#fff"}}]}],theme:{axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:n.props.theme.colors.legend,fontFamily:n.props.theme.fonts.sansSerif}}},grid:{line:{stroke:n.props.theme.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontWeight:500,fill:n.props.theme.colors.legend,fontSize:n.props.isMobile?12:14,fontFamily:n.props.theme.fonts.sansSerif}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:20,bottom:40,left:65}:{top:20,right:40,bottom:70,left:70},sliceTooltip:function(e){var t=e.slice,a=t.points[0];return m.a.createElement(U.a,{point:a},"object"===typeof t.points&&t.points.length&&t.points.map(function(e){var t=e.serieId,a=e.data.yFormatted;return m.a.createElement(j.a,{key:e.id,color:e.color,label:t,value:"".concat(a," ").concat(n.props.selectedToken)})}))}},e.abrupt("break",231);case 117:for(O=0,x.push({id:"Coverage",color:u.AA.color.hex,data:s.map(function(e,t){var a=n.functionsUtil.fixTokenDecimals(e.contractValue,18),o=y()(1e3*e.timeStamp).format("YYYY/MM/DD HH:mm"),i=r[t]?n.functionsUtil.fixTokenDecimals(r[t].contractValue,18):n.functionsUtil.BNify(0),s=a>0?i.div(a):1,l=parseFloat((s>1?100:100*s).toString());return O=Math.max(O,l),{x:o,y:l}})}),w=E.a,b=parseFloat(O/t),D=[0],re=1;re<=5;re++)D.push(re*b);return A=0,B=6,v=y()(x[0].data[x[0].data.length-1].x,"YYYY/MM/DD HH:mm").diff(y()(x[0].data[0].x,"YYYY/MM/DD HH:mm"),"days"),I=Math.max(1,Math.ceil(v/B)),T={xScale:{type:"time",format:"%Y/%m/%d %H:%M"},xFormat:"time:%b %d %H:%M",yFormat:function(e){return parseFloat(e).toFixed(3)+"%"},yScale:{type:"linear",stacked:!1},axisLeft:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:D,legendPosition:"middle",format:function(e){return n.functionsUtil.abbreviateNumber(e,e<1?3:0)}},axisBottom:n.props.isMobile?null:{legend:"",tickSize:0,format:function(e){if(A++%I===0)return y()(e,"YYYY/MM/DD HH:mm").format("MMM DD")},tickPadding:15,orient:"bottom",legendOffset:0,tickValues:"every day",legendPosition:"middle"},gridYValues:D,pointSize:0,useMesh:!0,animate:!1,pointLabel:"y",curve:"linear",enableArea:!1,enableSlices:"x",enableGridX:!1,enableGridY:!0,pointBorderWidth:1,colors:function(e){return e.color},pointLabelYOffset:-12,legends:[{itemWidth:n.props.isMobile?70:80,itemHeight:18,translateX:n.props.isMobile?-35:0,translateY:n.props.isMobile?40:65,symbolSize:10,itemsSpacing:5,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:n.props.theme.colors.legend,effects:[{on:"hover",style:{itemTextColor:"light"===n.props.themeMode?"#000":"#fff"}}]}],theme:{axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:n.props.theme.colors.legend,fontFamily:n.props.theme.fonts.sansSerif}}},grid:{line:{stroke:n.props.theme.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontSize:n.props.isMobile?12:14,fill:n.props.theme.colors.legend,fontWeight:500,fontFamily:n.props.theme.fonts.sansSerif}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:20,bottom:40,left:65}:{top:20,right:40,bottom:70,left:70},sliceTooltip:function(e){var t=e.slice,n=t.points[0];return m.a.createElement(U.a,{point:n},"object"===typeof t.points&&t.points.length&&t.points.map(function(e){var t=e.serieId,n=e.data.yFormatted;return m.a.createElement(j.a,{key:e.id,label:t,color:e.color,value:"".concat(n)})}))}},e.abrupt("break",231);case 129:for(O=0,x.push({id:"AUM",color:"hsl("+M.a.stats.tokens[n.props.selectedToken].color.hsl.join(",")+")",data:a.map(function(e,t){var a=n.functionsUtil.fixTokenDecimals(e.idleSupply,18),o=n.functionsUtil.fixTokenDecimals(e.idlePrice,n.props.tokenConfig.decimals),i=a.times(o),s=y()(1e3*e.timestamp).format("YYYY/MM/DD HH:mm"),r=parseFloat(i.toString());return O=Math.max(O,r),{x:s,y:r}})}),n.props.tokenConfig.protocols.forEach(function(e,t){a.map(function(t,a){return t.protocolsData.filter(function(t,n){return t.protocolAddr.toLowerCase()===e.address.toLowerCase()}).map(function(a,o){if(!n.functionsUtil.BNify(a.rate).eq(0)){var i=y()(1e3*t.timestamp).format("YYYY/MM/DD HH:mm"),s=parseFloat(n.functionsUtil.fixTokenDecimals(a.allocation,n.props.tokenConfig.decimals));O=Math.max(O,s);var r=x[0].data.filter(function(e){return e.x===i});if(r){r=r[0];var l=x[0].data.indexOf(r);r.allocations||(r.allocations={}),r.allocations[e.name]=s,x[0].data[l]=r}}})[0]}).filter(function(e){return void 0!==e})}),w=E.a,b=parseFloat(O/t),D=[0],le=1;le<=5;le++)D.push(le*b);return A=0,B=6,v=y()(x[0].data[x[0].data.length-1].x,"YYYY/MM/DD HH:mm").diff(y()(x[0].data[0].x,"YYYY/MM/DD HH:mm"),"days"),I=Math.max(1,Math.ceil(v/B)),T={xScale:{type:"time",format:"%Y/%m/%d %H:%M"},xFormat:"time:%b %d %H:%M",yFormat:function(e){return n.functionsUtil.formatMoney(e,e<1?3:0)},yScale:{type:"linear",stacked:!1},axisLeft:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:D,legendPosition:"middle",format:function(e){return n.functionsUtil.abbreviateNumber(e,e<1?3:0)}},axisBottom:n.props.isMobile?null:{legend:"",tickSize:0,format:function(e){if(A++%I===0)return y()(e,"YYYY/MM/DD HH:mm").format("MMM DD")},tickPadding:15,orient:"bottom",legendOffset:0,tickValues:"every day",legendPosition:"middle"},gridYValues:D,pointSize:0,useMesh:!0,animate:!1,pointLabel:"y",curve:"linear",enableArea:!0,enableSlices:"x",enableGridX:!1,enableGridY:!0,pointBorderWidth:1,colors:function(e){return e.color},pointLabelYOffset:-12,legends:[{itemWidth:n.props.isMobile?70:80,itemHeight:18,translateX:n.props.isMobile?-35:0,translateY:n.props.isMobile?40:65,symbolSize:10,itemsSpacing:5,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:n.props.theme.colors.legend,effects:[{on:"hover",style:{itemTextColor:"light"===n.props.themeMode?"#000":"#fff"}}]}],theme:{axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:n.props.theme.colors.legend,fontFamily:n.props.theme.fonts.sansSerif}}},grid:{line:{stroke:n.props.theme.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontSize:n.props.isMobile?12:14,fill:n.props.theme.colors.legend,fontWeight:500,fontFamily:n.props.theme.fonts.sansSerif}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:20,bottom:40,left:65}:{top:20,right:40,bottom:70,left:70},sliceTooltip:function(e){var t=e.slice.points[0];return"object"===typeof t&&"object"===typeof t.data?m.a.createElement(U.a,{point:t},m.a.createElement(j.a,{label:t.serieId,color:t.serieColor,value:t.data.yFormatted}),t.data.allocations&&"object"===typeof t.data.allocations&&Object.keys(t.data.allocations).map(function(e){var a=M.a.stats.protocols[e],o="hsl("+a.color.hsl.join(",")+")",i=t.data.allocations[e],s=n.functionsUtil.formatMoney(i,i<1?3:0),r=n.functionsUtil.BNify(t.data.allocations[e]).div(n.functionsUtil.BNify(t.data.y)).times(100).toFixed(0)+"%";return m.a.createElement(j.a,{color:o,label:a.label,key:"".concat(t.id,"_").concat(e),value:"".concat(s," (").concat(r,")")})})):null}},e.abrupt("break",231);case 142:for(d={},f={},a.forEach(function(e,t){var a=y()(1e3*e.timestamp).format("YYYY/MM/DD"),o={date:a};e.protocolsData.forEach(function(e){var t=n.functionsUtil.BNify(e.rate).eq(0),a=n.props.tokenConfig.protocols.find(function(t){return t.address.toLowerCase()===e.protocolAddr.toLowerCase()});if(a){var i=M.a.stats.protocols[a.name];if(t)o[i.label]=0;else{var s=parseFloat(n.functionsUtil.fixTokenDecimals(e.allocation,n.props.tokenConfig.decimals));d[i.label]=1,o[i.label]=s,o["".concat(i.label,"Color")]="hsl("+i.color.hsl.join(",")+")",O=Math.max(O,s)}}}),f[a]=o}),ce=Object.keys(f),x=Object.values(f),w=S.a,b=parseFloat(O/t),D=[0],pe=1;pe<=5;pe++)D.push(pe*b);return A=0,B=12,v=y()(ce[ce.length-1],"YYYY/MM/DD").diff(y()(ce[0],"YYYY/MM/DD"),"days"),I=Math.max(1,Math.ceil(v/B)),T={padding:.2,animate:!1,indexBy:"date",enableLabel:!1,labelSkipWidth:16,labelSkipHeight:16,keys:Object.keys(d),labelTextColor:"inherit:darker(1.4)",colors:function(e){var t=e.id;return e.data["".concat(t,"Color")]},axisLeft:{format:function(e){return n.functionsUtil.abbreviateNumber(e,e<1?3:0)},orient:"left",tickSize:0,tickPadding:10,tickRotation:0,legend:"",legendOffset:-65,tickValues:D,legendPosition:"middle"},gridYValues:D,axisBottom:n.props.isMobile?null:{legend:"",format:function(e){if(A++%I===0)return y()(e,"YYYY/MM/DD HH:mm").format("MMM DD")},tickSize:0,tickPadding:10,legendOffset:36,orient:"bottom-left",tickValues:"every day",legendPosition:"middle"},legends:[{dataFrom:"keys",itemWidth:n.props.isMobile?70:80,itemHeight:18,translateX:n.props.isMobile?-35:0,translateY:n.props.isMobile?40:65,symbolSize:10,itemsSpacing:5,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:n.props.theme.colors.legend,effects:[{on:"hover",style:{itemTextColor:"light"===n.props.themeMode?"#000":"#fff"}}]}],theme:{tooltip:{container:{padding:"0",boxShadow:"none",background:"transparent"},tableCell:{padding:"0"}},axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:n.props.theme.colors.legend,fontFamily:n.props.theme.fonts.sansSerif}}},grid:{line:{stroke:n.props.theme.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontSize:n.props.isMobile?12:14,fill:n.props.theme.colors.legend,fontWeight:500,fontFamily:n.props.theme.fonts.sansSerif}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:20,bottom:40,left:65}:{top:20,right:40,bottom:70,left:60},tooltip:function(e){var t=e.id,a=e.value,o=e.color,i=n.functionsUtil.formatMoney(a,0);return m.a.createElement(g.a,{cardProps:{py:1,px:2,width:1}},m.a.createElement("table",{style:{width:"100%",borderCollapse:"collapse"}},m.a.createElement("tbody",null,m.a.createElement("tr",null,m.a.createElement("td",{style:{padding:"3px 5px"}},m.a.createElement("span",{style:{display:"block",width:"12px",height:"12px",background:o}})),m.a.createElement("td",{style:{padding:"3px 5px",textTransform:"capitalize"}},t),m.a.createElement("td",{style:{padding:"3px 5px"}},m.a.createElement("strong",null,i," ",n.props.selectedToken))))))}},e.abrupt("break",231);case 157:return d={},f={},a.forEach(function(e,t){var a=y()(1e3*e.timestamp).format("YYYY/MM/DD"),o={date:y()(1e3*e.timestamp).format("YYYY/MM/DD HH:mm")};f[a]&&(o=f[a]);var i=e.protocolsData.reduce(function(e,t){var a=n.functionsUtil.fixTokenDecimals(t.allocation,n.props.tokenConfig.decimals);return n.functionsUtil.BNify(e).plus(a)},0);e.protocolsData.forEach(function(e){var t=n.functionsUtil.BNify(e.rate).eq(0),a=n.props.tokenConfig.protocols.filter(function(t){return t.address.toLowerCase()===e.protocolAddr.toLowerCase()})[0].name;if(t)void 0!==typeof o[a]&&(o[a]=0);else{var s=n.functionsUtil.fixTokenDecimals(e.allocation,n.props.tokenConfig.decimals),r=parseFloat(s.div(i).times(100));d[a]=1,o[a]=r,o["".concat(a,"Color")]="hsl("+M.a.stats.protocols[a].color.hsl.join(",")+")"}}),f[a]=o}),x=Object.values(f),w=S.a,A=0,T={padding:.2,animate:!1,indexBy:"date",data:x,enableLabel:!1,labelSkipWidth:16,labelSkipHeight:16,keys:Object.keys(d),labelTextColor:"inherit:darker(1.4)",margin:n.props.isMobile?{top:20,right:20,bottom:40,left:50}:{top:20,right:40,bottom:40,left:60},colors:function(e){var t=e.id;return e.data["".concat(t,"Color")]},axisLeft:{format:function(e){return parseInt(e)+"%"}},axisBottom:n.props.isMobile?null:{legend:"",format:function(e){if(A++%3===0)return y()(e,"YYYY/MM/DD HH:mm").format("MMM DD")},orient:"bottom",legendOffset:36,legendPosition:"middle",tickValues:"every 3 days"},tooltip:function(e){var t=e.id,a=e.value,o=e.color,i=100===parseInt(a)?n.functionsUtil.formatMoney(a,0):n.functionsUtil.formatMoney(a,2);return m.a.createElement("table",{style:{width:"100%",borderCollapse:"collapse"}},m.a.createElement("tbody",null,m.a.createElement("tr",null,m.a.createElement("td",{style:{padding:"3px 5px"}},m.a.createElement("span",{style:{display:"block",width:"12px",height:"12px",background:o}})),m.a.createElement("td",{style:{padding:"3px 5px",textTransform:"capitalize"}},t),m.a.createElement("td",{style:{padding:"3px 5px"}},m.a.createElement("strong",null,i,"%")))))}},e.abrupt("break",231);case 165:for(O=0,h.additionalProtocols&&h.additionalProtocols.length>0&&h.additionalProtocols.forEach(function(e){var t=n.props.tokenConfig.protocols.find(function(t){return t.name===e.protocol});t&&e.enabledTokens.includes(n.props.selectedToken)&&(e.enabled=!0,e.address=t.address,c.unshift(e))}),c.forEach(function(e,t){var o=Object(C.a)({},M.a.stats.protocols[e.name]);if(o.enabled&&!x.filter(function(t){return t.name===e.name}).length){var i=o.rateField?o.rateField:"rate";x.push({id:o.label,color:"hsl("+M.a.stats.protocols[e.name].color.hsl.join(",")+")",data:a.map(function(t,a){return t.protocolsData.filter(function(t,n){return t.protocolAddr.toLowerCase()===e.address.toLowerCase()}).map(function(e,a){var o="object"===typeof i&&i.length?i.reduce(function(t,a){return e[a]?n.functionsUtil.BNify(t).plus(n.functionsUtil.BNify(e[a])):n.functionsUtil.BNify(t)},0):n.functionsUtil.BNify(e[i]);if(!o.eq(0)){o.lt(0)&&e.aaveAdditionalAPR&&n.functionsUtil.BNify(e.aaveAdditionalAPR).gt(0)&&(o=o.plus(n.functionsUtil.BNify(e.aaveAdditionalAPR))),o=n.functionsUtil.fixTokenDecimals(o,18);var s=y()(1e3*t.timestamp).format("YYYY/MM/DD HH:mm"),r=parseFloat(o);return O=Math.max(O,r),{x:s,y:r}}})[0]}).filter(function(e){return void 0!==e})})}}),x.push({id:"Idle",color:"hsl("+M.a.stats.protocols.idle.color.hsl.join(",")+")",data:a.map(function(e,t){var a=y()(1e3*e.timestamp).format("YYYY/MM/DD HH:mm"),o=parseFloat(n.functionsUtil.fixTokenDecimals(e.idleRate,18));return O=Math.max(O,o),{x:a,y:o}})}),w=E.a,b=parseFloat(O/t),D=[0],ue=1;ue<=5;ue++)D.push(ue*b);return A=0,B=6,me=x[x.length-1].data.sort(function(e,t){return y()(e.x,"YYYY/MM/DD HH:mm").isBefore(y()(t.x,"YYYY/MM/DD HH:mm"))?-1:1}),v=y()(me[me.length-1].x,"YYYY/MM/DD HH:mm").diff(y()(me[0].x,"YYYY/MM/DD HH:mm"),"days"),I=Math.max(1,Math.ceil(v/B)),T={xScale:{type:"time",format:"%Y/%m/%d %H:%M"},xFormat:"time:%b %d %H:%M",yFormat:function(e){return parseFloat(e).toFixed(2)+"%"},yScale:{type:"linear",stacked:!1},axisLeft:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:D,legendPosition:"middle",format:function(e){return parseFloat(e).toFixed(1)+"%"}},axisBottom:n.props.isMobile?null:{legend:"",tickSize:0,tickPadding:15,legendOffset:0,orient:"bottom",format:function(e){if(A++%I===0)return y()(e,"YYYY/MM/DD HH:mm").format("MMM DD")},tickValues:"every day",legendPosition:"middle"},gridYValues:D,pointSize:0,useMesh:!0,animate:!1,pointLabel:"y",curve:"linear",enableArea:!1,enableSlices:"x",enableGridX:!1,enableGridY:!0,pointBorderWidth:1,colors:function(e){return e.color},pointLabelYOffset:-12,legends:[{itemWidth:n.props.isMobile?70:80,itemHeight:18,translateX:n.props.isMobile?-35:0,translateY:n.props.isMobile?40:65,symbolSize:10,itemsSpacing:0,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:n.props.theme.colors.legend,effects:[{on:"hover",style:{itemTextColor:"light"===n.props.themeMode?"#000":"#fff"}}]}],theme:{axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:n.props.theme.colors.legend,fontFamily:n.props.theme.fonts.sansSerif}}},grid:{line:{stroke:n.props.theme.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontWeight:500,fill:n.props.theme.colors.legend,textTransform:"capitalize",fontFamily:n.props.theme.fonts.sansSerif,fontSize:n.props.isMobile?12:14}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:20,bottom:40,left:65}:{top:20,right:40,bottom:70,left:70},sliceTooltip:function(e){var t=e.slice,n=t.points[0];return m.a.createElement(U.a,{point:n},"object"===typeof t.points&&t.points.length&&t.points.map(function(e){var t=e.serieId,n=e.data.yFormatted;return m.a.createElement(j.a,{key:e.id,color:e.color,label:t,value:n})}))}},e.abrupt("break",231);case 180:for(he=0,O=0,n.props.tokenConfig.protocols.forEach(function(e,t){var n=M.a.stats.protocols[e.name];n.enabled&&(x.filter(function(t){return t.name===e.name}).length||x.push({id:n.label,color:"hsl("+M.a.stats.protocols[e.name].color.hsl.join(",")+")",data:a.map(function(t,n){return t.protocolsData.filter(function(t,n){return t.protocolAddr.toLowerCase()===e.address.toLowerCase()}).map(function(e,n){var a=y()(1e3*t.timestamp).format("YYYY/MM/DD HH:mm"),o=parseFloat(e.defiScore);return o=isNaN(o)||!o?he:o,he=o,O=Math.max(O,o),{x:a,y:o}})[0]}).filter(function(e){return void 0!==e})}))}),x.push({id:"Idle",color:"hsl("+M.a.stats.protocols.idle.color.hsl.join(",")+")",data:a.map(function(e,t){var n=y()(1e3*e.timestamp).format("YYYY/MM/DD HH:mm"),a=parseFloat(e.idleScore);return a=isNaN(a)||!a?he:a,he=a,O=Math.max(O,a),{x:n,y:a}})}),w=E.a,b=parseFloat(O/t),D=[0],de=1;de<=5;de++)D.push(de*b);return A=0,B=6,v=y()(x[0].data[x[0].data.length-1].x,"YYYY/MM/DD").diff(y()(x[0].data[0].x,"YYYY/MM/DD"),"days"),I=Math.max(1,Math.ceil(v/B)),T={xScale:{type:"time",format:"%Y/%m/%d %H:%M"},xFormat:"time:%b %d %H:%M",yFormat:function(e){return parseFloat(e).toFixed(1)},yScale:{type:"linear",stacked:!1},axisLeft:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:D,legendPosition:"middle",format:function(e){return parseFloat(e).toFixed(1)}},axisBottom:n.props.isMobile?null:{legend:"",tickSize:0,tickPadding:15,orient:"bottom",legendOffset:0,tickValues:"every day",format:function(e){if(A++%I===0)return y()(e,"YYYY/MM/DD HH:mm").format("MMM DD")},legendPosition:"middle"},gridYValues:D,pointSize:0,useMesh:!0,animate:!1,pointLabel:"y",curve:"linear",enableArea:!1,enableSlices:"x",enableGridX:!1,enableGridY:!0,pointBorderWidth:1,colors:function(e){return e.color},pointLabelYOffset:-12,legends:[{itemWidth:n.props.isMobile?70:80,itemHeight:18,translateX:n.props.isMobile?-35:0,translateY:n.props.isMobile?40:65,symbolSize:10,itemsSpacing:0,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:n.props.theme.colors.legend,effects:[{on:"hover",style:{itemTextColor:"light"===n.props.themeMode?"#000":"#fff"}}]}],theme:{axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:n.props.theme.colors.legend,fontFamily:n.props.theme.fonts.sansSerif}}},grid:{line:{stroke:n.props.theme.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontWeight:500,fill:n.props.theme.colors.legend,textTransform:"capitalize",fontFamily:n.props.theme.fonts.sansSerif,fontSize:n.props.isMobile?12:14}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:20,bottom:40,left:65}:{top:20,right:40,bottom:70,left:70},sliceTooltip:function(e){var t=e.slice,n=t.points[0];return m.a.createElement(U.a,{point:n},"object"===typeof t.points&&t.points.length&&t.points.map(function(e){var t=e.serieId,n=e.data.yFormatted;return m.a.createElement(j.a,{key:e.id,color:e.color,label:t,value:n})}))}},e.abrupt("break",231);case 194:for(k=0,O=0,fe=null,ge=null,be=n.functionsUtil.BNify(0),ke=n.functionsUtil.BNify(1),ve=n.functionsUtil.BNify(1),P=[],xe=c.find(function(e){return"aavev2"===e.name}),a.forEach(function(e,t){var a=n.functionsUtil.BNify(e.idleRate),o=0,i=0,s=y()(1e3*e.timestamp).format("YYYY/MM/DD HH:mm");if("WETH"===n.props.selectedToken&&y()(s).isSameOrBefore(y()("2021-05-19 12:20","YYYY-MM-DD HH:mm"))){var r=xe?e.protocolsData.find(function(e,t){return e.protocolAddr.toLowerCase()===xe.address.toLowerCase()}):null;r.aaveAdditionalAPR&&n.functionsUtil.BNify(r.aaveAdditionalAPR).gt(0)&&(a=a.plus(n.functionsUtil.BNify(r.aaveAdditionalAPR)))}var l=n.functionsUtil.fixTokenDecimals(a,18).div(100);if(be=be.plus(l.times(100)),fe){var c=(e.timestamp-ge.timestamp)/86400,u=ve.times(fe.times(c).div(365)),m=(ve=ve.plus(u)).div(ke).minus(1).times(100);o=parseFloat(m);var h=P.length>0?Math.max(1,y()(1e3*e.timestamp).diff(y()(P[0].x,"YYYY/MM/DD HH:mm"),"days")):1;i=parseFloat(365*o/h).toFixed(2)}ge=e,fe=l,null===Y&&(Y=parseInt(e.blocknumber)),O=Math.max(O,o);var d=Math.floor(k/p*100),f=e.blocknumber;k++,i>0&&P.push({x:s,y:o,apy:i,blocknumber:f,itemPos:d})}),h.additionalProtocols&&h.additionalProtocols.length>0&&h.additionalProtocols.forEach(function(e){var t=n.props.tokenConfig.protocols.find(function(t){return t.name===e.protocol});t&&e.enabledTokens.includes(n.props.selectedToken)&&(e.enabled=!0,e.address=t.address,c.unshift(e))}),c.forEach(function(e){var t=Object(C.a)({},M.a.stats.protocols[e.name]);if(t.tokensProps&&t.tokensProps[n.props.selectedToken]){var o=t.tokensProps[n.props.selectedToken];Object.keys(o).forEach(function(e){t[e]=o[e]})}if(!(!t.enabled||t.startTimestamp&&n.functionsUtil.strToMoment(t.startTimestamp).isAfter(Date.now()))){var i=t.rateField?t.rateField:"rate",s={id:t.label,color:"hsl("+t.color.hsl.join(",")+")",data:[]};k=0,fe=null,ge=null;var r=0,l=null,c=null;be=n.functionsUtil.BNify(0),ke=n.functionsUtil.BNify(1),ve=n.functionsUtil.BNify(1),a.filter(function(e){return!t.startTimestamp||y()(t.startTimestamp).isSameOrBefore(y()(1e3*e.timestamp))}).forEach(function(t,a){var o=t.protocolsData.find(function(t,n){return t.protocolAddr.toLowerCase()===e.address.toLowerCase()});if(o){l||(l=o);var u="object"===typeof i&&i.length?i.reduce(function(e,t){return o[t]?n.functionsUtil.BNify(e).plus(n.functionsUtil.BNify(o[t])):n.functionsUtil.BNify(e)},0):n.functionsUtil.BNify(o[i]);if(u.lt(0)&&o.aaveAdditionalAPR&&n.functionsUtil.BNify(o.aaveAdditionalAPR).gt(0)&&(u=u.plus(n.functionsUtil.BNify(o.aaveAdditionalAPR))),!u.eq(0)){var m={},h=0,d=y()(1e3*t.timestamp).format("YYYY/MM/DD HH:mm"),f=n.functionsUtil.fixTokenDecimals(u,18).div(100);if(be=be.plus(f.times(100)),null===c&&(c=parseInt(t.blocknumber))>Y){var g=P.find(function(e){return e.blocknumber>=c});g&&(h=r=g.y,be.toFixed(2))}if(k++,ge){var b=(t.timestamp-ge.timestamp)/86400,v=ve.times(fe.times(b).div(365)),x=(ve=ve.plus(v)).div(ke).minus(1).times(100);h=parseFloat(x)+r;var T=Math.max(1,y()(1e3*t.timestamp).diff(y()(P[0].x,"YYYY/MM/DD HH:mm"),"days"));m={x:d,y:h,apy:parseFloat(365*h/T).toFixed(2),itemPos:Math.floor(k/p*100)},k++,s.data.push(m)}ge=t,fe=f,null===Y&&(Y=parseInt(t.blocknumber)),O=Math.max(O,h)}}}),x.push(s)}}),b=parseFloat(O/t),D=[0],ye=1;ye<=5;ye++)D.push(ye*b);return x.push({id:"Idle",data:P,color:"hsl("+M.a.stats.protocols.idle.color.hsl.join(",")+")"}),w=E.a,A=0,B=12,v=y()(P[P.length-1].x,"YYYY/MM/DD HH:mm").diff(y()(P[0].x,"YYYY/MM/DD HH:mm"),"days"),I=Math.max(1,Math.ceil(v/B)),T={xScale:{type:"time",format:"%Y/%m/%d %H:%M"},xFormat:"time:%b %d %H:%M",yFormat:function(e){return parseFloat(e).toFixed(3)+"%"},yScale:{type:"linear",stacked:!1},axisLeft:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:D,legendPosition:"middle",format:function(e){return parseFloat(e).toFixed(2)+"%"}},axisBottom:n.props.isMobile?null:{legend:"",tickSize:0,format:function(e){if(A++%I===0)return y()(e,"YYYY/MM/DD HH:mm").format("MMM DD")},tickPadding:10,legendOffset:0,orient:"bottom",tickValues:"every day",legendPosition:"middle"},gridYValues:D,pointSize:0,useMesh:!0,animate:!1,pointLabel:"y",curve:"monotoneX",enableArea:!1,enableSlices:"x",enableGridX:!1,enableGridY:!0,pointBorderWidth:1,colors:function(e){return e.color},pointLabelYOffset:-12,legends:[{itemHeight:18,symbolSize:10,itemsSpacing:5,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:n.props.theme.colors.legend,itemWidth:n.props.isMobile?70:160,translateX:n.props.isMobile?-35:0,translateY:n.props.isMobile?40:65,effects:[{on:"hover",style:{itemTextColor:"light"===n.props.themeMode?"#000":"#fff"}}]}],theme:{axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:n.props.theme.colors.legend,fontFamily:n.props.theme.fonts.sansSerif}}},grid:{line:{stroke:n.props.theme.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontSize:n.props.isMobile?12:14,fill:n.props.theme.colors.legend,fontWeight:500,fontFamily:n.props.theme.fonts.sansSerif}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:20,bottom:40,left:65}:{top:20,right:40,bottom:80,left:80},sliceTooltip:function(e){var t=e.slice,n=t.points[0];return m.a.createElement(U.a,{point:n},"object"===typeof t.points&&t.points.length&&t.points.map(function(e){var t=e.serieId,n=e.data.yFormatted,a=e.data.apy;return m.a.createElement(j.a,{key:e.id,label:t,color:e.color,value:"".concat(n," <small>(").concat(a,"% APY)</small>")})}))}},e.abrupt("break",231);case 217:return O=0,Te=null,P=a.map(function(e,t){var o=0,i=0,s=0,r=y()(1e3*e.timestamp).format("YYYY/MM/DD HH:mm"),l=n.functionsUtil.fixTokenDecimals(e.idlePrice,n.props.tokenConfig.decimals);Te?(o=parseFloat(l.div(Te).minus(1).times(100)),s=(e.timestamp-a[0].timestamp)/86400,i=l.div(Te).minus(1).times(100).times(365).div(s).toFixed(2)):Te=l;null===Y&&(Y=parseInt(e.blocknumber)),O=Math.max(O,o);var c=Math.floor(k/p*100),u=e.blocknumber;return k++,{x:r,y:o,apy:i,blocknumber:u,itemPos:c}}),h.additionalProtocols&&h.additionalProtocols.length>0&&h.additionalProtocols.forEach(function(e){var t=n.props.tokenConfig.protocols.find(function(t){return t.name===e.protocol});t&&e.enabledTokens.includes(n.props.selectedToken)&&(e.enabled=!0,e.address=t.address,c.unshift(e))}),e.next=223,n.functionsUtil.asyncForEach(c,function(){var e=Object(i.a)(o.a.mark(function e(t){var s,r,l,c,u,m,h,d;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((s=M.a.stats.protocols[t.name]).enabled){e.next=3;break}return e.abrupt("return");case 3:return r=s.rateField?s.rateField:"rate",l={id:s.label,color:"hsl("+s.color.hsl.join(",")+")",data:[]},k=0,c=0,Te=null,u=null,m=null,h=null,d=null,e.next=14,n.functionsUtil.asyncForEach(a,function(){var e=Object(i.a)(o.a.mark(function e(i){var f,g,b,v,x,T,w,C,S,E,D,U;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(f=i.protocolsData.find(function(e,n){return e.protocolAddr.toLowerCase()===t.address.toLowerCase()}))&&f[r]&&(h||(h=f),n.functionsUtil.BNify(f[r]).eq(0)||(null===d&&(d=parseInt(i.blocknumber))>Y&&(g=P.find(function(e){return e.blocknumber>=d}))&&(c=g.y),{},v=f.price,x=n.functionsUtil.fixTokenDecimals(v,t.decimals),T=y()(1e3*i.timestamp).format("YYYY/MM/DD HH:mm"),s&&s.data&&s.data[t.address.toLowerCase()]&&s.data[t.address.toLowerCase()][i.blocknumber]&&(v=n.functionsUtil.BNify(M.a.stats.protocols[t.name].data[t.address.toLowerCase()][i.blocknumber]),x=n.functionsUtil.fixTokenDecimals(v,t.decimals)),w=c,C=0,Te?(x.lt(m)?(Te=x,S=l.data[l.data.length-1].y-l.data[l.data.length-2].y,w=u.y+S,c=w):w+=parseFloat(x.div(Te).minus(1).times(100)),E=(i.timestamp-a[0].timestamp)/86400,D=x.div(Te).minus(1).times(100),C=D.times(365).div(E).toFixed(2)):Te=x,w=Math.max(0,w),O=Math.max(O,w),U=Math.floor(k/p*100),k++,u=b={x:T,y:w,apy:C,itemPos:U},l.data.push(b),m=x));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 14:x.push(l);case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 223:for(b=parseFloat(O/t),D=[0],we=1;we<=5;we++)D.push(we*b);return x.push({id:"Idle",color:"hsl("+M.a.stats.protocols.idle.color.hsl.join(",")+")",data:P}),w=E.a,T={xScale:{type:"time",format:"%Y/%m/%d %H:%M"},xFormat:"time:%b %d %H:%M",yFormat:function(e){return parseFloat(e).toFixed(3)+"%"},yScale:{type:"linear",stacked:!1},axisLeft:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:D,legendPosition:"middle",format:function(e){return parseFloat(e).toFixed(2)+"%"}},axisBottom:n.props.isMobile?null:{legend:"",tickSize:0,format:"%b %d",tickPadding:10,legendOffset:0,orient:"bottom",legendPosition:"middle",tickValues:n.props.isMobile?"every 4 days":n.props.showAdvanced?"every 3 days":"every 2 days"},gridYValues:D,pointSize:0,useMesh:!0,animate:!1,pointLabel:"y",curve:"monotoneX",enableArea:!1,enableSlices:"x",enableGridX:!1,enableGridY:!0,pointBorderWidth:1,colors:function(e){return e.color},pointLabelYOffset:-12,legends:[{itemHeight:18,itemWidth:n.props.isMobile?70:100,translateX:n.props.isMobile?-35:0,translateY:n.props.isMobile?40:65,symbolSize:10,itemsSpacing:5,direction:"row",anchor:"bottom-left",symbolShape:"circle",itemTextColor:n.props.theme.colors.legend,effects:[{on:"hover",style:{itemTextColor:"light"===n.props.themeMode?"#000":"#fff"}}]}],theme:{axis:{ticks:{text:{fontSize:n.props.isMobile?12:14,fontWeight:600,fill:n.props.theme.colors.legend,fontFamily:n.props.theme.fonts.sansSerif}}},grid:{line:{stroke:n.props.theme.colors.lineChartStroke,strokeDasharray:"10 6"}},legends:{text:{fontWeight:500,fill:n.props.theme.colors.legend,textTransform:"capitalize",fontFamily:n.props.theme.fonts.sansSerif,fontSize:n.props.isMobile?12:14}}},pointColor:{from:"color",modifiers:[]},margin:n.props.isMobile?{top:20,right:20,bottom:40,left:65}:{top:20,right:40,bottom:80,left:80},sliceTooltip:function(e){var t=e.slice,n=t.points[0];return m.a.createElement(U.a,{point:n},"object"===typeof t.points&&t.points.length&&t.points.map(function(e){var t=e.serieId,n=e.data.yFormatted,a=e.data.apy;return m.a.createElement(j.a,{key:e.id,label:t,color:e.color,value:"".concat(n," <small>(").concat(a,"% APY)</small>")})}))}},e.abrupt("break",231);case 230:return e.abrupt("break",231);case 231:n.setState({chartType:w,chartProps:T,chartData:x});case 232:case"end":return e.stop()}},e,this)})),n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({chartData:null,chartType:null,chartProps:null}),this.loadUtils(),this.loadApiData();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t){var n,a,i,s,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.showAdvanced!==this.props.showAdvanced,a=t.apiResults_aa!==this.props.apiResults_aa,i=t.apiResults_bb!==this.props.apiResults_bb,s=t.apiResults!==this.props.apiResults,r=t.selectedToken!==this.props.selectedToken||JSON.stringify(t.tokenConfig)!==JSON.stringify(this.props.tokenConfig),(s||n||r||a||i)&&this.componentDidMount();case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"render",value:function(){return m.a.createElement(D.a,Object.assign({showLoader:!0},this.state.chartProps,{height:this.props.height,type:this.state.chartType,data:this.state.chartData,width:this.state.chartWidth,isMobile:this.props.isMobile,parentId:this.props.parentId,parentIdHeight:this.props.parentIdHeight}))}}]),t}(u.Component),A=n(88),I=n(170),P=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),p=0;p<a;p++)r[p]=arguments[p];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!0,processing:{rebalance:{txHash:null,loading:!1}},shouldRebalance:null},n.functionsUtil=null,n.componentUnmounted=!1,n.checkRebalance=Object(i.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setStateSafe({loading:!0}),e.next=3,n.functionsUtil.checkRebalance(n.props.tokenConfig);case 3:t=e.sent,n.setStateSafe({loading:!1,shouldRebalance:t});case 5:case"end":return e.stop()}},e,this)})),n.rebalance=function(){var e=Object(i.a)(o.a.mark(function e(t){var a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=function(e,t){if(e){var a={eventLabel:e.status,eventCategory:"Rebalance",eventAction:n.props.selectedToken};t&&(a.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==a.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(a),"success"===e.status?window.toastProvider.addMessage("Rebalance completed",{secondaryMessage:"Now the pool is balanced!",colorTheme:"light",actionHref:"",actionText:"",variant:"success"}):window.toastProvider.addMessage("Rebalance error",{secondaryMessage:"The rebalance has failed, try again...",colorTheme:"light",actionHref:"",actionText:"",variant:"failure"})}n.setStateSafe(function(e){return{processing:Object(C.a)({},e.processing,{rebalance:{txHash:null,loading:!1}})}}),n.checkRebalance()},i=function(e){var t=e.transactionHash;n.setStateSafe(function(e){return{processing:Object(C.a)({},e.processing,{rebalance:Object(C.a)({},e.processing.rebalance,{txHash:t})})}})},e.next=5,n.setStateSafe({processing:{rebalance:{txHash:null,loading:!0}}});case 5:n.props.contractMethodSendWrapper(n.props.tokenConfig.idle.token,"rebalance",[],null,a,i);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillUnmount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.componentUnmounted=!0;case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),this.checkRebalance();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),a=t.account!==this.props.account,(t.selectedToken!==this.props.selectedToken||a)&&this.checkRebalance();case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"setStateSafe",value:function(){var e=Object(i.a)(o.a.mark(function e(t){var n,a=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:null,this.componentUnmounted){e.next=3;break}return e.abrupt("return",this.setState(t,n));case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return m.a.createElement(d.h,{px:3,width:1,minHeight:"100px",alignItems:"center",flexDirection:"column",justifyContent:"center"},this.state.loading?m.a.createElement(k.a,{flexProps:{flexDirection:"row"},loaderProps:{size:"30px"},textProps:{ml:2},text:"Checking rebalance..."}):this.state.processing.rebalance.loading?m.a.createElement(I.a,Object.assign({},this.props,{waitText:"Rebalance estimated in",endMessage:"Finalizing rebalance request...",hash:this.state.processing.rebalance.txHash})):m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.u,{mt:0,mb:3,textAlign:"center"},this.state.shouldRebalance?"Rebalance the entire pool. All users will bless you.":"The pool is already balanced."),m.a.createElement(A.a,{buttonProps:{width:"auto",disabled:!this.state.shouldRebalance},handleClick:function(t){return e.rebalance(t)}},"Rebalance")))}}]),t}(u.Component),Y=n(4701),B=n(1198),F=n(108),z=n(189),R=n(138),H=n(1201),N=n(637),V=n(1335),G=(n(4761),n(57)),W=(n(4763),n(4765)),L=(n(4777),function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={quickSelection:"",ranges:{startDate:n.props.startDate?n.props.startDate:new Date,endDate:n.props.endDate?n.props.endDate:new Date,key:"selection"},options:Object.keys(n.props.quickSelections).map(function(e){return{value:e,label:n.props.quickSelections[e].label}})},n.componentDidUpdate=function(e){e.startDate===n.props.startDate&&e.endDate===n.props.endDate||n.setState({ranges:{startDate:n.props.startDate?n.props.startDate:new Date,endDate:n.props.endDate?n.props.endDate:new Date,key:"selection"}})},n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"handleSelect",value:function(e){this.setState({quickSelection:"",ranges:e.selection})}},{key:"handleQuickSelect",value:function(e){var t=this,n=null,a=y()(new Date),o=e.target.value;if(o&&this.props.quickSelections[o]){var i=this.props.quickSelections[o];n=a.clone().subtract(i.value,i.type)}else n=null,a=null;if(n&&a){var s={startDate:n=n._d,endDate:a=a._d,key:"selection"};this.setState({ranges:s,quickSelection:o},function(){t.closeModal()})}}},{key:"closeModal",value:function(){var e=this.props.handleSelect(this.state.ranges,this.state.quickSelection),t={startDate:e.startTimestampObj?e.startTimestampObj._d:new Date,endDate:e.endTimestampObj?e.endTimestampObj._d:new Date,key:"selection"};this.setState({ranges:t}),this.props.closeModal()}},{key:"render",value:function(){var e=this;return m.a.createElement(d.p,{isOpen:this.props.isOpen},m.a.createElement(G.a,{closeFunc:this.props.closeModal},m.a.createElement(G.a.Header,{title:"Select Date Range"}),m.a.createElement(G.a.Body,null,m.a.createElement(d.h,{width:1,flexDirection:"column",alignItems:"center"},m.a.createElement(d.g,{label:"Quick Date Selection",style:{display:"flex",width:"100%",alignItems:"stretch",justifyContent:"center"}},m.a.createElement(d.t,{style:{fontSize:"14px",height:"2.5em",boxShadow:"none",color:this.props.theme.colors.counter,backgroundColor:this.props.theme.colors.cardBg},width:"100%",required:!0,options:this.state.options,value:this.state.quickSelection,onChange:this.handleQuickSelect.bind(this)})),m.a.createElement(W.DateRange,{ranges:[this.state.ranges],minDate:this.props.minDate,maxDate:this.props.maxDate,className:this.props.themeMode,onChange:this.handleSelect.bind(this)}))),m.a.createElement(G.a.Footer,null,m.a.createElement(d.h,{px:[2,0],flexDirection:["column","row"],width:1,justifyContent:"center"},m.a.createElement(d.c,{my:2,mx:[0,2],borderRadius:4,mainColor:"blue",onClick:function(t){return e.closeModal(t)},size:this.props.isMobile?"small":"medium"},"APPLY")))))}}]),t}(m.a.Component)),_=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),p=0;p<a;p++)r[p]=arguments[p];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={aum:null,apr:null,days:"-",delta:null,earning:null,minDate:null,maxDate:null,carouselMax:1,rebalances:"-",buttonGroups:[],apiResults:null,carouselIndex:0,idleVersion:null,statsVersions:{},minStartTime:null,endTimestamp:null,govTokensPool:null,unlentBalance:null,quickSelection:null,startTimestamp:null,endTimestampObj:null,shouldRebalance:null,carouselOffsetLeft:0,startTimestampObj:null,apiResults_unfiltered:null,dateRangeModalOpened:!1},n.quickSelections={day:{value:1,type:"day",label:"Last day"},week:{value:1,type:"week",label:"Last week"},weeks:{value:2,type:"week",label:"Last 2 weeks"},month:{value:1,type:"month",label:"Last month"},ytd:{type:"day",label:"Year to date",value:y()().diff(y()("01/01/YYYY","DD/MM/YYYY"),"days")}},n.functionsUtil=null,n.componentUnmounted=null,n.setDateRange=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=y()(M.a.stats.tokens[n.props.selectedToken].startTimestamp),o=y()(e.startDate).isSameOrAfter(a)?y()(e.startDate):a,i=y()(e.endDate);o.isSame(i)&&i.add(1,"day"),i=y()(i.format("YYYY-MM-DD 23:59"),"YYYY-MM-DD HH:mm"),o.isBefore(n.state.minStartTime)&&(o=n.state.minStartTime),i.isAfter(n.state.maxEndDate)&&(i=n.state.maxEndDate);var s=parseInt(o._d.getTime()/1e3),r={minStartTime:a,endTimestamp:parseInt(i._d.getTime()/1e3),quickSelection:t,startTimestamp:s,endTimestampObj:i,startTimestampObj:o};return n.setStateSafe(r),r},n.setDateRangeModal=function(e){e!==n.state.dateRangeModalOpened&&n.setStateSafe({dateRangeModalOpened:e})},n.filterTokenData=function(e){return e.filter(function(e,t){return(!n.state.startTimestamp||e.timestamp>=n.state.startTimestamp)&&(!n.state.endTimestamp||e.timestamp<=n.state.endTimestamp)})},n.setIdleVersion=function(e){n.setStateSafe({idleVersion:e})},n.loadApiData=Object(i.a)(o.a.mark(function e(){var t,a,i,s,r,l,c,p,u,m,h,d,f,g,b,k,v,x,T,w,C,S,E,D,U,j,O,A;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.selectedToken&&n.props.tokenConfig){e.next=2;break}return e.abrupt("return",!1);case 2:return t=n.state.minDate?parseInt(n.functionsUtil.strToMoment(n.functionsUtil.strToMoment(n.state.minDate).format("DD/MM/YYYY 00:00:00"),"DD/MM/YYYY HH:mm:ss")._d.getTime()/1e3):null,a=n.state.maxDate?parseInt(n.functionsUtil.strToMoment(n.functionsUtil.strToMoment(n.state.maxDate).format("DD/MM/YYYY 23:59:59"),"DD/MM/YYYY HH:mm:ss")._d.getTime()/1e3):null,i=["v3","v4"].includes(n.state.idleVersion)&&"risk"===n.props.selectedStrategy,e.next=7,n.functionsUtil.getTokenApiData(n.props.tokenConfig.address,i,t,a,!0,7200);case 7:if(s=e.sent,(r=n.filterTokenData(s))&&s&&r.length&&s.length){e.next=11;break}return e.abrupt("return",!1);case 11:return l=r[0],c=Object.values(r).pop(),window.moment=y.a,0===(p=(c.timestamp-l.timestamp)/86400)&&(p=1),u=null,m="N/A",h=n.functionsUtil.fixTokenDecimals(c.idleSupply,18),d=n.functionsUtil.fixTokenDecimals(l.idlePrice,n.props.tokenConfig.decimals),f=n.functionsUtil.fixTokenDecimals(c.idlePrice,n.props.tokenConfig.decimals),g=h.times(f),e.next=24,n.functionsUtil.convertTokenBalance(g,n.props.selectedToken,n.props.tokenConfig,i);case 24:return g=e.sent,b=n.props.tokenConfig.protocols.filter(function(e){return"compound"===e.name})[0],k=b?l.protocolsData.filter(function(e){return e.protocolAddr.toLowerCase()===b.address.toLowerCase()})[0]:null,v=b?c.protocolsData.filter(function(e){return e.protocolAddr.toLowerCase()===b.address.toLowerCase()})[0]:null,"v4"===n.state.idleVersion?(u=(u=r.reduce(function(e,t){var a=n.functionsUtil.fixTokenDecimals(t.idleRate,18);return n.functionsUtil.BNify(e).plus(a)},0)).div(r.length),b&&(x=M.a.stats.protocols.compoundWithCOMP,T=x.rateField?x.rateField:"rate",w=(w=r.reduce(function(e,t){var a=t.protocolsData.find(function(e,t){return e.protocolAddr.toLowerCase()===b.address.toLowerCase()}),o="object"===typeof T&&T.length?T.reduce(function(e,t){return a&&a[t]?n.functionsUtil.BNify(e).plus(n.functionsUtil.BNify(a[t])):n.functionsUtil.BNify(e)},0):n.functionsUtil.BNify(a[T]);return o=n.functionsUtil.fixTokenDecimals(o,18),n.functionsUtil.BNify(e).plus(o)},0)).div(r.length),m=u.minus(w),parseFloat(m)<0&&(m=0),m=m.toFixed(2)),u=u.toFixed(2)):(C=f.div(d).minus(1).times(100),u=C.times(365).div(p).toFixed(2),k&&v&&(S=n.functionsUtil.fixTokenDecimals(k.price,n.props.tokenConfig.decimals),E=n.functionsUtil.fixTokenDecimals(v.price,n.props.tokenConfig.decimals),D=E.div(S).minus(1).times(100),m=C.minus(D).times(365).div(p),parseFloat(m)<0&&(m=0),m=m.toFixed(2))),U=0,r.forEach(function(e,t){if(t){var a=r[t-1],o=e.protocolsData.reduce(function(e,t){var a=n.functionsUtil.fixTokenDecimals(t.allocation,n.props.tokenConfig.decimals);return n.functionsUtil.BNify(e).plus(a)},0),i=a.protocolsData.reduce(function(e,t){var a=n.functionsUtil.fixTokenDecimals(t.allocation,n.props.tokenConfig.decimals);return n.functionsUtil.BNify(e).plus(a)},0),s=!1;e.protocolsData.forEach(function(e){if(!s){var t=a.protocolsData.find(function(t){return t.protocolAddr.toLowerCase()===e.protocolAddr.toLowerCase()}),r=n.functionsUtil.fixTokenDecimals(e.allocation,n.props.tokenConfig.decimals),l=t?n.functionsUtil.fixTokenDecimals(t.allocation,n.props.tokenConfig.decimals):n.functionsUtil.BNify(0);parseInt(parseFloat(r.div(o).times(100)))!==parseInt(parseFloat(l.div(i).times(100)))&&(U++,s=!0)}})}}),(j={})[n.props.selectedToken]=n.props.tokenConfig,e.next=35,n.functionsUtil.getGovTokenPool(null,j,"DAI");case 35:return(O=e.sent)&&(g=g.plus(O)),e.next=39,n.functionsUtil.getUnlentBalance(n.props.tokenConfig);case 39:(A=e.sent)&&(A=n.functionsUtil.formatMoney(parseFloat(A))),n.setStateSafe({aum:g,apr:u,days:p,delta:m,apiResults:r,rebalances:U,govTokensPool:O,unlentBalance:A,apiResults_unfiltered:s});case 42:case"end":return e.stop()}},e,this)})),n.selectToken=function(){var e=Object(i.a)(o.a.mark(function e(t,a){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.setStrategyToken(t,a);case 2:n.props.changeToken(a);case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),n.handleCarousel=function(e){var t=n.state.carouselIndex;"next"===e&&t<n.state.carouselMax?t++:"back"===e&&t>0&&t--;var a=window.jQuery("#carousel-cursor > div:eq(".concat(t,")")),o=-parseFloat(a.position().left)+"px";n.setStateSafe({carouselIndex:t,carouselOffsetLeft:o})},n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.loadParams();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.componentUnmounted=!0}},{key:"setStateSafe",value:function(){var e=Object(i.a)(o.a.mark(function e(t){var n,a=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:null,this.componentUnmounted){e.next=3;break}return e.abrupt("return",this.setState(t,n));case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getLatestAvailableVersion",value:function(){var e=this,t=M.a.stats.versions,n=null;return Object.keys(t).forEach(function(a){t[a].enabledStrategies.includes(e.props.selectedStrategy)&&(n=a)}),n}},{key:"getVersionInfo",value:function(e){if(e||(e=this.state.idleVersion),!M.a.stats.versions[e])return null;var t=Object.assign({},M.a.stats.versions[e]);if(t.strategiesParams&&t.strategiesParams[this.props.selectedStrategy]){var n=t.strategiesParams[this.props.selectedStrategy];Object.keys(n).forEach(function(e){t[e]=n[e]})}return t}},{key:"loadParams",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.selectedToken&&this.props.tokenConfig){e.next=2;break}return e.abrupt("return",!1);case 2:if(t={},n=this.props.match.params,a=Object.keys(this.props.availableTokens),n.customToken&&-1!==a.indexOf(n.customToken.toUpperCase())?t.selectedToken=n.customToken.toUpperCase():t.selectedToken=this.props.selectedToken.toUpperCase(),t.tokenConfig=this.props.availableTokens[t.selectedToken],t.minStartTime=y()(M.a.stats.tokens[this.props.selectedToken].startTimestamp,"YYYY-MM-DD"),t.maxEndDate=y()(),t.endTimestampObj=y()(y()().format("YYYY-MM-DD 23:59"),"YYYY-MM-DD HH:mm"),t.latestVersion=this.getLatestAvailableVersion(),t.idleVersion=null===this.state.idleVersion?t.latestVersion:this.state.idleVersion,i=this.getVersionInfo(t.idleVersion),t.idleVersion&&i.endTimestamp&&(s=y()(y()(1e3*i.endTimestamp).format("YYYY-MM-DD HH:mm"),"YYYY-MM-DD HH:mm"),t.endTimestampObj.isAfter(s)&&(t.endTimestampObj=s,t.endTimestamp=parseInt(t.endTimestampObj._d.getTime()/1e3)),t.maxEndDate&&!t.maxEndDate.isAfter(s)||(t.maxEndDate=s)),t.endTimestamp=parseInt(t.endTimestampObj._d.getTime()/1e3),t.startTimestampObj=t.endTimestampObj.clone().subtract(1,"month"),t.startTimestamp=parseInt(t.startTimestampObj._d.getTime()/1e3),t.idleVersion&&i.startTimestamp&&(r=y()(y()(1e3*i.startTimestamp).format("YYYY-MM-DD HH:mm"),"YYYY-MM-DD HH:mm"),t.startTimestampObj.isBefore(r)&&(t.startTimestampObj=r,t.startTimestamp=parseInt(t.startTimestampObj._d.getTime()/1e3)),t.minStartTime.isBefore(r)&&(t.minStartTime=r)),t.minDate=t.minStartTime._d,t.maxDate=t.maxEndDate._d,t===this.state){e.next=23;break}return e.next=23,this.setStateSafe(t);case 23:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.web3){e.next=3;break}return this.props.initWeb3(),e.abrupt("return",!1);case 3:return this.loadUtils(),e.next=6,this.loadParams();case 6:this.loadApiData(),this.loadCarousel();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadCarousel",value:function(){var e=this.props.isMobile?3:2;this.setStateSafe({carouselMax:e})}},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a,i,s,r,l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.contractsInitialized!==this.props.contractsInitialized,i=t.selectedStrategy!==this.props.selectedStrategy,s=t.selectedToken!==this.props.selectedToken||JSON.stringify(t.tokenConfig)!==JSON.stringify(this.props.tokenConfig),r=n.startTimestamp!==this.state.startTimestamp||n.endTimestamp!==this.state.endTimestamp,l=n.idleVersion!==this.state.idleVersion,t.isMobile!==this.props.isMobile&&this.loadCarousel(),!(a||s||i||l)){e.next=12;break}return e.next=10,this.componentDidMount();case 10:e.next=13;break;case 12:r&&this.loadApiData();case 13:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.functionsUtil.getGlobalConfig(["stats","tokens"])[this.props.selectedToken],n=Object.keys(M.a.stats.versions).filter(function(t){var n=e.getVersionInfo(t);return n.enabledTokens.includes(e.props.selectedToken)&&n.enabledStrategies.includes(e.props.selectedStrategy)}).map(function(t){return{value:t,label:e.getVersionInfo(t).label}}),a=this.getVersionInfo(this.state.idleVersion),o=null;this.state.idleVersion&&a&&(o=this.functionsUtil.getGlobalConfig(["stats","versions",this.state.idleVersion,"showPerformanceTooltip"])?this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken,"performanceTooltip"]):null);var i=n.find(function(t){return t.value===e.state.idleVersion});return m.a.createElement(d.h,{p:0,width:1,flexDirection:"column"},m.a.createElement(d.b,{mb:[3,4]},m.a.createElement(d.h,{flexDirection:["column","row"]},m.a.createElement(d.h,{width:[1,.4]},m.a.createElement(B.a,Object.assign({},this.props,{showPathMobile:!0,text:"ASSETS OVERVIEW",isMobile:this.props.isMobile,handleClick:function(t){return e.props.goToSection("stats")},path:[this.functionsUtil.getGlobalConfig(["strategies",this.props.selectedStrategy,"title"])]}))),m.a.createElement(d.h,{mt:[3,0],width:[1,.6],flexDirection:["column","row"],justifyContent:["center","space-between"]},m.a.createElement(d.h,{width:[1,.26],flexDirection:"column"},m.a.createElement(R.a,{innerProps:{p:1,height:["100%","46px"]},name:"idle-version",options:n,defaultValue:i,onChange:function(t){return e.setIdleVersion(t)}})),m.a.createElement(d.h,{mt:[3,0],width:[1,.3],flexDirection:"column"},m.a.createElement(z.a,Object.assign({innerProps:{p:1}},this.props))),m.a.createElement(d.h,{mt:[3,0],width:[1,.39],flexDirection:"column"},m.a.createElement(g.a,{cardProps:{p:1,display:"flex",alignItems:"center",height:["46px","100%"],justifyContent:"center"},isInteractive:!0,handleClick:function(t){return e.setDateRangeModal(!0)}},m.a.createElement(d.u,{fontWeight:3,color:"copyColor"},this.state.quickSelection?this.quickSelections[this.state.quickSelection].label:this.state.startTimestampObj&&this.state.endTimestampObj&&"".concat(this.state.startTimestampObj.format("DD/MM/YY")," - ").concat(this.state.endTimestampObj.format("DD/MM/YY")))))))),t.enabled?this.state.idleVersion&&this.functionsUtil.strToMoment(a.startTimestamp).isAfter(Date.now())?m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(g.a,{cardProps:{p:3,width:[1,.5]}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(d.k,{size:"2.3em",color:"cellText",name:"AccessTime"}),m.a.createElement(d.u,{mt:2,fontSize:2,color:"cellText",textAlign:"center"},"Idle Stats ",this.state.idleVersion," will be available shortly!")))):this.functionsUtil.strToMoment(t.startTimestamp).isAfter(Date.now())?m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(g.a,{cardProps:{p:3,width:[1,.5]}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(d.k,{size:"2.3em",color:"cellText",name:"AccessTime"}),m.a.createElement(d.u,{mt:2,fontSize:2,color:"cellText",textAlign:"center"},"Stats for ",this.props.selectedToken," will be available shortly!")))):m.a.createElement(d.b,{width:1},m.a.createElement(d.b,{mt:[3,0],mb:[3,4]},m.a.createElement(d.h,{width:1,alignItems:"center",justifyContent:"center",flexDirection:["column","row"]},m.a.createElement(d.h,{mb:[2,0],pr:[0,2],width:[1,.25],flexDirection:"column"},m.a.createElement(Y.a,{title:"Asset Under Management",label:this.state.unlentBalance?"Unlent funds: ".concat(this.state.unlentBalance," ").concat(this.props.selectedToken):this.props.selectedToken,labelTooltip:this.state.unlentBalance?this.functionsUtil.getGlobalConfig(["messages","cheapRedeem"]):null},m.a.createElement(F.a,Object.assign({precision:2,type:"money"},{lineHeight:1,fontSize:[4,5],fontWeight:[3,4],color:"statValue"},{unitProps:{ml:2,lineHeight:1,fontWeight:[2,3],color:"statValue",fontSize:[3,"23px"]},number:this.state.aum,flexProps:{alignItems:"baseline",justifyContent:"flex-start"},unit:this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken,"conversionRateField"])?"$":null})))),m.a.createElement(d.h,{mb:[2,0],pr:[0,2],width:[1,.25],flexDirection:"column"},m.a.createElement(Y.a,{title:"Avg APY",label:"Annualized"},m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:["column","row"]},m.a.createElement(N.a,{direction:"up",iconPos:"right",iconSize:"1.8em",justifyContent:"flex-start",width:1},m.a.createElement(d.u,{lineHeight:1,fontWeight:[3,4],color:"statValue",fontSize:[4,5]},this.state.apr,m.a.createElement(d.u.span,{color:"statValue",fontWeight:3,fontSize:["90%","70%"]},"%")))))),m.a.createElement(d.h,{mb:[2,0],pr:[0,2],width:[1,.25],flexDirection:"column"},m.a.createElement(Y.a,{title:"Overperformance on Compound",label:"Annualized"},this.state.delta&&!isNaN(this.state.delta)?m.a.createElement(N.a,{direction:"up",iconPos:"right",iconSize:"1.8em",justifyContent:"flex-start"},m.a.createElement(d.u,{lineHeight:1,fontSize:[4,5],fontWeight:[3,4],color:"statValue"},this.state.delta,m.a.createElement(d.u.span,{color:"statValue",fontWeight:3,fontSize:["90%","70%"]},"%"))):m.a.createElement(d.u,{lineHeight:1,fontSize:[4,5],fontWeight:[3,4],color:"statValue"},this.state.delta))),m.a.createElement(d.h,{mb:[2,0],pr:[0,2],width:[1,.25],flexDirection:"column"},m.a.createElement(Y.a,{label:" ",title:"Rebalances",value:this.state.rebalances.toString()})))),m.a.createElement(g.a,{title:"Historical Performance",description:o,cardProps:{mb:[3,4]}},m.a.createElement(d.h,{id:"chart-PRICE",width:1,mb:3},m.a.createElement(O,Object.assign({height:350},this.state,{parentId:"chart-PRICE",theme:this.props.theme,isMobile:this.props.isMobile,contracts:this.props.contracts,themeMode:this.props.themeMode,apiResults:this.state.apiResults,idleVersion:this.state.idleVersion,selectedToken:this.props.selectedToken,apiResults_unfiltered:this.state.apiResults_unfiltered,chartMode:this.state.idleVersion===this.state.latestVersion?"PRICE_V4":"PRICE"})))),m.a.createElement(g.a,{cardProps:{pb:3,mb:[3,4]}},m.a.createElement(d.h,{flexDirection:["column","row"],justifyContent:"space-between"},this.state.idleVersion===this.state.latestVersion&&m.a.createElement(d.h,{pt:2,width:[1,1/3],id:"allocation-chart",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start"},m.a.createElement(V.a,Object.assign({height:310},this.props,{parentId:"allocation-chart"})),m.a.createElement(P,this.props)),m.a.createElement(d.h,{mb:[0,3],id:"chart-ALL",pl:[0,this.state.idleVersion===this.state.latestVersion?0:3],width:[1,this.state.idleVersion===this.state.latestVersion?2/3:1]},m.a.createElement(d.h,{alignItems:"flex-start",justifyContent:"flex-start",flexDirection:"column",width:1},m.a.createElement(d.j.h4,{mb:2,ml:3,mt:[3,4],fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"Allocations over time"),m.a.createElement(O,Object.assign({height:350},this.state,{chartMode:"ALL",parentId:"chart-ALL",theme:this.props.theme,isMobile:this.props.isMobile,themeMode:this.props.themeMode,contracts:this.props.contracts,apiResults:this.state.apiResults,idleVersion:this.state.idleVersion,apiResults_unfiltered:this.state.apiResults_unfiltered})))))),m.a.createElement(d.h,{position:"relative"},m.a.createElement(d.h,{width:1,id:"carousel-container",justifyContent:"flex-end"},m.a.createElement(H.a,{buttonProps:{mr:3},iconName:"ArrowBack",disabled:0===this.state.carouselIndex,handleClick:function(t){return e.handleCarousel("back")}}),m.a.createElement(H.a,{iconName:"ArrowForward",handleClick:function(t){return e.handleCarousel("next")},disabled:this.state.carouselIndex===this.state.carouselMax})),m.a.createElement(d.h,{mt:5,height:"400px",position:"absolute",id:"carousel-cursor",width:["444%","200%"],justifyContent:"flex-start",left:this.state.carouselOffsetLeft,style:{transition:"left 0.3s ease-in-out"}},m.a.createElement(g.a,{cardProps:{mr:4,height:"fit-content",style:this.props.isMobile?{width:"100%"}:{width:"32vw"}}},m.a.createElement(d.h,{width:1,id:"chart-AUM"},m.a.createElement(d.h,{mb:3,width:1,flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},m.a.createElement(d.j.h4,{ml:3,mt:3,mb:2,fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"Asset Under Management"),m.a.createElement(O,Object.assign({height:300},this.state,{chartMode:"AUM",parentId:"chart-AUM",theme:this.props.theme,isMobile:this.props.isMobile,themeMode:this.props.themeMode,contracts:this.props.contracts,apiResults:this.state.apiResults,idleVersion:this.state.idleVersion,apiResults_unfiltered:this.state.apiResults_unfiltered}))))),m.a.createElement(g.a,{cardProps:{mr:4,height:"fit-content",style:this.props.isMobile?{width:"100%"}:{width:"32vw"}}},m.a.createElement(d.h,{id:"chart-APR",width:1},m.a.createElement(d.h,{mb:3,width:1,flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},m.a.createElement(d.j.h4,{mb:2,ml:3,mt:3,fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"APRs"),m.a.createElement(O,Object.assign({height:300},this.state,{chartMode:"APR",parentId:"chart-APR",theme:this.props.theme,isMobile:this.props.isMobile,themeMode:this.props.themeMode,contracts:this.props.contracts,apiResults:this.state.apiResults,idleVersion:this.state.idleVersion,apiResults_unfiltered:this.state.apiResults_unfiltered}))))),m.a.createElement(g.a,{cardProps:{mr:4,height:"fit-content",style:this.props.isMobile?{width:"100%"}:{width:"32vw"}}},m.a.createElement(d.h,{id:"chart-VOL",width:1},m.a.createElement(d.h,{mb:3,width:1,flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},m.a.createElement(d.j.h4,{mb:2,ml:3,mt:3,fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"Volume"),m.a.createElement(O,Object.assign({height:300},this.state,{chartMode:"VOL",parentId:"chart-VOL",theme:this.props.theme,isMobile:this.props.isMobile,themeMode:this.props.themeMode,contracts:this.props.contracts,apiResults:this.state.apiResults,idleVersion:this.state.idleVersion,apiResults_unfiltered:this.state.apiResults_unfiltered})))))))):m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(g.a,{cardProps:{p:3,width:[1,.5]}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(d.k,{size:"2.3em",color:"cellText",name:"DoNotDisturb"}),m.a.createElement(d.u,{mt:2,fontSize:2,color:"cellText",textAlign:"center"},"Stats for ",this.props.selectedToken," are not available!")))),m.a.createElement(L,Object.assign({},this.props,{minDate:this.state.minDate,maxDate:this.state.maxDate,handleSelect:this.setDateRange,quickSelections:this.quickSelections,isOpen:this.state.dateRangeModalOpened,closeModal:function(t){return e.setDateRangeModal(!1)},startDate:this.state.startTimestampObj?this.state.startTimestampObj._d:null,endDate:this.state.endTimestampObj?this.state.endTimestampObj._d:null})))}}]),t}(u.Component),q=n(1154),X=n(92),J=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={options:null,defaultValue:null,CustomOptionValue:null,CustomValueContainer:null},n.functionsUtil=null,n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"onChange",value:function(){var e=Object(i.a)(o.a.mark(function e(t){var n,a=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Object.keys(this.props.availableTranches).map(function(e){return Object.keys(a.props.availableTranches[e]).map(function(a){return t===a&&(n=e),0}),0}),e.next=3,this.props.changeProtocolToken(n,t);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"loadComponents",value:function(){var e=this,t=[];Object.keys(this.props.availableTranches).map(function(n){return Object.keys(e.props.availableTranches[n]).map(function(a){var o=e.props.availableTranches[n][a];return t.push({value:a,label:a,tokenConfig:o}),0}),0});var n=t,a=this.props.selectedToken?n.find(function(t){return t.value.toUpperCase()===e.props.selectedToken.toUpperCase()}):null;this.setState({options:n,defaultValue:a,CustomOptionValue:function(e){var t=e.value,n=e.data.tokenConfig;return m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},m.a.createElement(d.h,{alignItems:"center"},m.a.createElement(X.a,{token:t,tokenConfig:n,fieldInfo:{name:"icon",props:{mr:2,width:"2em",height:"2em"}}}),m.a.createElement(X.a,{token:t,fieldInfo:{name:"tokenName",props:{fontSize:[1,2],fontWeight:500,color:"copyColor"}}})))},CustomValueContainer:function(e){var t=-1!==e.selectProps.options.indexOf(e.selectProps.value)?e.selectProps.value:a;if(!t)return null;var n=t.value,o=t.tokenConfig;return m.a.createElement(d.h,Object.assign({style:{flex:"1"},justifyContent:"space-between"},e.innerProps),m.a.createElement(d.h,Object.assign({p:0,width:1},e.innerProps,{alignItems:"center",flexDirection:"row",style:{cursor:"pointer"},justifyContent:"flex-start"}),m.a.createElement(X.a,{token:n,tokenConfig:o,fieldInfo:{name:"icon",props:{mr:2,height:"2em"}}}),m.a.createElement(X.a,{token:n,fieldInfo:{name:"tokenName",props:{fontSize:[1,2],fontWeight:500,color:"copyColor"}}})))}})}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),this.loadComponents(),this.setState({props:this.props});case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),a=t.selectedToken!==this.props.selectedToken,(JSON.stringify(Object.keys(t.availableTranches))!==JSON.stringify(Object.keys(this.props.availableTranches))||a)&&this.loadComponents();case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.options&&this.state.defaultValue&&this.state.CustomOptionValue&&this.state.CustomValueContainer&&this.props.availableTranches&&Object.keys(this.props.availableTranches).length?m.a.createElement(R.a,Object.assign({},this.props,{name:"assets",options:this.state.options,innerProps:this.props.innerProps,isSearchable:this.props.isSearchable,defaultValue:this.state.defaultValue,selectedToken:this.props.selectedToken,CustomOptionValue:this.state.CustomOptionValue,CustomValueContainer:this.state.CustomValueContainer,onChange:this.onChange.bind(this)})):null}}]),t}(u.Component),K=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),p=0;p<a;p++)r[p]=arguments[p];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={aum:null,apr:null,days:"-",delta:null,earning:null,minDate:null,maxDate:null,carouselMax:1,rebalances:"-",buttonGroups:[],apiResults:null,carouselIndex:0,idleVersion:null,minStartTime:null,endTimestamp:null,apiResults_aa:null,apiResults_bb:null,govTokensPool:null,unlentBalance:null,quickSelection:null,startTimestamp:null,endTimestampObj:null,shouldRebalance:null,carouselOffsetLeft:0,seniorTrancheApy:null,juniorTrancheApy:null,startTimestampObj:null,dateRangeModalOpened:!1,apiResults_unfiltered:null,seniorTrancheConverage:null,apiResults_unfiltered_aa:null,apiResults_unfiltered_bb:null},n.quickSelections={day:{value:1,type:"day",label:"Last day"},week:{value:1,type:"week",label:"Last week"},weeks:{value:2,type:"week",label:"Last 2 weeks"},month:{value:1,type:"month",label:"Last month"},ytd:{type:"day",label:"Year to date",value:y()().diff(y()("01/01/YYYY","DD/MM/YYYY"),"days")}},n.functionsUtil=null,n.componentUnmounted=null,n.setDateRange=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=n.functionsUtil.getGlobalConfig(["stats","tokens",n.props.selectedToken.toUpperCase(),"startTimestamp"]),o=a?y()(e.startDate).isSameOrAfter(a)?y()(e.startDate):a:y()(e.startDate),i=y()(e.endDate);o.isSame(i)&&i.add(1,"day"),i=y()(i.format("YYYY-MM-DD 23:59"),"YYYY-MM-DD HH:mm"),o.isBefore(n.state.minStartTime)&&(o=n.state.minStartTime),i.isAfter(n.state.maxEndDate)&&(i=n.state.maxEndDate);var s=parseInt(o._d.getTime()/1e3),r={minStartTime:a,endTimestamp:parseInt(i._d.getTime()/1e3),quickSelection:t,startTimestamp:s,endTimestampObj:i,startTimestampObj:o};return n.setStateSafe(r),r},n.setDateRangeModal=function(e){e!==n.state.dateRangeModalOpened&&n.setStateSafe({dateRangeModalOpened:e})},n.filterTokenData=function(e){return e.filter(function(e,t){return(!n.state.startTimestamp||e.timeStamp>=n.state.startTimestamp)&&(!n.state.endTimestamp||e.timeStamp<=n.state.endTimestamp)})},n.loadApiData=Object(i.a)(o.a.mark(function e(){var t,a,i,s,r,l,c,p,u,m,h,d,f,g,b,k,v,x,y,T;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.selectedToken&&n.props.selectedProtocol&&n.props.selectedStrategy&&n.props.tokenConfig){e.next=2;break}return e.abrupt("return",!1);case 2:return t=n.state.minDate?parseInt(n.functionsUtil.strToMoment(n.functionsUtil.strToMoment(n.state.minDate).format("DD/MM/YYYY 00:00:00"),"DD/MM/YYYY HH:mm:ss")._d.getTime()/1e3):null,a=n.state.maxDate?parseInt(n.functionsUtil.strToMoment(n.functionsUtil.strToMoment(n.state.maxDate).format("DD/MM/YYYY 23:59:59"),"DD/MM/YYYY HH:mm:ss")._d.getTime()/1e3):null,e.next=6,n.functionsUtil.getSubgraphTrancheInfo(n.props.tokenConfig.AA.address,t,a);case 6:return i=e.sent,e.next=9,n.functionsUtil.getSubgraphTrancheInfo(n.props.tokenConfig.BB.address,t,a);case 9:if(s=e.sent,r=n.filterTokenData(i),l=n.filterTokenData(s),r&&i&&r.length&&i.length&&l&&s&&l.length&&s.length){e.next=14;break}return e.abrupt("return",!1);case 14:return c=Object.values(r)[0],p=Object.values(l)[0],u=Object.values(r).pop(),m=Object.values(l).pop(),h=n.functionsUtil.fixTokenDecimals(u.contractValue,n.props.tokenConfig.decimals),d=n.functionsUtil.fixTokenDecimals(m.contractValue,n.props.tokenConfig.decimals),e.next=22,n.functionsUtil.convertTrancheTokenBalance(h.plus(d),n.props.tokenConfig);case 22:f=e.sent,g=n.functionsUtil.fixTokenDecimals(c.virtualPrice,n.props.tokenConfig.decimals),b=n.functionsUtil.fixTokenDecimals(u.virtualPrice,n.props.tokenConfig.decimals),k=b.div(g).minus(1).times(100).toFixed(2),v=n.functionsUtil.fixTokenDecimals(p.virtualPrice,n.props.tokenConfig.decimals),x=n.functionsUtil.fixTokenDecimals(m.virtualPrice,n.props.tokenConfig.decimals),y=x.div(v).minus(1).times(100).toFixed(2),T=Math.min(d.div(h).times(100),100).toFixed(2),n.setStateSafe({aum:f,apiResults_aa:r,apiResults_bb:l,seniorTrancheApy:k,juniorTrancheApy:y,seniorTrancheConverage:T,apiResults_unfiltered_aa:i,apiResults_unfiltered_bb:s});case 31:case"end":return e.stop()}},e,this)})),n.selectToken=function(){var e=Object(i.a)(o.a.mark(function e(t,a){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.setStrategyToken(t,a);case 2:n.props.changeToken(a);case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),n.handleCarousel=function(e){var t=n.state.carouselIndex;"next"===e&&t<n.state.carouselMax?t++:"back"===e&&t>0&&t--;var a=window.jQuery("#carousel-cursor > div:eq(".concat(t,")")),o=-parseFloat(a.position().left)+"px";n.setStateSafe({carouselIndex:t,carouselOffsetLeft:o})},n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.loadParams();case 3:return e.next=5,this.loadApiData();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.componentUnmounted=!0}},{key:"setStateSafe",value:function(){var e=Object(i.a)(o.a.mark(function e(t){var n,a=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:null,this.componentUnmounted){e.next=3;break}return e.abrupt("return",this.setState(t,n));case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"selectTranche",value:function(e){var t=this.functionsUtil.getGlobalConfig(["tranches",e]);t&&this.props.selectTrancheType(t.route)}},{key:"loadParams",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.selectedToken&&this.props.tokenConfig){e.next=2;break}return e.abrupt("return",!1);case 2:if(t={},n=this.props.match.params,a=Object.keys(this.props.availableTokens),n.customToken&&-1!==a.indexOf(n.customToken.toUpperCase())?t.selectedToken=n.customToken.toUpperCase():t.selectedToken=this.props.selectedToken.toUpperCase(),t.tokenConfig=this.props.availableTokens[t.selectedToken],t.minStartTime=y()("2021-12-01","YYYY-MM-DD"),t.maxEndDate=y()(),t.endTimestampObj=y()(y()().format("YYYY-MM-DD 23:59"),"YYYY-MM-DD HH:mm"),t.endTimestamp=parseInt(t.endTimestampObj._d.getTime()/1e3),t.startTimestampObj=t.endTimestampObj.clone().subtract(1,"month"),t.startTimestamp=parseInt(t.startTimestampObj._d.getTime()/1e3),t.minDate=t.minStartTime._d,t.maxDate=t.maxEndDate._d,t===this.state){e.next=18;break}return e.next=18,this.setStateSafe(t);case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.web3){e.next=3;break}return this.props.initWeb3(),e.abrupt("return",!1);case 3:return this.loadUtils(),e.next=6,this.loadParams();case 6:this.loadApiData(),this.loadCarousel();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadCarousel",value:function(){var e=this.props.isMobile?4:3;this.setStateSafe({carouselMax:e})}},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a,i,s,r,l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.contractsInitialized!==this.props.contractsInitialized,i=t.selectedStrategy!==this.props.selectedStrategy,s=t.selectedProtocol!==this.props.selectedProtocol,r=t.selectedToken!==this.props.selectedToken||JSON.stringify(t.tokenConfig)!==JSON.stringify(this.props.tokenConfig),l=n.startTimestamp!==this.state.startTimestamp||n.endTimestamp!==this.state.endTimestamp,t.isMobile!==this.props.isMobile&&this.loadCarousel(),!(a||r||i||s)){e.next=12;break}return e.next=10,this.componentDidMount();case 10:e.next=13;break;case 12:l&&this.loadApiData();case 13:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.functionsUtil.getGlobalConfig(["stats","tokens"])[this.props.selectedToken.toUpperCase()],n=this.functionsUtil.capitalize(this.functionsUtil.getGlobalConfig(["tranches","AA","baseName"])),a=this.functionsUtil.capitalize(this.functionsUtil.getGlobalConfig(["tranches","BB","baseName"]));return m.a.createElement(d.h,{p:0,width:1,flexDirection:"column"},m.a.createElement(d.b,{mb:[3,4]},m.a.createElement(d.h,{flexDirection:["column","row"]},m.a.createElement(d.h,{width:[1,.4]},m.a.createElement(B.a,Object.assign({},this.props,{showPathMobile:!0,text:"ASSETS OVERVIEW",isMobile:this.props.isMobile,handleClick:function(t){return e.props.goToSection("stats")},path:[this.functionsUtil.getGlobalConfig(["strategies",this.props.selectedStrategy,"title"])]}))),m.a.createElement(d.h,{mt:[3,0],width:[1,.6],flexDirection:["column","row"],justifyContent:["center","space-between"]},m.a.createElement(d.h,{width:[1,.26],flexDirection:"column"}),m.a.createElement(d.h,{mt:[3,0],width:[1,.3],flexDirection:"column"},m.a.createElement(J,Object.assign({innerProps:{p:1}},this.props))),m.a.createElement(d.h,{mt:[3,0],width:[1,.39],flexDirection:"column"},m.a.createElement(g.a,{cardProps:{p:1,display:"flex",alignItems:"center",height:["46px","100%"],justifyContent:"center"},isInteractive:!0,handleClick:function(t){return e.setDateRangeModal(!0)}},m.a.createElement(d.u,{fontWeight:3,color:"copyColor"},this.state.quickSelection?this.quickSelections[this.state.quickSelection].label:this.state.startTimestampObj&&this.state.endTimestampObj&&"".concat(this.state.startTimestampObj.format("DD/MM/YY")," - ").concat(this.state.endTimestampObj.format("DD/MM/YY")))))))),t&&t.enabled?this.functionsUtil.strToMoment(t.startTimestamp).isAfter(Date.now())?m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(g.a,{cardProps:{p:3,width:[1,.5]}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(d.k,{size:"2.3em",color:"cellText",name:"AccessTime"}),m.a.createElement(d.u,{mt:2,fontSize:2,color:"cellText",textAlign:"center"},"Stats for ",this.props.selectedToken," will be available shortly!")))):m.a.createElement(d.b,{width:1},m.a.createElement(d.h,{width:1,alignItems:"center",justifyContent:"flex-start",flexDirection:["column","row"]},m.a.createElement(d.h,{mb:[2,4],pr:[0,2],width:[1,.25],flexDirection:"row"},m.a.createElement(Y.a,{title:"Asset Under Management",label:"".concat(n," Tranche AUM + ").concat(a," Tranche AUM")},m.a.createElement(F.a,Object.assign({unit:"$",precision:2,type:"money"},{lineHeight:1,fontSize:[4,5],fontWeight:[3,4],color:"statValue"},{unitProps:{ml:2,lineHeight:1,fontWeight:[3,4],color:"statValue",fontSize:[3,5]},number:this.state.aum,flexProps:{alignItems:"baseline",justifyContent:"flex-start"}})))),m.a.createElement(d.h,{mb:[2,4],pr:[0,2],width:[1,.25],flexDirection:"row"},m.a.createElement(Y.a,{label:"Annualized",title:"Performance ".concat(n," Tranche")},m.a.createElement(N.a,{direction:"up",iconPos:"right",iconSize:"1.8em",justifyContent:"flex-start",width:1},m.a.createElement(d.u,{lineHeight:1,fontWeight:[3,4],color:"statValue",fontSize:[4,5]},this.state.seniorTrancheApy,m.a.createElement(d.u.span,{color:"statValue",fontWeight:3,fontSize:["90%","70%"]},"%"))))),m.a.createElement(d.h,{mb:[2,4],pr:[0,2],width:[1,.25],flexDirection:"row"},m.a.createElement(Y.a,{label:"Annualized",title:"Performance ".concat(a," Tranche")},m.a.createElement(N.a,{direction:"up",iconPos:"right",iconSize:"1.8em",justifyContent:"flex-start",width:1},m.a.createElement(d.u,{lineHeight:1,fontWeight:[3,4],color:"statValue",fontSize:[4,5]},this.state.juniorTrancheApy,m.a.createElement(d.u.span,{color:"statValue",fontWeight:3,fontSize:["90%","70%"]},"%"))))),m.a.createElement(d.h,{mb:[2,4],pr:[0,2],width:[1,.25],flexDirection:"row"},m.a.createElement(Y.a,{title:"".concat(n," Tranche coverage"),label:"Covered by ".concat(a," Tranche AUM")},m.a.createElement(d.u,{lineHeight:1,fontWeight:[3,4],color:"statValue",fontSize:[4,5]},this.state.seniorTrancheConverage,m.a.createElement(d.u.span,{color:"statValue",fontWeight:3,fontSize:["90%","70%"]},"%"))))),m.a.createElement(g.a,{title:"Historical Performance",description:null,cardProps:{mb:[3,4]}},m.a.createElement(d.h,{mb:3,width:1,id:"chart-PRICE"},m.a.createElement(O,Object.assign({height:350},this.state,{parentId:"chart-PRICE",theme:this.props.theme,chartMode:"PRICE_TRANCHE",isMobile:this.props.isMobile,contracts:this.props.contracts,themeMode:this.props.themeMode,tokenConfig:this.props.tokenConfig,apiResults_aa:this.state.apiResults_aa,apiResults_bb:this.state.apiResults_bb,selectedToken:this.props.selectedToken})))),m.a.createElement(d.h,{position:"relative"},m.a.createElement(d.h,{width:1,id:"carousel-container",justifyContent:"flex-end"},m.a.createElement(H.a,{buttonProps:{mr:3},iconName:"ArrowBack",disabled:0===this.state.carouselIndex,handleClick:function(t){return e.handleCarousel("back")}}),m.a.createElement(H.a,{iconName:"ArrowForward",handleClick:function(t){return e.handleCarousel("next")},disabled:this.state.carouselIndex===this.state.carouselMax})),m.a.createElement(d.h,{mt:5,height:"400px",position:"absolute",id:"carousel-cursor",width:["555%","200%"],justifyContent:"flex-start",left:this.state.carouselOffsetLeft,style:{transition:"left 0.3s ease-in-out"}},m.a.createElement(g.a,{cardProps:{mr:4,height:"fit-content",style:this.props.isMobile?{width:"100%"}:{width:"32vw"}}},m.a.createElement(d.h,{width:1,id:"chart-AUM"},m.a.createElement(d.h,{mb:3,width:1,flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},m.a.createElement(d.j.h4,{ml:3,mt:3,mb:2,fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"Asset Under Management"),m.a.createElement(O,Object.assign({height:300},this.state,{parentId:"chart-AUM",theme:this.props.theme,chartMode:"AUM_TRANCHE",isMobile:this.props.isMobile,themeMode:this.props.themeMode,contracts:this.props.contracts,idleVersion:this.state.idleVersion,tokenConfig:this.props.tokenConfig,apiResults_aa:this.state.apiResults_aa,apiResults_bb:this.state.apiResults_bb,selectedToken:this.props.selectedToken}))))),m.a.createElement(g.a,{cardProps:{mr:4,height:"fit-content",style:this.props.isMobile?{width:"100%"}:{width:"32vw"}}},m.a.createElement(d.h,{width:1,id:"chart-APR"},m.a.createElement(d.h,{mb:3,width:1,flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},m.a.createElement(d.j.h4,{mb:2,ml:3,mt:3,fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"APRs"),m.a.createElement(O,Object.assign({height:300},this.state,{parentId:"chart-APR",theme:this.props.theme,chartMode:"APR_TRANCHE",isMobile:this.props.isMobile,themeMode:this.props.themeMode,contracts:this.props.contracts,idleVersion:this.state.idleVersion,tokenConfig:this.props.tokenConfig,apiResults_aa:this.state.apiResults_aa,apiResults_bb:this.state.apiResults_bb,apiResults_unfiltered_aa:this.state.apiResults_unfiltered_aa,apiResults_unfiltered_bb:this.state.apiResults_unfiltered_bb}))))),m.a.createElement(g.a,{cardProps:{mr:4,height:"fit-content",style:this.props.isMobile?{width:"100%"}:{width:"32vw"}}},m.a.createElement(d.h,{width:1,id:"chart-VOL"},m.a.createElement(d.h,{mb:3,width:1,flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},m.a.createElement(d.j.h4,{mb:2,ml:3,mt:3,fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},n," Tranche Coverage"),m.a.createElement(O,Object.assign({height:300},this.state,{parentId:"chart-VOL",theme:this.props.theme,chartMode:"COVERAGE_TRANCHE",isMobile:this.props.isMobile,themeMode:this.props.themeMode,contracts:this.props.contracts,apiResults_aa:this.state.apiResults_aa,apiResults_bb:this.state.apiResults_bb,idleVersion:this.state.idleVersion,tokenConfig:this.props.tokenConfig,apiResults_unfiltered_aa:this.state.apiResults_unfiltered_aa,apiResults_unfiltered_bb:this.state.apiResults_unfiltered_bb}))))),m.a.createElement(g.a,{cardProps:{mr:4,height:"fit-content",style:this.props.isMobile?{width:"100%"}:{width:"32vw"}}},m.a.createElement(d.h,{width:1,id:"chart-VOL-AA"},m.a.createElement(d.h,{mb:3,width:1,flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},m.a.createElement(d.j.h4,{mb:2,ml:3,mt:3,fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"Volume ",n," Tranche"),m.a.createElement(O,Object.assign({height:300},this.state,{theme:this.props.theme,parentId:"chart-VOL-AA",chartMode:"VOL_TRANCHE",isMobile:this.props.isMobile,themeMode:this.props.themeMode,contracts:this.props.contracts,apiResults:this.state.apiResults_aa,idleVersion:this.state.idleVersion,tokenConfig:this.props.tokenConfig,apiResults_unfiltered:this.state.apiResults_unfiltered_aa}))))),m.a.createElement(g.a,{cardProps:{mr:4,height:"fit-content",style:this.props.isMobile?{width:"100%"}:{width:"32vw"}}},m.a.createElement(d.h,{width:1,id:"chart-VOL-BB"},m.a.createElement(d.h,{mb:3,width:1,flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},m.a.createElement(d.j.h4,{mb:2,ml:3,mt:3,fontWeight:4,fontSize:[2,3],textAlign:"left",color:"dark-gray",lineHeight:"initial"},"Volume ",a," Tranche"),m.a.createElement(O,Object.assign({height:300},this.state,{theme:this.props.theme,chartMode:"VOL_TRANCHE",parentId:"chart-VOL-BB",isMobile:this.props.isMobile,themeMode:this.props.themeMode,contracts:this.props.contracts,apiResults:this.state.apiResults_bb,idleVersion:this.state.idleVersion,tokenConfig:this.props.tokenConfig,apiResults_unfiltered:this.state.apiResults_unfiltered_bb})))))))):m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(g.a,{cardProps:{p:3,width:[1,.5]}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(d.k,{size:"2.3em",color:"cellText",name:"DoNotDisturb"}),m.a.createElement(d.u,{mt:2,fontSize:2,color:"cellText",textAlign:"center"},"Stats for ",this.props.selectedToken," are not available!")))),m.a.createElement(L,Object.assign({},this.props,{minDate:this.state.minDate,maxDate:this.state.maxDate,handleSelect:this.setDateRange,quickSelections:this.quickSelections,isOpen:this.state.dateRangeModalOpened,closeModal:function(t){return e.setDateRangeModal(!1)},startDate:this.state.startTimestampObj?this.state.startTimestampObj._d:null,endDate:this.state.endTimestampObj?this.state.endTimestampObj._d:null})))}}]),t}(u.Component),$=n(191),Q=n(634),Z=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),p=0;p<a;p++)r[p]=arguments[p];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={aum:null,apr:null,days:"-",delta:null,earning:null,minDate:null,maxDate:null,carouselMax:1,rebalances:"-",buttonGroups:[],apiResults:null,carouselIndex:0,idleVersion:null,statsVersions:{},minStartTime:null,endTimestamp:null,showAdvanced:!0,govTokensPool:null,unlentBalance:null,quickSelection:null,startTimestamp:null,endTimestampObj:null,shouldRebalance:null,carouselOffsetLeft:0,startTimestampObj:null,showRefreshIdleSpeed:!1,dateRangeModalOpened:!1,apiResults_unfiltered:null},n.quickSelections={day:{value:1,type:"day",label:"Last day"},week:{value:1,type:"week",label:"Last week"},weeks:{value:2,type:"week",label:"Last 2 weeks"},month:{value:1,type:"month",label:"Last month"},ytd:{type:"day",label:"Year to date",value:y()().diff(y()("01/01/YYYY","DD/MM/YYYY"),"days")}},n.functionsUtil=null,n.componentUnmounted=null,n.setDateRange=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=y()(M.a.stats.tokens[n.props.selectedToken.toUpperCase()].startTimestamp),o=y()(e.startDate).isSameOrAfter(a)?y()(e.startDate):a,i=y()(e.endDate);o.isSame(i)&&i.add(1,"day"),i=y()(i.format("YYYY-MM-DD 23:59"),"YYYY-MM-DD HH:mm"),o.isBefore(n.state.minStartTime)&&(o=n.state.minStartTime),i.isAfter(n.state.maxEndDate)&&(i=n.state.maxEndDate);var s=parseInt(o._d.getTime()/1e3),r={minStartTime:a,endTimestamp:parseInt(i._d.getTime()/1e3),quickSelection:t,startTimestamp:s,endTimestampObj:i,startTimestampObj:o};return n.setStateSafe(r),r},n.toggleAdvancedCharts=function(e){e.preventDefault(),n.setStateSafe({showAdvanced:!n.state.showAdvanced})},n.setDateRangeModal=function(e){e!==n.state.dateRangeModalOpened&&n.setStateSafe({dateRangeModalOpened:e})},n.filterTokenData=function(e){return e.filter(function(e,t){return(!n.state.startTimestamp||e.timestamp>=n.state.startTimestamp)&&(!n.state.endTimestamp||e.timestamp<=n.state.endTimestamp)})},n.setIdleVersion=function(e){n.setStateSafe({idleVersion:e})},n.loadApiData=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)})),n.selectToken=function(){var e=Object(i.a)(o.a.mark(function e(t,a){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.setStrategyToken(t,a);case 2:n.props.changeToken(a);case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),n.selectTranche=function(){var e=Object(i.a)(o.a.mark(function e(t,a,i){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.setStrategyToken(t,i,a);case 2:n.props.changeProtocolToken(a,i);case 3:case"end":return e.stop()}},e,this)}));return function(t,n,a){return e.apply(this,arguments)}}(),n.handleCarousel=function(e){var t=n.state.carouselIndex;"next"===e&&t<n.state.carouselMax?t++:"back"===e&&t>0&&t--;var a=window.jQuery("#carousel-cursor > div:eq(".concat(t,")")),o=-parseFloat(a.position().left)+"px";n.setStateSafe({carouselIndex:t,carouselOffsetLeft:o})},n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.loadParams();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.componentUnmounted=!0}},{key:"setStateSafe",value:function(){var e=Object(i.a)(o.a.mark(function e(t){var n,a=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:null,this.componentUnmounted){e.next=3;break}return e.abrupt("return",this.setState(t,n));case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"showRefreshIdleSpeed",value:function(){this.setStateSafe({showRefreshIdleSpeed:!0})}},{key:"getLatestAvailableVersion",value:function(){var e=this,t=M.a.stats.versions,n=null;return Object.keys(t).forEach(function(a){t[a].enabledStrategies.includes(e.props.selectedStrategy)&&(n=a)}),n}},{key:"getVersionInfo",value:function(e){if(e||(e=this.state.idleVersion),!M.a.stats.versions[e])return null;var t=Object.assign({},M.a.stats.versions[e]);if(t.strategiesParams&&t.strategiesParams[this.props.selectedStrategy]){var n=t.strategiesParams[this.props.selectedStrategy];Object.keys(n).forEach(function(e){t[e]=n[e]})}return t}},{key:"loadParams",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.selectedToken){e.next=2;break}return e.abrupt("return",!1);case 2:if(t={},n=this.props.match.params,a=Object.keys(this.props.availableTokens),"tranches"===this.props.selectedStrategy?t.selectedToken=this.props.selectedToken:n.customToken&&-1!==a.indexOf(n.customToken.toUpperCase())?t.selectedToken=n.customToken.toUpperCase():t.selectedToken=this.props.selectedToken.toUpperCase(),t.tokenConfig=this.props.availableTokens[t.selectedToken],t.minStartTime=y()(M.a.stats.tokens[this.props.selectedToken.toUpperCase()].startTimestamp,"YYYY-MM-DD"),t.maxEndDate=y()(),t.endTimestampObj=y()(y()().format("YYYY-MM-DD 23:59"),"YYYY-MM-DD HH:mm"),t.latestVersion=this.getLatestAvailableVersion(),t.idleVersion=null===this.state.idleVersion?t.latestVersion:this.state.idleVersion,i=this.getVersionInfo(t.idleVersion),t.idleVersion&&i.endTimestamp&&(s=y()(y()(1e3*i.endTimestamp).format("YYYY-MM-DD HH:mm"),"YYYY-MM-DD HH:mm"),t.endTimestampObj.isAfter(s)&&(t.endTimestampObj=s,t.endTimestamp=parseInt(t.endTimestampObj._d.getTime()/1e3)),t.maxEndDate&&!t.maxEndDate.isAfter(s)||(t.maxEndDate=s)),t.endTimestamp=parseInt(t.endTimestampObj._d.getTime()/1e3),t.startTimestampObj=t.endTimestampObj.clone().subtract(1,"month"),t.startTimestamp=parseInt(t.startTimestampObj._d.getTime()/1e3),t.idleVersion&&i.startTimestamp&&(r=y()(y()(1e3*i.startTimestamp).format("YYYY-MM-DD HH:mm"),"YYYY-MM-DD HH:mm"),t.startTimestampObj.isBefore(r)&&(t.startTimestampObj=r,t.startTimestamp=parseInt(t.startTimestampObj._d.getTime()/1e3)),t.minStartTime.isBefore(r)&&(t.minStartTime=r)),t.minDate=t.minStartTime._d,t.maxDate=t.maxEndDate._d,t===this.state){e.next=23;break}return e.next=23,this.setStateSafe(t);case 23:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.web3){e.next=3;break}return this.props.initWeb3(),e.abrupt("return",!1);case 3:return this.loadUtils(),e.next=6,this.loadParams();case 6:this.loadApiData(),this.loadCarousel();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadCarousel",value:function(){var e=this.props.isMobile?3:2;this.setStateSafe({carouselMax:e})}},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a,i,s,r,l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.contractsInitialized!==this.props.contractsInitialized,i=t.selectedStrategy!==this.props.selectedStrategy,s=t.selectedToken!==this.props.selectedToken||JSON.stringify(t.tokenConfig)!==JSON.stringify(this.props.tokenConfig),r=n.startTimestamp!==this.state.startTimestamp||n.endTimestamp!==this.state.endTimestamp,l=n.idleVersion!==this.state.idleVersion,t.isMobile!==this.props.isMobile&&this.loadCarousel(),!(a||s||i||l)){e.next=12;break}return e.next=10,this.componentDidMount();case 10:e.next=13;break;case 12:r&&this.loadApiData();case 13:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.functionsUtil.getRequiredNetworkId(),n=this.functionsUtil.getGlobalConfig(["govTokens","IDLE","availableNetworks"]),a=this.functionsUtil.getGlobalConfig(["govTokens","IDLE","enabled"])&&n.includes(t),o=this.functionsUtil.getGlobalConfig(["strategies","tranches"]).availableNetworks.includes(t),i=this.functionsUtil.getGlobalConfig(["contract","methods","refreshIdleSpeed"]),s=i.enabled&&i.availableNetworks.includes(t),r=this.functionsUtil.getGlobalConfig(["messages","apyLong"]);if(!this.props.availableStrategies)return m.a.createElement(k.a,{textProps:{textSize:4,fontWeight:2},loaderProps:{mb:3,size:"40px"},flexProps:{minHeight:"50vh",flexDirection:"column"},text:"Loading assets..."});var l=this.functionsUtil.getGlobalConfig(["stats","tokens"]);if(this.props.selectedToken)return"best"===this.props.selectedStrategy?m.a.createElement(_,this.props):"tranches"===this.props.selectedStrategy&&m.a.createElement(K,this.props);var c=this.functionsUtil.getGlobalConfig(["strategies"]),p=[],u=this.functionsUtil.getGlobalConfig(["stats","protocols"]);return Object.keys(l).forEach(function(e){l[e].enabled&&p.push(e)}),m.a.createElement(d.h,{mb:3,width:1,flexDirection:"column"},m.a.createElement(Q.a,Object.assign({},this.props,{loaderAlign:"flex-end"})),Object.keys(c).map(function(n){if("risk"===n)return!1;var a=c[n],o=e.props.availableStrategies[n];if(!o||!Object.keys(o).length)return!1;var i=[];Object.keys(o).forEach(function(e){o[e].protocols.forEach(function(e){i.indexOf(e.name)<0&&i.push(e.name)})});var s=i.map(function(e){return u[e]},{});return m.a.createElement(d.b,{mb:2,width:1,flexDirection:"column",justifyContent:"center",key:"strategy-container-".concat(n)},m.a.createElement(T.a,{mt:3,mb:[3,4]},m.a.createElement(d.h,{flexDirection:"row",alignItems:"baseline",justifyContent:"center"},a.title,a.titlePostfix&&m.a.createElement(d.u,{ml:2,fontWeight:3,fontSize:[2,4],color:"dark-gray"},a.titlePostfix))),m.a.createElement(w.a,Object.assign({enabledTokens:p,handleClick:function(t){return e.selectToken(n,t.token)},cols:[{title:"CURRENCY",props:{width:[.26,.15]},fields:[{name:"icon",props:{mr:2,height:["1.4em","2.3em"]}},{name:"tokenName"}]},{title:"POOL",props:{width:[.2,.14]},fields:[{name:"allocationChart",mobile:!1,parentProps:{width:.3},style:{overflow:"visible"},showLoader:!1},{name:"pool",props:{ml:1},parentProps:{width:[1,.7]}}]},{title:"APY",desc:r,props:{width:[.29,.15]},parentProps:{flexDirection:"column",alignItems:"flex-start",justifyContent:1===t?"flex-start":"center"},fields:[{name:"apy",showTooltip:!0},1===t?{name:"idleDistribution",showLoader:!1,props:{decimals:e.props.isMobile?1:2,fontSize:e.props.isMobile?"9px":0}}:null]},{title:"FARMING",desc:e.functionsUtil.getGlobalConfig(["messages","yieldFarming"]),mobile:!1,props:{width:[.27,.14]},fields:[{name:"govTokens"}]},{title:"APR LAST WEEK",mobile:!1,props:{width:.25},parentProps:{width:1,pr:[2,4]},fields:[{name:"aprChart",style:{overflow:"visible"}}]},{title:"",props:{width:[.29,.15]},parentProps:{width:1},fields:[{name:"button",label:e.props.isMobile?"View":"View stats",props:{width:1,fontSize:3,fontWeight:3,height:"45px",borderRadius:4,boxShadow:null,mainColor:"redeem",size:e.props.isMobile?"small":"medium",handleClick:function(t){return e.selectToken(n,t.token)}}}]}]},e.props,{selectedStrategy:n,availableTokens:o})),!e.props.isMobile&&m.a.createElement(d.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"flex-end"},s.filter(function(e){return e.legend}).map(function(e,t){return m.a.createElement(d.h,{mr:3,alignItems:"center",flexDirection:"row",key:"legend_".concat(t)},m.a.createElement(d.b,{mr:1,width:"10px",height:"10px",borderRadius:"50%",backgroundColor:"rgb(".concat(e.color.rgb.join(","),")")}),m.a.createElement(d.u.span,{fontSize:1,color:"cellText"},e.label))})))}),o&&m.a.createElement(d.b,{width:1},m.a.createElement(T.a,{mb:[3,4]},"Tranches"),m.a.createElement(q.a,Object.assign({enabledProtocols:[],availableTranches:this.props.availableTranches,handleClick:function(t){return e.selectTranche("tranches",t.protocol,t.token)},cols:[{title:"PROTOCOL",props:{width:[.25,.14]},fields:[{name:"protocolIcon",props:{mr:2,height:["1.4em","2em"]}},{name:"protocolName"},{mobile:!1,name:"experimentalBadge",props:{ml:1,height:"1.5em"}}]},{title:"TOKEN",props:{width:[.25,.14]},fields:[{name:"tokenIcon",props:{mr:2,height:["1.4em","2em"]}},{mobile:!1,name:"tokenName"}]},{title:"POOL",props:{width:[.25,.14]},fields:[{name:"pool",props:{minPrecision:1,decimals:this.props.isMobile?0:2}}]},{title:"SENIOR APY",props:{width:[.28,.14]},parentProps:{flexDirection:"column",alignItems:"flex-start"},fields:[{name:"seniorApy",showTooltip:!0}]},{title:"JUNIOR APY",props:{width:[.28,.14]},parentProps:{flexDirection:"column",alignItems:"flex-start"},fields:[{name:"juniorApy",props:{flexProps:{mr:3}},showTooltip:!0}]},{mobile:!1,title:"APR RATIO",props:{width:[.24,.13]},fields:[{name:"trancheAPRSplitRatio",props:{flexProps:{mr:2},height:["1.4em","2em"]}}]},{title:"",mobile:!1,props:{width:[.29,.15]},parentProps:{width:1},fields:[{name:"button",label:"View Stats",props:{width:1,fontSize:3,fontWeight:3,height:"45px",borderRadius:4,boxShadow:null,mainColor:"redeem",size:this.props.isMobile?"small":"medium",handleClick:function(t){return e.selectTranche("tranches",t.protocol,t.token)}}}]}]},this.props))),a&&s&&!this.state.showRefreshIdleSpeed?m.a.createElement(d.h,{mb:4,width:1,mt:[2,3],alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(d.n,{hoverColor:"primary",onClick:this.showRefreshIdleSpeed.bind(this)},"Refresh Idle Speed")):a&&s&&this.state.showRefreshIdleSpeed&&m.a.createElement(g.a,{cardProps:{p:2,mb:4,width:1,mt:[2,3]},isActive:!0,isInteractive:!1},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.u,{fontWeight:500,color:"flashColor",textAlign:"center",fontSize:[1,"15px"]},"By executing this transaction you can adjust the IDLE distribution speed among the pools."),m.a.createElement($.a,Object.assign({action:"Refresh",Component:d.c,parentProps:{mt:1},componentProps:{size:"small",mainColor:"blue",value:"REFRESH IDLE SPEED"},params:[],contractName:"IdleController",methodName:"refreshIdleSpeeds"},this.props),m.a.createElement(d.h,{flexDirection:"row",alignItems:"center",justifyContent:"center"},m.a.createElement(d.k,{mr:1,name:"Done",size:"1.4em",color:this.props.theme.colors.transactions.status.completed}),m.a.createElement(d.u,{fontWeight:500,fontSize:"15px",color:"copyColor",textAlign:"center"},"Idle Speed Refreshed"))))))}}]),t}(u.Component),ee=n(162),te=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).functionsUtil=null,n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.selectedSubsection&&this.props.selectedSubsection.subComponent?this.props.selectedSubsection.subComponent:null,n="custom"===this.props.connectorName,a="undefined"===typeof this.props.showBreadCrumb||this.props.showBreadCrumb;return m.a.createElement(d.h,{width:1,flexDirection:"column"},this.props.selectedSubsection?m.a.createElement(d.b,{width:1},a&&m.a.createElement(d.h,{width:1},m.a.createElement(B.a,Object.assign({},this.props,{showPathMobile:!0,isMobile:this.props.isMobile,path:[this.props.selectedSubsection.label],text:this.props.selectedSection.label.toUpperCase(),handleClick:function(t){return e.props.goToSection(e.props.selectedSection.route)}}))),m.a.createElement(d.h,{my:[2,3],flexDirection:"column",justifyContent:"center"},m.a.createElement(T.a,{mb:2},this.props.selectedSubsection.label),m.a.createElement(d.u,{textAlign:"center",dangerouslySetInnerHTML:{__html:this.props.selectedSubsection.desc}})),m.a.createElement(t,Object.assign({},this.props,this.props.selectedSubsection.directProps,{toolProps:this.props.selectedSubsection.props}))):m.a.createElement(d.h,{my:[2,3],flexDirection:"column",justifyContent:"center"},m.a.createElement(T.a,{mb:3},"Tools"),m.a.createElement(d.h,{width:1,style:{flexWrap:"wrap"},justifyContent:n?"center":"flex-start"},n?m.a.createElement(ee.a,{cardProps:{maxWidth:[1,"35em"]},icon:"Visibility",text:'You are using Idle in "Read-Only" mode.<br />Logout and connect with your wallet to interact.'}):this.props.selectedSection.submenu.map(function(t,n){return m.a.createElement(g.a,{isInteractive:!0,key:"tool_".concat(n),cardProps:{p:[3,4],mb:[3,3],mr:[0,"2%"],style:{flex:e.props.isMobile?"1 1 100%":"0 0 31%"},alignItems:"center",flexDirection:"column",justifyContent:"center"},handleClick:function(n){return e.props.goToSection(e.props.selectedSection.route+"/"+t.route)}},m.a.createElement(d.u,{fontSize:[3,4],textAlign:"center"},t.label),m.a.createElement(d.h,{justifyContent:"center"},t.image?m.a.createElement(d.l,{my:[0,2],height:"2.2em",src:t.image}):t.icon&&m.a.createElement(d.k,{my:[0,2],size:"3em",name:t.icon})),m.a.createElement(d.u,{fontSize:[2,2],textAlign:"center",dangerouslySetInnerHTML:{__html:t.desc}}))}))))}}]),t}(u.Component),ne=n(25),ae=n(377),oe=n(1337),ie=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={aggregatedValues:[],govTokensTotalApr:null,govTokensUserBalance:null,govTokensDistribution:null,govTokensTotalBalance:null,govTokensTotalAprTooltip:null,idleTokenUserDistribution:null,govTokensDistributionTooltip:null,govTokensTotalBalanceTooltip:null},n.functionsUtil=null,n.idleGovToken=null,n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props),this.idleGovToken=this.functionsUtil.getIdleGovToken()}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l,c,p,u,h,f,g,b=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t={})[this.props.selectedToken]=this.props.tokenConfig,n="risk"===this.props.selectedStrategy,e.next=5,Promise.all([this.idleGovToken.getUserDistribution(this.props.account,t,!0),this.functionsUtil.getGovTokensUserBalances(this.props.account,t,null),this.functionsUtil.loadAssetField("apy",this.props.selectedToken,this.props.tokenConfig,this.props.account,!1),this.functionsUtil.loadAssetField("depositTimestamp",this.props.selectedToken,this.props.tokenConfig,this.props.account),this.functionsUtil.loadAssetField("daysFirstDeposit",this.props.selectedToken,this.props.tokenConfig,this.props.account)]);case 5:return a=e.sent,i=Object(ne.a)(a,5),s=i[0],r=i[1],l=i[2],c=i[3],p=i[4],e.next=14,this.functionsUtil.getAvgAPYStats(this.props.tokenConfig.address,n,c);case 14:(u=e.sent)&&!this.functionsUtil.BNify(u).lte(0)||(u=l),h=r?Object.values(r).reduce(function(e,t){return e.plus(b.functionsUtil.BNify(t))},this.functionsUtil.BNify(0)):null,f=r?Object.keys(r).map(function(e){var t=r[e];return t.gt(0)?"+".concat(t.toFixed(2)," ").concat(e):null}).filter(function(e){return null!==e}):null,g=[{flexProps:{width:[1,.32]},props:{title:"Avg APY",desc:this.functionsUtil.getGlobalConfig(["messages","apyLong"]),children:m.a.createElement(d.h,{width:1,alignItems:"center",height:["55px","59px"],flexDirection:"column",justifyContent:"center"},m.a.createElement(d.u,{lineHeight:1,fontWeight:[3,4],color:"copyColor",fontFamily:"counter",fontSize:["1.7em","1.7em"],dangerouslySetInnerHTML:{__html:u?u.toFixed(2)+"%":"0.00%"}}))}},{flexProps:{width:[1,.32]},props:{title:"Current Allocation",children:m.a.createElement(d.h,{width:1,id:"allocationChart",height:["55px","59px"],flexDirection:"column"},m.a.createElement(X.a,Object.assign({},this.props,{showLoader:!0,fieldInfo:{name:"allocationChart"},parentId:"allocationChart",token:this.props.selectedToken,tokenConfig:this.props.tokenConfig}))),label:""}},{flexProps:{width:[1,.32]},props:{title:"Days since first deposit",children:m.a.createElement(d.h,{width:1,alignItems:"center",height:["55px","59px"],flexDirection:"column",justifyContent:"center"},m.a.createElement(d.u,{lineHeight:1,fontWeight:[3,4],color:"copyColor",fontFamily:"counter",fontSize:["1.7em","1.7em"],dangerouslySetInnerHTML:{__html:p?parseInt(p):"-"}}))}}],this.setState({aggregatedValues:g,govTokensUserBalance:r,govTokensTotalBalance:h,idleTokenUserDistribution:s,govTokensTotalBalanceTooltip:f});case 20:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){return m.a.createElement(d.h,{width:1,flexDirection:"column"},this.state.aggregatedValues.length>0&&m.a.createElement(d.h,{width:1,mb:[0,3],mt:[2,0],alignItems:"center",flexDirection:["column","row"],justifyContent:"space-between"},this.state.aggregatedValues.map(function(e,t){return m.a.createElement(d.h,Object.assign({},e.flexProps,{flexDirection:"column",key:"aggregatedValue_".concat(t)}),m.a.createElement(g.a,{cardProps:{py:[2,3],mb:[3,0]}},m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},e.props.children?e.props.children:m.a.createElement(d.u,{lineHeight:1,fontWeight:[3,4],color:"copyColor",fontFamily:"counter",fontSize:[4,"1.7em"],dangerouslySetInnerHTML:{__html:e.props.value}}),m.a.createElement(d.h,{mt:2,width:1,alignItems:"center",justifyContent:"center"},m.a.createElement(d.u,{fontWeight:2,fontSize:[1,2],color:"cellText"},e.props.title),e.props.desc&&m.a.createElement(d.y,{placement:"bottom",message:e.props.desc},m.a.createElement(d.k,{ml:2,name:"Info",size:"1em",color:"cellTitle"}))))))})),m.a.createElement(g.a,{cardProps:{px:2,py:3}},m.a.createElement(d.h,{width:1,ml:[0,3],id:"funds-overview"},m.a.createElement(oe.a,Object.assign({},this.props,{chartHeight:350,parentId:"funds-overview",chartToken:this.props.selectedToken,enabledTokens:[this.props.selectedToken],frequencySeconds:this.functionsUtil.getFrequencySeconds("day",1)}))),m.a.createElement(d.h,{width:1,flexDirection:["column","row"]},m.a.createElement(d.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},m.a.createElement(T.a,{mb:2,fontSize:[3,4],component:d.j.h3},"Deposited"),m.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"amountLent",props:{decimals:4,maxPrecision:8,fontWeight:300,fontSize:["1.8em","1.9em"],color:this.props.theme.colors.counter,flexProps:{justifyContent:"center"}}}}))),m.a.createElement(d.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},m.a.createElement(T.a,{mb:2,fontSize:[3,4],component:d.j.h3},"Redeemable"),m.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"redeemableBalanceCounter",props:{decimals:7,maxPrecision:8,style:{fontWeight:300,color:this.props.theme.colors.counter,fontSize:this.props.isMobile?"1.8em":"1.9em"},flexProps:{justifyContent:"center"}}}})),m.a.createElement(d.h,{width:1,mt:"-9px"},m.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"earningsPerc",props:{fontSize:1,fontWeight:2,color:"cellText",flexProps:{justifyContent:"center"}}}})))),m.a.createElement(d.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},m.a.createElement(T.a,{mb:2,fontSize:[3,4],component:d.j.h3},"Earnings"),m.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"earningsCounter",props:{decimals:7,maxPrecision:8,style:{fontWeight:300,fontSize:this.props.isMobile?"1.8em":"1.9em",color:this.props.theme.colors.counter},flexProps:{justifyContent:"center"}}}})),this.state.govTokensTotalBalanceTooltip&&this.state.govTokensTotalBalanceTooltip.length>0&&m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},this.state.govTokensTotalBalanceTooltip.map(function(e,t){return m.a.createElement(d.u,{fontSize:1,lineHeight:1,fontWeight:2,color:"cellText",textAlign:"center",mt:t?1:0,key:"govToken_".concat(t)},e)}))),m.a.createElement(d.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},m.a.createElement(T.a,{mb:2,fontSize:[3,4],component:d.j.h3},"Fees"),m.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"feesCounter",props:{decimals:7,maxPrecision:8,style:{fontWeight:300,fontSize:this.props.isMobile?"1.8em":"1.9em",color:this.props.theme.colors.counter},flexProps:{justifyContent:"center"}}}}))),m.a.createElement(d.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},m.a.createElement(T.a,{mb:2,fontSize:[3,4],component:d.j.h3},"Current APY"),m.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"apy",props:{decimals:2,fontWeight:300,fontSize:["1.8em","1.9em"],color:this.props.theme.colors.counter,flexProps:{justifyContent:"center"}}}})),this.state.idleTokenUserDistribution&&m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.u,{mt:1,fontSize:1,lineHeight:1,fontWeight:2,color:"cellText",textAlign:"center"},this.state.idleTokenUserDistribution.toFixed(4)," ",this.idleGovToken.tokenName,"/",this.idleGovToken.tokenConfig.distributionFrequency))))))}}]),t}(u.Component),se=n(77),re=n(73),le=n(514),ce=n(717),pe=n(379),ue=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={processing:{txHash:null,loading:!1},inputValue:null,maxSlippage:.2,tokenConfig:null,unevenAmounts:null,selectedToken:null,availableTokens:null,buttonDisabled:!1,showMaxSlippage:!1,redeemUnderlying:!0,curveTokenConfig:null,curvePoolContract:null,curveSwapContract:null,curveTokenBalance:null,curveTokensAmounts:null,fastBalanceSelector:null,redeemUnevenAmounts:!1,curveRedeemableIdleTokens:null},n.functionsUtil=null,n.toggleUnevenAmounts=function(e){n.setState({redeemUnevenAmounts:e})},n.checkButtonDisabled=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e||(e=n.state.inputValue);var t;t=!e||e.gt(n.state.curveTokenBalance),n.setState({buttonDisabled:t})},n.changeInputValue=function(e){var t=e.target.value.length&&!isNaN(e.target.value)?n.functionsUtil.BNify(e.target.value):n.functionsUtil.BNify(0);n.checkButtonDisabled(t);n.setState(function(e){return{inputValue:t,fastBalanceSelector:null}})},n.setFastBalanceSelector=function(e){n.setState({fastBalanceSelector:e})},n.setMaxSlippage=function(e){n.setState({maxSlippage:e})},n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.initToken();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"showMaxSlippage",value:function(){this.setState({showMaxSlippage:!0})}},{key:"calculateSlippage",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l,c,p,u,m=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=m.length>0&&void 0!==m[0]?m[0]:null,(n=this.state.inputValue?this.functionsUtil.BNify(this.state.inputValue):null)&&!n.lte(0)){e.next=4;break}return e.abrupt("return",!1);case 4:if(a=this.functionsUtil.normalizeTokenAmount(n,this.state.curvePoolContract.decimals),i=null,s=null,r=null,!this.state.redeemUnevenAmounts){e.next=20;break}return e.next=11,Promise.all([this.functionsUtil.getCurveTokensAmounts(this.props.account,a,!0),this.functionsUtil.getCurveIdleTokensAmounts(this.props.account,a)]);case 11:return l=e.sent,c=Object(ne.a)(l,2),s=c[0],r=c[1],e.next=17,this.functionsUtil.getCurveSlippage(this.state.tokenConfig.idle.token,a,!1,r);case 17:i=e.sent,e.next=29;break;case 20:return e.next=22,this.functionsUtil.getCurveSlippage(this.state.tokenConfig.idle.token,a,!1);case 22:return i=e.sent,e.next=25,this.functionsUtil.getCurveTokenPrice();case 25:p=e.sent,u=n.times(p).minus(n.times(i.times(100).plus(this.state.maxSlippage||this.functionsUtil.BNify(0)).div(100))),(s={})[this.state.selectedToken]=u;case 29:return i&&(i=i.times(100)),this.setState({withdrawSlippage:i,curveTokensAmounts:s,curveIdleTokensAmounts:r}),i&&t&&(i=i.plus(t)),e.abrupt("return",i);case 33:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a,i,s,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadUtils(),!(t.tokenConfig.idle.token!==this.props.tokenConfig.idle.token)){e.next=5;break}return e.next=5,this.initToken();case 5:a=n.redeemUnevenAmounts!==this.state.redeemUnevenAmounts,(this.state.fastBalanceSelector!==n.fastBalanceSelector||a)&&this.setInputValue(),i=n.inputValue!==this.state.inputValue,s=parseFloat(n.maxSlippage)!==parseFloat(this.state.maxSlippage),r=JSON.stringify(n.tokenConfig)!==JSON.stringify(this.state.tokenConfig),(i||r||s)&&this.calculateSlippage(),n.selectedToken!==this.state.selectedToken&&this.loadSelectedTokenConfig();case 14:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"setInputValue",value:function(){if(null===this.state.fastBalanceSelector)return!1;var e,t=this.functionsUtil.BNify(this.state.fastBalanceSelector).div(100);e=this.state.curveTokenBalance?this.functionsUtil.BNify(this.state.curveTokenBalance).times(t):null,this.checkButtonDisabled(e),this.setState({inputValue:e})}},{key:"selectDestinationToken",value:function(e){this.setState({selectedToken:e})}},{key:"loadSelectedTokenConfig",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.functionsUtil.getGlobalConfig(["curve"]),n=this.state.availableTokens[this.state.selectedToken],a=t.availableTokens[n.idle.token],this.setState({tokenConfig:n,curveTokenConfig:a});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"initToken",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l,c,p,u,m,h,d;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.functionsUtil.getCurvePoolContract(),this.functionsUtil.getCurveSwapContract()]);case 2:return t=e.sent,n=Object(ne.a)(t,2),a=n[0],i=n[1],e.next=8,Promise.all([this.functionsUtil.getCurveTokenPrice(),this.functionsUtil.getCurveTokenBalance(this.props.account),this.functionsUtil.getCurveRedeemableIdleTokens(this.props.account)]);case 8:s=e.sent,r=Object(ne.a)(s,3),l=r[0],c=r[1],p=r[2],u=[],m=c?c.times(l):this.functionsUtil.BNify(0),h=this.functionsUtil.getCurveAvailableTokens(),d=Object.keys(h)[0],this.setState({selectedToken:d,unevenAmounts:u,curveTokenPrice:l,availableTokens:h,curvePoolContract:a,curveSwapContract:i,curveTokenBalance:c,redeemableBalance:m,curveRedeemableIdleTokens:p});case 19:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"redeem",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l,c,p,u,m,h=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.curveTokenBalance){e.next=2;break}return e.abrupt("return",!1);case 2:return t=function(e,t){var n="success"===e.status,a={eventLabel:e.status,eventCategory:"CurveRedeem",eventAction:h.props.selectedToken,eventValue:h.state.curveTokenBalance.toFixed()};t&&(a.eventLabel=h.functionsUtil.getTransactionError(t)),(t||"error"!==a.status)&&h.functionsUtil.sendGoogleAnalyticsEvent(a),h.setState(function(e){return{processing:{txHash:null,loading:!1}}}),"function"===typeof h.props.callbackRedeem&&n&&h.props.callbackRedeem(e)},n=function(e){var t=e.transactionHash;h.setState(function(e){return{processing:Object(C.a)({},e.processing,{txHash:t})}})},a=this.state.curveSwapContract.name,e.next=7,this.calculateSlippage(this.state.maxSlippage);case 7:if(i=e.sent,s=this.functionsUtil.BNify(this.state.maxSlippage).div(100),r=this.state.inputValue?this.functionsUtil.BNify(this.state.inputValue):null,l=this.functionsUtil.normalizeTokenAmount(r,this.state.curvePoolContract.decimals),!this.state.redeemUnevenAmounts){e.next=26;break}if(!this.state.redeemUnderlying){e.next=18;break}return e.next=15,this.functionsUtil.getCurveTokensAmounts(this.props.account,l,!1,!0);case 15:e.t0=e.sent,e.next=21;break;case 18:return e.next=20,this.functionsUtil.getCurveIdleTokensAmounts(this.props.account,l,s);case 20:e.t0=e.sent;case 21:c=e.t0,console.log("remove_liquidity",l.toString(),c),this.props.contractMethodSendWrapper(a,"remove_liquidity",[l,c,this.state.redeemUnderlying],null,t,n),e.next=33;break;case 26:return p=this.state.curveTokenConfig.migrationParams.coinIndex,e.next=29,this.functionsUtil.getCurveTokenPrice();case 29:u=e.sent,m=this.functionsUtil.normalizeTokenAmount(r.times(u).minus(r.times(i.div(100))),this.state.tokenConfig.decimals),console.log("remove_liquidity_one_coin",l,p,m),this.props.contractMethodSendWrapper(a,"remove_liquidity_one_coin",[l,p,m,this.state.redeemUnderlying],null,t,n);case 33:this.setState(function(e){return{processing:Object(C.a)({},e.processing,{loading:!0})}});case 34:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cancelTransaction",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({processing:{txHash:null,loading:!1}});case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getFastBalanceSelector",value:function(){return null!==this.state.fastBalanceSelector&&this.functionsUtil.BNify(this.state.fastBalanceSelector).div(100)}},{key:"render",value:function(){var e=this,t=!this.state.buttonDisabled&&this.state.withdrawSlippage,n=this.functionsUtil.getGlobalConfig(["curve","poolContract","token"]);return m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.h,{width:[1,.36],alignItems:"stretch",flexDirection:"column",justifyContent:"center"},this.state.curveTokenBalance?this.state.processing.loading?m.a.createElement(g.a,{cardProps:{p:3,mt:3}},m.a.createElement(d.h,{flexDirection:"column"},m.a.createElement(I.a,{web3:this.props.web3,hash:this.state.processing.txHash,endMessage:"Finalizing redeem request...",cancelTransaction:this.cancelTransaction.bind(this),waitText:this.props.waitText?this.props.waitText:"Redeem estimated in"}))):m.a.createElement(d.h,{width:1,flexDirection:"column"},m.a.createElement(g.a,{cardProps:{p:3,mb:2}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(d.k,{size:"1.8em",color:"cellText",name:"FileUpload"}),m.a.createElement(d.u,{mt:1,fontSize:2,color:"cellText",textAlign:"center"},"Withdraw from the Curve Pool in a specific token or in uneven amounts of tokens (with no slippage)."),m.a.createElement(d.h,{mt:2,alignItems:"center",flexDirection:"row"},m.a.createElement(d.e,{required:!1,label:"Redeem with no slippage",checked:this.state.redeemUnevenAmounts,onChange:function(t){return e.toggleUnevenAmounts(t.target.checked)}}),m.a.createElement(d.y,{placement:"top",message:"You will receive an uneven amounts of ".concat(Object.keys(this.state.availableTokens).join(", ")," proportional to the token availailability in the Curve pool.")},m.a.createElement(d.k,{size:"1em",color:"cellTitle",name:"InfoOutline"}))))),!this.state.redeemUnevenAmounts&&m.a.createElement(d.b,{mb:2,width:1},this.state.tokenConfig&&m.a.createElement(d.b,{width:1},m.a.createElement(d.u,{mb:1},"Select destination token:"),m.a.createElement(z.a,Object.assign({},this.props,{id:"token-from",showBalance:!1,tokenConfig:this.state.tokenConfig,selectedToken:this.state.selectedToken,availableTokens:this.state.availableTokens,onChange:this.selectDestinationToken.bind(this)})))),this.state.curveTokensAmounts&&!this.state.buttonDisabled&&m.a.createElement(g.a,{cardProps:{mt:1,mb:2,py:2,px:1}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(d.u,{mt:1,fontSize:2,color:"cellText",textAlign:"center"},"You will receive:"),m.a.createElement(d.h,{mt:2,width:1,boxShadow:0,style:{flexWrap:"wrap"},alignItems:"center",justifyContent:"center"},Object.keys(this.state.curveTokensAmounts).map(function(t){var n=e.state.curveTokensAmounts[t];return m.a.createElement(d.h,{mb:1,mx:1,width:"auto",flexDirection:"row",key:"tokenBalance_".concat(t),justifyContent:"flex-start"},m.a.createElement(X.a,{token:t,tokenConfig:{token:t},fieldInfo:{name:"icon",props:{mr:1,width:["1.4em","1.6em"],height:["1.4em","1.6em"]}}}),m.a.createElement(F.a,{ml:1,fontSize:[0,1],fontWeight:500,maxPrecision:4,color:"cellText",number:n.toString()}))})))),this.state.showMaxSlippage&&t&&m.a.createElement(d.b,{mb:2,width:1},m.a.createElement(d.h,{alignItems:"center",flexDirection:"row"},m.a.createElement(d.u,null,"Choose max slippage:"),m.a.createElement(d.y,{placement:"top",message:"Max additional slippage on top of the one shown below"},m.a.createElement(d.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))),m.a.createElement(d.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[.2,.5,1,5].map(function(t){return m.a.createElement(pe.a,{cardProps:{p:1},textProps:{fontSize:1},percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setMaxSlippage(t)},isActive:e.state.maxSlippage===parseFloat(t)})}))),m.a.createElement(d.h,{mb:3,width:1,flexDirection:"column"},m.a.createElement(d.h,{mb:1,alignItems:"center",flexDirection:"row",justifyContent:"flex-end"},t&&m.a.createElement(d.h,{width:1,maxWidth:"40%",alignItems:"center",flexDirection:"row"},m.a.createElement(d.u,{fontSize:1,fontWeight:3,textAlign:"right",style:{whiteSpace:"nowrap"},color:parseFloat(this.state.withdrawSlippage.toFixed(3))>0?this.props.theme.colors.transactions.status.failed:this.props.theme.colors.transactions.status.completed},0===parseFloat(this.state.withdrawSlippage.toFixed(3))?"No Slippage":"".concat(this.state.withdrawSlippage.gt(0)?"Slippage: ":"Bonus: "," ").concat(this.state.withdrawSlippage.abs().toFixed(3),"%")),m.a.createElement(d.y,{placement:"top",message:this.state.redeemUnevenAmounts?"You will receive an uneven amounts of ".concat(Object.keys(this.state.availableTokens).join(", ")," proportional to the token availailability in the Curve pool."):this.state.withdrawSlippage.gt(0)?"Slippage comes from depositing too many coins not in balance, and current coin prices are additionally accounted for":"Bonus comes as an advantage from current coin prices which usually appears for coins which are high in balance"},m.a.createElement(d.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"})),!this.state.redeemUnevenAmounts&&m.a.createElement(d.n,{ml:1,color:"copyColor",hoverColor:"primary",onClick:this.showMaxSlippage.bind(this)},"change")),m.a.createElement(d.h,{width:1,maxWidth:"60%",alignItems:"center",flexDirection:"row",justifyContent:"flex-end"},m.a.createElement(d.n,{fontSize:1,fontWeight:3,color:"dark-gray",textAlign:"right",hoverColor:"copyColor",onClick:function(t){return e.setFastBalanceSelector(100)},style:{maxWidth:"100%",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},this.state.curveTokenBalance.toFixed(this.props.isMobile?2:4)," ",n))),m.a.createElement(d.m,{min:0,type:"number",required:!0,height:"3.4em",borderRadius:2,fontWeight:500,boxShadow:"none !important",placeholder:"Insert amount",onChange:this.changeInputValue.bind(this),border:"1px solid ".concat(this.props.theme.colors.divider),value:null!==this.state.inputValue?this.functionsUtil.BNify(this.state.inputValue).toFixed():""}),m.a.createElement(d.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[25,50,75,100].map(function(t){return m.a.createElement(pe.a,{percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setFastBalanceSelector(t)},isActive:e.state.fastBalanceSelector===parseInt(t)})}))),m.a.createElement(d.h,{justifyContent:"center"},m.a.createElement(A.a,{buttonProps:{mt:2,width:[1,.5],disabled:this.state.buttonDisabled},handleClick:this.redeem.bind(this)},"Redeem"))):m.a.createElement(g.a,{cardProps:{p:3,mt:3,minHeight:"195px",style:{display:"flex",alignItems:"center",justifyContent:"center"}}},m.a.createElement(k.a,{flexProps:{flexDirection:"row"},loaderProps:{size:"30px"},textProps:{ml:2},text:"Checking Curve Pool..."}))))}}]),t}(u.Component),me=n(837),he=n(140),de=n(262),fe=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),p=0;p<a;p++)r[p]=arguments[p];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={txError:{},tokenAPY:"-",inputValue:{},processing:{},curveAPY:null,totalAUM:null,canRedeem:!1,maxSlippage:.2,canDeposit:!1,action:"deposit",directMint:!1,activeModal:null,tokenGovTokens:{},showBuyFlow:!1,maxUnlentPerc:null,unlentBalance:null,tokenApproved:!1,skipMigration:!1,redeemSkipGov:!1,showRedeemFlow:!1,contractPaused:!1,buttonDisabled:!1,canRedeemCurve:!1,erc20ForwarderTx:null,signedParameters:null,minAmountForMint:null,showMaxSlippage:!1,redeemGovTokens:!1,canDepositCurve:!1,redeemSkipGovTokens:[],fastBalanceSelector:{},actionProxyContract:{},migrationEnabled:!1,componentMounted:!1,curveTokenBalance:null,agreeSkipGovTokens:!1,redeemCurveEnabled:!1,depositCurveBalance:null,depositCurveEnabled:!0,showAdvancedOptions:!1,skipGovTokensGasSave:null,depositCurveSlippage:null,erc20ForwarderContract:{},erc20ForwarderEnabled:!1,showETHWrapperEnabled:!1,skipGovTokensGasSaveUSD:null,metaTransactionsEnabled:!0,skippedGovTokensBalance:null,minAmountForMintReached:!1,loadingErc20ForwarderTx:!1},n.functionsUtil=null,n.setShowRedeemFlow=function(e){n.setState({showRedeemFlow:e})},n.setShowBuyFlow=function(e){n.setState({showBuyFlow:e})},n.toggleShowAdvancedOptions=function(e){n.setState(function(e){return{showAdvancedOptions:!e.showAdvancedOptions}})},n.toggleSkipMigration=function(e){n.setState({skipMigration:e})},n.toggleRedeemCurve=function(e){n.setState({redeemCurveEnabled:e})},n.toggleDepositCurve=function(e){n.setState({depositCurveEnabled:e})},n.toggleShowETHWrapper=function(e){n.setState({showETHWrapperEnabled:e})},n.toggleAgreeSkipGovTokens=function(e){n.setState({agreeSkipGovTokens:e})},n.toggleSkipMint=function(e){n.setState({directMint:e})},n.toggleRedeemGovTokens=function(e){n.setState({redeemGovTokens:e,redeemSkipGovTokens:[],agreeSkipGovTokens:!1,skippedGovTokensBalance:n.functionsUtil.BNify(0),redeemSkipGov:!e&&n.state.redeemSkipGov})},n.toggleRedeemSkipGov=function(e){n.setState({redeemSkipGov:e,redeemSkipGovTokens:[],agreeSkipGovTokens:!1,skippedGovTokensBalance:n.functionsUtil.BNify(0),redeemGovTokens:!e&&n.state.redeemGovTokens})},n.getSkippedGovTokensFlags=Object(i.a)(o.a.mark(function e(){var t,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.functionsUtil.getGovTokensIndexes(n.props.account,n.props.tokenConfig);case 2:return t=e.sent,a=Object.keys(t).map(function(e){return n.state.redeemSkipGovTokens.includes(e)}),e.abrupt("return",a);case 5:case"end":return e.stop()}},e,this)})),n.calculateSkippedGovTokens=Object(i.a)(o.a.mark(function e(){var t,a,s,r,l,c,p,u,m,h,d;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.functionsUtil.BNify(0),a=n.functionsUtil.getGlobalConfig(["stats","tokens","DAI"]),e.next=4,n.functionsUtil.asyncForEach(n.state.redeemSkipGovTokens,function(){var e=Object(i.a)(o.a.mark(function e(i){var s,r,l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.functionsUtil.getGlobalConfig(["govTokens",i]),e.next=3,n.functionsUtil.getUniswapConversionRate(a,s);case 3:r=e.sent,l=n.props.govTokensUserBalances[i].times(r),t=t.plus(l);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 4:return e.next=6,n.getSkippedGovTokensFlags();case 6:return s=e.sent,r=n.functionsUtil.getGlobalConfig(["stats","tokens","WETH"]),e.next=10,Promise.all([n.functionsUtil.getUniswapConversionRate(a,r),n.functionsUtil.estimateMethodGasUsage(n.props.tokenConfig.idle.token,"redeemIdleToken",[n.functionsUtil.normalizeTokenAmount(n.props.idleTokenBalance,n.props.tokenConfig.decimals)],n.props.account),n.functionsUtil.estimateMethodGasUsage(n.props.tokenConfig.idle.token,"redeemIdleTokenSkipGov",[n.functionsUtil.normalizeTokenAmount(n.props.idleTokenBalance,n.props.tokenConfig.decimals),s],n.props.account)]);case 10:return l=e.sent,c=Object(ne.a)(l,3),p=c[0],u=c[1],m=c[2],h=u&&m?u.minus(m):n.functionsUtil.BNify(0),d=h?h.times(p):n.functionsUtil.BNify(0),n.setState({skipGovTokensGasSave:h,skipGovTokensGasSaveUSD:d,skippedGovTokensBalance:t}),e.abrupt("return",t);case 19:case"end":return e.stop()}},e,this)})),n.setRedeemSkipGovTokens=function(e,t){n.setState(function(n){var a=Object.assign([],n.redeemSkipGovTokens);return!t&&a.includes(e)?a.splice(a.indexOf(e),1):t&&!a.includes(e)&&a.push(e),{redeemSkipGovTokens:a}},function(){n.calculateSkippedGovTokens()})},n.toggleErc20ForwarderEnabled=function(e){var t={erc20ForwarderEnabled:e};n.setState(t,function(){n.cancelTransaction()})},n.toggleMetaTransactionsEnabled=function(e){n.setState({metaTransactionsEnabled:e})},n.resetModal=function(){n.setState({activeModal:null})},n.setActiveModal=function(e){n.setState({activeModal:e})},n.checkUseProxyContract=function(){var e=n.state.actionProxyContract[n.state.action],t=n.functionsUtil.getGlobalConfig(["contract","methods","deposit","erc20ForwarderEnabled"])&&n.state.erc20ForwarderEnabled,a=n.functionsUtil.getGlobalConfig(["contract","methods","deposit","metaTransactionsEnabled"])&&n.state.metaTransactionsEnabled;return(t||a)&&e&&n.props.biconomy},n.approveContract=function(){var e=Object(i.a)(o.a.mark(function e(t,a){var i,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.state.depositCurveEnabled?(i=n.functionsUtil.getGlobalConfig(["curve","depositContract"]),n.functionsUtil.enableERC20(n.props.selectedToken,i.address,t,a)):n.checkUseProxyContract()?(s=n.state.actionProxyContract[n.state.action],n.functionsUtil.enableERC20(n.props.selectedToken,s.address,t,a)):n.functionsUtil.enableERC20(n.props.selectedToken,n.props.tokenConfig.idle.address,t,a);case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),n.checkTokenApproved=Object(i.a)(o.a.mark(function e(){var t,a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!1,!n.state.depositCurveEnabled){e.next=8;break}return a=n.functionsUtil.getGlobalConfig(["curve","depositContract"]),e.next=5,n.functionsUtil.checkTokenApproved(n.props.selectedToken,a.address,n.props.account);case 5:t=e.sent,e.next=24;break;case 8:if(!n.checkUseProxyContract()){e.next=21;break}if(!(n.functionsUtil.getGlobalConfig(["contract","methods","deposit","erc20ForwarderEnabled"])&&n.state.erc20ForwarderEnabled)){e.next=15;break}if(!n.functionsUtil.getGlobalConfig(["permit",n.props.selectedToken])){e.next=15;break}return e.abrupt("return",!0);case 15:return i=n.state.actionProxyContract[n.state.action],e.next=18,n.functionsUtil.checkTokenApproved(n.props.selectedToken,i.address,n.props.account);case 18:t=e.sent,e.next=24;break;case 21:return e.next=23,n.functionsUtil.checkTokenApproved(n.props.selectedToken,n.props.tokenConfig.idle.address,n.props.account);case 23:t=e.sent;case 24:return e.abrupt("return",t);case 25:case"end":return e.stop()}},e,this)})),n.approveToken=Object(i.a)(o.a.mark(function e(){var t,a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.checkTokenApproved();case 2:if(!(t=e.sent)){e.next=5;break}return e.abrupt("return",n.setState(function(e){return{tokenApproved:t,processing:Object(C.a)({},e.processing,{approve:{txHash:null,loading:!1}})}}));case 5:a=function(e,t){var a={eventCategory:"Approve",eventAction:n.props.selectedToken,eventLabel:e.status};t&&(a.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==a.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(a),n.setState(function(t){return{tokenApproved:"success"===e.status,processing:Object(C.a)({},t.processing,{approve:{txHash:null,loading:!1}})}})},i=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(C.a)({},e.processing,{approve:Object(C.a)({},e.processing.approve,{txHash:t})})}})},n.approveContract(a,i),n.setState(function(e){return{processing:Object(C.a)({},e.processing,{approve:{txHash:null,loading:!0}})}});case 9:case"end":return e.stop()}},e,this)})),n.loadTokenInfo=Object(i.a)(o.a.mark(function e(){var t,a,i,s,r,l,c,p,u,m,h,d,f,g,b,k,v,x,y,T,w;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.state.componentMounted&&n.setState({componentMounted:!1}),t=n.functionsUtil.getGlobalConfig(["curve"]),a=n.functionsUtil.getGlobalConfig(["curve","availableTokens",n.props.tokenConfig.idle.token]),i=t.enabled&&a&&a.enabled,e.next=6,Promise.all([n.checkTokenApproved(),n.functionsUtil.checkContractPaused(),n.functionsUtil.getCurveSwapContract(),n.functionsUtil.getCurveDepositContract(),n.functionsUtil.getUnlentBalance(n.props.tokenConfig),n.functionsUtil.checkMigration(n.props.tokenConfig,n.props.account),i?n.functionsUtil.getCurveTokenBalance(n.props.account):null]);case 6:s=e.sent,r=Object(ne.a)(s,7),l=r[0],c=r[1],p=r[2],u=r[3],m=r[4],h=r[5].migrationEnabled,d=r[6],f=n.props.tokenBalance&&n.functionsUtil.BNify(n.props.tokenBalance).gt(0),g=n.props.idleTokenBalance&&n.functionsUtil.BNify(n.props.idleTokenBalance).gt(0),k=b=i&&f,v="WETH"===n.props.selectedToken&&(n.state.showETHWrapperEnabled||!f),x=i&&d&&d.gt(0),y=x,T=n.functionsUtil.getTokenGovTokens(n.props.tokenConfig),(w=Object(C.a)({},n.state)).depositCurveEnabled&&!i&&(w.depositCurveEnabled=!1),w.canRedeem=g,w.canDeposit=f,w.unlentBalance=m,w.tokenApproved=l,w.tokenGovTokens=T,w.contractPaused=c,w.canRedeemCurve=x,w.canDepositCurve=b,w.migrationEnabled=h,w.curveTokenBalance=d,w.curveSwapContract=p,w.redeemCurveEnabled=y,w.depositCurveEnabled=k,w.curveDepositContract=u,w.showETHWrapperEnabled=v,w.txError={redeem:!1,deposit:!1},w.processing={redeem:{txHash:null,loading:!1},deposit:{txHash:null,loading:!1},approve:{txHash:null,loading:!1},boost:{txHash:null,loading:!1}},w.inputValue={boost:null,redeem:null,deposit:null},w.fastBalanceSelector={boost:null,redeem:null,deposit:null},w.componentMounted=!0,n.setState(w,function(){n.checkAction(),n.loadAPY()});case 46:case"end":return e.stop()}},e,this)})),n.cancelTransaction=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.setState(function(e){return{erc20ForwarderTx:null,loadingErc20ForwarderTx:!1,processing:Object(C.a)({},e.processing,Object(re.a)({approve:{txHash:null,loading:!1}},n.state.action,{txHash:null,loading:!1}))}});case 1:case"end":return e.stop()}},e,this)})),n.executeAction=Object(i.a)(o.a.mark(function e(){var t,a,s,r,l,c,p,u,m,h,d,f,g,b,k,v,x,y,T,w,S,E,M,D,U,j,O,A,I,P,Y,B,F,z,R,H;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=null,a=n.state.redeemGovTokens,s=n.getFastBalanceSelector(),r=n.state.inputValue[n.state.action],l=n.state.redeemSkipGov&&n.state.redeemSkipGovTokens.length>0&&n.state.agreeSkipGovTokens,c=n.functionsUtil.getGlobalConfig(["contract","methods","deposit","erc20ForwarderEnabled"])&&n.state.erc20ForwarderEnabled,p=n.functionsUtil.getGlobalConfig(["contract","methods","deposit","metaTransactionsEnabled"])&&n.state.metaTransactionsEnabled,u=!0,e.t0=n.state.action,e.next="deposit"===e.t0?11:"redeem"===e.t0?62:100;break;case 11:if(!n.state.buttonDisabled&&r&&!n.functionsUtil.BNify(r).lte(0)){e.next=13;break}return e.abrupt("return",!1);case 13:if(n.state.tokenApproved){e.next=15;break}return e.abrupt("return",n.approveToken());case 15:if(localStorage&&n.functionsUtil.setLocalStorage("redirectToFundsAfterLogged",0),n.setState({lendingProcessing:n.props.account,lendAmount:"",genericError:""}),m=function(e,t){!e&&t&&(e={status:"error"});var a="error"===e.status,o="success"===e.status,i={eventCategory:"Deposit",eventAction:n.props.selectedToken,eventLabel:e.status,eventValue:parseInt(r)};t&&(i.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==i.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(i),n.setState(function(e){return{processing:Object(C.a)({},e.processing,Object(re.a)({},n.state.action,{txHash:null,loading:!1}))}}),o?n.setState(function(e){return{activeModal:"share",inputValue:Object(C.a)({},e.inputValue,Object(re.a)({},n.state.action,n.functionsUtil.BNify(0)))}}):(n.state.metaTransactionsEnabled||n.state.erc20ForwarderEnabled)&&a&&n.setState({erc20ForwarderTx:null,loadingErc20ForwarderTx:!1,txError:Object(re.a)({},n.state.action,!0)})},h=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(C.a)({},e.processing,Object(re.a)({},n.state.action,Object(C.a)({},e.processing[n.state.action],{txHash:t})))}})},d=n.functionsUtil.getGlobalConfig(["curve"]),!(d.enabled&&n.functionsUtil.getGlobalConfig(["curve","availableTokens",n.props.tokenConfig.idle.token,"enabled"]))||!n.state.depositCurveEnabled){e.next=37;break}return f=n.functionsUtil.getGlobalConfig(["curve","poolContract"]),g=n.functionsUtil.normalizeTokenAmount(r,f.decimals),e.next=26,n.functionsUtil.getCurveAmounts(n.props.tokenConfig.idle.token,g);case 26:return b=e.sent,e.next=29,n.functionsUtil.getCurveTokenAmount(b);case 29:return k=e.sent,n.state.maxSlippage&&(k=(k=n.functionsUtil.BNify(k)).minus(k.times(n.functionsUtil.BNify(n.state.maxSlippage).div(100))),k=n.functionsUtil.integerValue(k)),v=[b,k],e.next=34,n.functionsUtil.contractMethodSendWrapper(n.state.curveDepositContract.name,"add_liquidity",v,m,h);case 34:t=e.sent,e.next=61;break;case 37:if(x=n.functionsUtil.normalizeTokenAmount(r,n.props.tokenConfig.decimals),y=[],!n.checkUseProxyContract()){e.next=55;break}if(T=n.state.actionProxyContract[n.state.action],w=T.contract,!p){e.next=52;break}return y=[x,n.props.tokenConfig.idle.address],E=(S=w.methods)[T.function].apply(S,Object(se.a)(y)),M=E.encodeABI(),e.next=49,n.functionsUtil.sendBiconomyTxWithPersonalSign(T.name,M,m,h);case 49:t=e.sent,e.next=53;break;case 52:c&&(D=T.contract._jsonInterface.find(function(e){return e.name===T.function}),U=!D||D.inputs.find(function(e){return"nonce"===e.name}),n.state.erc20ForwarderTx?n.setState({txError:Object(re.a)({},n.state.action,!1),loadingErc20ForwarderTx:!0},Object(i.a)(o.a.mark(function e(){var a,i,s,r,l,c,p,u,d,f,g,b,k;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={},i={},s=n.state.erc20ForwarderContract[n.state.action],r=n.functionsUtil.getGlobalConfig(["contract","methods",n.state.action,"erc20ForwarderProxyContract","forwarder"]),l="".concat(x,"00"),1,e.next=8,n.functionsUtil.signPermit(n.props.selectedToken,n.props.account,r.name,1,l);case 8:if(!(c=e.sent)){e.next=33;break}return n.setState({signedParameters:c}),p=n.functionsUtil.getGlobalConfig(["permit",n.props.selectedToken]),u=p.type.find(function(e){return"value"===e.name}),d=c.expiry,f=c.nonce,g=c.r,b=c.s,k=c.v,i.v=k,i.r=g,i.s=b,i.allowed=!0,i.expiry=parseInt(d),i.holder=n.props.account,i.value=u?l:0,i.nonce=parseInt(f.toString()),i.spender=r.address,a.permitData=i,a.permitType=s.permitType,e.next=27,n.functionsUtil.asyncTimeout(200);case 27:return e.next=29,n.functionsUtil.sendBiconomyTxWithErc20Forwarder(n.state.erc20ForwarderTx.request,a,m,h);case 29:t=e.sent,n.setState({erc20ForwarderTx:null,loadingErc20ForwarderTx:!1}),e.next=34;break;case 33:return e.abrupt("return",n.setState(function(e){return{processing:Object(C.a)({},e.processing,Object(re.a)({},n.state.action,{txHash:null,loading:!1})),signedParameters:null,erc20ForwarderTx:null,loadingErc20ForwarderTx:!1}}));case 34:case"end":return e.stop()}},e,this)}))):n.setState({txError:Object(re.a)({},n.state.action,!1),loadingErc20ForwarderTx:!0},Object(i.a)(o.a.mark(function e(){var t,a,i,s,r,l,c,p,u,m,h,d,f;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.erc20ForwarderContract[n.state.action],e.next=3,n.functionsUtil.signPermit(n.props.selectedToken,n.props.account,t.name,0,x);case 3:if(!(a=e.sent)){e.next=28;break}return s=a.expiry,r=a.nonce,l=a.r,c=a.s,p=a.v,y=U?[x,parseInt(r),s,p,l,c]:[x,s,p,l,c],"foo"===T.function&&(y=[]),u=t.permitType,m=(i=t.contract.methods)[t.function].apply(i,Object(se.a)(y)),h=m.encodeABI(),d=null,e.prev=12,e.next=15,m.estimateGas({from:n.props.account});case 15:d=(d=e.sent)?n.functionsUtil.BNify(d).times(1.2):n.functionsUtil.BNify(1e6),e.next=21;break;case 19:e.prev=19,e.t0=e.catch(12);case 21:return d||(d=n.functionsUtil.BNify(1e6)),e.next=24,n.functionsUtil.buildBiconomyErc20ForwarderTx(t.name,n.props.tokenConfig.address,u,h,d);case 24:return f=e.sent,e.abrupt("return",n.setState({erc20ForwarderTx:f,loadingErc20ForwarderTx:!1}));case 28:return e.abrupt("return",n.setState(function(e){return{processing:Object(C.a)({},e.processing,Object(re.a)({},n.state.action,{txHash:null,loading:!1})),signedParameters:null,erc20ForwarderTx:null,loadingErc20ForwarderTx:!1}}));case 29:case"end":return e.stop()}},e,this,[[12,19]])}))));case 53:e.next=61;break;case 55:return!0,j=n.getReferralAddress()||"0x0000000000000000000000000000000000000000",y=[x,!0,j],e.next=60,n.functionsUtil.contractMethodSendWrapper(n.props.tokenConfig.idle.token,"mintIdleToken",y,m,h);case 60:t=e.sent;case 61:return e.abrupt("break",102);case 62:if(!a){e.next=70;break}return O=function(e,t){var a="success"===e.status,o={eventCategory:"Redeem_gov",eventAction:n.props.selectedToken,eventLabel:e.status,eventValue:0};t&&(o.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==o.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(o),n.setState(function(e){return{processing:Object(C.a)({},e.processing,Object(re.a)({},n.state.action,{txHash:null,loading:!1}))}}),a&&n.setState(function(e){return{inputValue:Object(C.a)({},e.inputValue,Object(re.a)({},n.state.action,n.functionsUtil.BNify(0)))}})},A=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(C.a)({},e.processing,Object(re.a)({},n.state.action,Object(C.a)({},e.processing[n.state.action],{txHash:t})))}})},e.next=67,n.functionsUtil.contractMethodSendWrapper(n.props.tokenConfig.idle.token,"redeemIdleToken",[0],O,A);case 67:t=e.sent,e.next=99;break;case 70:if(!n.state.buttonDisabled&&r&&!n.functionsUtil.BNify(r).lte(0)){e.next=72;break}return e.abrupt("return",!1);case 72:if(I={value:n.functionsUtil.BNify(r)},P=null,!s){e.next=78;break}P=n.functionsUtil.BNify(n.props.idleTokenBalance).times(s),e.next=82;break;case 78:return e.next=80,n.functionsUtil.getIdleTokenPriceWithFee(n.props.tokenConfig,n.props.account);case 80:Y=e.sent,P=n.functionsUtil.BNify(n.functionsUtil.normalizeTokenAmount(r,n.props.tokenConfig.decimals)).div(Y);case 82:if(P.gt(n.functionsUtil.BNify(n.props.idleTokenBalance))&&(P=n.functionsUtil.BNify(n.props.idleTokenBalance)),P=n.functionsUtil.normalizeTokenAmount(P,18)){e.next=86;break}return e.abrupt("return",!1);case 86:if(B=function(e,t){var a="success"===e.status,o={eventCategory:"Redeem_partial",eventAction:n.props.selectedToken,eventLabel:e.status,eventValue:parseInt(r)};t&&(o.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==o.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(o),n.setState(function(e){return{processing:Object(C.a)({},e.processing,Object(re.a)({},n.state.action,{txHash:null,loading:!1}))}}),a&&n.setState(function(e){return{inputValue:Object(C.a)({},e.inputValue,Object(re.a)({},n.state.action,n.functionsUtil.BNify(0)))}})},F=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(C.a)({},e.processing,Object(re.a)({},n.state.action,Object(C.a)({},e.processing[n.state.action],{txHash:t})))}})},z="redeemIdleToken",R=[P],!l){e.next=96;break}return z="redeemIdleTokenSkipGov",e.next=94,n.getSkippedGovTokensFlags();case 94:H=e.sent,R.push(H);case 96:return e.next=98,n.functionsUtil.contractMethodSendWrapper(n.props.tokenConfig.idle.token,z,R,B,F,I);case 98:t=e.sent;case 99:return e.abrupt("break",102);case 100:return u=!1,e.abrupt("break",102);case 102:!1===t&&u===n.state.processing[n.state.action].loading||n.setState(function(e){return{processing:Object(C.a)({},e.processing,Object(re.a)({},n.state.action,Object(C.a)({},e.processing[n.state.action],{loading:u})))}});case 103:case"end":return e.stop()}},e,this)})),n.setMaxSlippage=function(e){n.setState({maxSlippage:e})},n.showMaxSlippage=function(){n.setState({showMaxSlippage:!0})},n.checkAction=function(){var e=n.state.action;switch(e){case"redeem":n.state.canRedeem||(e="deposit")}e!==n.state.action?n.setState({action:e},function(){n.checkButtonDisabled()}):n.checkButtonDisabled()},n.checkButtonDisabled=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!n.state.action)return!1;e||(e=n.state.inputValue[n.state.action]);var t=!1;switch(n.state.action){case"deposit":t=t||e&&(e.lte(0)||e.gt(n.props.tokenBalance));break;case"redeem":!(t=!n.state.canRedeemCurve&&!n.state.redeemGovTokens&&(t||!e||e.lte(0)||e.gt(n.props.redeemableBalance)))&&n.state.redeemSkipGov&&n.state.redeemSkipGovTokens.length>0&&!n.state.agreeSkipGovTokens&&(t=!0)}n.setState({buttonDisabled:t})},n.setInputValue=function(){if(!n.state.action||null===n.state.fastBalanceSelector[n.state.action])return!1;var e=n.functionsUtil.BNify(n.state.fastBalanceSelector[n.state.action]).div(100),t=null;switch(n.state.action){case"deposit":t=n.props.tokenBalance?n.functionsUtil.BNify(n.props.tokenBalance).times(e):null;break;case"redeem":t=n.props.redeemableBalance?n.functionsUtil.BNify(n.props.redeemableBalance).times(e):null}n.checkButtonDisabled(t),n.setState(function(e){return{inputValue:Object(C.a)({},e.inputValue,Object(re.a)({},n.state.action,t))}})},n.getFastBalanceSelector=function(){return null!==n.state.fastBalanceSelector[n.state.action]&&n.functionsUtil.BNify(n.state.fastBalanceSelector[n.state.action]).div(100)},n.setFastBalanceSelector=function(e){if(!n.state.action)return!1;n.setState(function(t){return{fastBalanceSelector:Object(C.a)({},t.fastBalanceSelector,Object(re.a)({},n.state.action,e))}})},n.changeInputValue=function(){var e=Object(i.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.state.action){e.next=2;break}return e.abrupt("return",!1);case 2:a=t.target.value.length&&!isNaN(t.target.value)?n.functionsUtil.BNify(t.target.value):n.functionsUtil.BNify(0),n.checkButtonDisabled(a),n.setState(function(e){return{fastBalanceSelector:Object(C.a)({},e.fastBalanceSelector,Object(re.a)({},n.state.action,null)),inputValue:Object(C.a)({},e.inputValue,Object(re.a)({},n.state.action,a))}});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.setAction=function(e){switch(e.toLowerCase()){case"deposit":break;case"redeem":n.state.canRedeem||n.state.canRedeemCurve||(e=null);break;default:e=null}null!==e&&n.setState({action:e})},n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.loadProxyContracts();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadTokenInfo();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadProxyContracts",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.contractsInitialized){e.next=2;break}return e.abrupt("return",!1);case 2:return t=["deposit","redeem"],n={actionProxyContract:{},erc20ForwarderContract:{}},e.next=6,this.functionsUtil.asyncForEach(t,function(){var e=Object(i.a)(o.a.mark(function e(t){var i,s,r,l,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null,!a.functionsUtil.getGlobalConfig(["contract","methods",t,"erc20ForwarderEnabled"])){e.next=13;break}return i=a.functionsUtil.getGlobalConfig(["contract","methods",t,"erc20ForwarderProxyContract","forwarder"]),e.next=6,a.props.initContract(i.name,i.address,i.abi);case 6:if(!(s=a.functionsUtil.getGlobalConfig(["contract","methods",t,"erc20ForwarderProxyContract","tokens",a.props.selectedToken]))){e.next=13;break}return i=s,e.next=11,a.props.initContract(s.name,s.address,s.abi);case 11:(r=e.sent)&&(n.erc20ForwarderContract[t]=s,n.erc20ForwarderContract[t].contract=r.contract);case 13:if(i||(i=a.functionsUtil.getGlobalConfig(["contract","methods",t,"proxyContract"])),l=i&&i.enabled,n.actionProxyContract[t]=l?i:null,!l){e.next=25;break}return e.next=19,a.props.initContract(i.name,i.address,i.abi);case 19:if(!(c=e.sent)){e.next=25;break}return n.actionProxyContract[t].contract=c.contract,e.next=24,a.functionsUtil.checkTokenApproved(a.props.selectedToken,i.address,a.props.account);case 24:n.actionProxyContract[t].approved=e.sent;case 25:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 6:return e.next=8,this.setState(n);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadAPY",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.functionsUtil.getTokenAprs(this.props.tokenConfig);case 2:if(!(t=e.sent)||null===t.avgApy){e.next=12;break}if(n=this.functionsUtil.BNify(t.avgApy).toFixed(2),a=null,!this.state.canDepositCurve){e.next=11;break}return e.next=9,this.functionsUtil.getCurveAPY();case 9:(a=e.sent)&&(a=a.plus(n));case 11:this.setState({tokenAPY:n,curveAPY:a});case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getReferralAddress",value:function(){var e=this.functionsUtil.getQueryStringParameterByName("_referral");return this.functionsUtil.checkAddress(e)||(e=null),e}},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a,i,s,r,l,c,p,u,m,h,d,f,g;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadUtils(),null!==this.props.tokenBalance){e.next=3;break}return e.abrupt("return",!1);case 3:if(a=t.account!==this.props.account,i=t.selectedToken!==this.props.selectedToken,s=t.contractsInitialized!==this.props.contractsInitialized,r=n.erc20ForwarderEnabled!==this.state.erc20ForwarderEnabled,l=t.tokenBalance!==this.props.tokenBalance&&null!==this.props.tokenBalance,!(a||i||l||r||s)){e.next=13;break}return e.next=11,this.loadProxyContracts();case 11:return this.loadTokenInfo(),e.abrupt("return",!1);case 13:if(c=this.state.action!==n.action,p=this.state.fastBalanceSelector[this.state.action]!==n.fastBalanceSelector[this.state.action],(c||p)&&this.setInputValue(),n.inputValue[this.state.action]!==this.state.inputValue[this.state.action],u=n.redeemSkipGov!==this.state.redeemSkipGov,m=n.redeemGovTokens!==this.state.redeemGovTokens,h=n.agreeSkipGovTokens!==this.state.agreeSkipGovTokens,d=JSON.stringify(n.redeemSkipGovTokens)!==JSON.stringify(this.state.redeemSkipGovTokens),(m||c||d||u||h)&&this.checkButtonDisabled(),f=n.depositCurveEnabled!==this.state.depositCurveEnabled,!(n.metaTransactionsEnabled!==this.state.metaTransactionsEnabled)&&!f){e.next=30;break}return e.next=28,this.checkTokenApproved();case 28:g=e.sent,this.setState({tokenApproved:g});case 30:n.inputValue[this.state.action]!==this.state.inputValue[this.state.action]&&this.calculateCurveSlippage();case 32:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"checkMinAmountForMint",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l,c,p,u,m,h;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!1,n=this.state.totalAUM,a=this.state.maxUnlentPerc,i="risk"===this.props.selectedStrategy,!(s=this.functionsUtil.BNify(this.state.inputValue[this.state.action])).gt(this.props.tokenBalance)){e.next=7;break}return e.abrupt("return",!1);case 7:return e.next=9,this.functionsUtil.convertTokenBalance(s,this.props.selectedToken,this.props.tokenConfig,i);case 9:if(r=e.sent,l=this.functionsUtil.BNify(this.functionsUtil.getGlobalConfig(["contract","methods","deposit","minAmountForMint"])),!(c=r.gte(l))){e.next=24;break}if(!(this.props.tokenConfig.deposit&&this.props.tokenConfig.deposit.minAmountForMint&&r.lt(this.props.tokenConfig.deposit.minAmountForMint))){e.next=17;break}c=!1,e.next=24;break;case 17:return e.next=19,Promise.all([a||this.functionsUtil.genericContractCall(this.props.tokenConfig.idle.token,"maxUnlentPerc"),n||this.functionsUtil.loadAssetField("pool",this.props.selectedToken,this.props.tokenConfig,this.props.account)]);case 19:p=e.sent,u=Object(ne.a)(p,2),a=u[0],n=u[1],a&&n&&(m=s.div(n).times(100),a=this.functionsUtil.BNify(a),h=a.div(1e3).times(2),m.lt(h)?c=!1:n.times(h.div(100)).gt(l)&&(t=!0,l=n.times(h.div(100))));case 24:this.setState({totalAUM:n,showPoolPerc:t,maxUnlentPerc:a,minAmountForMint:l,minAmountForMintReached:c});case 25:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"calculateCurveSlippage",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.state.inputValue[this.state.action]?this.functionsUtil.BNify(this.state.inputValue[this.state.action]):null)&&!t.lte(0)){e.next=3;break}return e.abrupt("return",!1);case 3:n=this.functionsUtil.getGlobalConfig(["curve","poolContract"]),a=this.functionsUtil.normalizeTokenAmount(t,n.decimals),i={},e.t0=this.state.action,e.next="deposit"===e.t0?9:"redeem"===e.t0?14:15;break;case 9:return i.depositCurveBalance=t,e.next=12,this.functionsUtil.getCurveSlippage(this.props.tokenConfig.idle.token,a,!0);case 12:return i.depositCurveSlippage=e.sent,e.abrupt("break",16);case 14:case 15:return e.abrupt("break",16);case 16:this.setState(i);case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;if(!this.props.selectedToken||!this.props.tokenConfig)return null;var t="custom"===this.props.connectorName,n=this.functionsUtil.getCurrentNetwork(),a=!(!this.props.tokenConfig.canDeposit||this.props.tokenConfig.canDeposit.enabled),o=a?this.state.canRedeem&&this.props.tokenConfig.canDeposit.disabledMessageRedeemKey?this.functionsUtil.getGlobalConfig(["messages",this.props.tokenConfig.canDeposit.disabledMessageRedeemKey]):this.props.tokenConfig.canDeposit.disabledMessageDepositKey?this.functionsUtil.getGlobalConfig(["messages",this.props.tokenConfig.canDeposit.disabledMessageDepositKey]):null:null,i=!this.props.tokenConfig.govTokensDisabled&&this.functionsUtil.getGlobalConfig(["strategies",this.props.selectedStrategy,"govTokensEnabled"])&&Object.keys(this.state.tokenGovTokens).length>0,s="undefined"===typeof this.props.tokenConfig.skipMintForDeposit||this.props.tokenConfig.skipMintForDeposit,r=(this.functionsUtil.getGlobalConfig(["contract","methods","deposit","skipMintCheckboxEnabled"]),this.state.canRedeem&&(!this.state.redeemCurveEnabled||this.state.showRedeemFlow)&&"redeem"===this.state.action),l=this.functionsUtil.getGlobalConfig(["contract","methods","redeemGovTokens","enabled"])&&i&&r,c=l&&this.state.redeemGovTokens,p=this.functionsUtil.getGlobalConfig(["contract","methods","redeemSkipGov"]),u=p&&!p.disabledTokens.includes(this.props.tokenConfig.idle.token)&&i&&r,h=u&&this.state.redeemSkipGov&&Object.keys(this.props.govTokensUserBalances).length>0&&this.props.govTokensBalance.gt(0),f=u&&this.state.redeemSkipGov&&(!Object.keys(this.props.govTokensUserBalances).length||this.props.govTokensBalance.lte(0)),b=l||u,v=this.functionsUtil.getGlobalConfig(["contract","methods","deposit","erc20ForwarderEnabled"]),x=this.functionsUtil.getGlobalConfig(["contract","methods","deposit","metaTransactionsEnabled"]),y=this.functionsUtil.getGlobalConfig(["contract","methods","deposit","erc20ForwarderProxyContract","tokens"]),T=x&&this.props.biconomy&&this.state.actionProxyContract[this.state.action],w=T&&this.state.metaTransactionsEnabled,C=v&&Object.keys(y).includes(this.props.selectedToken)&&y[this.props.selectedToken].enabled&&this.props.biconomy&&this.props.erc20ForwarderClient&&this.state.actionProxyContract[this.state.action]&&!a,S="deposit"===this.state.action?this.props.tokenBalance:this.props.redeemableBalance,E=this.state.migrationEnabled&&void 0!==this.props.tokenConfig.migration.message?this.props.tokenConfig.migration.message:null,M=this.functionsUtil.getGlobalConfig(["curve"]),D=M.enabled&&this.functionsUtil.getGlobalConfig(["curve","availableTokens",this.props.tokenConfig.idle.token,"enabled"]),U=D&&this.state.depositCurveEnabled&&"deposit"===this.state.action,j="deposit"===this.state.action&&!this.state.contractPaused&&(D||this.state.tokenApproved)&&D&&this.state.componentMounted&&(!this.state.migrationEnabled||this.state.skipMigration)&&this.state.canDepositCurve&&"deposit"===this.state.action,O=D&&this.state.componentMounted&&(!this.state.migrationEnabled||this.state.skipMigration)&&this.state.canRedeemCurve&&"redeem"===this.state.action,P=U&&this.state.depositCurveSlippage&&this.state.depositCurveBalance&&!this.state.buttonDisabled,Y=j||!1,B=this.functionsUtil.getGlobalConfig(["tools","batchDeposit"]),R=B.enabled&&"undefined"!==typeof B.props.availableTokens[this.props.tokenConfig.idle.token]&&B.availableNetworks.includes(n.id),H=B.depositEnabled,N=!w&&R&&H&&!this.props.isMigrationTool&&"deposit"===this.state.action,V=this.functionsUtil.getGlobalConfig(["tools","ethWrapper"]),G=V.subComponent,W="WETH"===this.props.selectedToken&&V.enabled&&V.availableNetworks.includes(n.id)&&!this.props.isMigrationTool&&"deposit"===this.state.action,L=this.functionsUtil.getGlobalConfig(["tools","polygonBridge"]),_=this.functionsUtil.getGlobalConfig(["network","providers","polygon","networkPairs",n.id]),q=("deposit"===this.state.action&&this.state.canDeposit&&!a||"redeem"===this.state.action&&this.state.canRedeem||c)&&(!this.state.showPolygonBridgeEnabled||"redeem"===this.state.action),J=!c&&q,K=this.state.componentMounted&&"infura"===n.provider&&(!j||this.state.showBuyFlow)&&!this.state.depositCurveEnabled&&this.state.tokenApproved&&!this.state.contractPaused&&(!this.state.migrationEnabled||this.state.skipMigration)&&"deposit"===this.state.action&&!a&&!this.state.canDeposit&&!this.state.showETHWrapperEnabled,$=this.props.account&&this.state.componentMounted&&"deposit"===this.state.action&&!this.state.canDeposit&&"polygon"===n.provider,Q=!$&&"polygon"===n.provider&&_&&L.enabled&&"deposit"===this.state.action,Z=this.functionsUtil.BNify(this.props.accountBalance).gt(0)?this.props.selectedToken:this.functionsUtil.getBaseToken(),te=this.getReferralAddress(),ne=te&&"deposit"===this.state.action&&J&&!K;return m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.h,{width:[1,"35em"],alignItems:"stretch",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.b,{width:1},m.a.createElement(d.u,{mb:1},"Select your asset:"),m.a.createElement(z.a,this.props)),t?m.a.createElement(ee.a,{cardProps:{mt:3},icon:"Visibility",text:'You are using Idle in "Read-Only" mode.<br />Logout and connect with your wallet to interact.'}):m.a.createElement(le.a,Object.assign({},this.props,{migrateTextBefore:E,migrateText:null!==E?"":null,toggleSkipMigration:this.toggleSkipMigration.bind(this)}),this.props.account?this.state.componentMounted?this.state.action&&m.a.createElement(d.b,{width:1},m.a.createElement(d.h,{mt:2,flexDirection:"column"},m.a.createElement(d.u,{mb:2},"Choose the action:"),m.a.createElement(d.h,{alignItems:"center",flexDirection:"row",justifyContent:"space-between"},m.a.createElement(g.a,{cardProps:{p:3,width:.48,onMouseDown:function(){e.setAction("deposit")}},isInteractive:!0,isActive:"deposit"===this.state.action},m.a.createElement(d.h,{my:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(de.a,{transaction:{action:"deposit"},fieldInfo:{name:"icon",props:{mr:3}}}),m.a.createElement(d.u,{fontSize:3,fontWeight:3},"Deposit"))),m.a.createElement(g.a,{cardProps:{p:3,width:.48,onMouseDown:function(){e.setAction("redeem")}},isInteractive:!0,isActive:"redeem"===this.state.action,isDisabled:!this.state.canRedeem&&!this.state.canRedeemCurve},m.a.createElement(d.h,{my:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(de.a,{transaction:{action:"redeem"},fieldInfo:{name:"icon",props:{mr:3}}}),m.a.createElement(d.u,{fontSize:3,fontWeight:3},"Redeem")))),a&&m.a.createElement(ee.a,{cardProps:{mt:3},iconProps:{color:"#ffe000"},icon:"Warning",text:o},"deposit"===this.state.action&&this.state.canRedeem&&m.a.createElement(A.a,{buttonProps:{mt:3,width:[1,.5]},handleClick:function(t){return e.setAction("redeem")}},"Redeem"))),r&&this.state.unlentBalance&&m.a.createElement(g.a,{cardProps:{py:2,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.k,{size:"1.8em",color:"cellText",name:"LocalGasStation"}),m.a.createElement(d.u,{px:2,fontSize:1,color:"cellText",textAlign:"center"},"Available balance for Cheap Redeem"),m.a.createElement(d.h,{alignItems:"center",flexDirection:"row"},m.a.createElement(d.u,{fontSize:1,fontWeight:3,color:"dark-gray",textAlign:"center",hoverColor:"copyColor"},this.state.unlentBalance.toFixed(4)," ",this.props.selectedToken),m.a.createElement(d.y,{placement:"top",message:this.functionsUtil.getGlobalConfig(["messages","cheapRedeem"])},m.a.createElement(d.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))))),b?m.a.createElement(g.a,{cardProps:{pt:2,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",pb:this.state.showAdvancedOptions?3:2}},m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(d.n,{ml:1,mainColor:"primary",hoverColor:"primary",onClick:this.toggleShowAdvancedOptions},this.state.showAdvancedOptions?"Hide":"Show"," advanced options"),m.a.createElement(d.k,{size:"1.8em",color:"cellText",name:this.state.showAdvancedOptions?"ArrowDropUp":"ArrowDropDown"})),this.state.showAdvancedOptions&&m.a.createElement(d.h,{mt:1,flexDirection:"column"},l&&m.a.createElement(d.h,{alignItems:"center",justifyContent:"row"},m.a.createElement(d.e,{required:!1,checked:this.state.redeemGovTokens,label:"Redeem governance tokens only",onChange:function(t){return e.toggleRedeemGovTokens(t.target.checked)}}),m.a.createElement(d.n,{color:"link",hoverColor:"link",onClick:function(t){return e.props.openTooltipModal("Redeem governance tokens","This feature allows you to redeem just the amount of governance tokens accrued".concat(e.props.govTokensBalance&&e.props.govTokensBalance.gt(0)?" (~".concat(e.props.govTokensBalance.toFixed(2),"$)"):null," without redeeming the underlying token."))}},"(read more)")),u&&m.a.createElement(d.h,{alignItems:"center",flexDirection:"row"},m.a.createElement(d.e,{required:!1,checked:this.state.redeemSkipGov,label:"Redeem without governance tokens",onChange:function(t){return e.toggleRedeemSkipGov(t.target.checked)}}),m.a.createElement(d.k,{mr:1,size:"1.2em",name:"Warning",color:"#ffe000"}),m.a.createElement(d.n,{color:"link",hoverColor:"link",onClick:function(t){return e.props.openTooltipModal("Redeem without governance tokens",e.functionsUtil.getGlobalConfig(["messages","redeemSkipGov"]))}},"(read more)")))):Y?m.a.createElement(g.a,{cardProps:{pt:2,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",pb:this.state.showAdvancedOptions?3:2}},m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(d.n,{ml:1,mainColor:"primary",hoverColor:"primary",onClick:this.toggleShowAdvancedOptions},this.state.showAdvancedOptions?"Hide":"Show"," advanced options"),m.a.createElement(d.k,{size:"1.8em",color:"cellText",name:this.state.showAdvancedOptions?"ArrowDropUp":"ArrowDropDown"})),this.state.showAdvancedOptions&&m.a.createElement(d.h,{mt:1,flexDirection:"column"},j&&m.a.createElement(d.h,{alignItems:"center",justifyContent:"row"},m.a.createElement(d.e,{required:!1,disabled:this.state.directMint,label:"Deposit in the Curve Pool",checked:this.state.depositCurveEnabled,onChange:function(t){return e.toggleDepositCurve(t.target.checked)}}),m.a.createElement(d.n,{mainColor:"primary",hoverColor:"primary",onClick:function(t){return e.props.openTooltipModal("How Curve works",e.functionsUtil.getGlobalConfig(["messages","curveInstructions"]))}},"(read more)")),!1)):m.a.createElement(d.h,{width:1,flexDirection:"column"},j&&m.a.createElement(d.h,{width:1,flexDirection:"column",justifyContent:"center"},m.a.createElement(g.a,{isRainbow:!0,cardProps:{py:3,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.l,{height:"1.8em",src:M.params.image}),m.a.createElement(d.u,{mt:2,px:2,fontSize:1,color:"dark-gray",textAlign:"center"},"Deposit your tokens in the Curve Pool and boost your APY up to ",this.state.curveAPY?this.state.curveAPY.toFixed(2):"-","%.",m.a.createElement(d.n,{ml:1,mainColor:"primary",hoverColor:"primary",onClick:function(t){return e.props.openTooltipModal("How Curve works",e.functionsUtil.getGlobalConfig(["messages","curveInstructions"]))}},"Read More")),m.a.createElement(d.e,{mt:2,required:!1,label:"Deposit in Curve",checked:this.state.depositCurveEnabled,onChange:function(t){return e.toggleDepositCurve(t.target.checked)}}))),!this.state.showBuyFlow&&!this.state.depositCurveEnabled&&!this.state.canDeposit&&m.a.createElement(d.n,{textAlign:"center",hoverColor:"primary",onClick:function(t){return e.setShowBuyFlow(!0)}},"I just want to deposit more ",this.props.selectedToken)),!1,l&&m.a.createElement(g.a,{cardProps:{py:3,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.k,{size:"1.8em",color:"cellText",name:"InfoOutline"}),m.a.createElement(d.u,{mt:1,px:2,fontSize:1,color:"cellText",textAlign:"center"},"By redeeming your ",this.props.selectedToken," you will automatically get also the proportional amount of governance tokens accrued",this.props.govTokensBalance&&this.props.govTokensBalance.gt(0)?" (~ $".concat(this.props.govTokensBalance.toFixed(2),")"):null,".")),m.a.createElement(d.e,{mt:2,required:!1,checked:this.state.redeemGovTokens,label:"Redeem governance tokens only",onChange:function(t){return e.toggleRedeemGovTokens(t.target.checked)}}))),h?m.a.createElement(g.a,{cardProps:{mt:2,mb:2,py:2,px:1}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(d.u,{mt:1,fontSize:2,color:"cellText",textAlign:"center"},"Select the gov tokens you want to give away:"),m.a.createElement(d.h,{mt:2,width:1,boxShadow:0,style:{flexWrap:"wrap"},alignItems:"center",justifyContent:"center"},Object.keys(this.props.govTokensUserBalances).map(function(t){var n=e.props.govTokensUserBalances[t],a=e.state.redeemSkipGovTokens.includes(t),o=e.functionsUtil.getGlobalConfig(["govTokens",t]);return m.a.createElement(d.h,{p:2,mb:1,mx:1,width:"auto",style:{cursor:"pointer"},borderRadius:2,flexDirection:"row",border:a?2:1,key:"skipGovToken_".concat(t),justifyContent:"flex-start",backgroundColor:a?"menuHover":"cardBgHover",onClick:function(n){return e.setRedeemSkipGovTokens(t,!e.state.redeemSkipGovTokens.includes(t))}},m.a.createElement(d.e,{m:0,required:!1,checked:a,onChange:function(n){return e.setRedeemSkipGovTokens(t,n.target.checked)}}),m.a.createElement(X.a,{token:t,tokenConfig:o,fieldInfo:{name:"icon",props:{mr:1,width:["1.4em","1.6em"],height:["1.4em","1.6em"]}}}),m.a.createElement(F.a,{ml:1,fontSize:[0,2],fontWeight:500,maxPrecision:4,color:"cellText",number:n.toString()}))})))):f&&m.a.createElement(g.a,{cardProps:{p:2,my:2}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.k,{size:"1.8em",name:"MoneyOff",color:"cellText"}),m.a.createElement(d.u,{mt:1,fontSize:1,color:"cellText",textAlign:"center"},"You don't have any gov tokens to give away."))),h&&this.functionsUtil.BNify(this.state.skippedGovTokensBalance).gt(0)?m.a.createElement(g.a,{cardProps:{p:2,my:2}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.k,{size:"1.8em",name:"Warning",color:"#ffe000"}),m.a.createElement(d.u,{mt:1,fontSize:1,color:"red",textAlign:"center"},"You are giving away ",this.functionsUtil.formatMoney(this.state.skippedGovTokensBalance),"$ worth of governance tokens!"),this.state.skipGovTokensGasSave&&this.state.skipGovTokensGasSave.gte(1e-4)&&m.a.createElement(d.u,{mt:1,fontSize:1,color:"#00b84a",textAlign:"center"},"This will save you ",this.state.skipGovTokensGasSave.toFixed(4)," ETH of gas (~",this.state.skipGovTokensGasSaveUSD.toFixed(2),"$)"),m.a.createElement(d.u,{mt:1,fontSize:1,color:"cellText",textAlign:"center"},"To proceed with the redeem please give your authorization by checking the following flag:"),m.a.createElement(d.e,{my:1,required:!1,checked:this.state.agreeSkipGovTokens,label:"I agree to give away my governance tokens",onChange:function(t){return e.toggleAgreeSkipGovTokens(t.target.checked)}}))):h&&this.state.redeemSkipGovTokens.length>0&&m.a.createElement(g.a,{cardProps:{p:3,my:2}},m.a.createElement(k.a,{flexProps:{flexDirection:"row"},loaderProps:{size:"25px"},textProps:{ml:2},text:"Loading estimated gas usage..."})),ne&&m.a.createElement(g.a,{cardProps:{py:3,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.k,{size:"1.8em",name:"Share",color:"cellText"}),m.a.createElement(d.u,{mt:1,px:2,fontSize:1,color:"cellText",textAlign:"center"},"You are depositing with the following referral address:"),m.a.createElement(d.u,{mt:1,px:2,fontSize:1,fontWeight:500,textAlign:"center",color:this.props.theme.colors.transactions.status.completed},te))),!T||K||this.state.contractPaused?C&&!K&&!this.state.contractPaused&&m.a.createElement(g.a,{cardProps:{p:3,my:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},m.a.createElement(d.u,{mb:2,fontSize:2,color:"cellText",textAlign:"center"},"How do you prefer to pay gas fees for this ",this.state.action,"?"),m.a.createElement(d.h,{width:[1,.7],alignItems:"center",flexDirection:"row",justifyContent:"space-between"},m.a.createElement(he.a,Object.assign({},this.props,{cardProps:{py:2,px:[2,3],width:.48},textProps:{ml:[1,2]},text:this.props.selectedToken,isActive:this.state.erc20ForwarderEnabled,imageProps:{height:this.props.isMobile?"1.4em":"1.8em",width:this.props.isMobile?"1.4em":"1.8em"},image:"/images/tokens/".concat(this.props.selectedToken,".svg"),handleClick:function(t){return e.toggleErc20ForwarderEnabled(!0)}})),m.a.createElement(he.a,Object.assign({},this.props,{cardProps:{py:2,px:[2,3],width:.48},textProps:{ml:[1,2]},text:"ETH",isActive:!this.state.erc20ForwarderEnabled,imageProps:{height:this.props.isMobile?"1.4em":"1.8em",width:this.props.isMobile?"1.4em":"1.8em"},image:"/images/tokens/ETH.svg",handleClick:function(t){return e.toggleErc20ForwarderEnabled(!1)}}))),this.state.erc20ForwarderEnabled&&this.state.txError[this.state.action]&&m.a.createElement(d.u,{mt:2,fontSize:1,color:"red",textAlign:"center"},"The meta-transaction cannot be executed due to insufficient funds, fund your wallet or select ETH and try again.")):m.a.createElement(g.a,{cardProps:{py:3,px:2,my:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},this.state.metaTransactionsEnabled&&this.state.txError[this.state.action]&&this.state.actionProxyContract[this.state.action].approved?m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.k,{size:"1.8em",name:"Warning",color:"cellText"}),m.a.createElement(d.u,{mt:1,fontSize:1,color:"cellText",textAlign:"center"},"Seems like you are having some trouble with Meta-Transactions... Disable them by unchecking the box below and try again!")):"WalletConnect"===this.functionsUtil.getWalletProvider()&&this.state.metaTransactionsEnabled?m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.k,{size:"1.8em",name:"Warning",color:"cellText"}),m.a.createElement(d.u,{mt:1,fontSize:1,color:"cellText",textAlign:"center"},"Please disable Meta-Transactions if you are using Argent Wallet to avoid failed transactions!")):m.a.createElement(d.u,{mt:1,fontSize:1,color:"cellText",textAlign:"center"},"Meta-Transactions are ",this.state.metaTransactionsEnabled?"enabled":"disabled"," for ",this.state.action,"s!",m.a.createElement("br",null),this.state.metaTransactionsEnabled&&!this.state.actionProxyContract[this.state.action].approved&&"Please either enable the Smart-Contract to enjoy gas-less ".concat(this.state.action," or just disable meta-tx.")),m.a.createElement(d.e,{mt:2,required:!1,checked:this.state.metaTransactionsEnabled,onChange:function(t){return e.toggleMetaTransactionsEnabled(t.target.checked)},label:"".concat(this.functionsUtil.capitalize(this.state.action)," with Meta-Transaction")})),this.state.minAmountForMintReached&&"deposit"===this.state.action&&m.a.createElement(g.a,{cardProps:{p:3,mt:3}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(d.k,{size:"1.8em",color:"cellText",name:"InfoOutline"}),m.a.createElement(d.u,{mt:1,fontSize:2,color:"cellText",textAlign:"center"},"By depositing more than ",this.functionsUtil.formatMoney(this.state.minAmountForMint),"$ ",this.state.showPoolPerc?"(".concat(this.state.minAmountForMint.div(this.state.totalAUM).times(100).toFixed(0),"% of the pool)"):null," the pool will be automatically rebalanced, gas cost may be higher."))),N?m.a.createElement(d.h,{p:2,mt:3,width:1,borderRadius:2,alignItems:"center",flexDirection:"row",justifyContent:"center",backgroundColor:"DashboardCard",border:"1px solid ".concat(this.props.theme.colors.primary)},m.a.createElement(d.n,{textAlign:"center",hoverColor:"primary",href:"/#/dashboard/tools/".concat(B.route,"/").concat(this.props.tokenConfig.idle.token)},"Gas fees too high? Save gas with our Batch Deposit!"),m.a.createElement(d.k,{ml:1,size:"1em",color:"primary",name:"LocalGasStation"})):W?m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(g.a,{cardProps:{py:3,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",pb:this.state.showAdvancedOptions?3:2}},m.a.createElement(d.h,{alignItems:"center",justifyContent:"row"},m.a.createElement(d.e,{required:!1,checked:this.state.showETHWrapperEnabled,label:"Convert your ETH to WETH",onChange:function(t){return e.toggleShowETHWrapper(t.target.checked)}}))),this.state.showETHWrapperEnabled&&m.a.createElement(G,Object.assign({},this.props,{action:"wrap",fullWidth:!0,toolProps:V.props}))):Q&&m.a.createElement(d.h,{p:2,mt:3,width:1,borderRadius:2,alignItems:"center",flexDirection:"column",justifyContent:"center",backgroundColor:"DashboardCard",border:"1px solid ".concat(this.props.theme.colors.primary)},m.a.createElement(d.l,{height:"1.2em",src:L.image}),m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(d.n,{textAlign:"center",hoverColor:"primary",href:"/#/dashboard/tools/".concat(L.route,"/").concat(this.props.selectedToken)},"Use the ",L.label," to deposit your ",this.props.selectedToken),m.a.createElement(d.k,{ml:1,size:"1em",color:"primary",name:"ArrowForward"}))),O&&this.state.canRedeem&&m.a.createElement(d.h,{width:1,flexDirection:"column",justifyContent:"center"},m.a.createElement(g.a,{isRainbow:!0,cardProps:{py:3,px:2,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.l,{height:"1.8em",src:M.params.image}),m.a.createElement(d.u,{mt:2,px:2,fontSize:1,color:"dark-gray",textAlign:"center"},"Redeem your tokens from the Curve Pool.",m.a.createElement(d.n,{ml:1,mainColor:"primary",hoverColor:"primary",onClick:function(t){return e.props.openTooltipModal("How Curve works",e.functionsUtil.getGlobalConfig(["messages","curveInstructions"]))}},"Read More")),this.state.canRedeem&&m.a.createElement(d.e,{mt:2,required:!1,label:"Redeem from Curve",checked:this.state.redeemCurveEnabled,onChange:function(t){return e.toggleRedeemCurve(t.target.checked)}}))),this.canRedeem&&m.a.createElement(d.n,{textAlign:"center",hoverColor:"primary",onClick:function(t){return e.setShowRedeemFlow(!0)}},"I just want to redeem my ",this.props.selectedToken)),this.state.contractPaused&&"deposit"===this.state.action?m.a.createElement(g.a,{cardProps:{p:3,mt:3}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(d.k,{size:"1.8em",name:"Warning",color:"cellText"}),m.a.createElement(d.u,{mt:1,fontSize:2,color:"cellText",textAlign:"center"},"Deposits for ",this.props.selectedToken," are temporarily unavailable due to Smart-Contract maintenance. Redeems are always available."))):this.state.tokenApproved||"deposit"!==this.state.action||this.state.showETHWrapperEnabled||a?!K&&q&&(this.state.processing[this.state.action].loading?this.state.loadingErc20ForwarderTx?m.a.createElement(d.h,{mt:3,flexDirection:"column"},m.a.createElement(k.a,{flexProps:{flexDirection:"row"},loaderProps:{size:"25px"},textProps:{ml:2},text:this.state.erc20ForwarderTx?this.state.signedParameters?"Please Sign the Transaction...":"Please Sign the Permit...":"Calculating transaction fees..."})):this.state.erc20ForwarderTx?m.a.createElement(g.a,{cardProps:{p:3,mt:3,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"}},m.a.createElement(d.u,{mb:2,fontSize:2,color:"cellText",textAlign:"center"},"The required gas fee to perform the ",this.state.action," is ",m.a.createElement("strong",null,this.state.erc20ForwarderTx.cost," ",this.props.selectedToken)),m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(g.a,{cardProps:{mx:2,py:2,px:[2,3],width:.4,onMouseDown:function(){e.executeAction()}},isInteractive:!0},m.a.createElement(d.h,{my:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(d.h,{mr:2,alignItems:"center",justifyContent:"center"},m.a.createElement(d.k,{align:"center",color:"#00b84a",name:"CheckCircle",size:this.props.isMobile?"1em":"1.8em"})),m.a.createElement(d.u,{fontWeight:3,fontSize:[2,3]},"Confirm"))),m.a.createElement(g.a,{cardProps:{mx:2,py:2,px:[2,3],width:.4,onMouseDown:function(){e.cancelTransaction()}},isInteractive:!0},m.a.createElement(d.h,{my:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(d.h,{mr:2,alignItems:"center",justifyContent:"center"},m.a.createElement(d.k,{name:"Cancel",align:"center",color:"#e13636",size:this.props.isMobile?"1em":"1.8em"})),m.a.createElement(d.u,{fontWeight:3,fontSize:[2,3]},"Decline"))))):m.a.createElement(d.h,{mt:3,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(I.a,Object.assign({},this.props,{cancelTransaction:this.cancelTransaction.bind(this),hash:this.state.processing[this.state.action].txHash,endMessage:"Finalizing ".concat(this.state.action," request..."),waitText:"".concat(this.functionsUtil.capitalize(this.state.action)," estimated in")}))):m.a.createElement(d.h,{mt:2,flexDirection:"column"},J&&m.a.createElement(d.h,{mb:3,width:1,flexDirection:"column"},(S||this.props.tokenFeesPercentage)&&m.a.createElement(d.b,{mb:1,width:1},this.state.showMaxSlippage&&P&&m.a.createElement(d.b,{mb:2,width:1},m.a.createElement(d.h,{alignItems:"center",flexDirection:"row"},m.a.createElement(d.u,null,"Choose max slippage:"),m.a.createElement(d.y,{placement:"top",message:"Max additional slippage on top of the one shown below"},m.a.createElement(d.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))),m.a.createElement(d.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[.2,.5,1,5].map(function(t){return m.a.createElement(pe.a,{cardProps:{p:1},textProps:{fontSize:1},percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setMaxSlippage(t)},isActive:e.state.maxSlippage===parseFloat(t)})}))),m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},P?m.a.createElement(d.h,{width:1,maxWidth:"50%",alignItems:"center",flexDirection:"row"},m.a.createElement(d.u,{fontSize:1,fontWeight:3,textAlign:"right",style:{whiteSpace:"nowrap"},color:this.state.depositCurveSlippage.gt(0)?this.props.theme.colors.transactions.status.failed:this.props.theme.colors.transactions.status.completed},0===parseFloat(this.state.depositCurveSlippage.times(100).toFixed(2))?"No Slippage":"".concat(this.state.depositCurveSlippage.gt(0)?"Slippage: ":"Bonus: "," ").concat(this.state.depositCurveSlippage.times(100).abs().toFixed(2),"%")),m.a.createElement(d.y,{placement:"top",message:this.functionsUtil.getGlobalConfig(["messages","curveBonusSlippage"])},m.a.createElement(d.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"})),m.a.createElement(d.n,{ml:1,color:"copyColor",hoverColor:"primary",onClick:this.showMaxSlippage},"change")):this.props.tokenFeesPercentage&&m.a.createElement(d.h,{alignItems:"center",flexDirection:"row"},m.a.createElement(d.u,{fontSize:1,fontWeight:3,color:"dark-gray",textAlign:"right",hoverColor:"copyColor"},"Performance fee: ",this.props.tokenFeesPercentage.times(100).toFixed(2),"%"),m.a.createElement(d.y,{placement:"top",message:this.functionsUtil.getGlobalConfig(["messages","performanceFee"])},m.a.createElement(d.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))),S&&m.a.createElement(d.n,{fontSize:1,fontWeight:3,color:"dark-gray",textAlign:"right",hoverColor:"copyColor",onClick:function(t){return e.setFastBalanceSelector(100)}},S.toFixed(6)," ",this.props.selectedToken))),m.a.createElement(d.m,{min:0,type:"number",required:!0,height:"3.4em",borderRadius:2,fontWeight:500,borderColor:"cardBorder",backgroundColor:"cardBg",boxShadow:"none !important",placeholder:"Insert amount",onChange:this.changeInputValue.bind(this),border:"1px solid ".concat(this.props.theme.colors.divider),value:null!==this.state.inputValue[this.state.action]?this.functionsUtil.BNify(this.state.inputValue[this.state.action]).toFixed():""}),m.a.createElement(d.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[25,50,75,100].map(function(t){return m.a.createElement(pe.a,{percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setFastBalanceSelector(t)},isActive:e.state.fastBalanceSelector[e.state.action]===parseInt(t)})}))),q&&m.a.createElement(d.h,{justifyContent:"center",mt:c?2:0},m.a.createElement(A.a,{buttonProps:{width:"auto",minWidth:[1,.5],style:{textTransform:"capitalize"},disabled:this.state.buttonDisabled},handleClick:this.state.buttonDisabled?null:this.executeAction.bind(this)},this.state.action,c?" Gov Tokens":"")))):m.a.createElement(g.a,{isDisabled:a,cardProps:{p:3,mt:3}},this.state.processing.approve&&this.state.processing.approve.loading?m.a.createElement(d.h,{flexDirection:"column"},m.a.createElement(I.a,Object.assign({},this.props,{waitText:"Approve estimated in",endMessage:"Finalizing approve request...",hash:this.state.processing.approve.txHash,cancelTransaction:this.cancelTransaction.bind(this)}))):m.a.createElement(d.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(d.k,{size:"1.8em",name:"LockOpen",color:"cellText"}),m.a.createElement(d.u,{mt:3,fontSize:2,color:"cellText",textAlign:"center"},this.state.depositCurveEnabled?"To ".concat(this.functionsUtil.capitalize(this.state.action)," your ").concat(this.props.selectedToken," in the Curve Pool you need to approve the Smart-Contract first."):w?"To ".concat(this.functionsUtil.capitalize(this.state.action)," your ").concat(this.props.selectedToken," into Idle using Meta-Transaction you need to approve our Smart-Contract first."):"To ".concat(this.functionsUtil.capitalize(this.state.action)," your ").concat(this.props.selectedToken," into Idle you need to approve our Smart-Contract first.")),m.a.createElement(A.a,{buttonProps:{mt:3,width:[1,.5]},handleClick:this.approveToken.bind(this)},"Approve")))):m.a.createElement(d.h,{mt:4,flexDirection:"column"},m.a.createElement(k.a,{flexProps:{flexDirection:"row"},loaderProps:{size:"30px"},textProps:{ml:2},text:"Loading asset info..."})):m.a.createElement(ce.a,this.props))),O&&this.state.redeemCurveEnabled&&m.a.createElement(d.b,{mt:3,width:1},m.a.createElement(ue,this.props)),K?m.a.createElement(d.h,{mt:3,width:[1,.5],alignItems:"stretch",flexDirection:"column",justifyContent:"center"},m.a.createElement(ae.a,Object.assign({},this.props,{showInline:!0,availableMethods:[],buyToken:this.props.selectedToken}))):$&&m.a.createElement(d.h,{mt:3,width:[1,"35em"],alignItems:"stretch",flexDirection:"column",justifyContent:"center"},m.a.createElement(g.a,{cardProps:{p:3}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(d.l,{height:"2em",src:L.image}),m.a.createElement(d.u,{mt:1,fontSize:2,color:"cellText",textAlign:"center"},m.a.createElement("strong",null,"You don't have enough ",Z," in your wallet!"),m.a.createElement("br",null),"Use the ",L.label," to transfer your ",Z," in Polygon."),m.a.createElement(A.a,{buttonProps:{mt:2,width:[1,.5]},handleClick:function(t){return e.props.goToSection("tools/".concat(L.route,"/").concat(Z))}},"Deposit ",Z)))),m.a.createElement(me.a,{confettiEnabled:!0,icon:"images/medal.svg",title:"Congratulations!",account:this.props.account,closeModal:this.resetModal,tokenName:this.props.selectedToken,isOpen:"share"===this.state.activeModal,text:"You have successfully deposited in Idle!<br />Enjoy <strong>".concat(this.state.tokenAPY,"% APY</strong> on your <strong>").concat(this.props.selectedToken,"</strong>!"),tweet:"I'm earning ".concat(this.state.tokenAPY,"% APY on my ").concat(this.props.selectedToken," with @idlefinance! Go to ").concat(this.functionsUtil.getGlobalConfig(["baseURL"])," and start earning now from your idle tokens!")}))}}]),t}(u.Component),ge=n(826),be=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={loaded:!1,activeCoverages:null},n.functionsUtil=null,n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadCoverages();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),t.account!==this.props.account&&this.loadCoverages();case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadCoverages",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.account){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,this.functionsUtil.getActiveCoverages(this.props.account);case 4:t=e.sent,n=[],t&&t.length>0&&t.forEach(function(e){if(!a.props.availableTokens||!a.props.availableTokens.length||a.props.availableTokens.includes(e.collateral)){var t=a.props.theme.colors.transactions.status,o="VerifiedUser",i=t.completed;switch(e.status){case"Expired":o="Error",i=t.failed;break;case"Claimed":o="Error",i=t.pending;break;default:case"Active":o="VerifiedUser",i=t.completed}var s={color:i},r=e.portfolioCoverage||"N/A";n.push(Object.assign(e,{statusIcon:o,statusIconProps:s,portfolioCoverage:r}))}}),this.setState({loaded:!0,activeCoverages:n});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.loaded?m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},this.props.title&&(this.state.activeCoverages&&this.state.activeCoverages.length>0||this.props.children)&&m.a.createElement(T.a,this.props.titleProps,this.props.title),this.state.activeCoverages&&this.state.activeCoverages.length>0?m.a.createElement(ge.a,Object.assign({rows:this.state.activeCoverages,handleClick:this.props.isMobile?function(t){return"Expired"!==t.row.status&&t.row.fileClaimUrl&&e.functionsUtil.openWindow(t.row.fileClaimUrl)}:null,cols:[{title:"PROTOCOL",props:{width:[.28,.14]},fields:[{type:"image",props:{mr:[1,2],size:this.props.isMobile?"1.2em":"1.8em"},path:["dark"===this.props.themeMode?"protocolImageDark":"protocolImage"]},{type:"text",path:["protocolName"]}]},{title:"TOKEN",props:{width:[.33,.14]},fields:[{type:"image",props:{mr:[1,2],size:this.props.isMobile?"1.2em":"1.8em"},path:["collateralIcon"]},{type:"text",path:["collateral"]}]},{title:"AMOUNT",props:{width:[.24,.12]},fields:[{type:"number",path:["balance"],props:{decimals:this.props.isMobile?2:4}},{type:"text",path:["token"],props:{ml:[1,2],style:{textTransform:"uppercase"}}}]},{mobile:!1,title:"EXPIRATION DATE",props:{width:.19,justifyContent:["center","flex-start"]},fields:[{type:"text",path:["expirationDate"],props:{}}]},{mobile:!1,title:"COVERED FUNDS",props:{width:.14,justifyContent:["center","flex-start"]},fields:[{type:"text",path:["portfolioCoverage"],props:{}}]},{title:"STATUS",props:{width:[.15,.12],justifyContent:["center","flex-start"]},fields:[{type:"icon",name:"custom",path:["statusIcon"],props:{mr:[1,2],size:this.props.isMobile?"1.2em":"1.8em"}},{mobile:!1,name:"custom",path:["status"],props:{style:{textTransform:"capitalize"}}}]},{title:"",mobile:!1,props:{width:.17},parentProps:{width:1},fields:[{type:"button",name:"custom",funcProps:{label:function(e){return e.row.actionLabel},disabled:function(e){return e.row.actionDisabled}},props:{width:1,fontSize:3,fontWeight:3,height:"45px",borderRadius:4,boxShadow:null,mainColor:"redeem",size:this.props.isMobile?"small":"medium",handleClick:function(t){return"Expired"!==t.row.status&&t.row.actionUrl&&e.functionsUtil.openWindow(t.row.actionUrl)}}}]}]},this.props)):this.props.children):null}}]),t}(u.Component),ke=n(513),ve=n(176),xe=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={chartData:null,chartProps:null,inputValue:1e3,maxInputValue:999999999999999},n.functionsUtil=null,n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadChart();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),t.selectedToken!==this.props.selectedToken&&this.loadChart();case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadChart",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l,c,p,u,m,h,d,f=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.functionsUtil.getTokenApy(this.props.tokenConfig);case 2:if(e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:for(t=this.functionsUtil.BNify(this.state.inputValue),n=t.times(this.props.tokenApy.div(100)),a=parseFloat(n.div(12)),i=parseFloat(n.div(4)),s=parseFloat(n.div(2)),r=parseFloat(n.div(1)),l=[{perc:1/12,label:"MONTH",value:a,month:a,color:this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken.toUpperCase(),"color","rgb"]).join(","),monthColor:"hsl("+this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken.toUpperCase(),"color","hsl"]).join(",")+")"},{perc:.25,label:"3 MONTHS",value:i,month3:i,color:this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken.toUpperCase(),"color","rgb"]).join(","),month3Color:"hsl("+this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken.toUpperCase(),"color","hsl"]).join(",")+")"},{perc:.5,label:"6 MONTHS",value:s,month6:s,color:this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken.toUpperCase(),"color","rgb"]).join(","),month6Color:"hsl("+this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken.toUpperCase(),"color","hsl"]).join(",")+")"},{perc:1,label:"YEAR",year:r,value:r,color:this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken.toUpperCase(),"color","rgb"]).join(","),yearColor:"hsl("+this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken.toUpperCase(),"color","hsl"]).join(",")+")"}],c=this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.selectedToken.toUpperCase(),"chart","labelTextColorModifiers"]),4,p=r/4,u=[0],m=1;m<=4;m++)h=m*p,u.push(h);d={padding:.2,animate:!1,indexBy:"label",labelSkipWidth:16,labelSkipHeight:16,keys:["month","month3","month6","year"],colors:function(e){var t=e.id;return e.data["".concat(t,"Color")]},label:function(e){return f.functionsUtil.abbreviateNumber(e.value,2,4)+" "+f.props.selectedToken},labelTextColor:c?{from:"color",modifiers:[c]}:null,isInteractive:!1,minValue:0,gridYValues:u,axisLeft:{format:function(e){return f.functionsUtil.abbreviateNumber(e,1,3)},tickValues:u,orient:"left",tickSize:0,tickPadding:5,tickRotation:0,legend:"",legendPosition:"middle"},axisBottom:{legend:"",tickSize:0,tickPadding:15,orient:"bottom"},theme:{labels:{text:{fontSize:15,fontWeight:600,fill:ve.a.colors.counter,fontFamily:ve.a.fonts.sansSerif}},axis:{ticks:{text:{fontSize:14,fontWeight:600,fill:ve.a.colors.legend,fontFamily:ve.a.fonts.sansSerif}}},grid:{line:{stroke:"#dbdbdb",strokeDasharray:"9 5"}}},margin:this.props.isMobile?{top:0,right:0,bottom:30,left:0}:{top:10,right:0,bottom:50,left:65}},this.setState({chartData:l,chartProps:d});case 19:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"changeInputValue",value:function(e){var t=e.target.value.length&&!isNaN(e.target.value)?Math.min(this.state.maxInputValue,parseFloat(e.target.value)):0;t=this.functionsUtil.BNify(t),this.setState({inputValue:t})}},{key:"render",value:function(){var e=this;if(!this.props.selectedToken||!this.props.tokenConfig)return null;var t=this.functionsUtil.getGlobalConfig(["govTokens","IDLE","enabled"])&&this.functionsUtil.getGlobalConfig(["govTokens","IDLE","showAPR"]);return m.a.createElement(g.a,{cardProps:{p:[3,4]}},m.a.createElement(d.h,{width:1,flexDirection:["column","row"]},m.a.createElement(d.h,{width:[1,.3],flexDirection:"column",justifyContent:"flex-start"},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(X.a,{token:this.props.selectedToken,tokenConfig:this.props.tokenConfig,fieldInfo:{name:"icon",props:{mb:2,height:"2.5em"}}}),m.a.createElement(d.u,{fontSize:2,color:"cellText",textAlign:"center"},"Set the amount and see your estimated earnings on time based on the current APY: ",this.props.tokenApy?"".concat(this.props.tokenApy.toFixed(2),"%"):null,t&&m.a.createElement(d.h,{style:{display:"inline-flex",verticalAlign:"middle"}},m.a.createElement(d.y,{placement:"top",message:this.functionsUtil.getGlobalConfig(["messages","apyLong"])},m.a.createElement(d.k,{ml:1,name:"Info",size:"1em",color:"cellTitle"}))))),m.a.createElement(d.h,{mt:3,flexDirection:"column"},m.a.createElement(d.m,{min:0,type:"number",required:!0,borderRadius:2,fontWeight:500,textAlign:"center",height:["3em","3.4em"],borderColor:"cardBorder",boxShadow:"none !important",max:this.state.maxInputValue,backgroundColor:"cardBgHover",onChange:this.changeInputValue.bind(this),border:"1px solid ".concat(ve.a.colors.divider),placeholder:"Insert ".concat(this.props.selectedToken.toUpperCase()," amount"),value:this.state.inputValue&&!isNaN(this.state.inputValue)?this.state.inputValue:""})),m.a.createElement(d.h,{mt:3,justifyContent:"center"},m.a.createElement(A.a,{buttonProps:{width:[1,.5]},handleClick:this.loadChart.bind(this)},"CALCULATE"))),m.a.createElement(d.h,{mt:[3,0],width:[1,.7],id:"estimated-earnings-chart"},this.props.isMobile?m.a.createElement(d.h,{width:1,flexDirection:"column"},null!==this.state.chartData&&this.state.chartData.map(function(t,n){return m.a.createElement(d.h,{py:2,my:2,width:1,flexDirection:"row",key:"earnings_".concat(n)},m.a.createElement(d.h,{width:.35,alignItems:"center",justifyContent:"flex-start"},m.a.createElement(d.u,{fontSize:1,fontWeight:3,color:"legend"},t.label)),m.a.createElement(d.h,{width:.65,position:"relative",alignItems:"center",minHeight:["20px","35px"],justifyContent:"center"},m.a.createElement(d.h,{zIndex:1,position:"relative",alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.u,{fontSize:1,fontWeight:3,color:"counter"},e.functionsUtil.abbreviateNumber(t.value,2,4)," ",e.props.selectedToken)),m.a.createElement(d.h,{right:0,width:t.perc,position:"absolute",height:["20px","35px"],borderRadius:["20px 0 0 20px","35px 0 0 35px"],style:{background:"linear-gradient(-90deg, rgba(".concat(t.color,",0) 0%, rgba(").concat(t.color,",1) 100%)")}})))})):m.a.createElement(D.a,Object.assign({type:S.a,height:250,showLoader:!0},this.state.chartProps,{data:this.state.chartData,parentId:"estimated-earnings-chart"})))))}}]),t}(u.Component),ye=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={tokenApy:{},tokenFees:{},tokenBalance:{},tokenApproved:{},activeModal:null,idleTokenPrice:{},userHasFunds:!1,govTokensBalance:{},idleTokenBalance:{},redeemableBalance:{},govTokensDisabled:{},availableGovTokens:{},tokenFeesPercentage:{},componentMounted:!1,govTokensUserBalances:{}},n.functionsUtil=null,n.resetModal=function(){n.setState({activeModal:null})},n.setActiveModal=function(e){n.setState({activeModal:e})},n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"loadTokensInfo",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l,c,p,u,m,h,d,f,g;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.account&&this.props.contractsInitialized){e.next=2;break}return e.abrupt("return",this.setState({userHasFunds:!1}));case 2:return t=Object(C.a)({},this.state),n=this.props.selectedToken,a=this.props.availableTokens[n],(i={})[n]=a,e.next=9,Promise.all([this.functionsUtil.getTokenFees(a),this.functionsUtil.getIdleTokenPrice(a),this.functionsUtil.getTokenApy(this.props.tokenConfig),this.functionsUtil.getTokenBalance(n,this.props.account),this.functionsUtil.getUserTokenFees(a,this.props.account),this.functionsUtil.getTokenBalance(a.idle.token,this.props.account),this.functionsUtil.checkTokenApproved(n,a.idle.address,this.props.account),this.functionsUtil.getGovTokensUserBalances(this.props.account,i,null,null),this.functionsUtil.getGovTokensUserTotalBalance(this.props.account,i,"DAI",!1)]);case 9:s=e.sent,r=Object(ne.a)(s,9),l=r[0],c=r[1],p=r[2],u=r[3],m=r[4],h=r[5],d=r[6],f=r[7],g=r[8],t.tokenFees[n]=m,t.tokenBalance[n]=u,t.tokenApproved[n]=d,t.idleTokenPrice[n]=c,t.idleTokenBalance[n]=h,t.govTokensBalance[n]=g,t.tokenFeesPercentage[n]=l,t.govTokensUserBalances[n]=f,t.govTokensDisabled[n]=a.govTokensDisabled,t.tokenApy[n]=p&&!p.isNaN()?p:null,t.redeemableBalance[n]=h&&c?h.times(c):this.functionsUtil.BNify(0),t.availableGovTokens=this.functionsUtil.getTokenGovTokens(this.props.tokenConfig),t.componentMounted=!0,t.userHasFunds=this.props.account&&t.idleTokenBalance[n]&&this.functionsUtil.BNify(t.idleTokenBalance[n]).gt(0),this.setState(t);case 35:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.loadTokensInfo();case 3:window.loadTokensInfo=this.loadTokensInfo.bind(this);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a,i,s,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),a=t.account!==this.props.account,i=t.selectedToken!==this.props.selectedToken,s=JSON.stringify(t.availableTokens)!==JSON.stringify(this.props.availableTokens),r=t.transactions&&this.props.transactions&&Object.values(t.transactions).filter(function(e){return"success"===e.status}).length!==Object.values(this.props.transactions).filter(function(e){return"success"===e.status}).length,(a||r||s||i)&&this.loadTokensInfo();case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.functionsUtil.getRequiredNetwork(),n=this.functionsUtil.getGlobalConfig(["tools","nexusMutual"]);return m.a.createElement(d.b,{width:1},m.a.createElement(d.h,{width:1,mb:[3,4],alignItems:"center",flexDirection:"row",justifyContent:"flex-start"},m.a.createElement(d.h,{width:.5},m.a.createElement(B.a,Object.assign({},this.props,{isMobile:this.props.isMobile,path:[this.props.selectedToken],handleClick:function(t){return e.props.goToSection(e.props.selectedStrategy)},text:this.functionsUtil.getGlobalConfig(["strategies",this.props.selectedStrategy,"title"])}))),m.a.createElement(d.h,{width:.5,justifyContent:"flex-end"},m.a.createElement(he.a,Object.assign({icon:"Add"},this.props,{text:"Add funds",handleClick:function(t){return e.setActiveModal("buy")}})))),m.a.createElement(T.a,{mb:[3,4]},"Deposit / Redeem"),m.a.createElement(m.a.Fragment,null,m.a.createElement(d.h,{width:1},m.a.createElement(fe,Object.assign({},this.props,{tokenFees:this.state.tokenFees[this.props.selectedToken],tokenBalance:this.state.tokenBalance[this.props.selectedToken],tokenApproved:this.state.tokenApproved[this.props.selectedToken],govTokensBalance:this.state.govTokensBalance[this.props.selectedToken],idleTokenBalance:this.state.idleTokenBalance[this.props.selectedToken],redeemableBalance:this.state.redeemableBalance[this.props.selectedToken],tokenFeesPercentage:this.state.tokenFeesPercentage[this.props.selectedToken],govTokensUserBalances:this.state.govTokensUserBalances[this.props.selectedToken]}))),this.state.userHasFunds&&n.enabled&&n.availableNetworks.includes(t.id)&&Object.keys(n.props.availableTokens).includes(this.props.tokenConfig.idle.token)&&m.a.createElement(d.h,{width:1,id:"active-coverages",flexDirection:"column"},m.a.createElement(be,Object.assign({},this.props,{titleProps:{mb:3,mt:[3,4]},title:"Coverage",availableTokens:[this.props.tokenConfig.idle.token]}),m.a.createElement(d.h,{width:1,alignItems:"center",id:"no-active-cover",flexDirection:"column",justifyContent:"center"},m.a.createElement(g.a,{cardProps:{py:3,px:[3,4],width:[1,"auto"]}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.k,{my:[0,2],size:"3em",name:n.icon}),m.a.createElement(d.u,{mb:1,fontSize:[2,3],fontWeight:500,textAlign:"center"},"You don't have an active coverage"),m.a.createElement(d.u,{mb:2,color:"link",fontSize:[1,2],fontWeight:500,textAlign:"center"},n.desc),m.a.createElement(A.a,{buttonProps:{mt:1,width:"auto",minHeight:"40px",mainColor:"redeem",size:this.props.isMobile?"small":"medium"},handleClick:function(t){return e.props.goToSection("tools/".concat(n.route,"/deposit/").concat(e.props.tokenConfig.idle.token))}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(d.u,{color:"white",fontSize:[1,2],fontWeight:500},"Get Covered"),m.a.createElement(d.k,{ml:1,size:"1.3em",name:"KeyboardArrowRight"})))))))),this.state.userHasFunds&&this.props.account&&m.a.createElement(d.h,{mb:[0,4],width:1,flexDirection:"column",id:"funds-overview-container"},m.a.createElement(T.a,{my:[3,4]},"Funds Overview"),m.a.createElement(ie,Object.assign({},this.props,{tokenFees:this.state.tokenFees[this.props.selectedToken]}))),this.state.userHasFunds&&this.props.account&&!this.state.govTokensDisabled[this.props.selectedToken]&&Object.keys(this.state.availableGovTokens).length>0&&m.a.createElement(d.h,{width:1,id:"yield-farming",flexDirection:"column"},m.a.createElement(T.a,{my:[3,4]},"Yield Farming"),m.a.createElement(w.a,Object.assign({enabledTokens:Object.keys(this.state.availableGovTokens),cols:[{title:"TOKEN",props:{width:[.3,.15]},fields:[{name:"icon",props:{mr:2,height:["1.4em","2.3em"]}},{name:"tokenName"}]},{mobile:!1,title:"BALANCE",props:{width:[.33,.25]},fields:[{name:"tokenBalance",props:{decimals:this.props.isMobile?6:8}}]},{title:"REDEEMABLE",desc:this.functionsUtil.getGlobalConfig(["messages","govTokenRedeemableBalance"]),props:{width:[.35,.3],justifyContent:["center","flex-start"]},fields:[{name:"redeemableBalance",props:{decimals:this.props.isMobile?6:8}}]},{title:"DISTRIBUTION",desc:this.functionsUtil.getGlobalConfig(["messages","userDistributionSpeed"]),props:{width:[.35,.3]},fields:[{name:"userDistributionSpeed",props:{decimals:6}}]}]},this.props,{availableTokens:this.state.availableGovTokens}))),this.props.account&&this.state.tokenApy[this.props.selectedToken]&&m.a.createElement(d.h,{mb:[3,4],width:1,flexDirection:"column",id:"estimated-earnings-container"},m.a.createElement(T.a,{my:[3,4]},"Estimated earnings"),m.a.createElement(xe,Object.assign({},this.props,{tokenApy:this.state.tokenApy[this.props.selectedToken]}))),this.props.account&&m.a.createElement(d.h,{mb:[3,4],width:1,flexDirection:"column",id:"transactions-container"},m.a.createElement(T.a,{my:[3,4]},"Transactions"),m.a.createElement(ke.a,Object.assign({},this.props,{enabledTokens:[this.props.selectedToken],cols:[{title:this.props.isMobile?"":"HASH",props:{width:[.15,.24]},fields:[{name:"icon",props:{mr:[0,2]}},{name:"hash",mobile:!1}]},{title:"ACTION",mobile:!1,props:{width:.15},fields:[{name:"action"}]},{title:"DATE",props:{width:[.32,.23]},fields:[{name:"date"}]},{title:"STATUS",props:{width:[.18,.22],justifyContent:["center","flex-start"]},fields:[{name:"statusIcon",props:{mr:[0,2]}},{mobile:!1,name:"status"}]},{title:"AMOUNT",props:{width:.19},fields:[{name:"amount"}]},{title:"ASSET",props:{width:[.15,.2],justifyContent:["center","flex-start"]},fields:[{name:"tokenIcon",props:{mr:[0,2],height:["1.4em","1.6em"]}},{mobile:!1,name:"tokenName"}]}]})))),m.a.createElement(ae.a,Object.assign({},this.props,{closeModal:this.resetModal,buyToken:this.props.selectedToken,isOpen:"buy"===this.state.activeModal})))}}]),t}(u.Component),Te=n(4716),we=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={},n.functionsUtil=null,n.componentDidUpdate=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.loadUtils();case 1:case"end":return e.stop()}},e,this)})),n.closeModal=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.functionsUtil.setLocalStorage("betaApproved",!0),n.props.closeModal();case 2:case"end":return e.stop()}},e,this)})),n.loadUtils(),n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}}]),Object(r.a)(t,[{key:"render",value:function(){return m.a.createElement(d.p,{isOpen:this.props.isOpen},m.a.createElement(G.a,{maxWidth:["960px","650px"],closeFunc:this.props.closeModal},m.a.createElement(G.a.Header,{pt:3,iconHeight:"40px",title:"Beta Version",icon:"images/warning.svg"}),m.a.createElement(G.a.Body,null,m.a.createElement(d.h,{width:1,flexDirection:"column"},m.a.createElement(d.u,{fontSize:2,textAlign:"left",color:"dark-gray"},"You're about to enter Idle Finance Beta Dashboard \u2013 this is the place where several un-audited and risky features are being tested!",m.a.createElement("br",null),"Please use at your own risk, or visit the official website at ",m.a.createElement(d.n,{fontSize:2,mainColor:"primary",hoverColor:"primary",href:this.functionsUtil.getGlobalConfig(["baseURL"])},this.functionsUtil.getGlobalConfig(["baseURL"])),".")),m.a.createElement(d.h,{my:3,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(A.a,{handleClick:this.closeModal,buttonProps:{width:["100%","40%"]}},"Continue Anyway")))))}}]),t}(m.a.Component),Ce=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),p=0;p<a;p++)r[p]=arguments[p];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={processing:{txHash:null,loading:!1},inputValue:null,maxSlippage:.2,depositSlippage:null,redeemableBalance:null,migrationContract:null,curveTokensBalance:null,migrationSucceeded:!1,fastBalanceSelector:null,migrationContractApproved:!1},n.functionsUtil=null,n.changeInputValue=function(e){var t=e.target.value.length&&!isNaN(e.target.value)?n.functionsUtil.BNify(e.target.value):n.functionsUtil.BNify(0);n.checkButtonDisabled(t);n.setState(function(e){return{inputValue:t,fastBalanceSelector:null}})},n.setInputValue=function(){if(null===n.state.fastBalanceSelector)return!1;var e=n.functionsUtil.BNify(n.state.fastBalanceSelector).div(100),t=n.props.idleTokenBalance?n.functionsUtil.BNify(n.props.idleTokenBalance).times(e):null;n.checkButtonDisabled(t),n.setState({inputValue:t})},n.getFastBalanceSelector=function(){return null!==n.state.fastBalanceSelector&&n.functionsUtil.BNify(n.state.fastBalanceSelector).div(100)},n.setFastBalanceSelector=function(e){n.setState({fastBalanceSelector:e})},n.checkButtonDisabled=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e||(e=n.state.inputValue);var t=!e||e.gt(n.state.idleTokenBalance);n.setState({buttonDisabled:t})},n.approve=Object(i.a)(o.a.mark(function e(){var t,a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=n.state.migrationContract)){e.next=6;break}return e.next=4,n.checkMigrationContractApproved();case 4:e.sent?n.setState({migrationContractApproved:!0}):(a=function(e,t){var a={eventAction:"approve",eventCategory:"CurveDeposit",eventLabel:e?e.status:null},o=e&&"success"===e.status;t&&(a.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==a.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(a),n.setState(function(e){return{migrationContractApproved:o,processing:Object(C.a)({},e.processing,{txHash:null,loading:!1})}}),"function"===typeof n.props.callbackApprove&&o&&n.props.callbackApprove(e),n.checkMigration()},i=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(C.a)({},e.processing,{txHash:t})}})},n.functionsUtil.enableERC20(n.props.selectedToken,t.address,a,i),n.setState(function(e){return{processing:Object(C.a)({},e.processing,{txHash:null,loading:!0}),migrationContractApproved:!1}}));case 6:case"end":return e.stop()}},e,this)})),n.deposit=Object(i.a)(o.a.mark(function e(){var t,a,i,s,r,l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.inputValue?n.functionsUtil.BNify(n.state.inputValue):null){e.next=3;break}return e.abrupt("return",!1);case 3:return a=function(e,a){var o="success"===e.status,i={eventLabel:e.status,eventCategory:"CurveDeposit",eventAction:n.props.selectedToken,eventValue:t.toFixed()};a&&(i.eventLabel=n.functionsUtil.getTransactionError(a)),(a||"error"!==i.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(i),n.setState(function(e){return{processing:{txHash:null,loading:!1}}}),"function"===typeof n.props.callbackDeposit&&o&&n.props.callbackDeposit(e)},i=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(C.a)({},e.processing,{txHash:t})}})},s=n.state.migrationContract.name,r=n.functionsUtil.normalizeTokenAmount(t,n.props.tokenConfig.decimals),e.next=9,n.getMigrationParams(r);case 9:l=e.sent,n.props.contractMethodSendWrapper(s,"add_liquidity",l,null,a,i),n.setState(function(e){return{processing:Object(C.a)({},e.processing,{loading:!0})}});case 12:case"end":return e.stop()}},e,this)})),n.cancelTransaction=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.setState({processing:{txHash:null,loading:!1}});case 1:case"end":return e.stop()}},e,this)})),n.setMaxSlippage=function(e){n.setState({maxSlippage:e})},n.approveCallback=function(){n.initToken()},n.migrationCallback=function(){n.setState({migrationSucceeded:!0})},n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initToken();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadUtils(),a=t.account!==this.props.account,i=t.idleTokenBalance!==this.props.idleTokenBalance,!a&&!i){e.next=6;break}return e.next=6,this.initToken();case 6:this.state.fastBalanceSelector!==n.fastBalanceSelector&&this.setInputValue(),this.state.inputValue!==n.inputValue&&this.calculateSlippage();case 10:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getMigrationParams",value:function(){var e=Object(i.a)(o.a.mark(function e(t){var n,a,i,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],a=this.functionsUtil.getGlobalConfig(["curve","availableTokens",this.props.selectedToken])){e.next=4;break}return e.abrupt("return",!1);case 4:if(!a.migrationParams.n_coins){e.next=15;break}return e.next=8,this.functionsUtil.getCurveAmounts(this.props.selectedToken,t,!0);case 8:return i=e.sent,e.next=11,this.functionsUtil.getCurveTokenAmount(i);case 11:s=e.sent,this.state.maxSlippage&&(s=(s=this.functionsUtil.BNify(s)).minus(s.times(this.functionsUtil.BNify(this.state.maxSlippage).div(100))),s=this.functionsUtil.integerValue(s)),n.push(i),n.push(s);case 15:return e.abrupt("return",n);case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"calculateSlippage",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.state.inputValue?this.functionsUtil.BNify(this.state.inputValue):null)){e.next=17;break}if(!(n=t)){e.next=10;break}return e.next=6,this.functionsUtil.getIdleTokenPrice(this.props.tokenConfig);case 6:(a=e.sent)&&(n=n.times(a)),e.next=11;break;case 10:n=this.functionsUtil.BNify(0);case 11:return i=this.functionsUtil.normalizeTokenAmount(n,this.props.tokenConfig.decimals),e.next=14,this.functionsUtil.getCurveSlippage(this.props.tokenConfig.idle.token,i);case 14:(s=e.sent)&&(s=s.times(100)),this.setState({depositSlippage:s});case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkMigrationContractApproved",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.state.migrationContract,e.t0){e.next=5;break}return e.next=4,this.functionsUtil.getCurveSwapContract();case 4:e.t0=e.sent;case 5:if(!(t=e.t0)){e.next=10;break}return e.next=9,this.functionsUtil.checkTokenApproved(this.props.tokenConfig.idle.token,t.address,this.props.account);case 9:return e.abrupt("return",e.sent);case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"initToken",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.functionsUtil.getCurveSwapContract();case 2:return t=e.sent,e.next=5,this.checkMigrationContractApproved();case 5:n=e.sent,this.setState({migrationContract:t,migrationContractApproved:n});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;if(!this.props.selectedToken)return null;var t=this.state.curveTokensBalance&&this.state.curveTokensBalance.gt(0);return m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.h,{width:[1,.36],alignItems:"stretch",flexDirection:"column",justifyContent:"center"},this.props.idleTokenBalance&&this.props.idleTokenBalance.gt(0)&&m.a.createElement(d.b,{width:1},m.a.createElement(g.a,{cardProps:{p:3,px:[2,4]}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"row"},m.a.createElement(d.k,{size:"1.5em",name:this.state.migrationContractApproved?"CheckBox":"LooksOne",color:this.state.migrationContractApproved?this.props.theme.colors.transactions.status.completed:"cellText"}),m.a.createElement(d.u,{ml:2,fontSize:2,color:"cellText",textAlign:"left"},"Approve the Curve contract")),m.a.createElement(d.h,{mt:2,width:1,alignItems:"center",flexDirection:"row"},m.a.createElement(d.k,{size:"1.5em",name:t?"CheckBox":"LooksTwo",color:t?this.props.theme.colors.transactions.status.completed:"cellText"}),m.a.createElement(d.u,{ml:2,fontSize:2,color:"cellText",textAlign:"left"},"Deposit your ",this.props.tokenConfig.idle.token)))),this.state.migrationContractApproved?this.state.processing.loading?m.a.createElement(d.h,{mt:3,flexDirection:"column"},m.a.createElement(I.a,{web3:this.props.web3,waitText:"Deposit estimated in",hash:this.state.processing.txHash,endMessage:"Finalizing deposit request...",cancelTransaction:this.cancelTransaction.bind(this)})):m.a.createElement(d.b,{mt:2,width:1},m.a.createElement(d.h,{alignItems:"center",flexDirection:"row"},m.a.createElement(d.u,null,"Choose max slippage:"),m.a.createElement(d.y,{placement:"top",message:"Max additional slippage on top of the one shown below"},m.a.createElement(d.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))),m.a.createElement(d.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[.2,.5,1,5].map(function(t){return m.a.createElement(pe.a,{cardProps:{p:1},textProps:{fontSize:1},percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setMaxSlippage(t)},isActive:e.state.maxSlippage===parseFloat(t)})})),m.a.createElement(d.h,{mt:2,mb:3,width:1,flexDirection:"column"},m.a.createElement(d.h,{mb:1,alignItems:"center",flexDirection:"row",justifyContent:this.state.depositSlippage?"space-between":"flex-end"},this.state.depositSlippage&&m.a.createElement(d.h,{width:1,maxWidth:"50%",alignItems:"center",flexDirection:"row"},m.a.createElement(d.u,{fontSize:1,fontWeight:3,textAlign:"right",style:{whiteSpace:"nowrap"},color:parseFloat(this.state.depositSlippage.toFixed(3))>0?this.props.theme.colors.transactions.status.failed:this.props.theme.colors.transactions.status.completed},0===parseFloat(this.state.depositSlippage.toFixed(3))?"No Slippage":"".concat(this.state.depositSlippage.gt(0)?"Slippage: ":"Bonus: "," ").concat(this.state.depositSlippage.abs().toFixed(3),"%")),m.a.createElement(d.y,{placement:"top",message:this.state.depositSlippage.gt(0)?"Slippage comes from depositing too many coins not in balance, and current coin prices are additionally accounted for":"Bonus comes as an advantage from current coin prices which usually appears for coins which are high in balance"},m.a.createElement(d.k,{ml:1,size:"1em",color:"cellTitle",name:"InfoOutline"}))),this.props.idleTokenBalance&&m.a.createElement(d.h,{width:1,maxWidth:"50%",alignItems:"center",flexDirection:"row",justifyContent:"flex-end"},m.a.createElement(d.n,{fontSize:1,fontWeight:3,color:"dark-gray",textAlign:"right",hoverColor:"copyColor",onClick:function(t){return e.setFastBalanceSelector(100)},style:{maxWidth:"100%",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},this.props.idleTokenBalance.toFixed(this.props.isMobile?2:4)," ",this.props.selectedToken))),m.a.createElement(d.m,{min:0,type:"number",required:!0,height:"3.4em",borderRadius:2,fontWeight:500,boxShadow:"none !important",placeholder:"Insert amount",onChange:this.changeInputValue.bind(this),border:"1px solid ".concat(this.props.theme.colors.divider),value:null!==this.state.inputValue?this.functionsUtil.BNify(this.state.inputValue).toFixed():""}),m.a.createElement(d.h,{mt:2,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},[25,50,75,100].map(function(t){return m.a.createElement(pe.a,{percentage:t,key:"selector_".concat(t),onMouseDown:function(){return e.setFastBalanceSelector(t)},isActive:e.state.fastBalanceSelector===parseInt(t)})})),m.a.createElement(d.h,{mt:2,justifyContent:"center"},m.a.createElement(A.a,{buttonProps:{mt:2,width:[1,.5],disabled:this.state.buttonDisabled},handleClick:this.deposit.bind(this)},"Deposit")))):this.state.processing.loading?m.a.createElement(d.h,{mt:3,flexDirection:"column"},m.a.createElement(I.a,{web3:this.props.web3,waitText:"Approve estimated in",hash:this.state.processing.txHash,endMessage:"Finalizing approve request...",cancelTransaction:this.cancelTransaction.bind(this)})):m.a.createElement(g.a,{cardProps:{p:3,mt:3}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(d.k,{size:"2.3em",name:"LockOpen",color:"cellText"}),m.a.createElement(d.u,{mt:1,fontSize:2,color:"cellText",textAlign:"center"},"To deposit your ",this.props.selectedToken," in the Curve Pool you need to approve the Smart-Contract first."),m.a.createElement(A.a,{buttonProps:{mt:3,width:[1,.5]},handleClick:this.approve.bind(this)},"Approve"))))))}}]),t}(u.Component),Se=n(825),Ee=n(523),Me=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={startDate:null,chartData:null,chartProps:null,chartwidth:null,chartHeight:null},n.functionsUtil=null,n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),this.loadChartData();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a,i=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils(),a=t.quickDateSelection!==this.props.quickDateSelection,(JSON.stringify(t.enabledTokens)!==JSON.stringify(this.props.enabledTokens)||a)&&this.setState({chartData:null},function(){i.componentDidMount()}),t.isMobile!==this.props.isMobile&&this.loadChartData();case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadChartData",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l,c,p,u,h,d,f,g,b,k,v,x,y,T,w,C,S,E,M,D,U,j,O,A,I,P,Y=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.props.enabledTokens)&&t.length||(t=Object.keys(this.props.availableTokens)),e.next=4,this.functionsUtil.getCurveTxs(this.props.account,0,"latest",t);case 4:n=e.sent,a=[],i=[],s={},r=null,l=this.functionsUtil.BNify(0),c=this.functionsUtil.getGlobalConfig(["curve","poolContract"]),n&&n.length&&n.forEach(function(e,t){if(s[e.hash]||(s[e.hash]=[]),!s[e.hash].includes(e.action)){r=r?Math.min(r,parseInt(e.timeStamp)):parseInt(e.timeStamp);var n=Y.functionsUtil.BNify(e.curveTokens);switch(e.action){case"CurveIn":case"CurveZapIn":case"CurveDepositIn":case"CurveTransferIn":l=l.plus(n);break;case"CurveOut":case"CurveZapOut":case"CurveDepositOut":case"CurveTransferOut":l=l.minus(n)}l.lt(0)&&(l=Y.functionsUtil.BNify(0));var a=e.action,o=l,p=parseInt(e.timeStamp),u=Y.functionsUtil.fixTokenDecimals(e.curveTokenPrice,c.decimals);u.isNaN()||u.isNaN()||(i.push({action:a,balance:o,timeStamp:p,curveTokens:n,curveTokenPrice:u}),s[e.hash].push(a))}}),p=null,u=this.functionsUtil.strToMoment(new Date),e.t0=this.props.quickDateSelection,e.next="week"===e.t0?17:"month"===e.t0?19:"month3"===e.t0?21:"month6"===e.t0?23:25;break;case 17:return p=u.clone().subtract(1,"week"),e.abrupt("break",27);case 19:return p=u.clone().subtract(1,"month"),e.abrupt("break",27);case 21:return p=u.clone().subtract(3,"month"),e.abrupt("break",27);case 23:return p=u.clone().subtract(6,"month"),e.abrupt("break",27);case 25:return p=null,e.abrupt("break",27);case 27:return h={},d={},f=null,g=null,b=null,k={},v={},x=this.functionsUtil.BNify(0),y=parseInt((new Date).getTime()/1e3)+86400,e.next=38,this.functionsUtil.getTokenApiData(Object.values(this.props.availableTokens)[0].address,!1,r,null,!1,3600);case 38:T=e.sent,w=o.a.mark(function e(t){var n,a,s,l,u,m,w,S,E,M,D,U,j;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},a={},t=Math.min(y,t),s=Y.functionsUtil.strToMoment(1e3*t),l=T.filter(function(e){return e.timestamp>=f&&e.timestamp<=t}),(u=i.filter(function(e){return e.timeStamp<=t&&(!f||e.timeStamp>f)})).length){e.next=21;break}if(!d){e.next=20;break}if(u=d,m=Object.values(u).pop(),w=parseFloat(m.balance),S=Object.values(l).pop(),E=null,!S){e.next=17;break}return e.next=16,Y.functionsUtil.getCurveTokenPrice(S.blocknumber);case 16:E=e.sent;case 17:w>0&&t>r&&E&&(m.curveTokenPrice=E,u=[m]),e.next=21;break;case 20:u=[{balance:Y.functionsUtil.BNify(0),curveTokenPrice:Y.functionsUtil.BNify(0)}];case 21:M=Object.assign([],u).pop(),D=Y.functionsUtil.BNify(M.balance).times(M.curveTokenPrice),a[c.token]=Y.functionsUtil.BNify(M.balance),x=D,n=u,(null===p||s.isSameOrAfter(p))&&(s.isAfter(new Date,"day")&&(s=Y.functionsUtil.strToMoment(new Date)),U=s.format("YYYY/MM/DD 00:00"),h[s.format("YYYY/MM/DD")]=1,j=parseFloat(parseFloat(x.toFixed(6))),k[U]=j,v[U]=a,g=null===g?j:Math.min(g,j),b=null===b?j:Math.max(b,j)),f=t,d=n,C=t;case 30:case"end":return e.stop()}},e,this)}),C=r;case 41:if(!(C<=y)){e.next=46;break}return e.delegateYield(w(C),"t1",43);case 43:C+=this.props.frequencySeconds,e.next=41;break;case 46:for(S=Object.keys(k).map(function(e){return{x:e,y:k[e],balances:v[e]}}),E=0,S.forEach(function(e,t){var n=Math.floor(E/S.length*100);S[t].itemPos=n,E++}),a.push({id:"USD",color:"hsl("+this.functionsUtil.getGlobalConfig(["stats","tokens","USD","color","hsl"]).join(",")+")",data:S}),M=2,b-g<1&&(M=4),b===g&&(g=Math.max(0,b-1)),5,D=(b-g)/5,U=[],j=0;j<=5;j++)O=parseFloat(parseFloat(g+j*D).toFixed(6)),U.push(O);10,A=Object.values(h).length,I=Math.max(1,Math.ceil(A/10)),P={xScale:{type:"time",format:"%Y/%m/%d %H:%M"},yScale:{type:"linear",stacked:!1,min:g,max:b},xFormat:"time:%b %d %Y",yFormat:function(e){return Y.functionsUtil.formatMoney(e,M)},axisBottom:this.props.isMobile?null:{legend:"",tickSize:0,format:"%b %d",tickPadding:15,orient:"bottom",legendOffset:36,legendPosition:"middle",tickValues:"every "+I+" days"},gridYValues:U,pointSize:0,useMesh:!0,axisLeft:this.props.isMobile?null:{legend:"",tickSize:0,orient:"left",tickPadding:10,tickRotation:0,legendOffset:-70,tickValues:U,legendPosition:"middle",format:function(e){return Y.functionsUtil.abbreviateNumber(e,2)}},animate:!0,pointLabel:"y",areaOpacity:.1,enableArea:!0,enableSlices:"x",enableGridY:!0,curve:"monotoneX",enableGridX:!1,pointBorderWidth:1,colors:function(e){return e.color},pointLabelYOffset:-12,areaBaselineValue:g,pointColor:{from:"color",modifiers:[]},theme:{axis:{ticks:{text:{fontSize:12,fontWeight:600,fill:ve.a.colors.legend,fontFamily:ve.a.fonts.sansSerif}}},grid:{line:{stroke:"#dbdbdb",strokeDasharray:"8 4"}}},margin:this.props.isMobile?{top:20,right:25,bottom:25,left:20}:{top:30,right:50,bottom:45,left:50},sliceTooltip:function(e){var t=e.slice.points[0];return m.a.createElement(Se.a,{point:t},m.a.createElement(Ee.a,{color:t.color,label:t.serieId,value:"$ ".concat(t.data.yFormatted)}),"object"===typeof t.data.balances&&Object.keys(t.data.balances).length>0&&Object.keys(t.data.balances).map(function(e){if(e===t.serieId)return null;var n=Y.functionsUtil.getGlobalConfig(["stats","tokens",e.toUpperCase()]);if(n){var a=n.name?n.name:e,o=n.color.hex,i=t.data.balances[e],s=Y.functionsUtil.formatMoney(i,2);if(parseFloat(i)>=.01)return m.a.createElement(Ee.a,{label:a,color:o,key:"row_".concat(e),value:"".concat(s)})}return null}))}},this.setState({chartData:a,chartProps:P});case 62:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return m.a.createElement(D.a,Object.assign({type:E.a,showLoader:!0},this.state.chartProps,{data:this.state.chartData,parentId:this.props.parentId,height:this.props.chartHeight,parentIdHeight:this.props.parentIdHeight}))}}]),t}(u.Component),De=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={compAPR:null,aggregatedValues:[],govTokensUserBalance:null},n.functionsUtil=null,n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.functionsUtil.getCurveAvgBuyPrice();case 2:return e.next=4,this.functionsUtil.getCurveAvgSlippage();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadUtils();case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){return m.a.createElement(d.h,{width:1,flexDirection:"column"},this.state.aggregatedValues.length>0&&m.a.createElement(d.h,{width:1,mb:[0,3],mt:[2,0],alignItems:"center",flexDirection:["column","row"],justifyContent:"space-between"},this.state.aggregatedValues.map(function(e,t){return m.a.createElement(d.h,Object.assign({},e.flexProps,{flexDirection:"column",key:"aggregatedValue_".concat(t)}),m.a.createElement(g.a,{cardProps:{py:[2,3],mb:[3,0]}},m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},e.props.children?e.props.children:m.a.createElement(d.u,{lineHeight:1,fontWeight:[3,4],color:"copyColor",fontFamily:"counter",fontSize:[4,"1.7em"],dangerouslySetInnerHTML:{__html:e.props.value}}),m.a.createElement(d.u,{mt:2,fontWeight:2,fontSize:[1,2],color:"cellText"},e.props.title))))})),m.a.createElement(g.a,{cardProps:{px:2,py:3}},m.a.createElement(d.h,{width:1,ml:[0,3],id:"funds-overview"},m.a.createElement(Me,Object.assign({},this.props,{chartHeight:350,parentId:"funds-overview",frequencySeconds:this.functionsUtil.getFrequencySeconds("day",1)}))),m.a.createElement(d.h,{width:1,flexDirection:["column","row"]},m.a.createElement(d.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},m.a.createElement(T.a,{mb:2,fontSize:[3,4],component:d.j.h3},"Deposited"),m.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"amountLentCurve",props:{decimals:4,maxPrecision:8,fontWeight:300,fontSize:["1.8em","1.9em"],color:ve.a.colors.counter,flexProps:{justifyContent:"center"}}}}))),m.a.createElement(d.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},m.a.createElement(T.a,{mb:2,fontSize:[3,4],component:d.j.h3},"Redeemable"),m.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"redeemableBalanceCounterCurve",props:{decimals:7,maxPrecision:8,style:{fontWeight:300,color:ve.a.colors.counter,fontSize:this.props.isMobile?"1.8em":"1.9em"},flexProps:{justifyContent:"center"}}}})),m.a.createElement(d.h,{width:1,mt:"-9px"},m.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"earningsPercCurve",props:{fontSize:1,fontWeight:2,color:"cellText",flexProps:{justifyContent:"center"}}}})))),m.a.createElement(d.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},m.a.createElement(T.a,{mb:2,fontSize:[3,4],component:d.j.h3},"Earnings"),m.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"earningsCounterCurve",props:{decimals:7,maxPrecision:8,style:{fontWeight:300,fontSize:this.props.isMobile?"1.8em":"1.9em",color:ve.a.colors.counter},flexProps:{justifyContent:"center"}}}}))),m.a.createElement(d.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},m.a.createElement(T.a,{mb:2,fontSize:[3,4],component:d.j.h3},"Current APY"),m.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"curveApy",props:{decimals:2,fontWeight:300,fontSize:["1.8em","1.9em"],color:ve.a.colors.counter,flexProps:{justifyContent:"center"}}}}))),m.a.createElement(d.h,{mb:[2,0],width:[1,.2],alignItems:"center",flexDirection:"column",justifyContent:"flex-start"},m.a.createElement(T.a,{mb:2,fontSize:[3,4],component:d.j.h3},"Avg Slippage"),m.a.createElement(X.a,Object.assign({},this.props,{token:this.props.selectedToken,fieldInfo:{name:"curveAvgSlippage",props:{decimals:2,fontWeight:300,fontSize:["1.8em","1.9em"],color:ve.a.colors.counter,flexProps:{justifyContent:"center"}}}}))))))}}]),t}(u.Component),Ue=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),p=0;p<a;p++)r[p]=arguments[p];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={inputValue:{},processing:{},tokenFees:null,canRedeem:null,canDeposit:null,action:"deposit",activeModal:null,tokenConfig:null,tokenBalance:null,tokenApproved:null,selectedToken:null,availableTokens:{},redeemBalance:null,depositBalance:null,buttonDisabled:!1,curveTokenPrice:null,depositSlippage:null,idleTokenBalance:null,withdrawSlippage:null,govTokensBalance:null,curveZapContract:null,curveTokenConfig:null,curveTokensAmounts:{},govTokensDisabled:null,componentMounted:!1,curvePoolContract:null,curveSwapContract:null,curveTokenBalance:null,redeemableBalance:null,fastBalanceSelector:{},curveAvailableTokens:{},tokenFeesPercentage:null,redeemUnevenAmounts:!1,curveDepositContract:null},n.functionsUtil=null,n.resetModal=function(){n.setState({activeModal:null})},n.setActiveModal=function(e){n.setState({activeModal:e})},n.toggleUnevenAmounts=function(e){n.setState({redeemUnevenAmounts:e})},n.changeFromToken=function(e){var t=n.functionsUtil.getGlobalConfig(["curve"]);n.props.goToSection("".concat(t.params.route,"/").concat(e))},n.setSelectedToken=function(){var e=Object(i.a)(o.a.mark(function e(t){var a,i,s,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=n.functionsUtil.getCurveAvailableTokens(),i=n.functionsUtil.getGlobalConfig(["curve","availableTokens"]),s=i[t],r=a[s.baseToken],n.setState({tokenConfig:r,selectedToken:t,availableTokens:a,curveTokenConfig:s});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.loadTokensInfo=Object(i.a)(o.a.mark(function e(){var t,a,i,s,r,l,c,p,u,m,h,d,f,g;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.functionsUtil.getGlobalConfig(["curve","availableTokens"]),n.setState({curveAvailableTokens:t}),!(a=n.getSelectedToken())||a===n.props.urlParams.param1){e.next=10;break}return n.changeFromToken(a),e.next=7,n.setSelectedToken(a);case 7:return e.abrupt("return",e.sent);case 10:if(a===n.state.selectedToken){e.next=13;break}return e.next=13,n.setSelectedToken(a);case 13:return i=Object(C.a)({},n.state),s=n.functionsUtil.getCurveAvailableTokens(),i.selectedToken!==a&&(i.selectedToken=a),r=t[a],l=s[r.baseToken],e.next=20,Promise.all([n.functionsUtil.getCurveZapContract(),n.functionsUtil.getCurvePoolContract(),n.functionsUtil.getCurveSwapContract(),n.functionsUtil.getCurveDepositContract()]);case 20:if(c=e.sent,p=Object(ne.a)(c,4),u=p[0],m=p[1],h=p[2],d=p[3],i.curveZapContract=u,i.curvePoolContract=m,i.curveSwapContract=h,i.curveDepositContract=d,i.availableTokens=s,{}[a]=l,i.tokenConfig=l,i.curveTokenConfig=r,!n.props.account){e.next=57;break}return e.next=38,Promise.all([n.functionsUtil.getCurveTokenPrice(),n.functionsUtil.getCurveTokenBalance(),n.functionsUtil.getTokenFees(l),n.functionsUtil.getUserTokenFees(l,n.props.account),n.functionsUtil.getTokenBalance(a,n.props.account),n.functionsUtil.getTokenBalance(l.idle.token,n.props.account),n.functionsUtil.checkTokenApproved(a,d.address,n.props.account)]);case 38:f=e.sent,g=Object(ne.a)(f,7),i.curveTokenPrice=g[0],i.curveTokenBalance=g[1],i.tokenFeesPercentage=g[2],i.tokenFees=g[3],i.tokenBalance=g[4],i.idleTokenBalance=g[5],i.tokenApproved=g[6],i.processing={redeem:{txHash:null,loading:!1},deposit:{txHash:null,loading:!1},approve:{txHash:null,loading:!1}},i.inputValue={redeem:null,deposit:null},i.fastBalanceSelector={redeem:null,deposit:null},i.componentMounted=!0,i.depositBalance=i.tokenBalance,i.redeemBalance=i.redeemableBalance,i.govTokensDisabled=l.govTokensDisabled,i.canRedeem=i.curveTokenBalance&&i.curveTokenBalance.gt(0),i.canDeposit=i.idleTokenBalance&&i.idleTokenBalance.gt(0),i.redeemableBalance=i.curveTokenBalance?i.curveTokenBalance.times(i.curveTokenPrice):n.functionsUtil.BNify(0);case 57:n.setState(i);case 58:case"end":return e.stop()}},e,this)})),n.updateAssetSelector=Object(i.a)(o.a.mark(function e(){var t,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={},e.t0=n.state.action,e.next="deposit"===e.t0?4:"redeem"===e.t0?6:12;break;case 4:return n.loadTokensInfo(),e.abrupt("break",13);case 6:return a=n.functionsUtil.getGlobalConfig(["curve","poolContract"]),t.curveAvailableTokens={},t.curveTokenConfig=a,t.selectedToken=a.token,t.curveAvailableTokens[a.token]=a,e.abrupt("break",13);case 12:return e.abrupt("break",13);case 13:n.setState(t);case 14:case"end":return e.stop()}},e,this)})),n.getFastBalanceSelector=function(){return null!==n.state.fastBalanceSelector[n.state.action]&&n.functionsUtil.BNify(n.state.fastBalanceSelector[n.state.action]).div(100)},n.setFastBalanceSelector=function(e){if(!n.state.action)return!1;n.setState(function(t){return{fastBalanceSelector:Object(C.a)({},t.fastBalanceSelector,Object(re.a)({},n.state.action,e))}})},n.setInputValue=function(){if(!n.state.action||null===n.state.fastBalanceSelector[n.state.action])return!1;var e=n.functionsUtil.BNify(n.state.fastBalanceSelector[n.state.action]).div(100),t=null;switch(n.state.action){case"deposit":t=n.state.tokenBalance?n.functionsUtil.BNify(n.state.tokenBalance).times(e):null;break;case"redeem":t=n.state.redeemUnevenAmounts?n.state.curveTokenBalance?n.functionsUtil.BNify(n.state.curveTokenBalance).times(e):null:n.state.redeemableBalance?n.functionsUtil.BNify(n.state.redeemableBalance).times(e):null}n.checkButtonDisabled(t),n.setState(function(e){return{inputValue:Object(C.a)({},e.inputValue,Object(re.a)({},n.state.action,t))}})},n.changeInputValue=function(e){if(!n.state.action)return!1;var t=e.target.value.length&&!isNaN(e.target.value)?n.functionsUtil.BNify(e.target.value):n.functionsUtil.BNify(0);n.checkButtonDisabled(t),n.setState(function(e){return{fastBalanceSelector:Object(C.a)({},e.fastBalanceSelector,Object(re.a)({},n.state.action,null)),inputValue:Object(C.a)({},e.inputValue,Object(re.a)({},n.state.action,t))}})},n.checkButtonDisabled=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!n.state.action)return!1;e||(e=n.state.inputValue[n.state.action]);var t=!1;switch(n.state.action){case"deposit":t=t||e&&e.gt(n.state.tokenBalance);break;case"redeem":t=n.state.redeemUnevenAmounts?!n.state.canRedeem||t||e&&e.gt(n.state.curveTokenBalance):!n.state.canRedeem||t||e&&e.gt(n.state.redeemableBalance)}n.setState({buttonDisabled:t})},n.cancelTransaction=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.setState(function(e){return{processing:Object(C.a)({},e.processing,Object(re.a)({approve:{txHash:null,loading:!1}},n.state.action,{txHash:null,loading:!1}))}});case 1:case"end":return e.stop()}},e,this)})),n.approveToken=Object(i.a)(o.a.mark(function e(){var t,a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=n.state.tokenApproved)){e.next=3;break}return e.abrupt("return",n.setState(function(e){return{tokenApproved:t,processing:Object(C.a)({},e.processing,{approve:{txHash:null,loading:!1}})}}));case 3:a=function(e,t){var a={eventCategory:"Approve",eventAction:n.state.selectedToken,eventLabel:e.status};t&&(a.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==a.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(a),n.setState(function(t){return{tokenApproved:"success"===e.status,processing:Object(C.a)({},t.processing,{approve:{txHash:null,loading:!1}})}})},i=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(C.a)({},e.processing,{approve:Object(C.a)({},e.processing.approve,{txHash:t})})}})},n.functionsUtil.enableERC20(n.state.selectedToken,n.state.curveDepositContract.address,a,i),n.setState(function(e){return{processing:Object(C.a)({},e.processing,{approve:{txHash:null,loading:!0}})}});case 7:case"end":return e.stop()}},e,this)})),n.executeAction=Object(i.a)(o.a.mark(function e(){var t,a,i,s,r,l,c,p,u,m,h,d,f,g,b,k,v;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=null,a=n.state.inputValue[n.state.action],i=n.getFastBalanceSelector(),s=!0,e.t0=n.state.action,e.next="deposit"===e.t0?7:"redeem"===e.t0?23:56;break;case 7:if(!n.state.buttonDisabled&&a&&!n.functionsUtil.BNify(a).lte(0)){e.next=9;break}return e.abrupt("return",!1);case 9:return r=n.functionsUtil.normalizeTokenAmount(a,n.state.curvePoolContract.decimals),l=function(e,t){!e&&t&&(e={status:"error"});var o="error"===e.status,i="success"===e.status,s={eventCategory:"Deposit",eventAction:n.state.selectedToken,eventLabel:e.status,eventValue:parseInt(a)};t&&(s.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==s.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(s),n.setState(function(e){return{processing:Object(C.a)({},e.processing,Object(re.a)({},n.state.action,{txHash:null,loading:!1}))}}),i?n.setState(function(e){return{activeModal:"share",inputValue:Object(C.a)({},e.inputValue,Object(re.a)({},n.state.action,n.functionsUtil.BNify(0)))}}):n.state.metaTransactionsEnabled&&o&&n.setState({txError:Object(re.a)({},n.state.action,!0)})},c=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(C.a)({},e.processing,Object(re.a)({},n.state.action,Object(C.a)({},e.processing[n.state.action],{txHash:t})))}})},e.next=14,n.functionsUtil.getCurveAmounts(n.state.tokenConfig.idle.token,r);case 14:return p=e.sent,e.next=17,n.functionsUtil.genericContractCall(n.state.curveSwapContract.name,"calc_token_amount",[p,!0]);case 17:return u=e.sent,m=[p,u],e.next=21,n.props.contractMethodSendWrapper(n.state.curveDepositContract.name,"add_liquidity",m,null,l,c);case 21:return t=e.sent,e.abrupt("break",58);case 23:if(!n.state.buttonDisabled&&a&&!n.functionsUtil.BNify(a).lte(0)){e.next=25;break}return e.abrupt("return",!1);case 25:if(h=null,!i){e.next=30;break}h=n.functionsUtil.BNify(n.state.curveTokenBalance).times(i),e.next=36;break;case 30:if(h=n.functionsUtil.BNify(n.functionsUtil.normalizeTokenAmount(a,n.state.curvePoolContract.decimals)),n.state.redeemUnevenAmounts){e.next=36;break}return e.next=34,n.functionsUtil.getCurveTokenPrice();case 34:d=e.sent,h=h.div(d);case 36:if(h){e.next=38;break}return e.abrupt("return",!1);case 38:return f=function(e,t){var a="success"===e.status,o={eventLabel:e.status,eventCategory:"CurveRedeem",eventAction:n.state.selectedToken,eventValue:h.toFixed()};t&&(o.eventLabel=n.functionsUtil.getTransactionError(t)),(t||"error"!==o.status)&&n.functionsUtil.sendGoogleAnalyticsEvent(o),n.setState(function(e){return{processing:Object(C.a)({},e.processing,Object(re.a)({},n.state.action,{txHash:null,loading:!1}))}}),a&&n.setState(function(e){return{inputValue:Object(C.a)({},e.inputValue,Object(re.a)({},n.state.action,n.functionsUtil.BNify(0)))}})},g=function(e){var t=e.transactionHash;n.setState(function(e){return{processing:Object(C.a)({},e.processing,Object(re.a)({},n.state.action,Object(C.a)({},e.processing[n.state.action],{txHash:t})))}})},b=n.functionsUtil.normalizeTokenAmount(h,n.state.curvePoolContract.decimals).toString(),e.next=43,n.functionsUtil.getCurveAmounts(n.state.tokenConfig.idle.token,0);case 43:if(k=e.sent,v=n.state.curveDepositContract.name,!n.state.redeemUnevenAmounts){e.next=50;break}console.log("remove_liquidity_imbalance",n.functionsUtil.BNify(a).toString(),b.toString(),k),n.props.contractMethodSendWrapper(v,"remove_liquidity_imbalance",[k,b],null,f,g),e.next=55;break;case 50:return e.next=52,n.functionsUtil.getCurveAmounts(n.state.tokenConfig.idle.token,b);case 52:k=e.sent,console.log("remove_liquidity",n.functionsUtil.BNify(a).toString(),b.toString(),k),n.props.contractMethodSendWrapper(v,"remove_liquidity",[b,k],null,f,g);case 55:return e.abrupt("break",58);case 56:return s=!1,e.abrupt("break",58);case 58:!1!==t&&n.setState(function(e){return{processing:Object(C.a)({},e.processing,Object(re.a)({},n.state.action,Object(C.a)({},e.processing[n.state.action],{loading:s})))}});case 59:case"end":return e.stop()}},e,this)})),n.setAction=function(e){switch(e.toLowerCase()){case"deposit":break;case"redeem":n.state.canRedeem||(e=null);break;default:e=null}null!==e&&n.setState({action:e})},n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}},{key:"getSelectedToken",value:function(){var e=this.functionsUtil.getGlobalConfig(["curve","availableTokens"]);return this.props.urlParams.param1&&e[this.props.urlParams.param1]?this.props.urlParams.param1:Object.keys(e)[0]}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadUtils(),e.next=3,this.loadTokensInfo();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"calculateSlippage",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.state.inputValue[this.state.action]?this.functionsUtil.BNify(this.state.inputValue[this.state.action]):null)&&!t.lte(0)){e.next=3;break}return e.abrupt("return",!1);case 3:n=this.functionsUtil.normalizeTokenAmount(t,this.state.curvePoolContract.decimals),a={},e.t0=this.state.action,e.next="deposit"===e.t0?8:"redeem"===e.t0?13:18;break;case 8:return a.depositBalance=t,e.next=11,this.functionsUtil.getCurveSlippage(this.state.tokenConfig.idle.token,n,!0);case 11:return a.depositSlippage=e.sent,e.abrupt("break",19);case 13:return a.redeemBalance=t,e.next=16,this.functionsUtil.getCurveSlippage(this.state.tokenConfig.idle.token,n,!0);case 16:return a.withdrawSlippage=e.sent,e.abrupt("break",19);case 18:return e.abrupt("break",19);case 19:this.setState(a);case 20:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a,i,s,r,l,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadUtils(),a=t.account!==this.props.account,i=t.urlParams.param1!==this.props.urlParams.param1,s=t.transactions&&this.props.transactions&&Object.values(t.transactions).filter(function(e){return"success"===e.status}).length!==Object.values(this.props.transactions).filter(function(e){return"success"===e.status}).length,!(a||s||i)){e.next=7;break}return e.next=7,this.loadTokensInfo();case 7:r=this.state.action!==n.action,l=this.state.redeemUnevenAmounts!==n.redeemUnevenAmounts,c=this.state.fastBalanceSelector[this.state.action]!==n.fastBalanceSelector[this.state.action],(r||c||l)&&this.setInputValue(),r&&this.updateAssetSelector(),n.inputValue[this.state.action]!==this.state.inputValue[this.state.action]&&this.calculateSlippage();case 14:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.account&&this.state.curveTokenBalance&&this.functionsUtil.BNify(this.state.curveTokenBalance).gt(0);return m.a.createElement(d.b,{width:1},m.a.createElement(d.h,{width:1,mb:[3,4],alignItems:"center",flexDirection:"row",justifyContent:"flex-start"},m.a.createElement(d.h,{width:.5},m.a.createElement(B.a,Object.assign({},this.props,{isMobile:this.props.isMobile,path:["Boost",this.state.selectedToken],handleClick:function(t){return e.props.goToSection("best")},text:this.functionsUtil.getGlobalConfig(["strategies","best","title"])})))),m.a.createElement(T.a,{mb:[3,4]},"Curve Pool"),m.a.createElement(d.h,{width:1},m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.h,{width:[1,.36],alignItems:"stretch",flexDirection:"column",justifyContent:"center"},m.a.createElement(d.b,{width:1},m.a.createElement(d.u,{mb:1},"Select your asset:"),m.a.createElement(z.a,Object.assign({},this.props,{id:"token-from",onChange:this.changeFromToken,selectedToken:this.state.selectedToken,tokenConfig:this.state.curveTokenConfig,showBalance:"deposit"===this.state.action,availableTokens:this.state.curveAvailableTokens}))),m.a.createElement(d.b,{width:1},m.a.createElement(d.h,{mt:2,flexDirection:"column"},m.a.createElement(d.u,{mb:2},"Choose the action:"),m.a.createElement(d.h,{alignItems:"center",flexDirection:"row",justifyContent:"space-between"},m.a.createElement(g.a,{cardProps:{p:[2,3],width:.48,onMouseDown:function(){e.setAction("deposit")}},isInteractive:!0,isActive:"deposit"===this.state.action},m.a.createElement(d.h,{my:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(de.a,{transaction:{action:"deposit"},fieldInfo:{name:"icon",props:{mr:[1,3]}}}),m.a.createElement(d.u,{fontSize:3,fontWeight:3},"Deposit"))),m.a.createElement(g.a,{cardProps:{p:[2,3],width:.48,onMouseDown:function(){e.setAction("redeem")}},isInteractive:!0,isDisabled:!this.state.canRedeem,isActive:"redeem"===this.state.action},m.a.createElement(d.h,{my:1,alignItems:"center",flexDirection:"row",justifyContent:"center"},m.a.createElement(de.a,{transaction:{action:"redeem"},fieldInfo:{name:"icon",props:{mr:[1,3]}}}),m.a.createElement(d.u,{fontSize:3,fontWeight:3},"Redeem"))))))),m.a.createElement(d.h,{width:1,mt:this.props.account?3:0},"deposit"===this.state.action?m.a.createElement(Ce,Object.assign({},this.props,this.state)):"redeem"===this.state.action&&m.a.createElement(ue,Object.assign({},this.props,this.state))))),t&&m.a.createElement(d.h,{mb:[0,4],width:1,flexDirection:"column",id:"funds-overview-container"},m.a.createElement(T.a,{my:[3,4]},"Funds Overview"),m.a.createElement(De,Object.assign({},this.props,{tokenFees:this.state.tokenFees,tokenConfig:this.state.tokenConfig,selectedToken:this.state.selectedToken,availableTokens:this.state.availableTokens,enabledTokens:Object.keys(this.state.availableTokens)}))),this.props.account&&m.a.createElement(d.h,{mb:[3,4],width:1,flexDirection:"column",id:"transactions-container"},m.a.createElement(T.a,{my:[3,4]},"Transactions"),m.a.createElement(ke.a,Object.assign({},this.props,{availableTokens:this.state.availableTokens,enabledTokens:Object.keys(this.state.availableTokens),enabledActions:["CurveIn","CurveOut","CurveZapIn","CurveZapOut","CurveTransferIn","CurveTransferOut","CurveDepositIn","CurveDepositOut"],cols:[{title:this.props.isMobile?"":"HASH",props:{width:[.15,.24]},fields:[{name:"icon",props:{mr:[0,2]}},{name:"hash",mobile:!1}]},{title:"ACTION",mobile:!1,props:{width:.15},fields:[{name:"action"}]},{title:"DATE",props:{width:[.32,.23]},fields:[{name:"date"}]},{title:"STATUS",props:{width:[.18,.22],justifyContent:["center","flex-start"]},fields:[{name:"statusIcon",props:{mr:[0,2]}},{mobile:!1,name:"status"}]},{title:"AMOUNT",props:{width:.19},fields:[{name:"amount"}]},{title:"ASSET",props:{width:[.15,.2],justifyContent:["center","flex-start"]},fields:[{name:"tokenIcon",props:{mr:[0,2],height:["1.4em","1.6em"]}},{mobile:!1,name:"tokenName"}]}]}))),m.a.createElement(ae.a,Object.assign({},this.props,{closeModal:this.resetModal,buyToken:this.state.selectedToken,isOpen:"buy"===this.state.activeModal})))}}]),t}(u.Component),je=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={},n.functionsUtil=null,n.componentDidUpdate=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.loadUtils();case 1:case"end":return e.stop()}},e,this)})),n.closeModal=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.functionsUtil.setLocalStorage("polygonApproved",!0),n.props.closeModal();case 2:case"end":return e.stop()}},e,this)})),n.loadUtils(),n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}}]),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.functionsUtil.getGlobalConfig(["tools","polygonBridge"]);return m.a.createElement(d.p,{isOpen:this.props.isOpen},m.a.createElement(G.a,{maxWidth:["960px","650px"],closeFunc:this.props.closeModal},m.a.createElement(G.a.Header,{pt:3,iconHeight:"2em",title:"Welcome to Idle <> Polygon",icon:"images/protocols/polygon.svg"}),m.a.createElement(G.a.Body,null,m.a.createElement(d.h,{width:1,flexDirection:"column"},m.a.createElement(d.u,{fontSize:2,textAlign:"left",color:"dark-gray"},"You're about to enter Idle Finance in the Polygon Network, make sure to have some ",m.a.createElement(h.a,{color:"link",fontSize:2,href:this.functionsUtil.getEtherscanAddressUrl(this.functionsUtil.getGlobalConfig(["stats","tokens",this.props.currentNetwork.baseToken,"address"]))},this.props.currentNetwork.baseToken)," tokens in your wallet to send your transactions! Also you can use our ",m.a.createElement(d.n,{color:"link",fontSize:2,mainColor:"link",onClick:function(n){return e.props.goToSection("tools/".concat(t.route,"/").concat(e.props.currentNetwork.baseToken))}},t.label)," to transfer your tokens from Mainnet to Polygon.",m.a.createElement("br",null),"If you are not confident with this just switch to Mainnet using your wallet provider.")),m.a.createElement(d.h,{my:3,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(A.a,{handleClick:this.closeModal,buttonProps:{width:["100%","40%"]}},"Let Me In")))))}}]),t}(m.a.Component),Oe=n(11),Ae=n(424),Ie=n.n(Ae),Pe=n(60),Ye=n(222),Be=n.n(Ye),Fe=n(1203),ze=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={email:null,error:!1,subscribed:!1,sendingForm:!1},n.functionsUtil=null,n.componentDidUpdate=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.functionsUtil.setProps(n.props);case 1:case"end":return e.stop()}},e,this)})),n.sendUserInfo=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=n.functionsUtil.getWalletProvider(),a={address:n.props.account,provider:t};e&&null!==n.state.email&&(a.email=n.state.email),n.functionsUtil.simpleIDPassUserInfo(a)},n.closeModal=Object(i.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=function(){n.props.closeModal()};try{n.sendUserInfo(!1),M.a.analytics.google.events.enabled?(n.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UI",eventAction:"continue_without_email",eventLabel:"WelcomeModal"},t),setTimeout(t,1e3)):t()}catch(a){t()}case 2:case"end":return e.stop()}},e,this)})),n.functionsUtil=new f.a(e),n.handleSubmit=n.handleSubmit.bind(Object(Oe.a)(Object(Oe.a)(n))),n.handleValidation=n.handleValidation.bind(Object(Oe.a)(Object(Oe.a)(n))),n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"handleSubmit",value:function(e){var t=this;if(e.preventDefault(),!this.state.email)return!1;var n=function(){t.setState({sendingForm:!1,subscribed:!0}),window.setTimeout(t.props.closeModal,2500)};if(this.sendUserInfo(),this.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UI",eventAction:"send_email",eventLabel:"WelcomeModal"}),Ie.a.post(M.a.newsletterSubscription.endpoint,{email:this.state.email}).then(function(e){n()}).catch(function(e){n()}),localStorage){var a=this.props.account.toLowerCase(),o=localStorage.getItem("lastLogin")?JSON.parse(localStorage.getItem("lastLogin")):null;o&&o[a]&&!o[a].signedUp&&(o[a].signedUp=!0,this.functionsUtil.setLocalStorage("lastLogin",JSON.stringify(o)))}this.setState({sendingForm:!0})}},{key:"handleValidation",value:function(e){e&&e.target&&(this.setState({email:e.target.value}),e.target.parentNode.classList.add("was-validated"))}},{key:"render",value:function(){return m.a.createElement(d.p,{isOpen:this.props.isOpen},this.state.subscribed?m.a.createElement(G.a,{closeFunc:this.closeModal},m.a.createElement(G.a.Header,{title:"All done",icon:"images/done.svg"}),m.a.createElement(G.a.Body,null,m.a.createElement(d.h,{width:1,flexDirection:"column",mb:3},m.a.createElement(d.u,{color:"dark-gray",textAlign:"center",fontSize:3,my:0},"Thanks for subscribing!"),m.a.createElement(d.c,{my:3,width:"100%",borderRadius:4,onClick:this.closeModal},"CLOSE")))):m.a.createElement(G.a,{closeFunc:this.closeModal},m.a.createElement(G.a.Header,{title:"Stay up-to-date!",icon:"images/notification.svg"}),m.a.createElement(G.a.Body,null,m.a.createElement(d.i,{onSubmit:this.handleSubmit},m.a.createElement(d.h,{width:1,flexDirection:"column",mb:3},m.a.createElement(d.u,{color:"mid-gray",textAlign:"left",fontSize:3,my:0},"Add your e-mail to receive updates about:")),m.a.createElement(d.h,{width:1,flexDirection:"column",mt:2},m.a.createElement(d.h,{my:2,flexDirection:"row",alignItems:"center"},m.a.createElement(d.k,{name:"CheckCircle",color:Pe.b.green,size:"32"}),m.a.createElement(d.u,{color:"dark-gray",textAlign:"left",fontSize:3,fontWeight:2,my:0,ml:2},"Performance reports")),m.a.createElement(d.h,{my:2,flexDirection:"row"},m.a.createElement(d.k,{name:"CheckCircle",color:Pe.b.green,size:"32"}),m.a.createElement(d.u,{color:"dark-gray",textAlign:"left",fontSize:3,fontWeight:2,my:0,ml:2},"New Protocols & Tokens")),m.a.createElement(d.h,{my:2,flexDirection:"row"},m.a.createElement(d.k,{name:"CheckCircle",color:Pe.b.green,size:"32"}),m.a.createElement(d.u,{color:"dark-gray",textAlign:"left",fontSize:3,fontWeight:2,my:0,ml:2},"Latest updates")),m.a.createElement(d.i.Field,{width:1,label:""},m.a.createElement(d.i.Input,{px:3,py:4,required:!0,width:1,border:0,fontSize:3,type:"email",name:"EMAIL",outline:"none",borderColor:"cardBorder",backgroundColor:"cardBg",textAlign:["center","left"],className:Be.a.input,placeholder:"Enter your e-mail",onChange:this.handleValidation})),m.a.createElement(d.h,{mb:3,flexDirection:"column",alignItems:"center",justifyContent:"center"},m.a.createElement(Fe.a,{buttonText:"SUBMIT",isLoading:this.state.sendingForm,buttonProps:{className:Be.a.gradientButton,width:"100%",type:"submit"}}),m.a.createElement(d.n,{mt:2,onClick:this.closeModal,hoverColor:"blue"},"continue without e-mail")))))))}}]),t}(m.a.Component),Re=n(4717),He=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={dontShowAgain:!1},n.functionsUtil=null,n.componentDidUpdate=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.loadUtils();case 1:case"end":return e.stop()}},e,this)})),n.closeModal=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.functionsUtil.getGlobalConfig(["globalConfigs","analytics","google","events","enabled"])){e.next=7;break}return e.next=4,n.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UI",eventAction:"continue_without_migrate",eventLabel:"MigrateModal"});case 4:n.props.closeModal(),e.next=8;break;case 7:n.props.closeModal();case 8:case"end":return e.stop()}},e,this)})),n.toggleDontShowAgain=function(e){e?n.functionsUtil.setLocalStorage("dontShowMigrateModal","true"):n.functionsUtil.removeStoredItem("dontShowMigrateModal"),n.setState({dontShowAgain:e})},n.migrate=function(){var e=n.functionsUtil.getGlobalConfig(["tools","tokenMigration","route"]);n.props.goToSection("tools/"+e),n.props.closeModal()},n.loadUtils(),n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}}]),Object(r.a)(t,[{key:"render",value:function(){var e=this,t={fontWeight:3,fontSize:[2,3],color:"cellText",flexProps:{justifyContent:"flex-start"}};return m.a.createElement(d.p,{isOpen:this.props.isOpen},m.a.createElement(G.a,{maxWidth:["960px","750px"],closeFunc:this.props.closeModal},m.a.createElement(G.a.Header,{iconHeight:"40px",title:"Migrate to Idle",icon:"images/migrate.svg"}),m.a.createElement(G.a.Body,null,m.a.createElement(d.h,{mb:0,width:1,flexDirection:"column"},m.a.createElement(d.u,{my:0,fontSize:3,color:"mid-gray",textAlign:"center"},"You can migrate your funds from Compound, Aave, Fulcrum, Yearn and Idle V2 with just one transaction.")),m.a.createElement(d.h,{width:1,flexDirection:"column"},m.a.createElement(d.h,{my:2,alignItems:"center",flexDirection:"column"},this.props.protocolsTokensBalances&&Object.keys(this.props.protocolsTokensBalances).map(function(n){return m.a.createElement(d.h,{mb:2,alignItems:"center",flexDirection:"row",key:"token_".concat(n),justifyContent:"space-between"},m.a.createElement(X.a,{token:n,fieldInfo:{name:"icon",props:{mr:2,height:"2.3em"}},tokenConfig:e.props.protocolsTokensBalances[n].tokenConfig}),m.a.createElement(F.a,Object.assign({mr:2},t,{minPrecision:5,number:e.props.protocolsTokensBalances[n].balance})),m.a.createElement(X.a,{token:n,fieldInfo:{name:"tokenName",props:t},tokenConfig:e.props.protocolsTokensBalances[n].tokenConfig}))}),m.a.createElement(d.u,{mb:0,fontSize:1,color:"red",fontWeight:500,textAlign:"center"},"Please be aware that by migrating your tokens from other protocols, your open positions might be liquidated if collateralized with migrated tokens.")),m.a.createElement(d.h,{mb:3,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(Fe.a,{buttonText:"MIGRATE",handleClick:this.migrate,isLoading:this.state.sendingForm,buttonProps:{width:["100%","50%"],className:Be.a.gradientButton}}),m.a.createElement(d.e,{mt:2,required:!1,color:"mid-gray",checked:this.state.dontShowAgain,label:"Don't show this popup again",onChange:function(t){return e.toggleDontShowAgain(t.target.checked)}}))))))}}]),t}(m.a.Component),Ne=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={dontShowAgain:!1},n.functionsUtil=null,n.componentDidUpdate=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.loadUtils();case 1:case"end":return e.stop()}},e,this)})),n.closeModal=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.functionsUtil.getGlobalConfig(["globalConfigs","analytics","google","events","enabled"])){e.next=7;break}return e.next=4,n.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UI",eventAction:"close_upgrade_modal",eventLabel:"UpgradeModal"});case 4:n.props.closeModal(),e.next=8;break;case 7:n.props.closeModal();case 8:case"end":return e.stop()}},e,this)})),n.toggleDontShowAgain=function(e){e?n.functionsUtil.setLocalStorage("dontShowUpgradeModal","true"):n.functionsUtil.removeStoredItem("dontShowUpgradeModal"),n.setState({dontShowAgain:e})},n.migrate=function(){var e=Object(i.a)(o.a.mark(function e(t){var a,i=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((a=i.length>1&&void 0!==i[1]?i[1]:null)||(a=n.props.selectedStrategy),!n.functionsUtil.getGlobalConfig(["globalConfigs","analytics","google","events","enabled"])){e.next=10;break}return e.next=6,n.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UpgradeModal",eventAction:"migrate",eventLabel:"".concat(n.props.selectedStrategy,"_").concat(t)});case 6:n.props.goToSection("".concat(a,"/").concat(t)),n.props.closeModal(),e.next=12;break;case 10:n.props.goToSection("".concat(a,"/").concat(t)),n.props.closeModal();case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.convert=function(){var e=Object(i.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.functionsUtil.getGlobalConfig(["tools","tokenMigration"]),!n.functionsUtil.getGlobalConfig(["globalConfigs","analytics","google","events","enabled"])){e.next=9;break}return e.next=5,n.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UpgradeModal",eventAction:"migrate",eventLabel:"".concat(n.props.selectedStrategy,"_").concat(t)});case 5:n.props.goToSection("tools/".concat(a.route,"/").concat(t)),n.props.closeModal(),e.next=11;break;case 9:n.props.goToSection("tools/".concat(a.route,"/").concat(t)),n.props.closeModal();case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.loadUtils(),n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}}]),Object(r.a)(t,[{key:"render",value:function(){var e=this;if(!this.props.availableStrategies||!this.props.availableTokens)return null;var t={fontWeight:3,fontSize:[2,3],color:"cellText",flexProps:{justifyContent:"flex-start"}};return m.a.createElement(d.p,{isOpen:this.props.isOpen},m.a.createElement(G.a,{maxWidth:["960px","750px"],closeFunc:this.props.closeModal},m.a.createElement(G.a.Header,{icon:"images/migrate.svg",title:"Upgrade Available",iconHeight:["35px","40px"]}),m.a.createElement(G.a.Body,null,m.a.createElement(d.h,{mb:0,width:1,flexDirection:"column"},m.a.createElement(d.u,{my:0,fontSize:[2,3],color:"mid-gray",textAlign:"center"},"Idle now supports yield farming and governance tokens distribution, migrate now your portfolio with just one click!")),m.a.createElement(d.h,{width:1,flexDirection:"column"},m.a.createElement(d.h,{mt:[2,3],alignItems:"center",flexDirection:"row"},m.a.createElement(d.h,{fontSize:[2,3],width:[.5,.28],fontWeight:[4,5],color:"copyColor"},this.props.isMobile?"ASSET":"ASSET TO MIGRATE"),!this.props.isMobile&&m.a.createElement(d.h,{width:.19,fontWeight:[4,5],color:"copyColor",justifyContent:"center"},"BALANCE"),!this.props.isMobile&&m.a.createElement(d.h,{width:.19,fontWeight:[4,5],color:"copyColor",justifyContent:"center"},"OLD APY"),m.a.createElement(d.h,{fontSize:[2,3],fontWeight:[4,5],width:[.25,.19],color:"copyColor",justifyContent:"center"},this.props.isMobile?"APY":"NEW APY"),m.a.createElement(d.h,{width:[.25,.15]})),m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column"},this.props.tokensToMigrate&&Object.keys(this.props.tokensToMigrate).map(function(n){var a=e.props.tokensToMigrate[n].token,o=e.props.tokensToMigrate[n].strategy,i=e.props.tokensToMigrate[n].tokenConfig,s=e.props.tokensToMigrate[n].oldContractBalanceFormatted;return m.a.createElement(d.h,{mt:2,width:1,alignItems:"center",flexDirection:"row",key:"token_".concat(n),justifyContent:"space-between"},m.a.createElement(d.h,{width:[.5,.28],alignItems:"center",flexDirection:"row"},m.a.createElement(X.a,{fieldInfo:{name:"icon",props:{mr:2,height:["1.8em","2.3em"]}},tokenConfig:i,token:i.idle.token}),m.a.createElement(X.a,{fieldInfo:{name:"tokenName",props:t},tokenConfig:i,token:i.idle.token})),!e.props.isMobile&&m.a.createElement(d.h,{width:.19,alignItems:"center",justifyContent:"center"},m.a.createElement(F.a,Object.assign({},t,{minPrecision:5,number:s,flexProps:{justifyContent:"center"}}))),!e.props.isMobile&&m.a.createElement(d.h,{width:.19,alignItems:"center",justifyContent:"center"},m.a.createElement(X.a,Object.assign({},e.props,{fieldInfo:{name:"oldApy",props:t},token:a,tokenConfig:i}))),m.a.createElement(d.h,{width:[.25,.19],alignItems:"center",justifyContent:"center"},m.a.createElement(X.a,Object.assign({},e.props,{fieldInfo:{name:"apy",props:t},token:a,tokenConfig:i}))),m.a.createElement(d.h,{width:[.25,.15],alignItems:"center",justifyContent:"center"},m.a.createElement(A.a,{handleClick:function(t){return e.migrate(a,o)},buttonProps:{size:"small",width:"100%",className:Be.a.gradientButton}},"MIGRATE")))})),m.a.createElement(d.h,{width:1,alignItems:"center",flexDirection:"column"},this.props.oldIdleTokensToMigrate&&Object.keys(this.props.oldIdleTokensToMigrate).map(function(n){var a=e.props.oldIdleTokensToMigrate[n].tokenConfig;if(!a)return null;var o=e.props.oldIdleTokensToMigrate[n].balance,i=null;return i=a.availableStrategies&&!e.props.availableTokens[a.baseToken]?e.props.availableStrategies[a.availableStrategies[0]][a.baseToken]:e.props.availableTokens[a.baseToken],m.a.createElement(d.h,{mt:2,width:1,alignItems:"center",flexDirection:"row",key:"token_".concat(n),justifyContent:"space-between"},m.a.createElement(d.h,{width:.28,alignItems:"center",flexDirection:"row"},m.a.createElement(X.a,{fieldInfo:{name:"icon",props:{mr:2,height:"2.3em"}},tokenConfig:a,token:n}),m.a.createElement(X.a,{fieldInfo:{name:"tokenName",props:t},tokenConfig:a,token:n})),m.a.createElement(d.h,{width:.19,alignItems:"center",justifyContent:"center"},m.a.createElement(F.a,Object.assign({},t,{minPrecision:5,number:o,flexProps:{justifyContent:"center"}}))),m.a.createElement(d.h,{width:.19,alignItems:"center",justifyContent:"center"},m.a.createElement(X.a,Object.assign({},e.props,{fieldInfo:{name:"oldApy",props:t},token:i.token,tokenConfig:i}))),m.a.createElement(d.h,{width:.19,alignItems:"center",justifyContent:"center"},m.a.createElement(X.a,Object.assign({},e.props,{fieldInfo:{name:"apy",props:t},token:i.token,tokenConfig:i}))),m.a.createElement(d.h,{width:.15,alignItems:"center",justifyContent:"center"},m.a.createElement(A.a,{handleClick:function(t){return e.convert(n)},buttonProps:{size:"small",width:"100%",className:Be.a.gradientButton}},"MIGRATE")))})),m.a.createElement(d.h,{my:3,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(A.a,{handleClick:this.closeModal,buttonProps:{fontSize:[2,3],width:["100%","40%"]}},"MIGRATE LATER"),m.a.createElement(d.e,{mt:2,required:!1,color:"mid-gray",checked:this.state.dontShowAgain,label:"Don't show this popup again",onChange:function(t){return e.toggleDontShowAgain(t.target.checked)}}))))))}}]),t}(m.a.Component),Ve=n(4722),Ge=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={},n.functionsUtil=null,n.componentDidUpdate=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.loadUtils();case 1:case"end":return e.stop()}},e,this)})),n.closeModal=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.props.closeModal();case 1:case"end":return e.stop()}},e,this)})),n.loadUtils(),n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props)}}]),Object(r.a)(t,[{key:"render",value:function(){return m.a.createElement(d.p,{isOpen:this.props.isOpen},m.a.createElement(G.a,{maxWidth:["960px","650px"],closeFunc:this.props.closeModal},m.a.createElement(G.a.Header,{pt:3,iconHeight:"40px",icon:"images/warning.svg",title:"Risk Adjusted Dismissed"}),m.a.createElement(G.a.Body,null,m.a.createElement(d.h,{width:1,flexDirection:"column"},m.a.createElement(d.u,{fontSize:2,textAlign:"left",color:"dark-gray"},"The Risk Adjusted strategy has been dismissed after the execution of ",m.a.createElement(h.a,{fontSize:2,href:this.functionsUtil.getAppUrl("#/governance/proposals/14")},"IIP-14")," on the 13th October 2021. An incentive program has been released to let users migrate their funds in the ",m.a.createElement(h.a,{fontSize:2,href:"https://beta.idle.finance/#/dashboard/tranches/senior/idle"},"Senior Tranche")," in order to keep a similar risk profile as the Risk-Adjusted strategy. Read the ",m.a.createElement(h.a,{fontSize:2,href:"https://gov.idle.finance/t/risk-adjusted-removal-for-tranches-migration/673"},"Governance Forum Post")," for further information about the migration program.")),m.a.createElement(d.h,{my:3,alignItems:"center",flexDirection:"column",justifyContent:"center"},m.a.createElement(A.a,{handleClick:this.closeModal,buttonProps:{width:["100%","40%"]}},"Got it")))))}}]),t}(m.a.Component),We=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),p=0;p<a;p++)r[p]=arguments[p];return(n=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={menu:[],baseRoute:null,clickEvent:null,activeModal:null,menuOpened:!1,currentRoute:null,pageComponent:null,currentSection:null,currentNetwork:null,selectedSection:null,tokensToMigrate:null,showResetButton:!1,selectedSubsection:null,pageComponentProps:null,oldIdleTokensToMigrate:null,protocolsTokensBalances:null},n.timeoutId=null,n.functionsUtil=null,n.resetModal=function(){n.setState({activeModal:null})},n.openTooltipModal=function(e,t){n.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UI",eventAction:e,eventLabel:"TooltipModal"}),n.setState({modalTitle:e,modalContent:t},function(){n.setActiveModal("tooltip")})},n.setActiveModal=function(e){n.setState({activeModal:e})},n.logout=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.props.setConnector("Infura","Infura"),e.next=3,n.props.initWeb3("Infura");case 3:case"end":return e.stop()}},e,this)})),n}return Object(p.a)(t,e),Object(r.a)(t,[{key:"loadUtils",value:function(){this.functionsUtil?this.functionsUtil.setProps(this.props):this.functionsUtil=new f.a(this.props),window.functionsUtil=this.functionsUtil}},{key:"loadMenu",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l,c,p,u,m=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.functionsUtil.getGlobalConfig(["extraicons"]),n=this.functionsUtil.getGlobalConfig(["dashboard","baseRoute"]),a=[],i=this.functionsUtil.getRequiredNetwork(),!(s=this.functionsUtil.getGlobalConfig(["tools","stakePolygon"])).enabled||s.availableNetworks&&!s.availableNetworks.includes(i.id)||a.push({submenu:[],label:"Stake",selected:!1,color:"dark-gray",route:"/dashboard/stake",image:t.stake.icon,imageDark:t.stake.iconDark,bgColor:this.props.theme.colors.primary,imageInactive:t.stake.iconInactive,imageInactiveDark:t.stake.iconInactiveDark,component:te,componentProps:{showBreadCrumb:!1,toolProps:s.props,selectedSubsection:s}}),r=this.functionsUtil.getGlobalConfig(["strategies"]),Object.keys(r).filter(function(e){return!r[e].comingSoon&&(!r[e].availableNetworks||r[e].availableNetworks.includes(i.id))&&(!r[e].enabledEnvs.length||r[e].enabledEnvs.includes(m.props.currentEnv))}).forEach(function(e){var o=r[e],i=t[e];a.push({submenu:[],color:"#fff",selected:!1,image:i.icon,label:o.title,bgColor:o.color,route:n+"/"+e,visible:o.visible,imageDark:i.iconDark,component:o.component,imageInactive:i.iconInactive,imageInactiveDark:i.iconInactiveDark})}),(l=this.functionsUtil.getGlobalConfig(["curve"])).enabled&&(c=Object.assign({submenu:[],selected:!1,component:Ue},l.params),a.push(c)),!(p=this.functionsUtil.getGlobalConfig(["tools","stake"])).enabled||p.availableNetworks&&!p.availableNetworks.includes(i.id)||a.push({submenu:[],label:"Stake",selected:!1,color:"dark-gray",route:"/dashboard/stake",image:t.stake.icon,imageDark:t.stake.iconDark,bgColor:this.props.theme.colors.primary,imageInactive:t.stake.iconInactive,imageInactiveDark:t.stake.iconInactiveDark,component:te,componentProps:{showBreadCrumb:!1,toolProps:p.props,selectedSubsection:p}}),(u=this.functionsUtil.getGlobalConfig(["stats"])).availableNetworks&&!u.availableNetworks.includes(i.id)||a.push({submenu:[],label:"Stats",selected:!1,component:Z,bgColor:"#21f36b",color:"dark-gray",route:"/dashboard/stats",image:t.stats.icon,imageDark:t.stats.iconDark,imageInactive:t.stats.iconInactive,imageInactiveDark:t.stats.iconInactiveDark}),a.push({label:"Tools",selected:!1,component:te,color:"dark-gray",route:"/dashboard/tools",image:t.tools.icon,imageDark:t.tools.iconDark,bgColor:this.props.theme.colors.primary,imageInactive:t.tools.iconInactive,imageInactiveDark:t.tools.iconInactiveDark,submenu:Object.values(this.functionsUtil.getGlobalConfig(["tools"])).filter(function(e){return e.enabled&&(!e.availableNetworks||e.availableNetworks.includes(i.id))})}),a.push({submenu:[],mobile:!1,label:"Forum",selected:!1,component:null,color:"dark-gray",bgColor:"#ff0000",isExternalLink:!0,image:t.forum.icon,imageDark:t.forum.iconDark,imageInactive:t.forum.iconInactive,imageInactiveDark:t.forum.iconInactiveDark,route:this.functionsUtil.getGlobalConfig(["forumURL"])}),e.next=18,this.setState({menu:a,currentNetwork:i});case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadParams",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l,c,p,u,m,h,d,f,g,b,k,v,x;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.networkInitialized){e.next=2;break}return e.abrupt("return");case 2:if(t=this.props.match.params,n=this.functionsUtil.getGlobalConfig(["dashboard","baseRoute"]),a=n,i=null,s=null,r=null,l=null,c=null,t.section&&(r=t.section,p=t.param1,u=t.param2,m=t.param3,h=Object.keys(this.props.availableStrategies).includes(r.toLowerCase()),d=p&&(Object.keys(this.props.availableStrategies).includes(p.toLowerCase())||"tranches"===p),h||d?(h||(a+="/"+r),a+="/"+(l=h?r:p),f="tranches"===p?null:p&&Object.keys(this.props.availableStrategies[l]).includes(p.toUpperCase()),g="tranches"===p?null:u&&Object.keys(this.props.availableStrategies[l]).includes(u.toUpperCase()),f||g?(s=f?p.toUpperCase():u.toUpperCase(),a+="/"+s,h&&(i=ye)):"tranches"===p&&(s=t.param3,a+="/"+u+"/"+m)):(a+="/"+t.section,t.param1&&t.param1.length&&(a+="/"+t.param1))),b=this.state.menu,k=null,v=null,b.forEach(function(e){e.selected=!1;var o=n+"/"+t.section;a.toLowerCase()===e.route.toLowerCase()||!e.submenu.length&&e.route.toLowerCase()===o.toLowerCase()?(e.selected=!0,null===i&&(i=e.component,c=e.componentProps)):e.submenu.length&&e.submenu.forEach(function(t){t.selected=!1,(e.route+"/"+t.route).toLowerCase()===a.toLowerCase()&&(e.selected=!0,t.selected=!0,null===i&&(t.component?(i=t.component,c=e.componentProps):(i=e.component,c=e.componentProps))),t.selected&&(v=t)}),e.selected&&(k=e)}),i){e.next=17;break}return e.abrupt("return",this.goToSection("",!1));case 17:if("tranches"!==l||"stats"!==r){e.next=22;break}return e.next=20,this.props.setStrategyToken(l,s,t.param2);case 20:e.next=24;break;case 22:return e.next=24,this.props.setStrategyToken(l,s);case 24:return this.functionsUtil.sendGoogleAnalyticsPageview(a),x={menu:b,params:t,baseRoute:n,currentRoute:a,pageComponent:i,currentSection:r,selectedSection:k,pageComponentProps:c,selectedSubsection:v},e.next=28,this.setState(x);case 28:return e.abrupt("return",x);case 29:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.timeoutId&&window.clearTimeout(this.timeoutId)}},{key:"componentWillMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.setCurrentSection("dashboard"),this.loadUtils(),e.next=4,this.loadMenu();case 4:this.loadParams();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.timeoutId=window.setTimeout(function(){t.props.accountInizialized&&t.props.contractsInitialized||t.setState({showResetButton:!0})},6e4),this.props.web3){e.next=5;break}return e.abrupt("return",this.props.initWeb3());case 5:if(this.props.accountInizialized){e.next=9;break}return e.abrupt("return",this.props.initAccount());case 9:if(this.props.contractsInitialized){e.next=11;break}return e.abrupt("return",this.props.initializeContracts());case 11:return this.loadUtils(),e.next=14,this.loadMenu();case 14:this.loadParams(),"custom"===this.props.connectorName||this.checkModals();case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a,i,s,r,l,c,p,u,m,h,d=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadUtils(),a=t.match.params,i=this.props.match.params,t.isMobile!==this.props.isMobile&&this.setState({menuOpened:!1}),JSON.stringify(a)===JSON.stringify(i)){e.next=8;break}return e.next=8,this.setState({pageComponent:null},function(){d.loadParams()});case 8:if(s=JSON.stringify(t.network.required)!==JSON.stringify(this.props.network.required),!(r=!t.networkInitialized&&this.props.networkInitialized||s)){e.next=14;break}return e.next=13,this.loadMenu();case 13:this.loadParams();case 14:l="custom"===this.props.connectorName,c=t.account!==this.props.account,p=this.props.selectedStrategy&&t.selectedStrategy!==this.props.selectedStrategy,u=JSON.stringify(t.availableTokens)!==JSON.stringify(this.props.availableTokens),m=this.props.accountInizialized&&t.accountInizialized!==this.props.accountInizialized,h=this.props.contractsInitialized&&t.contractsInitialized!==this.props.contractsInitialized,!l&&(r||c||m||h||p||u)&&this.checkModals();case 21:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"checkModals",value:function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.selectedToken&&this.props.accountInizialized&&this.props.contractsInitialized&&this.props.availableStrategies&&this.props.availableTokens){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,this.checkRiskAdjusted();case 4:return e.next=6,this.checkPolygonModal();case 6:return e.next=8,this.checkBetaApproval();case 8:return e.next=10,this.checkTokensToMigrate();case 10:return e.next=12,this.checkWelcomeModal();case 12:return e.next=14,this.checkProtocolsTokensBalances();case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkRiskAdjusted",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!("risk"===this.props.selectedStrategy)){e.next=7;break}if((t="risk")===this.state.activeModal){e.next=7;break}return e.next=6,this.setState({activeModal:t});case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkPolygonModal",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t="polygon"===this.state.currentNetwork.provider,n=this.functionsUtil.getStoredItem("polygonApproved",!1,!1),!t||n){e.next=8;break}if((a="polygon")===this.state.activeModal){e.next=8;break}return e.next=7,this.setState({activeModal:a});case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkBetaApproval",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.functionsUtil.checkUrlOrigin(),n="polygon"===this.state.currentNetwork.provider,a=this.functionsUtil.getStoredItem("betaApproved",!1,!1),t||a||n||null!==this.state.activeModal){e.next=9;break}if((i="beta")===this.state.activeModal){e.next=9;break}return e.next=8,this.setState({activeModal:i});case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkTokensToMigrate",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null===this.functionsUtil.getStoredItem("dontShowUpgradeModal",!1,null),!this.props.selectedToken&&t&&this.props.availableTokens&&null===this.state.activeModal){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,this.functionsUtil.getTokensToMigrate();case 5:return n=e.sent,e.next=8,this.functionsUtil.getProtocolsTokensBalances("idle");case 8:if(a=e.sent,!(n&&Object.keys(n).length>0||a&&Object.keys(a).length>0)){e.next=15;break}if((i="upgrade")===this.state.activeModal){e.next=15;break}return e.next=14,this.setState({activeModal:i,tokensToMigrate:n,oldIdleTokensToMigrate:a});case 14:return e.abrupt("return",i);case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkWelcomeModal",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r,l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.account&&this.props.accountInizialized&&this.props.contractsInitialized){e.next=2;break}return e.abrupt("return",null);case 2:if(!this.props.account||null!==this.state.activeModal){e.next=11;break}if(t=!1,(n=this.functionsUtil.getGlobalConfig(["modals","welcome"])).enabled&&localStorage&&(a=(new Date).getTime(),i=this.props.account.toLowerCase(),(s=localStorage.getItem("lastLogin")?JSON.parse(localStorage.getItem("lastLogin")):{})[i]?s[i].signedUp||(r=parseInt(s[i].lastTime),t=(a-r)/1e3>=n.frequency):(s[i]={signedUp:!1,lastTime:a},t=!0),t&&(s[i].lastTime=a,this.functionsUtil.setLocalStorage("lastLogin",JSON.stringify(s)))),l=t?"welcome":this.state.activeModal,this.state.activeModal===l){e.next=11;break}return e.next=10,this.setState({activeModal:l});case 10:return e.abrupt("return",l);case 11:return e.abrupt("return",null);case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkProtocolsTokensBalances",value:function(){var e=Object(i.a)(o.a.mark(function e(){var t,n,a,i,s,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.account&&this.props.accountInizialized&&this.props.contractsInitialized){e.next=2;break}return e.abrupt("return",null);case 2:if(t=this.functionsUtil.getGlobalConfig(["modals","migrate"]),n=t.enabled&&t.availableNetworks.includes(this.state.currentNetwork.id),a=null===this.functionsUtil.getStoredItem("dontShowMigrateModal",!1,null),null!==this.state.activeModal||!n||!a||this.state.protocolsTokensBalances){e.next=14;break}return e.next=8,this.functionsUtil.getProtocolsTokensBalances();case 8:return i=e.sent,s=i&&Object.keys(i).length>0?"migrate":null,r={activeModal:s,protocolsTokensBalances:i},e.next=13,this.setState(r);case 13:return e.abrupt("return",s);case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"goToSection",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&(e=e.replace(this.state.baseRoute+"/",""));var n=t?this.state.baseRoute+"/"+e:e;window.location.hash=n,this.functionsUtil.sendGoogleAnalyticsEvent({eventCategory:"UI",eventAction:"goToSection",eventLabel:n}),window.scrollTo(0,0)}},{key:"changeToken",value:function(e){if(e=e.toUpperCase(),Object.keys(this.props.availableTokens).includes(e)){var t=[];this.state.currentSection.toLowerCase()!==this.props.selectedStrategy.toLowerCase()&&t.push(this.state.currentSection),t.push(this.props.selectedStrategy),t.push(e),this.goToSection(t.join("/"))}}},{key:"changeProtocolToken",value:function(e,t){if(e=e.toLowerCase(),Object.keys(this.props.availableTranches).includes(e)&&Object.keys(this.props.availableTranches[e]).includes(t)){var n=[];this.state.currentSection.toLowerCase()!==this.props.selectedStrategy.toLowerCase()&&n.push(this.state.currentSection),n.push(this.props.selectedStrategy),n.push(e),n.push(t),this.goToSection(n.join("/"))}}},{key:"propagateClickEvent",value:function(e){this.setState({clickEvent:e.target})}},{key:"setMenu",value:function(e){this.setState({menuOpened:e})}},{key:"toggleMenu",value:function(){var e=!this.state.menuOpened;this.setMenu(e)}},{key:"swipeCallback",value:function(e){"Right"===e.dir?this.setMenu(!0):"Left"===e.dir&&this.setMenu(!1)}},{key:"render",value:function(){var e=this,t=this.props.network.isCorrectNetwork,n=this.props.network.isSupportedNetwork,a=this.state.pageComponent?this.state.pageComponent:null,o=this.props.networkInitialized&&this.props.network.current.id&&this.props.network.required.id;return this.props.availableStrategies?m.a.createElement(Te.a,{callback:this.swipeCallback.bind(this)},m.a.createElement(d.h,{height:"100vh",position:"fixed",flexDirection:"row",backgroundColor:"dashboardBg",className:this.props.themeMode,width:this.props.isMobile&&this.state.menuOpened?"180vw":"100vw"},(!this.props.isMobile||this.state.menuOpened)&&m.a.createElement(d.h,{bottom:0,zIndex:99999,position:"relative",width:["80vw",1/6],flexDirection:"column"},m.a.createElement(d.d,{p:0,border:0,boxShadow:0,width:"auto",height:"100vh",backgroundColor:"menuBg",borderColor:this.props.theme.colors.menuRightBorder,borderRight:"1px solid ".concat(this.props.theme.colors.menuRightBorder)},m.a.createElement(v.a,Object.assign({},this.props,{menu:this.state.menu,closeMenu:function(t){return e.setMenu(!1)},goToSection:this.goToSection.bind(this)})))),m.a.createElement(d.h,{minHeight:"70vh",width:["100vw",5/6],flexDirection:"column"},m.a.createElement(Ve.a,Object.assign({menuOpened:this.state.menuOpened,clickEvent:this.state.clickEvent,toggleMenu:this.toggleMenu.bind(this),goToSection:this.goToSection.bind(this)},this.props)),m.a.createElement(d.h,{py:3,mb:0,width:1,px:[3,5],alignItems:"center",style:{overflowY:"scroll",overflowX:"hidden"},justifyItems:"center",flexDirection:"column",height:["100vh","100%"],backgroundColor:"dashboardBg"},this.props.isDashboard&&m.a.createElement(b,this.props),o&&this.props.accountInizialized&&this.props.contractsInitialized&&a&&t&&n?m.a.createElement(d.h,{width:1,flexDirection:"column"},a&&m.a.createElement(a,Object.assign({},this.props,{match:{params:{}},urlParams:this.state.params,changeToken:this.changeToken.bind(this),changeProtocolToken:this.changeProtocolToken.bind(this),goToSection:this.goToSection.bind(this),selectedSection:this.state.selectedSection,selectedSubsection:this.state.selectedSubsection,openTooltipModal:this.openTooltipModal.bind(this)},this.state.pageComponentProps))):m.a.createElement(d.h,{width:1,minHeight:"50vh",alignItems:"center",flexDirection:"column",justifyContent:"center"},o&&!t?m.a.createElement(g.a,{cardProps:{p:3,mt:3,width:[1,.35]}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(d.k,{size:"2.3em",name:"Warning",color:"cellText"}),m.a.createElement(d.u,{mt:2,fontSize:2,color:"cellText",textAlign:"center"},"You should be on the ",m.a.createElement("strong",null,this.functionsUtil.capitalize(this.props.network.required.name)," network"),". You are currently connected to the ",m.a.createElement("strong",null,this.functionsUtil.capitalize(this.props.network.current.name)," network"),", please switch to the correct network."),m.a.createElement(A.a,{buttonProps:{mt:3,width:[1,.5]},handleClick:function(t){return e.functionsUtil.addEthereumChain(e.props.network.required.id)}},"Switch Network"))):o&&!n?m.a.createElement(g.a,{cardProps:{p:3,mt:3,width:[1,.35]}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(d.k,{size:"2.3em",name:"Warning",color:"cellText"}),m.a.createElement(d.u,{mt:2,fontSize:2,color:"cellText",textAlign:"center"},"The ",m.a.createElement("strong",null,this.functionsUtil.capitalize(this.props.network.current.name)," Network")," is not supported, please switch to the correct network."))):this.state.showResetButton?m.a.createElement(g.a,{cardProps:{p:3,mt:3,width:[1,.35]}},m.a.createElement(d.h,{alignItems:"center",flexDirection:"column"},m.a.createElement(d.k,{size:"2.3em",name:"Warning",color:"cellText"}),m.a.createElement(d.u,{mt:2,fontSize:2,color:"cellText",textAlign:"center"},"Idle can't connect to your wallet!",m.a.createElement("br",null),"Make sure that your wallet is unlocked and try again."),m.a.createElement(A.a,{buttonProps:{mt:3,width:[1,.5]},handleClick:this.logout.bind(this)},"Logout"))):m.a.createElement(k.a,{textProps:{textSize:4,fontWeight:2},loaderProps:{mb:3,size:"40px"},flexProps:{my:3,flexDirection:"column"},text:this.props.networkInitialized?this.props.accountInizialized?this.props.contractsInitialized?"Loading assets...":"Loading contracts...":"Loading account...":"Loading network..."})))),this.state.currentNetwork&&m.a.createElement(je,{closeModal:this.resetModal,goToSection:this.goToSection.bind(this),currentNetwork:this.state.currentNetwork,isOpen:"polygon"===this.state.activeModal}),m.a.createElement(we,{closeModal:this.resetModal,isOpen:"beta"===this.state.activeModal}),m.a.createElement(Ge,{closeModal:this.resetModal,isOpen:"risk"===this.state.activeModal}),m.a.createElement(Ne,Object.assign({},this.props,{closeModal:this.resetModal,goToSection:this.goToSection.bind(this),tokensToMigrate:this.state.tokensToMigrate,isOpen:"upgrade"===this.state.activeModal,oldIdleTokensToMigrate:this.state.oldIdleTokensToMigrate})),m.a.createElement(He,Object.assign({},this.props,{closeModal:this.resetModal,goToSection:this.goToSection.bind(this),isOpen:"migrate"===this.state.activeModal,protocolsTokensBalances:this.state.protocolsTokensBalances})),m.a.createElement(Re.a,{closeModal:this.resetModal,title:this.state.modalTitle,content:this.state.modalContent,isOpen:"tooltip"===this.state.activeModal}),m.a.createElement(ze,{closeModal:this.resetModal,account:this.props.account,simpleID:this.props.simpleID,network:this.props.network.current,tokenName:this.props.selectedToken,initSimpleID:this.props.initSimpleID,baseTokenName:this.props.selectedToken,isOpen:"welcome"===this.state.activeModal}))):m.a.createElement(d.h,{width:1,minHeight:"100vh",alignItems:"center",flexDirection:"column",justifyContent:"center",backgroundColor:"selectBg"},m.a.createElement(k.a,{textProps:{textSize:4,fontWeight:2},loaderProps:{mb:3,size:"80px",color:"primary"},flexProps:{my:3,flexDirection:"column"},text:""}))}}]),t}(u.Component);t.default=We}}]);
//# sourceMappingURL=8.a3d3d118.chunk.js.map